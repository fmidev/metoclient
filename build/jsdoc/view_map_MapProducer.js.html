<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: view/map/MapProducer.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: view/map/MapProducer.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview Map source factory.
 * @author Finnish Meteorological Institute
 * @license MIT
 */

import OlLayerTile from 'ol/layer/tile'
import TileWMS from './TileWMS'
import ImageWMS from './ImageWMS'
import WMTS from './WMTS'
import Vector from './Vector'
import Stamen from './Stamen'
import OSM from './OSM'
import FeatureProducer from './FeatureProducer'
import * as constants from '../../constants'
import OlLayerImage from 'ol/layer/image'
import OlLayerVector from 'ol/layer/vector'
import OlStyleStyle from 'ol/style/style'

export default class MapProducer {
  /**
   * Creates a new layer source object.
   * @param {string} type Source type.
   * @param options Source options.
   * @param projection {string} Projection.
   * @returns {Array} Source.
   */
  sourceFactory (type, options, projection) {
    if (options == null) {
      options = {}
    }
    let typeLwr = type.toLowerCase()
    switch (typeLwr) {
      case 'tilewms':
        return new TileWMS(options)
      case 'imagewms':
        return new ImageWMS(options)
      case 'wmts':
        return new WMTS(options)
      case 'vector':
        return new Vector(options, projection)
      case 'stamen':
        return new Stamen(options)
      case 'osm':
        return new OSM(options)
    }
  }

  /**
   * Creates a new layer.
   * @param options Layer options.
   * @param {Array} extent Extent of layer to be loaded.
   * @param projection {string} Projection.
   * @returns {Array} Layer.
   */
  layerFactory (options, extent, projection) {
    let numStyles
    let i
    let z
    let featureProducer
    let typeLwr = options['className'].toLowerCase()
    let source
    let sourceKey = 'source'
    if (options['sourceOptions'] !== undefined) {
      sourceKey += 'Options'
    }
    source = this.sourceFactory(typeLwr, options[sourceKey], projection)
    switch (typeLwr) {
      case 'tilewms':
      case 'wmts':
      case 'stamen':
      case 'osm':
        return new OlLayerTile({
          'extent': extent,
          'type': options['type'],
          'title': options['title'],
          'visible': options['visible'],
          'animation': options['animation'],
          'opacity': options['opacity'],
          'editOpacity': options['editOpacity'],
          'zIndex': options['zIndex'],
          'source': source
        })
      case 'imagewms':
        return new OlLayerImage({
          'extent': extent,
          'type': options['type'],
          'title': options['title'],
          'visible': options['visible'],
          'animation': options['animation'],
          'opacity': options['opacity'],
          'editOpacity': options['editOpacity'],
          'zIndex': options['zIndex'],
          'source': source
        })
      case 'vector':
        z = {
          'value': 0
        }
        options['source'] = source
        featureProducer = new FeatureProducer()
        if (Array.isArray(options['style'])) {
          numStyles = options['style'].length
          for (i = 0; i &lt; numStyles; i++) {
            if (!(options['style'][i] instanceof OlStyleStyle)) {
              options['style'][i] = featureProducer.styleFactory(options['style'][i], z)
            }
          }
        }
        options['zIndex'] = constants.zIndex.vector + z['value']
        let layer = new OlLayerVector(options)
        layer.setZIndex(options['zIndex'])
        return layer
    }
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="MetOClient.html">MetOClient</a></li><li><a href="module.exports.html">exports</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addFeatures">addFeatures</a></li><li><a href="global.html#clearFeatures">clearFeatures</a></li><li><a href="global.html#createMap">createMap</a></li><li><a href="global.html#createMenu">createMenu</a></li><li><a href="global.html#createTime">createTime</a></li><li><a href="global.html#createTimer">createTimer</a></li><li><a href="global.html#createTimeSlider">createTimeSlider</a></li><li><a href="global.html#destroyAnimation">destroyAnimation</a></li><li><a href="global.html#destroyTime">destroyTime</a></li><li><a href="global.html#destroyTimer">destroyTimer</a></li><li><a href="global.html#destroyTimeSlider">destroyTimeSlider</a></li><li><a href="global.html#featureFactory">featureFactory</a></li><li><a href="global.html#floorTime">floorTime</a></li><li><a href="global.html#getAnimationBeginTime">getAnimationBeginTime</a></li><li><a href="global.html#getAnimationEndTime">getAnimationEndTime</a></li><li><a href="global.html#getAnimationNumIntervals">getAnimationNumIntervals</a></li><li><a href="global.html#getAnimationResolutionTime">getAnimationResolutionTime</a></li><li><a href="global.html#getAnimationTime">getAnimationTime</a></li><li><a href="global.html#getCapabilities">getCapabilities</a></li><li><a href="global.html#getCreationTime">getCreationTime</a></li><li><a href="global.html#getCurrentTime">getCurrentTime</a></li><li><a href="global.html#getFeatures">getFeatures</a></li><li><a href="global.html#getFeaturesAt">getFeaturesAt</a></li><li><a href="global.html#getLayer">getLayer</a></li><li><a href="global.html#getLayers">getLayers</a></li><li><a href="global.html#getMap">getMap</a></li><li><a href="global.html#getRefreshInterval">getRefreshInterval</a></li><li><a href="global.html#getStaticControls">getStaticControls</a></li><li><a href="global.html#getTickText">getTickText</a></li><li><a href="global.html#hidePopup">hidePopup</a></li><li><a href="global.html#isWaitingAutoStart">isWaitingAutoStart</a></li><li><a href="global.html#layerFactory">layerFactory</a></li><li><a href="global.html#LEGEND_CONTAINER_CLASS">LEGEND_CONTAINER_CLASS</a></li><li><a href="global.html#LEGEND_FIGURE_CLASS_PREFIX">LEGEND_FIGURE_CLASS_PREFIX</a></li><li><a href="global.html#loadCapabilities">loadCapabilities</a></li><li><a href="global.html#LOADING_STATUS">LOADING_STATUS</a></li><li><a href="global.html#MAX_TIMESTAMP">MAX_TIMESTAMP</a></li><li><a href="global.html#moveAnimationTimeFrame">moveAnimationTimeFrame</a></li><li><a href="global.html#movePointer">movePointer</a></li><li><a href="global.html#next">next</a></li><li><a href="global.html#pause">pause</a></li><li><a href="global.html#play">play</a></li><li><a href="global.html#previous">previous</a></li><li><a href="global.html#refreshLayers">refreshLayers</a></li><li><a href="global.html#refreshMap">refreshMap</a></li><li><a href="global.html#refreshTime">refreshTime</a></li><li><a href="global.html#requestViewUpdate">requestViewUpdate</a></li><li><a href="global.html#setAnimationLastRefreshed">setAnimationLastRefreshed</a></li><li><a href="global.html#setAnimationPlay">setAnimationPlay</a></li><li><a href="global.html#setAnimationTime">setAnimationTime</a></li><li><a href="global.html#setAnimationTimes">setAnimationTimes</a></li><li><a href="global.html#setBeginTime">setBeginTime</a></li><li><a href="global.html#setCallbacks">setCallbacks</a></li><li><a href="global.html#setCapabilities">setCapabilities</a></li><li><a href="global.html#setCenter">setCenter</a></li><li><a href="global.html#setCurrentTime">setCurrentTime</a></li><li><a href="global.html#setDayStartOffset">setDayStartOffset</a></li><li><a href="global.html#setEndTime">setEndTime</a></li><li><a href="global.html#setFrameRate">setFrameRate</a></li><li><a href="global.html#setInteractions">setInteractions</a></li><li><a href="global.html#setLayers">setLayers</a></li><li><a href="global.html#setLayerVisible">setLayerVisible</a></li><li><a href="global.html#setPointerText">setPointerText</a></li><li><a href="global.html#setPointerTime">setPointerTime</a></li><li><a href="global.html#setResolutionTime">setResolutionTime</a></li><li><a href="global.html#setRotation">setRotation</a></li><li><a href="global.html#setStaticControls">setStaticControls</a></li><li><a href="global.html#setTimeStep">setTimeStep</a></li><li><a href="global.html#setTimeZone">setTimeZone</a></li><li><a href="global.html#setTimeZoneLabel">setTimeZoneLabel</a></li><li><a href="global.html#setZoom">setZoom</a></li><li><a href="global.html#showPopup">showPopup</a></li><li><a href="global.html#sourceFactory">sourceFactory</a></li><li><a href="global.html#startTimer">startTimer</a></li><li><a href="global.html#stop">stop</a></li><li><a href="global.html#styleFactory">styleFactory</a></li><li><a href="global.html#supportOldBrowsers">supportOldBrowsers</a></li><li><a href="global.html#updatePointer">updatePointer</a></li><li><a href="global.html#updateTimeLoaderVis">updateTimeLoaderVis</a></li><li><a href="global.html#updateTimeSlider">updateTimeSlider</a></li><li><a href="global.html#updateTimeSteps">updateTimeSteps</a></li><li><a href="global.html#zIndex">zIndex</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Fri Dec 15 2017 11:16:48 GMT+0200 (EET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
