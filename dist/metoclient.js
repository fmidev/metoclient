// MetOClient 6.0.1 - FMI - October 25, 2019
this.fmi=this.fmi||{},this.fmi.metoclient=function(t){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function asyncGeneratorStep(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(n,!0).forEach((function(e){_defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,e){return t.__proto__=e,t})(t,e)}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}createCommonjsModule((function(t){var e=function(t){var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function wrap(t,e,n,r){var i=e&&e.prototype instanceof Generator?e:Generator,o=Object.create(i.prototype),a=new Context(r||[]);return o._invoke=function makeInvokeMethod(t,e,n){var r=u;return function invoke(i,o){if(r===c)throw new Error("Generator is already running");if(r===h){if("throw"===i)throw o;return doneResult()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=maybeInvokeDelegate(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===u)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=c;var f=tryCatch(t,e,n);if("normal"===f.type){if(r=n.done?h:l,f.arg===d)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(r=h,n.method="throw",n.arg=f.arg)}}}(t,n,a),o}function tryCatch(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var u="suspendedStart",l="suspendedYield",c="executing",h="completed",d={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var f={};f[o]=function(){return this};var p=Object.getPrototypeOf,m=p&&p(p(values([])));m&&m!==n&&r.call(m,o)&&(f=m);var y=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(f);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function AsyncIterator(t){var e;this._invoke=function enqueue(n,i){function callInvokeWithMethodAndArg(){return new Promise((function(e,o){!function invoke(e,n,i,o){var a=tryCatch(t[e],t,n);if("throw"!==a.type){var s=a.arg,u=s.value;return u&&"object"==typeof u&&r.call(u,"__await")?Promise.resolve(u.__await).then((function(t){invoke("next",t,i,o)}),(function(t){invoke("throw",t,i,o)})):Promise.resolve(u).then((function(t){s.value=t,i(s)}),(function(t){return invoke("throw",t,i,o)}))}o(a.arg)}(n,i,e,o)}))}return e=e?e.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,maybeInvokeDelegate(t,n),"throw"===n.method))return d;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=tryCatch(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(r.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=e,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:e,done:!0}}return GeneratorFunction.prototype=y.constructor=GeneratorFunctionPrototype,GeneratorFunctionPrototype.constructor=GeneratorFunction,GeneratorFunctionPrototype[s]=GeneratorFunction.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),AsyncIterator.prototype[a]=function(){return this},t.AsyncIterator=AsyncIterator,t.async=function(e,n,r,i){var o=new AsyncIterator(wrap(e,n,r,i));return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},defineIteratorMethods(y),y[s]="Generator",y[o]=function(){return this},y.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function next(){for(;e.length;){var n=e.pop();if(n in t)return next.value=n,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function handle(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return handle("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0);if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),resetTryEntry(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;resetTryEntry(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:values(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),d}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}));var n="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,i=arguments.length;r<i;++r){var o=arguments[r];if(null!=o)for(var a in o)o.hasOwnProperty(a)&&(n[a]=o[a])}return n};function clear(t){for(var e in t)delete t[e]}var r="function"==typeof Object.values?Object.values:function(t){var e=[];for(var n in t)e.push(t[n]);return e};function clamp(t,e,n){return Math.min(Math.max(t,e),n)}var i="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function squaredSegmentDistance(t,e,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var u=((t-n)*a+(e-r)*s)/(a*a+s*s);u>1?(n=i,r=o):u>0&&(n+=a*u,r+=s*u)}return squaredDistance(t,e,n,r)}function squaredDistance(t,e,n,r){var i=n-t,o=r-e;return i*i+o*o}function toRadians(t){return t*Math.PI/180}function modulo(t,e){var n=t%e;return n*e<0?n+e:n}function lerp(t,e,n){return t+n*(e-t)}var o="Point",a="LinearRing",s="Polygon",l="Circle",c=6371008.8;
/**
   * @license
   * Latitude/longitude spherical geodesy formulae taken from
   * http://www.movable-type.co.uk/scripts/latlong.html
   * Licensed under CC-BY-3.0.
   */function getDistance(t,e,n){var r=n||c,i=toRadians(t[1]),o=toRadians(e[1]),a=(o-i)/2,s=toRadians(e[0]-t[0])/2,u=Math.sin(a)*Math.sin(a)+Math.sin(s)*Math.sin(s)*Math.cos(i)*Math.cos(o);return 2*r*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}function abstract(){return function(){throw new Error("Unimplemented abstract method.")}()}var h=0;function getUid(t){return t.ol_uid||(t.ol_uid=String(++h))}var d,f="6.0.1",m=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function __(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),y=function(t){function AssertionError(e){var n=this,r="Assertion failed. See https://openlayers.org/en/"+("v"+f.split("-")[0])+"/doc/errors/#"+e+" for details.";return(n=t.call(this,r)||this).code=e,n.name="AssertionError",n.message=r,n}return m(AssertionError,t),AssertionError}(Error);function assert(t,e){if(!t)throw new y(e)}var g={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},v={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function boundingExtent(t){for(var e=createEmpty(),n=0,r=t.length;n<r;++n)extendCoordinate(e,t[n]);return e}function buffer(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function closestSquaredDistanceXY(t,e,n){var r,i;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(i=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*i}function containsCoordinate(t,e){return containsXY(t,e[0],e[1])}function containsExtent(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function containsXY(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function coordinateRelationship(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],s=e[1],u=v.UNKNOWN;return a<n?u|=v.LEFT:a>i&&(u|=v.RIGHT),s<r?u|=v.BELOW:s>o&&(u|=v.ABOVE),u===v.UNKNOWN&&(u=v.INTERSECTING),u}function createEmpty(){return[1/0,1/0,-1/0,-1/0]}function createOrUpdate(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function createOrUpdateEmpty(t){return createOrUpdate(1/0,1/0,-1/0,-1/0,t)}function createOrUpdateFromCoordinates(t,e){return function extendCoordinates(t,e){for(var n=0,r=e.length;n<r;++n)extendCoordinate(t,e[n]);return t}(createOrUpdateEmpty(e),t)}function equals(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function extendCoordinate(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function extendFlatCoordinates(t,e,n,r,i){for(;n<r;n+=i)extendXY(t,e[n],e[n+1]);return t}function extendXY(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function getArea(t){var e=0;return isEmpty(t)||(e=getWidth(t)*getHeight(t)),e}function getBottomLeft(t){return[t[0],t[1]]}function getBottomRight(t){return[t[2],t[1]]}function getCenter(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function getCorner(t,e){var n;return e===g.BOTTOM_LEFT?n=getBottomLeft(t):e===g.BOTTOM_RIGHT?n=getBottomRight(t):e===g.TOP_LEFT?n=getTopLeft(t):e===g.TOP_RIGHT?n=getTopRight(t):assert(!1,13),n}function getForViewAndSize(t,e,n,r,i){var o=e*r[0]/2,a=e*r[1]/2,s=Math.cos(n),u=Math.sin(n),l=o*s,c=o*u,h=a*s,d=a*u,f=t[0],p=t[1],m=f-l+d,y=f-l-d,g=f+l-d,v=f+l+d,_=p-c-h,b=p-c+h,T=p+c+h,w=p+c-h;return createOrUpdate(Math.min(m,y,g,v),Math.min(_,b,T,w),Math.max(m,y,g,v),Math.max(_,b,T,w),i)}function getHeight(t){return t[3]-t[1]}function getIntersection(t,e,n){var r=n||[1/0,1/0,-1/0,-1/0];return intersects(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):createOrUpdateEmpty(r),r}function getTopLeft(t){return[t[0],t[3]]}function getTopRight(t){return[t[2],t[3]]}function getWidth(t){return t[2]-t[0]}function intersects(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function isEmpty(t){return t[2]<t[0]||t[3]<t[1]}function applyTransform(t,e,n){var r=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(r,r,2),function _boundingExtentXYs(t,e,n){return createOrUpdate(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}([r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]],n)}var _={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},b={};b[_.DEGREES]=2*Math.PI*6370997/360,b[_.FEET]=.3048,b[_.METERS]=1,b[_.USFEET]=1200/3937;var T=function(){function Projection(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return Projection.prototype.canWrapX=function(){return this.canWrapX_},Projection.prototype.getCode=function(){return this.code_},Projection.prototype.getExtent=function(){return this.extent_},Projection.prototype.getUnits=function(){return this.units_},Projection.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||b[this.units_]},Projection.prototype.getWorldExtent=function(){return this.worldExtent_},Projection.prototype.getAxisOrientation=function(){return this.axisOrientation_},Projection.prototype.isGlobal=function(){return this.global_},Projection.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},Projection.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},Projection.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},Projection.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},Projection.prototype.setWorldExtent=function(t){this.worldExtent_=t},Projection.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},Projection.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},Projection}(),w=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),E=6378137,S=Math.PI*E,M=[-S,-S,S,S],O=[-180,-85,180,85],C=function(t){function EPSG3857Projection(e){return t.call(this,{code:e,units:_.METERS,extent:M,global:!0,worldExtent:O,getPointResolution:function(t,e){return t/i(e[1]/E)}})||this}return w(EPSG3857Projection,t),EPSG3857Projection}(T),P=[new C("EPSG:3857"),new C("EPSG:102100"),new C("EPSG:102113"),new C("EPSG:900913"),new C("urn:ogc:def:crs:EPSG:6.18:3:3857"),new C("urn:ogc:def:crs:EPSG::3857"),new C("http://www.opengis.net/gml/srs/epsg.xml#3857")];function fromEPSG4326(t,e,n){var r=t.length,i=n>1?n:2,o=e;void 0===o&&(o=i>2?t.slice():new Array(r));for(var a=S,s=0;s<r;s+=i){o[s]=a*t[s]/180;var u=E*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));u>a?u=a:u<-a&&(u=-a),o[s+1]=u}return o}function toEPSG4326(t,e,n){var r=t.length,i=n>1?n:2,o=e;void 0===o&&(o=i>2?t.slice():new Array(r));for(var a=0;a<r;a+=i)o[a]=180*t[a]/S,o[a+1]=360*Math.atan(Math.exp(t[a+1]/E))/Math.PI-90;return o}var I=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),R=[-180,-90,180,90],L=6378137*Math.PI/180,k=function(t){function EPSG4326Projection(e,n){return t.call(this,{code:e,units:_.DEGREES,extent:R,axisOrientation:n,global:!0,metersPerUnit:L,worldExtent:R})||this}return I(EPSG4326Projection,t),EPSG4326Projection}(T),A=[new k("CRS:84"),new k("EPSG:4326","neu"),new k("urn:ogc:def:crs:EPSG::4326","neu"),new k("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new k("urn:ogc:def:crs:OGC:1.3:CRS84"),new k("urn:ogc:def:crs:OGC:2:84"),new k("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new k("urn:x-ogc:def:crs:EPSG:4326","neu")],D={};function add(t,e,n){var r=t.getCode(),i=e.getCode();r in D||(D[r]={}),D[r][i]=n}function get$1(t,e){var n;return t in D&&e in D[t]&&(n=D[t][e]),n}var j={};function cloneTransform(t,e,n){var r;if(void 0!==e){for(var i=0,o=t.length;i<o;++i)e[i]=t[i];r=e}else r=t.slice();return r}function identityTransform(t,e,n){if(void 0!==e&&t!==e){for(var r=0,i=t.length;r<i;++r)e[r]=t[r];t=e}return t}function addProjection(t){!function add$1(t,e){j[t]=e}(t.getCode(),t),add(t,t,cloneTransform)}function get$3(t){return"string"==typeof t?function get$2(t){return j[t]||null}(t):t||null}function getPointResolution(t,e,n,r){var i,o=(t=get$3(t)).getPointResolutionFunc();if(o)i=o(e,n),r&&r!==t.getUnits()&&(a=t.getMetersPerUnit())&&(i=i*a/b[r]);else if(t.getUnits()==_.DEGREES&&!r||r==_.DEGREES)i=e;else{var a,s=getTransformFromProjections(t,get$3("EPSG:4326")),u=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];i=(getDistance((u=s(u,u,2)).slice(0,2),u.slice(2,4))+getDistance(u.slice(4,6),u.slice(6,8)))/2,void 0!==(a=r?b[r]:t.getMetersPerUnit())&&(i/=a)}return i}function addEquivalentProjections(t){!function addProjections(t){t.forEach(addProjection)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&add(e,t,cloneTransform)}))}))}function createProjection(t,e){return t?"string"==typeof t?get$3(t):t:get$3(e)}function createTransformFromCoordinateTransform(t){return function(e,n,r){for(var i=e.length,o=void 0!==r?r:2,a=void 0!==n?n:new Array(i),s=0;s<i;s+=o){var u=t([e[s],e[s+1]]);a[s]=u[0],a[s+1]=u[1];for(var l=o-1;l>=2;--l)a[s+l]=e[s+l]}return a}}function equivalent(t,e){if(t===e)return!0;var n=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?n:getTransformFromProjections(t,e)===cloneTransform&&n}function getTransformFromProjections(t,e){var n=get$1(t.getCode(),e.getCode());return n||(n=identityTransform),n}function getTransform(t,e){return getTransformFromProjections(get$3(t),get$3(e))}function transform(t,e,n){return getTransform(e,n)(t,void 0,t.length)}function transformExtent(t,e,n){return applyTransform(t,getTransform(e,n))}var N=null;function getUserProjection(){return N}function toUserCoordinate(t,e){return N?transform(t,e,N):t}function fromUserCoordinate(t,e){return N?transform(t,N,e):t}function fromUserExtent(t,e){return N?transformExtent(t,N,e):t}function register(t){var e,n,r,i,o,a,s,u,l=Object.keys(t.defs),c=l.length;for(e=0;e<c;++e){var h=l[e];if(!get$3(h)){var d=t.defs(h);addProjection(new T({code:h,axisOrientation:d.axis,metersPerUnit:d.to_meter,units:d.units}))}}for(e=0;e<c;++e){var f=l[e],p=get$3(f);for(n=0;n<c;++n){var m=l[n],y=get$3(m);if(!get$1(f,m))if(t.defs[f]===t.defs[m])addEquivalentProjections([p,y]);else{var g=t(f,m);r=p,i=y,o=g.forward,a=g.inverse,s=void 0,u=void 0,s=get$3(r),u=get$3(i),add(s,u,createTransformFromCoordinateTransform(o)),add(u,s,createTransformFromCoordinateTransform(a))}}}}!function addCommon(){addEquivalentProjections(P),addEquivalentProjections(A),function addEquivalentTransforms(t,e,n,r){t.forEach((function(t){e.forEach((function(e){add(t,e,n),add(e,t,r)}))}))}(A,P,fromEPSG4326,toEPSG4326)}();var G=createCommonjsModule((function(t,e){t.exports=function(){function t(t,e){if(t[e])return t[e];for(var n,r=Object.keys(t),i=e.toLowerCase().replace(mt,""),o=-1;++o<r.length;)if((n=r[o]).toLowerCase().replace(mt,"")===i)return t[n]}function s(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=gt}function i(t){return new s(t).output()}function a(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,i=n.reduce((function(t,e){return h(e,t),t}),r);e&&(t[e]=i)}function h(t,e){if(Array.isArray(t)){var n=t.shift();if("PARAMETER"===n&&(n=t.shift()),1===t.length)return Array.isArray(t[0])?(e[n]={},void h(t[0],e[n])):void(e[n]=t[0]);if(t.length)if("TOWGS84"!==n){var r;switch(Array.isArray(n)||(e[n]={}),n){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[n]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&h(t[2],e[n]));case"SPHEROID":case"ELLIPSOID":return e[n]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&h(t[3],e[n]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void a(e,n,t);default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return h(t,e[n]);return a(e,n,t)}}else e[n]=t;else e[n]=!0}else e[t]=!0}function n(t){return t*Et}function r(t){function s(e){return e*(t.to_meter||1)}"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var r=t.GEOGCS;"GEOGCS"===t.type&&(r=t),r&&(r.DATUM?t.datumCode=r.DATUM.name.toLowerCase():t.datumCode=r.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),r.DATUM&&r.DATUM.SPHEROID&&(t.ellps=r.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=r.DATUM.SPHEROID.a,t.rf=parseFloat(r.DATUM.SPHEROID.rf,10)),r.DATUM&&r.DATUM.TOWGS84&&(t.datum_params=r.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",n],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",n],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",n],["lat0","latitude_of_origin",n],["lat0","standard_parallel_1",n],["lat1","standard_parallel_1",n],["lat2","standard_parallel_2",n],["azimuth","Azimuth"],["alpha","azimuth",n],["srsCode","name"]].forEach((function(n){return function e(t,n){var r=n[0],i=n[1];!(r in t)&&i in t&&(t[r]=t[i],3===n.length&&(t[r]=n[2](t[r])))}(t,n)})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=n(t.lat1>0?90:-90),t.lat_ts=t.lat1)}function o(t){var e=this;if(2===arguments.length){var n=arguments[1];"string"==typeof n?"+"===n.charAt(0)?o[t]=yt(arguments[1]):o[t]=St(arguments[1]):o[t]=n}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?o.apply(e,t):o(t)}));if("string"==typeof t){if(t in o)return o[t]}else"EPSG"in t?o["EPSG:"+t.EPSG]=t:"ESRI"in t?o["ESRI:"+t.ESRI]=t:"IAU2000"in t?o["IAU2000:"+t.IAU2000]=t:console.log(t);return}}function u(e){var n=t(e,"authority");if(n){var r=t(n,"epsg");return r&&Ot.indexOf(r)>-1}}function f(e){var n=t(e,"extension");if(n)return t(n,"proj4")}function p(t){if(!function l(t){return"string"==typeof t}(t))return t;if(function M(t){return t in o}(t))return o[t];if(function c(t){return Mt.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=St(t);if(u(e))return o["EPSG:3857"];var n=f(e);return n?yt(n):e}return function m(t){return"+"===t[0]}(t)?yt(t):void 0}function d(t){return t}function y(t,e){var n=Dt.length;return t.names?(Dt[n]=t,t.names.forEach((function(t){At[t.toLowerCase()]=n})),this):(console.log(e),!0)}function Projection(n,r){if(!(this instanceof Projection))return new Projection(n);r=r||function(t){if(t)throw t};var i=p(n);if("object"==typeof i){var o=Projection.projections.get(i.projName);if(o){if(i.datumCode&&"none"!==i.datumCode){var a=t(Ut,i.datumCode);a&&(i.datum_params=a.towgs84?a.towgs84.split(","):null,i.ellps=a.ellipse,i.datumName=a.datumName?a.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84";var s=function x(e,n,r,i,o){if(!e){var a=t(Nt,i);a||(a=Ft),e=a.a,n=a.b,r=a.rf}return r&&!n&&(n=(1-1/r)*e),(0===r||Math.abs(e-n)<st)&&(o=!0,n=e),{a:e,b:n,rf:r,sphere:o}}(i.a,i.b,i.rf,i.ellps,i.sphere),u=function _(t,e,n,r){var i=t*t,o=e*e,a=(i-o)/i,s=0;return r?(i=(t*=1-a*(it+a*(ot+a*at)))*t,a=0):s=Math.sqrt(a),{es:a,e:s,ep2:(i-o)/o}}(s.a,s.b,s.rf,i.R_A),l=i.datum||function v(t,n,r,i,o,a){var s={};return s.datum_type=void 0===t||"none"===t?et:tt,n&&(s.datum_params=n.map(parseFloat),0===s.datum_params[0]&&0===s.datum_params[1]&&0===s.datum_params[2]||(s.datum_type=e),s.datum_params.length>3&&(0===s.datum_params[3]&&0===s.datum_params[4]&&0===s.datum_params[5]&&0===s.datum_params[6]||(s.datum_type=$,s.datum_params[3]*=nt,s.datum_params[4]*=nt,s.datum_params[5]*=nt,s.datum_params[6]=s.datum_params[6]/1e6+1))),s.a=r,s.b=i,s.es=o,s.ep2=a,s}(i.datumCode,i.datum_params,s.a,s.b,u.es,u.ep2);xt(this,i),xt(this,o),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=u.es,this.e=u.e,this.ep2=u.ep2,this.datum=l,this.init(),r(null,this)}else r(n)}else r(n)}function E(t){return t===e||t===$}function P(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function S(t,n,r){var i;return Array.isArray(r)&&(r=Vt(r)),qt(r),t.datum&&n.datum&&function N(t,n){return(t.datum.datum_type===e||t.datum.datum_type===$)&&"WGS84"!==n.datumCode||(n.datum.datum_type===e||n.datum.datum_type===$)&&"WGS84"!==t.datumCode}(t,n)&&(r=S(t,i=new Projection("WGS84"),r),t=i),"enu"!==t.axis&&(r=zt(t,!1,r)),"longlat"===t.projName?r={x:r.x*ut,y:r.y*ut}:(t.to_meter&&(r={x:r.x*t.to_meter,y:r.y*t.to_meter}),r=t.inverse(r)),t.from_greenwich&&(r.x+=t.from_greenwich),r=Gt(t.datum,n.datum,r),n.from_greenwich&&(r={x:r.x-n.from_greenwich,y:r.y}),"longlat"===n.projName?r={x:r.x*lt,y:r.y*lt}:(r=n.forward(r),n.to_meter&&(r={x:r.x/n.to_meter,y:r.y/n.to_meter})),"enu"!==n.axis?zt(n,!0,r):r}function k(t,e,n){var r,i,o;return Array.isArray(n)?(r=S(t,e,n),3===n.length?[r.x,r.y,r.z]:[r.x,r.y]):(i=S(t,e,n),2===(o=Object.keys(n)).length?i:(o.forEach((function(t){"x"!==t&&"y"!==t&&(i[t]=n[t])})),i))}function q(t){return t instanceof Projection?t:t.oProj?t.oProj:Projection(t)}function I(t,e,n){t=q(t);var r,i=!1;return void 0===e?(e=t,t=Zt,i=!0):(void 0!==e.x||Array.isArray(e))&&(n=e,e=t,t=Zt,i=!0),e=q(e),n?k(t,e,n):(r={forward:function(n){return k(t,e,n)},inverse:function(n){return k(e,t,n)}},i&&(r.oProj=e),r)}function O(t,e){return e=e||5,function D(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+function B(t,e,n){var r=U(n);return function F(t,e,n){var r=n-1,i=Yt.charCodeAt(r),o=Bt.charCodeAt(r),a=i+t-1,s=o+e,u=!1;return a>Qt&&(a=a-Qt+Kt-1,u=!0),(a===Ht||i<Ht&&a>Ht||(a>Ht||i<Ht)&&u)&&a++,(a===Xt||i<Xt&&a>Xt||(a>Xt||i<Xt)&&u)&&++a===Ht&&a++,a>Qt&&(a=a-Qt+Kt-1),s>$t?(s=s-$t+Kt-1,u=!0):u=!1,(s===Ht||o<Ht&&s>Ht||(s>Ht||o<Ht)&&u)&&s++,(s===Xt||o<Xt&&s>Xt||(s>Xt||o<Xt)&&u)&&++s===Ht&&s++,s>$t&&(s=s-$t+Kt-1),String.fromCharCode(a)+String.fromCharCode(s)}(Math.floor(t/1e5),Math.floor(e/1e5)%20,r)}(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+r.substr(r.length-5,e)}(function j(t){var e,n,r,i,o,a,s=t.lat,u=t.lon,l=6378137,c=G(s),h=G(u);a=Math.floor((u+180)/6)+1,180===u&&(a=60),s>=56&&s<64&&u>=3&&u<12&&(a=32),s>=72&&s<84&&(u>=0&&u<9?a=31:u>=9&&u<21?a=33:u>=21&&u<33?a=35:u>=33&&u<42&&(a=37)),o=G(6*(a-1)-180+3),e=l/Math.sqrt(1-.00669438*Math.sin(c)*Math.sin(c)),n=Math.tan(c)*Math.tan(c),r=.006739496752268451*Math.cos(c)*Math.cos(c);var d=.9996*e*((i=Math.cos(c)*(h-o))+(1-n+r)*i*i*i/6+(5-18*n+n*n+72*r-.39089081163157013)*i*i*i*i*i/120)+5e5,f=.9996*(l*(.9983242984503243*c-.002514607064228144*Math.sin(2*c)+2639046602129982e-21*Math.sin(4*c)-3.418046101696858e-9*Math.sin(6*c))+e*Math.tan(c)*(i*i/2+(5-n+9*r+4*r*r)*i*i*i*i/24+(61-58*n+n*n+600*r-2.2240339282485886)*i*i*i*i*i*i/720));return s<0&&(f+=1e7),{northing:Math.round(f),easting:Math.round(d),zoneNumber:a,zoneLetter:z(s)}}({lat:t[1],lon:t[0]}),e)}function R(t){var e=L(Q(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function G(t){return t*(Math.PI/180)}function T(t){return t/Math.PI*180}function L(t){var e=t.northing,n=t.easting,r=t.zoneLetter,i=t.zoneNumber;if(i<0||i>60)return null;var o,a,s,u,l,c,h,d,f=6378137,p=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),m=n-5e5,y=e;r<"N"&&(y-=1e7),c=6*(i-1)-180+3,d=(h=y/.9996/6367449.145945056)+(3*p/2-27*p*p*p/32)*Math.sin(2*h)+(21*p*p/16-55*p*p*p*p/32)*Math.sin(4*h)+151*p*p*p/96*Math.sin(6*h),o=f/Math.sqrt(1-.00669438*Math.sin(d)*Math.sin(d)),a=Math.tan(d)*Math.tan(d),s=.006739496752268451*Math.cos(d)*Math.cos(d),u=.99330562*f/Math.pow(1-.00669438*Math.sin(d)*Math.sin(d),1.5),l=m/(.9996*o);var g=d-o*Math.tan(d)/u*(l*l/2-(5+3*a+10*s-4*s*s-.06065547077041606)*l*l*l*l/24+(61+90*a+298*s+45*a*a-1.6983531815716497-3*s*s)*l*l*l*l*l*l/720);g=T(g);var v,_=(l-(1+2*a+s)*l*l*l/6+(5-2*s+28*a-3*s*s+.05391597401814761+24*a*a)*l*l*l*l*l/120)/Math.cos(d);if(_=c+T(_),t.accuracy){var b=L({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});v={top:b.lat,right:b.lon,bottom:g,left:_}}else v={lat:g,lon:_};return v}function z(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function U(t){var e=t%Wt;return 0===e&&(e=Wt),e}function Q(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,n=t.length,r=null,i="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;i+=e,o++}var a=parseInt(i,10);if(0===o||o+3>n)throw"MGRSPoint bad conversion from: "+t;var s=t.charAt(o++);if(s<="A"||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+t;r=t.substring(o,o+=2);for(var u=U(a),l=function W(t,e){for(var n=Yt.charCodeAt(e-1),r=1e5,i=!1;n!==t.charCodeAt(0);){if(++n===Ht&&n++,n===Xt&&n++,n>Qt){if(i)throw"Bad character: "+t;n=Kt,i=!0}r+=1e5}return r}(r.charAt(0),u),c=function H(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=Bt.charCodeAt(e-1),r=0,i=!1;n!==t.charCodeAt(0);){if(++n===Ht&&n++,n===Xt&&n++,n>$t){if(i)throw"Bad character: "+t;n=Kt,i=!0}r+=1e5}return r}(r.charAt(1),u);c<K(s);)c+=2e6;var h=n-o;if(h%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var d,f,p,m=h/2,y=0,g=0;return m>0&&(d=1e5/Math.pow(10,m),f=t.substring(o,o+m),y=parseFloat(f)*d,p=t.substring(o+m),g=parseFloat(p)*d),{easting:y+l,northing:g+c,zoneLetter:s,zoneNumber:a,accuracy:d}}function K(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Point(t,e,n){if(!(this instanceof Point))return new Point(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var r=t.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function V(t,e,n,r){var i;return t<st?(r.value=rn.AREA_0,i=0):(i=Math.atan2(e,n),Math.abs(i)<=ct?r.value=rn.AREA_0:i>ct&&i<=rt+ct?(r.value=rn.AREA_1,i-=rt):i>rt+ct||i<=-(rt+ct)?(r.value=rn.AREA_2,i=i>=0?i-dt:i+dt):(r.value=rn.AREA_3,i+=rt)),i}function Z(t,e){var n=t+e;return n<-dt?n+=ht:n>+dt&&(n-=ht),n}var e=1,$=2,tt=4,et=5,nt=484813681109536e-20,rt=Math.PI/2,it=.16666666666666666,ot=.04722222222222222,at=.022156084656084655,st=1e-10,ut=.017453292519943295,lt=57.29577951308232,ct=Math.PI/4,ht=2*Math.PI,dt=3.14159265359,ft={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},pt={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},mt=/[\s_\-\/\(\)]/g,yt=function(e){var n,r,i,o={},a=e.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var n=e.split("=");return n.push(!0),t[n[0].toLowerCase()]=n[1],t}),{}),s={proj:"projName",datum:"datumCode",rf:function(t){o.rf=parseFloat(t)},lat_0:function(t){o.lat0=t*ut},lat_1:function(t){o.lat1=t*ut},lat_2:function(t){o.lat2=t*ut},lat_ts:function(t){o.lat_ts=t*ut},lon_0:function(t){o.long0=t*ut},lon_1:function(t){o.long1=t*ut},lon_2:function(t){o.long2=t*ut},alpha:function(t){o.alpha=parseFloat(t)*ut},lonc:function(t){o.longc=t*ut},x_0:function(t){o.x0=parseFloat(t)},y_0:function(t){o.y0=parseFloat(t)},k_0:function(t){o.k0=parseFloat(t)},k:function(t){o.k0=parseFloat(t)},a:function(t){o.a=parseFloat(t)},b:function(t){o.b=parseFloat(t)},r_a:function(){o.R_A=!0},zone:function(t){o.zone=parseInt(t,10)},south:function(){o.utmSouth=!0},towgs84:function(t){o.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){o.to_meter=parseFloat(t)},units:function(e){o.units=e;var n=t(pt,e);n&&(o.to_meter=n.to_meter)},from_greenwich:function(t){o.from_greenwich=t*ut},pm:function(e){var n=t(ft,e);o.from_greenwich=(n||parseFloat(e))*ut},nadgrids:function(t){"@null"===t?o.datumCode="none":o.nadgrids=t},axis:function(t){3===t.length&&-1!=="ewnsud".indexOf(t.substr(0,1))&&-1!=="ewnsud".indexOf(t.substr(1,1))&&-1!=="ewnsud".indexOf(t.substr(2,1))&&(o.axis=t)}};for(n in a)r=a[n],n in s?"function"==typeof(i=s[n])?i(r):o[i]=r:o[n]=r;return"string"==typeof o.datumCode&&"WGS84"!==o.datumCode&&(o.datumCode=o.datumCode.toLowerCase()),o},gt=1,vt=/\s/,_t=/[A-Za-z]/,bt=/[A-Za-z84]/,Tt=/[,\]]/,wt=/[\d\.E\-\+]/;s.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;vt.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case gt:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},s.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Tt.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},s.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=gt)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=gt,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},s.prototype.number=function(t){if(!wt.test(t)){if(Tt.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},s.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},s.prototype.keyword=function(t){if(bt.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=gt)}if(!Tt.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},s.prototype.neutral=function(t){if(_t.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(wt.test(t))return this.word=t,void(this.state=3);if(!Tt.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},s.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var Et=.017453292519943295,St=function(t){var e=i(t),n=e.shift(),o=e.shift();e.unshift(["name",o]),e.unshift(["type",n]);var a={};return h(e,a),r(a),a};!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(o);var Mt=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],Ot=["3857","900913","3785","102113"],xt=function(t,e){var n,r;if(t=t||{},!e)return t;for(r in e)void 0!==(n=e[r])&&(t[r]=n);return t},Ct=function(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)},Pt=function(t){return t<0?-1:1},It=function(t){return Math.abs(t)<=dt?t:t-Pt(t)*ht},Rt=function(t,e,n){var r=t*n,i=.5*t;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(rt-e))/r},Lt=function(t,e){for(var n,r,i=.5*t,o=rt-2*Math.atan(e),a=0;a<=15;a++)if(n=t*Math.sin(o),o+=r=rt-2*Math.atan(e*Math.pow((1-n)/(1+n),i))-o,Math.abs(r)<=1e-10)return o;return-9999},kt=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Ct(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,n,r=t.x,i=t.y;if(i*lt>90&&i*lt<-90&&r*lt>180&&r*lt<-180)return null;if(Math.abs(Math.abs(i)-rt)<=st)return null;if(this.sphere)e=this.x0+this.a*this.k0*It(r-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(ct+.5*i));else{var o=Math.sin(i),a=Rt(this.e,i,o);e=this.x0+this.a*this.k0*It(r-this.long0),n=this.y0-this.a*this.k0*Math.log(a)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,r=t.x-this.x0,i=t.y-this.y0;if(this.sphere)n=rt-2*Math.atan(Math.exp(-i/(this.a*this.k0)));else{var o=Math.exp(-i/(this.a*this.k0));if(-9999===(n=Lt(this.e,o)))return null}return e=It(this.long0+r/(this.a*this.k0)),t.x=e,t.y=n,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:d,inverse:d,names:["longlat","identity"]}],At={},Dt=[],jt={start:function(){kt.forEach(y)},add:y,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==At[e]&&Dt[At[e]]?Dt[At[e]]:void 0}},Nt={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},Ft=Nt.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Nt.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Ut={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};Projection.projections=jt,Projection.projections.start();var Gt=function(t,n,r){return function g(t,n){return t.datum_type===n.datum_type&&!(t.a!==n.a||Math.abs(t.es-n.es)>5e-11)&&(t.datum_type===e?t.datum_params[0]===n.datum_params[0]&&t.datum_params[1]===n.datum_params[1]&&t.datum_params[2]===n.datum_params[2]:t.datum_type!==$||t.datum_params[0]===n.datum_params[0]&&t.datum_params[1]===n.datum_params[1]&&t.datum_params[2]===n.datum_params[2]&&t.datum_params[3]===n.datum_params[3]&&t.datum_params[4]===n.datum_params[4]&&t.datum_params[5]===n.datum_params[5]&&t.datum_params[6]===n.datum_params[6])}(t,n)?r:t.datum_type===et||n.datum_type===et?r:t.es!==n.es||t.a!==n.a||E(t.datum_type)||E(n.datum_type)?(r=function b(t,e,n){var r,i,o,a,s=t.x,u=t.y,l=t.z?t.z:0;if(u<-rt&&u>-1.001*rt)u=-rt;else if(u>rt&&u<1.001*rt)u=rt;else{if(u<-rt)return{x:-1/0,y:-1/0,z:t.z};if(u>rt)return{x:1/0,y:1/0,z:t.z}}return s>Math.PI&&(s-=2*Math.PI),i=Math.sin(u),a=Math.cos(u),o=i*i,{x:((r=n/Math.sqrt(1-e*o))+l)*a*Math.cos(s),y:(r+l)*a*Math.sin(s),z:(r*(1-e)+l)*i}}(r,t.es,t.a),E(t.datum_type)&&(r=function A(t,n,r){if(n===e)return{x:t.x+r[0],y:t.y+r[1],z:t.z+r[2]};if(n===$){var i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],c=r[6];return{x:c*(t.x-l*t.y+u*t.z)+i,y:c*(l*t.x+t.y-s*t.z)+o,z:c*(-u*t.x+s*t.y+t.z)+a}}}(r,t.datum_type,t.datum_params)),E(n.datum_type)&&(r=function C(t,n,r){if(n===e)return{x:t.x-r[0],y:t.y-r[1],z:t.z-r[2]};if(n===$){var i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],c=r[6],h=(t.x-i)/c,d=(t.y-o)/c,f=(t.z-a)/c;return{x:h+l*d-u*f,y:-l*h+d+s*f,z:u*h-s*d+f}}}(r,n.datum_type,n.datum_params)),function w(t,e,n,r){var i,o,a,s,u,l,c,h,d,f,p,m,y,g,v,_=t.x,b=t.y,T=t.z?t.z:0;if(i=Math.sqrt(_*_+b*b),o=Math.sqrt(_*_+b*b+T*T),i/n<1e-12){if(g=0,o/n<1e-12)return v=-r,{x:t.x,y:t.y,z:t.z}}else g=Math.atan2(b,_);a=T/o,h=(s=i/o)*(1-e)*(u=1/Math.sqrt(1-e*(2-e)*s*s)),d=a*u,y=0;do{y++,l=e*(c=n/Math.sqrt(1-e*d*d))/(c+(v=i*h+T*d-c*(1-e*d*d))),m=(p=a*(u=1/Math.sqrt(1-l*(2-l)*s*s)))*h-(f=s*(1-l)*u)*d,h=f,d=p}while(m*m>1e-24&&y<30);return{x:g,y:Math.atan(p/Math.abs(f)),z:v}}(r,n.es,n.a,n.b)):r},zt=function(t,e,n){var r,i,o,a=n.x,s=n.y,u=n.z||0,l={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==n.z)switch(0===o?(r=a,i="x"):1===o?(r=s,i="y"):(r=u,i="z"),t.axis[o]){case"e":l[i]=r;break;case"w":l[i]=-r;break;case"n":l[i]=r;break;case"s":l[i]=-r;break;case"u":void 0!==n[i]&&(l.z=r);break;case"d":void 0!==n[i]&&(l.z=-r);break;default:return null}return l},Vt=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e},qt=function(t){P(t.x),P(t.y)},Zt=Projection("WGS84"),Wt=6,Yt="AJSAJS",Bt="AFAFAF",Kt=65,Ht=73,Xt=79,$t=86,Qt=90,Jt={forward:O,inverse:function(t){var e=L(Q(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:R};Point.fromMGRS=function(t){return new Point(R(t))},Point.prototype.toMGRS=function(t){return O([this.x,this.y],t)};var te=.01068115234375,ee=function(t){var e=[];e[0]=1-t*(.25+t*(.046875+t*(.01953125+t*te))),e[1]=t*(.75-t*(.046875+t*(.01953125+t*te)));var n=t*t;return e[2]=n*(.46875-t*(.013020833333333334+.007120768229166667*t)),n*=t,e[3]=n*(.3645833333333333-.005696614583333333*t),e[4]=n*t*.3076171875,e},ne=function(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))},re=function(t,e,n){for(var r=1/(1-e),i=t,o=20;o;--o){var a=Math.sin(i),s=1-e*a*a;if(i-=s=(ne(i,a,Math.cos(i),n)-t)*(s*Math.sqrt(s))*r,Math.abs(s)<st)return i}return i},ie={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=ee(this.es),this.ml0=ne(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,n,r,i=t.x,o=t.y,a=It(i-this.long0),s=Math.sin(o),u=Math.cos(o);if(this.es){var l=u*a,c=Math.pow(l,2),h=this.ep2*Math.pow(u,2),d=Math.pow(h,2),f=Math.abs(u)>st?Math.tan(o):0,p=Math.pow(f,2),m=Math.pow(p,2);e=1-this.es*Math.pow(s,2),l/=Math.sqrt(e);var y=ne(o,s,u,this.en);n=this.a*(this.k0*l*(1+c/6*(1-p+h+c/20*(5-18*p+m+14*h-58*p*h+c/42*(61+179*m-m*p-479*p)))))+this.x0,r=this.a*(this.k0*(y-this.ml0+s*a*l/2*(1+c/12*(5-p+9*h+4*d+c/30*(61+m-58*p+270*h-330*p*h+c/56*(1385+543*m-m*p-3111*p))))))+this.y0}else{var g=u*Math.sin(a);if(Math.abs(Math.abs(g)-1)<st)return 93;if(n=.5*this.a*this.k0*Math.log((1+g)/(1-g))+this.x0,r=u*Math.cos(a)/Math.sqrt(1-Math.pow(g,2)),(g=Math.abs(r))>=1){if(g-1>st)return 93;r=0}else r=Math.acos(r);o<0&&(r=-r),r=this.a*this.k0*(r-this.lat0)+this.y0}return t.x=n,t.y=r,t},inverse:function(t){var e,n,r,i,o=(t.x-this.x0)*(1/this.a),a=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,n=re(e,this.es,this.en),Math.abs(n)<rt){var s=Math.sin(n),u=Math.cos(n),l=Math.abs(u)>st?Math.tan(n):0,c=this.ep2*Math.pow(u,2),h=Math.pow(c,2),d=Math.pow(l,2),f=Math.pow(d,2);e=1-this.es*Math.pow(s,2);var p=o*Math.sqrt(e)/this.k0,m=Math.pow(p,2);r=n-(e*=l)*m/(1-this.es)*.5*(1-m/12*(5+3*d-9*c*d+c-4*h-m/30*(61+90*d-252*c*d+45*f+46*c-m/56*(1385+3633*d+4095*f+1574*f*d)))),i=It(this.long0+p*(1-m/6*(1+2*d+c-m/20*(5+28*d+24*f+8*c*d+6*c-m/42*(61+662*d+1320*f+720*f*d))))/u)}else r=rt*Pt(a),i=0;else{var y=Math.exp(o/this.k0),g=.5*(y-1/y),v=this.lat0+a/this.k0,_=Math.cos(v);e=Math.sqrt((1-Math.pow(_,2))/(1+Math.pow(g,2))),r=Math.asin(e),a<0&&(r=-r),i=0===g&&0===_?0:It(Math.atan2(g,_)+this.long0)}return t.x=i,t.y=r,t},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},oe=function(t){var e=Math.exp(t);return(e-1/e)/2},ae=function(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))},se=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,n=e-1;return 0===n?t:t*Math.log(e)/n}(e*(1+e/(ae(1,e)+1))),t<0?-e:e},ue=function(t,e){for(var n,r=2*Math.cos(2*e),i=t.length-1,o=t[i],a=0;--i>=0;)n=r*o-a+t[i],a=o,o=n;return e+n*Math.sin(2*e)},le=function(t,e,n){for(var r,i,o=Math.sin(e),a=Math.cos(e),s=oe(n),u=function(t){var e=Math.exp(t);return(e+1/e)/2}(n),l=2*a*u,c=-2*o*s,h=t.length-1,d=t[h],f=0,p=0,m=0;--h>=0;)r=p,i=f,d=l*(p=d)-r-c*(f=m)+t[h],m=c*p-i+l*f;return[(l=o*u)*d-(c=a*s)*m,l*m+c*d]},ce={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),n*=e,this.cgb[1]=n*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n*=e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),n*=e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(e*(-24832/14175)-2.4)),n*=e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n*=e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(.25+n*(1/64+n/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),n*=e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n*=e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n*=e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n*=e,this.utg[5]=-.03233083094085698*n,this.gtu[5]=.6650675310896665*n;var r=ue(this.cbg,this.lat0);this.Zb=-this.Qn*(r+function(t,e){for(var n,r=2*Math.cos(e),i=t.length-1,o=t[i],a=0;--i>=0;)n=r*o-a+t[i],a=o,o=n;return Math.sin(e)*n}(this.gtu,2*r))},forward:function(t){var e=It(t.x-this.long0),n=t.y;n=ue(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),o=Math.sin(e),a=Math.cos(e);n=Math.atan2(r,a*i),e=Math.atan2(o*i,ae(r,i*a)),e=se(Math.tan(e));var s,u,l=le(this.gtu,2*n,2*e);return n+=l[0],e+=l[1],Math.abs(e)<=2.623395162778?(s=this.a*(this.Qn*e)+this.x0,u=this.a*(this.Qn*n+this.Zb)+this.y0):(s=1/0,u=1/0),t.x=s,t.y=u,t},inverse:function(t){var e,n,r=(t.x-this.x0)*(1/this.a),i=(t.y-this.y0)*(1/this.a);if(i=(i-this.Zb)/this.Qn,r/=this.Qn,Math.abs(r)<=2.623395162778){var o=le(this.utg,2*i,2*r);i+=o[0],r+=o[1],r=Math.atan(oe(r));var a=Math.sin(i),s=Math.cos(i),u=Math.sin(r),l=Math.cos(r);i=Math.atan2(a*l,ae(u,l*s)),r=Math.atan2(u,l*s),e=It(r+this.long0),n=ue(this.cgb,i)}else e=1/0,n=1/0;return t.x=e,t.y=n,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},he={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(It(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*ut,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,ce.init.apply(this),this.forward=ce.forward,this.inverse=ce.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},de=function(t,e){return Math.pow((1-t)/(1+t),e)},fe={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ct)/(Math.pow(Math.tan(.5*this.lat0+ct),this.C)*de(this.e*t,this.ratexp))},forward:function(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+ct),this.C)*de(this.e*Math.sin(n),this.ratexp))-rt,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,n=t.y,r=Math.pow(Math.tan(.5*n+ct)/this.K,1/this.C),i=20;i>0&&(n=2*Math.atan(r*de(this.e*Math.sin(t.y),-.5*this.e))-rt,!(Math.abs(n-t.y)<1e-14));--i)t.y=n;return i?(t.x=e,t.y=n,t):null},names:["gauss"]},pe={init:function(){fe.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,n,r,i;return t.x=It(t.x-this.long0),fe.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=i*n*Math.sin(t.x),t.y=i*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,n,r,i,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Math.sqrt(t.x*t.x+t.y*t.y)){var a=2*Math.atan2(o,this.R2);e=Math.sin(a),n=Math.cos(a),i=Math.asin(n*this.sinc0+t.y*e*this.cosc0/o),r=Math.atan2(t.x*e,o*this.cosc0*n-t.y*this.sinc0*e)}else i=this.phic0,r=0;return t.x=r,t.y=i,fe.inverse.apply(this,[t]),t.x=It(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},me={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&(this.k0=.5*(1+Pt(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=st&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&(this.k0=.5*this.cons*Ct(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Rt(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Ct(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-rt,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,n,r,i,o,a,s=t.x,u=t.y,l=Math.sin(u),c=Math.cos(u),h=It(s-this.long0);return Math.abs(Math.abs(s-this.long0)-Math.PI)<=st&&Math.abs(u+this.lat0)<=st?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*l+this.coslat0*c*Math.cos(h)),t.x=this.a*e*c*Math.sin(h)+this.x0,t.y=this.a*e*(this.coslat0*l-this.sinlat0*c*Math.cos(h))+this.y0,t):(n=2*Math.atan(this.ssfn_(u,l,this.e))-rt,i=Math.cos(n),r=Math.sin(n),Math.abs(this.coslat0)<=st?(o=Rt(this.e,u*this.con,this.con*l),a=2*this.a*this.k0*o/this.cons,t.x=this.x0+a*Math.sin(s-this.long0),t.y=this.y0-this.con*a*Math.cos(s-this.long0),t):(Math.abs(this.sinlat0)<st?(e=2*this.a*this.k0/(1+i*Math.cos(h)),t.y=e*r):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*r+this.cosX0*i*Math.cos(h))),t.y=e*(this.cosX0*r-this.sinX0*i*Math.cos(h))+this.y0),t.x=e*i*Math.sin(h)+this.x0,t))},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,o,a=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var s=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,n=this.lat0,a<=st?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(s)*this.sinlat0+t.y*Math.sin(s)*this.coslat0/a),e=It(Math.abs(this.coslat0)<st?this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y):this.long0+Math.atan2(t.x*Math.sin(s),a*this.coslat0*Math.cos(s)-t.y*this.sinlat0*Math.sin(s))),t.x=e,t.y=n,t)}if(Math.abs(this.coslat0)<=st){if(a<=st)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=a*this.cons/(2*this.a*this.k0),n=this.con*Lt(this.e,r),e=this.con*It(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=st?o=this.X0:(o=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/a),e=It(this.long0+Math.atan2(t.x*Math.sin(i),a*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)))),n=-1*Lt(this.e,Math.tan(.5*(rt+o)));return t.x=e,t.y=n,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,n){return e*=n,Math.tan(.5*(rt+t))*Math.pow((1-e)/(1+e),.5*n)}},ye={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=1/this.rf,i=2*r-Math.pow(r,2),o=this.e=Math.sqrt(i);this.R=this.k0*n*Math.sqrt(1-i)/(1-i*Math.pow(e,2)),this.alpha=Math.sqrt(1+i/(1-i)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),s=Math.log(Math.tan(Math.PI/4+t/2)),u=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*s+this.alpha*o/2*u},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),a=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(o))),s=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*a+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),a=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),s=this.lambda0+a/this.alpha,u=0,l=o,c=-1e3,h=0;Math.abs(l-c)>1e-7;){if(++h>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),c=l,l=2*Math.atan(Math.exp(u))-Math.PI/2}return t.x=s,t.y=l,t},names:["somerc"]},ge={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),n=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-n*n);var r,i,o=Rt(this.e,this.lat0,t),a=this.bl/e*Math.sqrt((1-this.es)/(1-n*n));if(a*a<1&&(a=1),isNaN(this.longc)){var s=Rt(this.e,this.lat1,Math.sin(this.lat1)),u=Rt(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(a+Math.sqrt(a*a-1))*Math.pow(o,this.bl):this.el=(a-Math.sqrt(a*a-1))*Math.pow(o,this.bl);var l=Math.pow(s,this.bl),c=Math.pow(u,this.bl);i=.5*((r=this.el/l)-1/r);var h=(this.el*this.el-c*l)/(this.el*this.el+c*l),d=(c-l)/(c+l),f=It(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(h*Math.tan(.5*this.bl*f)/d)/this.bl,this.long0=It(this.long0);var p=It(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*p)/i),this.alpha=Math.asin(a*Math.sin(this.gamma0))}else r=this.lat0>=0?a+Math.sqrt(a*a-1):a-Math.sqrt(a*a-1),this.el=r*Math.pow(o,this.bl),i=.5*(r-1/r),this.gamma0=Math.asin(Math.sin(this.alpha)/a),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha))},forward:function(t){var e,n,r,i=t.x,o=t.y,a=It(i-this.long0);if(Math.abs(Math.abs(o)-rt)<=st)r=o>0?-1:1,n=this.al/this.bl*Math.log(Math.tan(ct+r*this.gamma0*.5)),e=-1*r*rt*this.al/this.bl;else{var s=Rt(this.e,o,Math.sin(o)),u=this.el/Math.pow(s,this.bl),l=.5*(u-1/u),c=.5*(u+1/u),h=Math.sin(this.bl*a),d=(l*Math.sin(this.gamma0)-h*Math.cos(this.gamma0))/c;n=Math.abs(Math.abs(d)-1)<=st?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-d)/(1+d))/this.bl,e=Math.abs(Math.cos(this.bl*a))<=st?this.al*this.bl*a:this.al*Math.atan2(l*Math.cos(this.gamma0)+h*Math.sin(this.gamma0),Math.cos(this.bl*a))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+n):(e-=this.uc,t.x=this.x0+n*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-n*Math.sin(this.alpha)),t},inverse:function(t){var e,n;this.no_rot?(n=t.y-this.y0,e=t.x-this.x0):(n=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var r=Math.exp(-1*this.bl*n/this.al),i=.5*(r-1/r),o=.5*(r+1/r),a=Math.sin(this.bl*e/this.al),s=(a*Math.cos(this.gamma0)+i*Math.sin(this.gamma0))/o,u=Math.pow(this.el/Math.sqrt((1+s)/(1-s)),1/this.bl);return Math.abs(s-1)<st?(t.x=this.long0,t.y=rt):Math.abs(s+1)<st?(t.x=this.long0,t.y=-1*rt):(t.y=Lt(this.e,u),t.x=It(this.long0-Math.atan2(i*Math.cos(this.gamma0)-a*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},ve={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<st)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=Ct(this.e,e,n),i=Rt(this.e,this.lat1,e),o=Math.sin(this.lat2),a=Math.cos(this.lat2),s=Ct(this.e,o,a),u=Rt(this.e,this.lat2,o),l=Rt(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>st?this.ns=Math.log(r/s)/Math.log(i/u):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=st&&(n=Pt(n)*(rt-2*st));var r,i,o=Math.abs(Math.abs(n)-rt);if(o>st)r=Rt(this.e,n,Math.sin(n)),i=this.a*this.f0*Math.pow(r,this.ns);else{if((o=n*this.ns)<=0)return null;i=0}var a=this.ns*It(e-this.long0);return t.x=this.k0*(i*Math.sin(a))+this.x0,t.y=this.k0*(this.rh-i*Math.cos(a))+this.y0,t},inverse:function(t){var e,n,r,i,o,a=(t.x-this.x0)/this.k0,s=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+s*s),n=1):(e=-Math.sqrt(a*a+s*s),n=-1);var u=0;if(0!==e&&(u=Math.atan2(n*a,n*s)),0!==e||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),-9999===(i=Lt(this.e,r)))return null}else i=-rt;return o=It(u/this.ns+this.long0),t.x=o,t.y=i,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},_e={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,n,r,i,o,a,s,u=t.x,l=t.y,c=It(u-this.long0);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),r=-c*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),o=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),a=this.n*o,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),t.y=s*Math.cos(a)/1,t.x=s*Math.sin(a)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,n,r,i,o,a,s,u=t.x;t.x=t.y,t.y=u,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),i=Math.atan2(t.y,t.x)/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),t.x=this.long0-n/this.alfa,a=e,s=0;var l=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(s=1),a=t.y,l+=1}while(0===s&&l<15);return l>=15?null:t},names:["Krovak","krovak"]},be=function(t,e,n,r,i){return t*i-e*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)},Te=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},we=function(t){return.375*t*(1+.25*t*(1+.46875*t))},Ee=function(t){return.05859375*t*t*(1+.75*t)},Se=function(t){return t*t*t*(35/3072)},Me=function(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)},Oe=function(t){return Math.abs(t)<rt?t:t-Pt(t)*Math.PI},xe=function(t,e,n,r,i){var o,a;o=t/e;for(var s=0;s<15;s++)if(o+=a=(t-(e*o-n*Math.sin(2*o)+r*Math.sin(4*o)-i*Math.sin(6*o)))/(e-2*n*Math.cos(2*o)+4*r*Math.cos(4*o)-6*i*Math.cos(6*o)),Math.abs(a)<=1e-10)return o;return NaN},Ce={init:function(){this.sphere||(this.e0=Te(this.es),this.e1=we(this.es),this.e2=Ee(this.es),this.e3=Se(this.es),this.ml0=this.a*be(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,n,r=t.x,i=t.y;if(r=It(r-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var o=Math.sin(i),a=Math.cos(i),s=Me(this.a,this.e,o),u=Math.tan(i)*Math.tan(i),l=r*Math.cos(i),c=l*l,h=this.es*a*a/(1-this.es);e=s*l*(1-c*u*(1/6-(8-u+8*h)*c/120)),n=this.a*be(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+s*o/a*c*(.5+(5-u+6*h)*c/24)}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,r=t.x/this.a,i=t.y/this.a;if(this.sphere){var o=i+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(r)),n=Math.atan2(Math.tan(r),Math.cos(o))}else{var a=this.ml0/this.a+i,s=xe(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-rt)<=st)return t.x=this.long0,t.y=rt,i<0&&(t.y*=-1),t;var u=Me(this.a,this.e,Math.sin(s)),l=u*u*u/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(s),2),h=r*this.a/u,d=h*h;e=s-u*Math.tan(s)/l*h*h*(.5-(1+3*c)*h*h/24),n=h*(1-d*(c/3+(1+3*c)*c*d/15))/Math.cos(s)}return t.x=It(n+this.long0),t.y=Oe(e),t},names:["Cassini","Cassini_Soldner","cass"]},Pe=function(t,e){var n;return t>1e-7?(1-t*t)*(e/(1-(n=t*e)*n)-.5/t*Math.log((1-n)/(1+n))):2*e},Ie=.3333333333333333,Re=.17222222222222222,Le=.10257936507936508,ke=.06388888888888888,Ae=.0664021164021164,De=.016415012942191543,je={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-rt)<st?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<st?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Pe(this.e,1),this.mmf=.5/(1-this.es),this.apa=function X(t){var e,n=[];return n[0]=t*Ie,e=t*t,n[0]+=e*Re,n[1]=e*ke,e*=t,n[0]+=e*Le,n[1]+=e*Ae,n[2]=e*De,n}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Pe(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,n,r,i,o,a,s,u,l,c,h=t.x,d=t.y;if(h=It(h-this.long0),this.sphere){if(o=Math.sin(d),c=Math.cos(d),r=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+c*r:1+this.sinph0*o+this.cosph0*c*r)<=st)return null;e=(n=Math.sqrt(2/n))*c*Math.sin(h),n*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*c*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(d+this.phi0)<st)return null;n=ct-.5*d,e=(n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)))*Math.sin(h),n*=r}}else{switch(s=0,u=0,l=0,r=Math.cos(h),i=Math.sin(h),o=Math.sin(d),a=Pe(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(s=a/this.qp,u=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:l=1+this.sinb1*s+this.cosb1*u*r;break;case this.EQUIT:l=1+u*r;break;case this.N_POLE:l=rt+d,a=this.qp-a;break;case this.S_POLE:l=d-rt,a=this.qp+a}if(Math.abs(l)<st)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),n=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*s-this.sinb1*u*r):(l=Math.sqrt(2/(1+u*r)))*s*this.ymf,e=this.xmf*l*u*i;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(l=Math.sqrt(a))*i,n=r*(this.mode===this.S_POLE?l:-l)):e=n=0}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,o,a,s,u=t.x/this.a,l=t.y/this.a;if(this.sphere){var c,h=0,d=0;if((n=.5*(c=Math.sqrt(u*u+l*l)))>1)return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(d=Math.sin(n),h=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(c)<=st?0:Math.asin(l*d/c),u*=d,l=h*c;break;case this.OBLIQ:n=Math.abs(c)<=st?this.phi0:Math.asin(h*this.sinph0+l*d*this.cosph0/c),u*=d*this.cosph0,l=(h-Math.sin(n)*this.sinph0)*c;break;case this.N_POLE:l=-l,n=rt-n;break;case this.S_POLE:n-=rt}e=0!==l||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,l):0}else{if(s=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,l*=this.dd,(a=Math.sqrt(u*u+l*l))<st)return t.x=0,t.y=this.phi0,t;i=2*Math.asin(.5*a/this.rq),r=Math.cos(i),u*=i=Math.sin(i),this.mode===this.OBLIQ?(s=r*this.sinb1+l*i*this.cosb1/a,o=this.qp*s,l=a*this.cosb1*r-l*this.sinb1*i):(s=l*i/a,o=this.qp*s,l=a*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(l=-l),!(o=u*u+l*l))return t.x=0,t.y=this.phi0,t;s=1-o/this.qp,this.mode===this.S_POLE&&(s=-s)}e=Math.atan2(u,l),n=function J(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}(Math.asin(s),this.apa)}return t.x=It(this.long0+e),t.y=n,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Ne=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)},Fe={init:function(){Math.abs(this.lat1+this.lat2)<st||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Ct(this.e3,this.sin_po,this.cos_po),this.qs1=Pe(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Ct(this.e3,this.sin_po,this.cos_po),this.qs2=Pe(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Pe(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>st?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Pe(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,o=this.ns0*It(e-this.long0),a=i*Math.sin(o)+this.x0,s=this.rh-i*Math.cos(o)+this.y0;return t.x=a,t.y=s,t},inverse:function(t){var e,n,r,i,o,a;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),i=0,0!==e&&(i=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,a=this.phi1z(this.e3,n)),o=It(i/this.ns0+this.long0),t.x=o,t.y=a,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var n,r,i,o,a=Ne(.5*e);if(t<st)return a;for(var s=t*t,u=1;u<=25;u++)if(a+=o=.5*(i=1-(r=t*(n=Math.sin(a)))*r)*i/Math.cos(a)*(e/(1-s)-n/i+.5/t*Math.log((1-r)/(1+r))),Math.abs(o)<=1e-7)return a;return null}},Ue={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,n,r,i,o,a,s,u=t.x,l=t.y;return r=It(u-this.long0),e=Math.sin(l),n=Math.cos(l),i=Math.cos(r),(o=this.sin_p14*e+this.cos_p14*n*i)>0||Math.abs(o)<=st?(a=this.x0+1*this.a*n*Math.sin(r)/o,s=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*i)/o):(a=this.x0+this.infinity_dist*n*Math.sin(r),s=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*i)),t.x=a,t.y=s,t},inverse:function(t){var e,n,r,i,o,a;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=Math.atan2(e,this.rc),n=Math.sin(i),r=Math.cos(i),a=Ne(r*this.sin_p14+t.y*n*this.cos_p14/e),o=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),o=It(this.long0+o)):(a=this.phic0,o=0),t.x=o,t.y=a,t},names:["gnom"]},Ge={init:function(){this.sphere||(this.k0=Ct(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,n,r=t.x,i=t.y,o=It(r-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var a=Pe(this.e,Math.sin(i));e=this.x0+this.a*this.k0*o,n=this.y0+this.a*a*.5/this.k0}return t.x=e,t.y=n,t},inverse:function(t){var e,n;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=It(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*rt:rt;for(var r,i,o,a,s=Math.asin(.5*e),u=0;u<30;u++)if(i=Math.sin(s),o=Math.cos(s),a=t*i,s+=r=Math.pow(1-a*a,2)/(2*o)*(e/(1-t*t)-i/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),Math.abs(r)<=1e-10)return s;return NaN}(this.e,2*t.y*this.k0/this.a),e=It(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t},names:["cea"]},ze={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,n=t.y,r=It(e-this.long0),i=Oe(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*i,t},inverse:function(t){var e=t.x,n=t.y;return t.x=It(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=Oe(this.lat0+(n-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Ve={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Te(this.es),this.e1=we(this.es),this.e2=Ee(this.es),this.e3=Se(this.es),this.ml0=this.a*be(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,n,r,i=t.x,o=t.y,a=It(i-this.long0);if(r=a*Math.sin(o),this.sphere)Math.abs(o)<=st?(e=this.a*a,n=-1*this.a*this.lat0):(e=this.a*Math.sin(r)/Math.tan(o),n=this.a*(Oe(o-this.lat0)+(1-Math.cos(r))/Math.tan(o)));else if(Math.abs(o)<=st)e=this.a*a,n=-1*this.ml0;else{var s=Me(this.a,this.e,Math.sin(o))/Math.tan(o);e=s*Math.sin(r),n=this.a*be(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+s*(1-Math.cos(r))}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){var e,n,r,i,o,a,s,u,l;if(r=t.x-this.x0,i=t.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=st)e=It(r/this.a+this.long0),n=0;else{var c;for(a=this.lat0+i/this.a,s=r*r/this.a/this.a+a*a,u=a,o=20;o;--o)if(u+=l=-1*(a*(u*(c=Math.tan(u))+1)-u-.5*(u*u+s)*c)/((u-a)/c-1),Math.abs(l)<=st){n=u;break}e=It(this.long0+Math.asin(r*Math.tan(u)/this.a)/Math.sin(n))}else if(Math.abs(i+this.ml0)<=st)n=0,e=It(this.long0+r/this.a);else{var h,d,f,p,m;for(a=(this.ml0+i)/this.a,s=r*r/this.a/this.a+a*a,u=a,o=20;o;--o)if(m=this.e*Math.sin(u),h=Math.sqrt(1-m*m)*Math.tan(u),d=this.a*be(this.e0,this.e1,this.e2,this.e3,u),f=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),u-=l=(a*(h*(p=d/this.a)+1)-p-.5*h*(p*p+s))/(this.es*Math.sin(2*u)*(p*p+s-2*a*p)/(4*h)+(a-p)*(h*f-2/Math.sin(2*u))-f),Math.abs(l)<=st){n=u;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=It(this.long0+Math.asin(r*h/this.a)/Math.sin(n))}return t.x=e,t.y=n,t},names:["Polyconic","poly"]},qe={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,n=t.x,r=t.y-this.lat0,i=n-this.long0,o=r/nt*1e-5,a=i,s=1,u=0;for(e=1;e<=10;e++)s*=o,u+=this.A[e]*s;var l,c=u,h=a,d=1,f=0,p=0,m=0;for(e=1;e<=6;e++)l=f*c+d*h,d=d*c-f*h,f=l,p=p+this.B_re[e]*d-this.B_im[e]*f,m=m+this.B_im[e]*d+this.B_re[e]*f;return t.x=m*this.a+this.x0,t.y=p*this.a+this.y0,t},inverse:function(t){var e,n,r=t.x,i=t.y,o=r-this.x0,a=(i-this.y0)/this.a,s=o/this.a,u=1,l=0,c=0,h=0;for(e=1;e<=6;e++)n=l*a+u*s,u=u*a-l*s,l=n,c=c+this.C_re[e]*u-this.C_im[e]*l,h=h+this.C_im[e]*u+this.C_re[e]*l;for(var d=0;d<this.iterations;d++){var f,p=c,m=h,y=a,g=s;for(e=2;e<=6;e++)f=m*c+p*h,p=p*c-m*h,m=f,y+=(e-1)*(this.B_re[e]*p-this.B_im[e]*m),g+=(e-1)*(this.B_im[e]*p+this.B_re[e]*m);p=1,m=0;var v=this.B_re[1],_=this.B_im[1];for(e=2;e<=6;e++)f=m*c+p*h,p=p*c-m*h,m=f,v+=e*(this.B_re[e]*p-this.B_im[e]*m),_+=e*(this.B_im[e]*p+this.B_re[e]*m);var b=v*v+_*_;c=(y*v+g*_)/b,h=(g*v-y*_)/b}var T=c,w=h,E=1,S=0;for(e=1;e<=9;e++)E*=T,S+=this.D[e]*E;var M=this.lat0+S*nt*1e5,O=this.long0+w;return t.x=O,t.y=M,t},names:["New_Zealand_Map_Grid","nzmg"]},Ze={init:function(){},forward:function(t){var e=t.x,n=t.y,r=It(e-this.long0),i=this.x0+this.a*r,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=i,t.y=o,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=It(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t},names:["Miller_Cylindrical","mill"]},We={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ee(this.es)},forward:function(t){var e,n,r=t.x,i=t.y;if(r=It(r-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(i),a=20;a;--a){var s=(this.m*i+Math.sin(i)-o)/(this.m+Math.cos(i));if(i-=s,Math.abs(s)<st)break}else i=1!==this.n?Math.asin(this.n*Math.sin(i)):i;e=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var u=Math.sin(i),l=Math.cos(i);n=this.a*ne(i,u,l,this.en),e=this.a*r*l/Math.sqrt(1-this.es*u*u)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,r,i;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r/=this.C_x*(this.m+Math.cos(e)),this.m?e=Ne((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Ne(Math.sin(e)/this.n)),r=It(r+this.long0),e=Oe(e)):(e=re(t.y/this.a,this.es,this.en),(i=Math.abs(e))<rt?(i=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=It(n)):i-st<rt&&(r=this.long0)),t.x=r,t.y=e,t},names:["Sinusoidal","sinu"]},Ye={init:function(){},forward:function(t){for(var e=t.x,n=t.y,r=It(e-this.long0),i=n,o=Math.PI*Math.sin(n);;){var a=-(i+Math.sin(i)-o)/(1+Math.cos(i));if(i+=a,Math.abs(a)<st)break}i/=2,Math.PI/2-Math.abs(n)<st&&(r=0);var s=.900316316158*this.a*r*Math.cos(i)+this.x0,u=1.4142135623731*this.a*Math.sin(i)+this.y0;return t.x=s,t.y=u,t},inverse:function(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=It(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return t.x=r,t.y=i,t},names:["Mollweide","moll"]},Be={init:function(){Math.abs(this.lat1+this.lat2)<st||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Te(this.es),this.e1=we(this.es),this.e2=Ee(this.es),this.e3=Se(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Ct(this.e,this.sinphi,this.cosphi),this.ml1=be(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<st?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Ct(this.e,this.sinphi,this.cosphi),this.ml2=be(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=be(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,n=t.x,r=t.y;if(this.sphere)e=this.a*(this.g-r);else{var i=be(this.e0,this.e1,this.e2,this.e3,r);e=this.a*(this.g-i)}var o=this.ns*It(n-this.long0),a=this.x0+e*Math.sin(o),s=this.y0+this.rh-e*Math.cos(o);return t.x=a,t.y=s,t},inverse:function(t){var e,n,r,i;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(0!==n&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return i=It(this.long0+o/this.ns),r=Oe(this.g-n/this.a),t.x=i,t.y=r,t;var a=this.g-n/this.a;return r=xe(a,this.e0,this.e1,this.e2,this.e3),i=It(this.long0+o/this.ns),t.x=i,t.y=r,t},names:["Equidistant_Conic","eqdc"]},Ke={init:function(){this.R=this.a},forward:function(t){var e,n,r=t.x,i=t.y,o=It(r-this.long0);Math.abs(i)<=st&&(e=this.x0+this.R*o,n=this.y0);var a=Ne(2*Math.abs(i/Math.PI));(Math.abs(o)<=st||Math.abs(Math.abs(i)-rt)<=st)&&(e=this.x0,n=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*a):this.y0+Math.PI*this.R*-Math.tan(.5*a));var s=.5*Math.abs(Math.PI/o-o/Math.PI),u=s*s,l=Math.sin(a),c=Math.cos(a),h=c/(l+c-1),d=h*h,f=h*(2/l-1),p=f*f,m=Math.PI*this.R*(s*(h-p)+Math.sqrt(u*(h-p)*(h-p)-(p+u)*(d-p)))/(p+u);o<0&&(m=-m),e=this.x0+m;var y=u+h;return m=Math.PI*this.R*(f*y-s*Math.sqrt((p+u)*(u+1)-y*y))/(p+u),n=i>=0?this.y0+m:this.y0-m,t.x=e,t.y=n,t},inverse:function(t){var e,n,r,i,o,a,s,u,l,c,h,d;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,o=(r=t.x/h)*r+(i=t.y/h)*i,h=3*(i*i/(u=-2*(a=-Math.abs(i)*(1+o))+1+2*i*i+o*o)+(2*(s=a-2*i*i+r*r)*s*s/u/u/u-9*a*s/u/u)/27)/(l=(a-s*s/3/u)/u)/(c=2*Math.sqrt(-l/3)),Math.abs(h)>1&&(h=h>=0?1:-1),d=Math.acos(h)/3,n=t.y>=0?(-c*Math.cos(d+Math.PI/3)-s/3/u)*Math.PI:-(-c*Math.cos(d+Math.PI/3)-s/3/u)*Math.PI,e=Math.abs(r)<st?this.long0:It(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(r*r-i*i)+o*o))/2/r),t.x=e,t.y=n,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},He={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,n,r,i,o,a,s,u,l,c,h,d,f,p,m,y,g,v,_,b,T,w,E=t.x,S=t.y,M=Math.sin(t.y),O=Math.cos(t.y),x=It(E-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=st?(t.x=this.x0+this.a*(rt-S)*Math.sin(x),t.y=this.y0-this.a*(rt-S)*Math.cos(x),t):Math.abs(this.sin_p12+1)<=st?(t.x=this.x0+this.a*(rt+S)*Math.sin(x),t.y=this.y0+this.a*(rt+S)*Math.cos(x),t):(v=this.sin_p12*M+this.cos_p12*O*Math.cos(x),g=(y=Math.acos(v))/Math.sin(y),t.x=this.x0+this.a*g*O*Math.sin(x),t.y=this.y0+this.a*g*(this.cos_p12*M-this.sin_p12*O*Math.cos(x)),t):(e=Te(this.es),n=we(this.es),r=Ee(this.es),i=Se(this.es),Math.abs(this.sin_p12-1)<=st?(o=this.a*be(e,n,r,i,rt),a=this.a*be(e,n,r,i,S),t.x=this.x0+(o-a)*Math.sin(x),t.y=this.y0-(o-a)*Math.cos(x),t):Math.abs(this.sin_p12+1)<=st?(o=this.a*be(e,n,r,i,rt),a=this.a*be(e,n,r,i,S),t.x=this.x0+(o+a)*Math.sin(x),t.y=this.y0+(o+a)*Math.cos(x),t):(s=M/O,u=Me(this.a,this.e,this.sin_p12),l=Me(this.a,this.e,M),c=Math.atan((1-this.es)*s+this.es*u*this.sin_p12/(l*O)),_=0===(h=Math.atan2(Math.sin(x),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(x)))?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(h)-Math.PI)<=st?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(x)*Math.cos(c)/Math.sin(h)),d=this.e*this.sin_p12/Math.sqrt(1-this.es),y=u*_*(1-(b=_*_)*(m=(f=this.e*this.cos_p12*Math.cos(h)/Math.sqrt(1-this.es))*f)*(1-m)/6+(T=b*_)/8*(p=d*f)*(1-2*m)+(w=T*_)/120*(m*(4-7*m)-3*d*d*(1-7*m))-w*_/48*p),t.x=this.x0+y*Math.sin(h),t.y=this.y0+y*Math.cos(h),t))},inverse:function(t){var e,n,r,i,o,a,s,u,l,c,h,d,f,p,m,y,g,v,_,b,T,w;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*rt*this.a)return;return n=e/this.a,r=Math.sin(n),i=Math.cos(n),o=this.long0,Math.abs(e)<=st?a=this.lat0:(a=Ne(i*this.sin_p12+t.y*r*this.cos_p12/e),s=Math.abs(this.lat0)-rt,o=It(Math.abs(s)<=st?this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y):this.long0+Math.atan2(t.x*r,e*this.cos_p12*i-t.y*this.sin_p12*r))),t.x=o,t.y=a,t}return u=Te(this.es),l=we(this.es),c=Ee(this.es),h=Se(this.es),Math.abs(this.sin_p12-1)<=st?(d=this.a*be(u,l,c,h,rt),e=Math.sqrt(t.x*t.x+t.y*t.y),a=xe((d-e)/this.a,u,l,c,h),o=It(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=a,t):Math.abs(this.sin_p12+1)<=st?(d=this.a*be(u,l,c,h,rt),e=Math.sqrt(t.x*t.x+t.y*t.y),a=xe((e-d)/this.a,u,l,c,h),o=It(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=a,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),m=Math.atan2(t.x,t.y),f=Me(this.a,this.e,this.sin_p12),y=Math.cos(m),v=-(g=this.e*this.cos_p12*y)*g/(1-this.es),_=3*this.es*(1-v)*this.sin_p12*this.cos_p12*y/(1-this.es),w=1-v*(T=(b=e/f)-v*(1+v)*Math.pow(b,3)/6-_*(1+3*v)*Math.pow(b,4)/24)*T/2-b*T*T*T/6,p=Math.asin(this.sin_p12*Math.cos(T)+this.cos_p12*Math.sin(T)*y),o=It(this.long0+Math.asin(Math.sin(m)*Math.sin(T)/Math.cos(p))),a=Math.atan((1-this.es*w*this.sin_p12/Math.sin(p))*Math.tan(p)/(1-this.es)),t.x=o,t.y=a,t)},names:["Azimuthal_Equidistant","aeqd"]},Xe={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,n,r,i,o,a,s,u=t.x,l=t.y;return r=It(u-this.long0),e=Math.sin(l),n=Math.cos(l),i=Math.cos(r),((o=this.sin_p14*e+this.cos_p14*n*i)>0||Math.abs(o)<=st)&&(a=1*this.a*n*Math.sin(r),s=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*i)),t.x=a,t.y=s,t},inverse:function(t){var e,n,r,i,o,a,s;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=Ne(e/this.a),r=Math.sin(n),i=Math.cos(n),a=this.long0,Math.abs(e)<=st?(s=this.lat0,t.x=a,t.y=s,t):(s=Ne(i*this.sin_p14+t.y*r*this.cos_p14/e),o=Math.abs(this.lat0)-rt,Math.abs(o)<=st?(a=It(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)),t.x=a,t.y=s,t):(a=It(this.long0+Math.atan2(t.x*r,e*this.cos_p14*i-t.y*this.sin_p14*r)),t.x=a,t.y=s,t))},names:["ortho"]},$e=1,Qe=2,Je=3,tn=4,en=5,nn=6,rn={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4},on={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=rt-ct/2?this.face=en:this.lat0<=-(rt-ct/2)?this.face=nn:Math.abs(this.long0)<=ct?this.face=$e:Math.abs(this.long0)<=rt+ct?this.face=this.long0>0?Qe:tn:this.face=Je,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,n,r,i,o,a,s={x:0,y:0},u={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,n=t.x,this.face===en)i=rt-e,n>=ct&&n<=rt+ct?(u.value=rn.AREA_0,r=n-rt):n>rt+ct||n<=-(rt+ct)?(u.value=rn.AREA_1,r=n>0?n-dt:n+dt):n>-(rt+ct)&&n<=-ct?(u.value=rn.AREA_2,r=n+rt):(u.value=rn.AREA_3,r=n);else if(this.face===nn)i=rt+e,n>=ct&&n<=rt+ct?(u.value=rn.AREA_0,r=-n+rt):n<ct&&n>=-ct?(u.value=rn.AREA_1,r=-n):n<-ct&&n>=-(rt+ct)?(u.value=rn.AREA_2,r=-n-rt):(u.value=rn.AREA_3,r=n>0?-n+dt:-n-dt);else{var l,c,h,d,f,p;this.face===Qe?n=Z(n,+rt):this.face===Je?n=Z(n,+dt):this.face===tn&&(n=Z(n,-rt)),d=Math.sin(e),f=Math.cos(e),p=Math.sin(n),l=f*Math.cos(n),c=f*p,h=d,this.face===$e?r=V(i=Math.acos(l),h,c,u):this.face===Qe?r=V(i=Math.acos(c),h,-l,u):this.face===Je?r=V(i=Math.acos(-l),h,-c,u):this.face===tn?r=V(i=Math.acos(-c),h,l,u):(i=r=0,u.value=rn.AREA_0)}return a=Math.atan(12/dt*(r+Math.acos(Math.sin(r)*Math.cos(ct))-rt)),o=Math.sqrt((1-Math.cos(i))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(r))))),u.value===rn.AREA_1?a+=rt:u.value===rn.AREA_2?a+=dt:u.value===rn.AREA_3&&(a+=1.5*dt),s.x=o*Math.cos(a),s.y=o*Math.sin(a),s.x=s.x*this.a+this.x0,s.y=s.y*this.a+this.y0,t.x=s.x,t.y=s.y,t},inverse:function(t){var e,n,r,i,o,a,s,u,l,c,h,d,f={lam:0,phi:0},p={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,n=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?p.value=rn.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(p.value=rn.AREA_1,e-=rt):t.x<0&&-t.x>=Math.abs(t.y)?(p.value=rn.AREA_2,e=e<0?e+dt:e-dt):(p.value=rn.AREA_3,e+=rt),l=dt/12*Math.tan(e),o=Math.sin(l)/(Math.cos(l)-1/Math.sqrt(2)),a=Math.atan(o),(s=1-(r=Math.cos(e))*r*(i=Math.tan(n))*i*(1-Math.cos(Math.atan(1/Math.cos(a)))))<-1?s=-1:s>1&&(s=1),this.face===en)u=Math.acos(s),f.phi=rt-u,p.value===rn.AREA_0?f.lam=a+rt:p.value===rn.AREA_1?f.lam=a<0?a+dt:a-dt:p.value===rn.AREA_2?f.lam=a-rt:f.lam=a;else if(this.face===nn)u=Math.acos(s),f.phi=u-rt,p.value===rn.AREA_0?f.lam=-a+rt:p.value===rn.AREA_1?f.lam=-a:p.value===rn.AREA_2?f.lam=-a-rt:f.lam=a<0?-a-dt:-a+dt;else{var m,y,g;l=(m=s)*m,y=(l+=(g=l>=1?0:Math.sqrt(1-l)*Math.sin(a))*g)>=1?0:Math.sqrt(1-l),p.value===rn.AREA_1?(l=y,y=-g,g=l):p.value===rn.AREA_2?(y=-y,g=-g):p.value===rn.AREA_3&&(l=y,y=g,g=-l),this.face===Qe?(l=m,m=-y,y=l):this.face===Je?(m=-m,y=-y):this.face===tn&&(l=m,m=y,y=-l),f.phi=Math.acos(-g)-rt,f.lam=Math.atan2(y,m),this.face===Qe?f.lam=Z(f.lam,-rt):this.face===Je?f.lam=Z(f.lam,-dt):this.face===tn&&(f.lam=Z(f.lam,+rt))}return 0!==this.es&&(c=f.phi<0?1:0,h=Math.tan(f.phi),d=this.b/Math.sqrt(h*h+this.one_minus_f_squared),f.phi=Math.atan(Math.sqrt(this.a*this.a-d*d)/(this.one_minus_f*d)),c&&(f.phi=-f.phi)),f.lam+=this.long0,t.x=f.lam,t.y=f.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},an=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],sn=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],un=lt/5,ln=1/un,cn=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},hn={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=It(t.x-this.long0),n=Math.abs(t.y),r=Math.floor(n*un);r<0?r=0:r>=18&&(r=17);var i={x:cn(an[r],n=lt*(n-ln*r))*e,y:cn(sn[r],n)};return t.y<0&&(i.y=-i.y),i.x=i.x*this.a*.8487+this.x0,i.y=i.y*this.a*1.3523+this.y0,i},inverse:function(t){var e={x:(t.x-this.x0)/(.8487*this.a),y:Math.abs(t.y-this.y0)/(1.3523*this.a)};if(e.y>=1)e.x/=an[18][0],e.y=t.y<0?-rt:rt;else{var n=Math.floor(18*e.y);for(n<0?n=0:n>=18&&(n=17);;)if(sn[n][0]>e.y)--n;else{if(!(sn[n+1][0]<=e.y))break;++n}var r=sn[n],i=5*(e.y-r[0])/(sn[n+1][0]-r[0]);i=function Y(t,e,n,r){for(var i=e;r;--r){var o=t(i);if(i-=o,Math.abs(o)<n)break}return i}((function(t){return(cn(r,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(r,t)}),i,st,100),e.x/=cn(an[n],i),e.y=(5*n+i)*ut,t.y<0&&(e.y=-e.y)}return e.x=It(e.x+this.long0),e},names:["Robinson","robin"]};return I.defaultDatum="WGS84",I.Proj=Projection,I.WGS84=new I.Proj("WGS84"),I.Point=Point,I.toPoint=Vt,I.defs=o,I.transform=S,I.mgrs=Jt,I.version="2.5.0",function(t){t.Proj.projections.add(ie),t.Proj.projections.add(ce),t.Proj.projections.add(he),t.Proj.projections.add(pe),t.Proj.projections.add(me),t.Proj.projections.add(ye),t.Proj.projections.add(ge),t.Proj.projections.add(ve),t.Proj.projections.add(_e),t.Proj.projections.add(Ce),t.Proj.projections.add(je),t.Proj.projections.add(Fe),t.Proj.projections.add(Ue),t.Proj.projections.add(Ge),t.Proj.projections.add(ze),t.Proj.projections.add(Ve),t.Proj.projections.add(qe),t.Proj.projections.add(Ze),t.Proj.projections.add(We),t.Proj.projections.add(Ye),t.Proj.projections.add(Be),t.Proj.projections.add(Ke),t.Proj.projections.add(He),t.Proj.projections.add(Xe),t.Proj.projections.add(on),t.Proj.projections.add(hn)}(I),I}()})),V=createCommonjsModule((function(t){!function(t){var n,r=/^[a-z]+:/,i=/[-a-z0-9]+(\.[-a-z0-9])*:\d+/i,o=/\/\/(.*?)(?::(.*?))?@/,a=/^win/i,s=/:$/,l=/^\?/,c=/^#/,d=/(.*\/)/,f=/^\/{2,}/,p=/'/g,m=/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,y=/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,g=/%([0-7][0-9a-f])/gi,v=/\+/g,_=/^\w:$/,b=/[^/#?]/,T="undefined"==typeof window&&void 0!==e&&!0,w=T?t.require:null,E={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},S={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443};function x(){return T?(n||(n="file://"+(process.platform.match(a)?"/":"")+w("fs").realpathSync(".")),n):document.location.href}function u(t){return encodeURIComponent(t).replace(p,"%27")}function z(t){return(t=(t=(t=t.replace(v," ")).replace(m,(function(t,e,n,r){var i=parseInt(e,16)-224,o=parseInt(n,16)-128;if(0===i&&o<32)return t;var a=(i<<12)+(o<<6)+(parseInt(r,16)-128);return 65535<a?t:String.fromCharCode(a)}))).replace(y,(function(t,e,n){var r=parseInt(e,16)-192;if(r<2)return t;var i=parseInt(n,16)-128;return String.fromCharCode((r<<6)+i)}))).replace(g,(function(t,e){return String.fromCharCode(parseInt(e,16))}))}function F(t){for(var e=t.split("&"),n=0,r=e.length;n<r;n++){var i=e[n].split("="),o=decodeURIComponent(i[0].replace(v," "));if(o){var a=void 0!==i[1]?z(i[1]):null;void 0===this[o]?this[o]=a:(this[o]instanceof Array||(this[o]=[this[o]]),this[o].push(a))}}}function U(t,e){!function h(t,e,n){var a,u,h;e||(e=x()),T?a=w("url").parse(e):(a=document.createElement("a")).href=e;var p,m,y=(m={path:!0,query:!0,hash:!0},(p=e)&&r.test(p)&&(m.protocol=!0,m.host=!0,i.test(p)&&(m.port=!0),o.test(p)&&(m.user=!0,m.pass=!0)),m);for(u in h=e.match(o)||[],E)y[u]?t[u]=a[E[u]]||"":t[u]="";if(t.protocol=t.protocol.replace(s,""),t.query=t.query.replace(l,""),t.hash=z(t.hash.replace(c,"")),t.user=z(h[1]||""),t.pass=z(h[2]||""),t.port=S[t.protocol]==t.port||0==t.port?"":t.port,!y.protocol&&b.test(e.charAt(0))&&(t.path=e.split("?")[0].split("#")[0]),!y.protocol&&n){var g=new U(x().match(d)[0]),v=g.path.split("/"),_=t.path.split("/"),M=["protocol","user","pass","host","port"],O=M.length;for(v.pop(),u=0;u<O;u++)t[M[u]]=g[M[u]];for(;".."===_[0];)v.pop(),_.shift();t.path=("/"!==e.charAt(0)?v.join("/"):"")+"/"+_.join("/")}t.path=t.path.replace(f,"/"),t.paths(t.paths()),t.query=new F(t.query)}(this,t,!e)}F.prototype.toString=function(){var t,e,n="",r=u;for(t in this){var i=this[t];if(!(i instanceof Function||null===i))if(i instanceof Array){var o=i.length;if(o)for(e=0;e<o;e++){var a=i[e];n+=n?"&":"",n+=r(t)+(null==a?"":"="+r(a))}else n+=(n?"&":"")+r(t)+"="}else n+=n?"&":"",n+=r(t)+(void 0===i?"":"="+r(i))}return n},U.prototype.clearQuery=function(){for(var t in this.query)this.query[t]instanceof Function||delete this.query[t];return this},U.prototype.queryLength=function(){var t=0;for(var e in this.query)this.query[e]instanceof Function||t++;return t},U.prototype.isEmptyQuery=function(){return 0===this.queryLength()},U.prototype.paths=function(t){var e,n="",r=0;if(t&&t.length&&t+""!==t){for(this.isAbsolute()&&(n="/"),e=t.length;r<e;r++)t[r]=!r&&_.test(t[r])?t[r]:u(t[r]);this.path=n+t.join("/")}for(r=0,e=(t=("/"===this.path.charAt(0)?this.path.slice(1):this.path).split("/")).length;r<e;r++)t[r]=z(t[r]);return t},U.prototype.encode=u,U.prototype.decode=z,U.prototype.isAbsolute=function(){return this.protocol||"/"===this.path.charAt(0)},U.prototype.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&u(this.user)+(this.pass&&":"+u(this.pass))+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+u(this.hash))},t[t.exports?"exports":"Url"]=U}(t.exports?t:window)}));class LuxonError extends Error{}class InvalidDateTimeError extends LuxonError{constructor(t){super(`Invalid DateTime: ${t.toMessage()}`)}}class InvalidIntervalError extends LuxonError{constructor(t){super(`Invalid Interval: ${t.toMessage()}`)}}class InvalidDurationError extends LuxonError{constructor(t){super(`Invalid Duration: ${t.toMessage()}`)}}class ConflictingSpecificationError extends LuxonError{}class InvalidUnitError extends LuxonError{constructor(t){super(`Invalid unit ${t}`)}}class InvalidArgumentError extends LuxonError{}class ZoneIsAbstractError extends LuxonError{constructor(){super("Zone is an abstract class")}}function isUndefined(t){return void 0===t}function isNumber(t){return"number"==typeof t}function hasIntl(){return"undefined"!=typeof Intl&&Intl.DateTimeFormat}function hasFormatToParts(){return!isUndefined(Intl.DateTimeFormat.prototype.formatToParts)}function hasRelative(){return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}function bestBy(t,e,n){if(0!==t.length)return t.reduce((t,r)=>{const i=[e(r),r];return t&&n(t[0],i[0])===t[0]?t:i},null)[1]}function pick(t,e){return e.reduce((e,n)=>(e[n]=t[n],e),{})}function numberBetween(t,e,n){return isNumber(t)&&t>=e&&t<=n}function padStart(t,e=2){return t.toString().length<e?("0".repeat(e)+t).slice(-e):t.toString()}function parseInteger(t){return isUndefined(t)||null===t||""===t?void 0:parseInt(t,10)}function parseMillis(t){if(!isUndefined(t)&&null!==t&&""!==t){const e=1e3*parseFloat("0."+t);return Math.floor(e)}}function roundTo(t,e,n=!1){const r=10**e;return(n?Math.trunc:Math.round)(t*r)/r}function isLeapYear(t){return t%4==0&&(t%100!=0||t%400==0)}function daysInYear(t){return isLeapYear(t)?366:365}function daysInMonth(t,e){const n=function floorMod(t,e){return t-e*Math.floor(t/e)}(e-1,12)+1;return 2===n?isLeapYear(t+(e-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function objToLocalTS(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e)).setUTCFullYear(e.getUTCFullYear()-1900),+e}function weeksInWeekYear(t){const e=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7,n=t-1,r=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7;return 4===e||3===r?53:52}function untruncateYear(t){return t>99?t:t>60?1900+t:2e3+t}function parseZoneInfo(t,e,n,r=null){const i=new Date(t),o={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(o.timeZone=r);const a=Object.assign({timeZoneName:e},o),s=hasIntl();if(s&&hasFormatToParts()){const t=new Intl.DateTimeFormat(n,a).formatToParts(i).find(t=>"timezonename"===t.type.toLowerCase());return t?t.value:null}if(s){const t=new Intl.DateTimeFormat(n,o).format(i);return new Intl.DateTimeFormat(n,a).format(i).substring(t.length).replace(/^[, \u200e]+/,"")}return null}function signedOffset(t,e){const n=parseInt(t,10)||0,r=parseInt(e,10)||0;return 60*n+(n<0?-r:r)}function asNumber(t){const e=Number(t);if("boolean"==typeof t||""===t||Number.isNaN(e))throw new InvalidArgumentError(`Invalid unit value ${t}`);return e}function normalizeObject(t,e,n){const r={};for(const i in t)if(t.hasOwnProperty(i)){if(n.indexOf(i)>=0)continue;const o=t[i];if(null==o)continue;r[e(i)]=asNumber(o)}return r}function formatOffset(t,e){const n=Math.trunc(t/60),r=Math.abs(t%60),i=n>=0?"+":"-",o=`${i}${Math.abs(n)}`;switch(e){case"short":return`${i}${padStart(Math.abs(n),2)}:${padStart(r,2)}`;case"narrow":return r>0?`${o}:${r}`:o;case"techie":return`${i}${padStart(Math.abs(n),2)}${padStart(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function timeObject(t){return pick(t,["hour","minute","second","millisecond"])}const q=/[A-Za-z_+-]{1,256}(:?\/[A-Za-z_+-]{1,256}(\/[A-Za-z_+-]{1,256})?)?/,Z="numeric",W="short",Y="long",B="2-digit",K={year:Z,month:Z,day:Z},H={year:Z,month:W,day:Z},X={year:Z,month:Y,day:Z},$={year:Z,month:Y,day:Z,weekday:Y},Q={hour:Z,minute:B},J={hour:Z,minute:B,second:B},tt={hour:Z,minute:B,second:B,timeZoneName:W},et={hour:Z,minute:B,second:B,timeZoneName:Y},nt={hour:Z,minute:B,hour12:!1},rt={hour:Z,minute:B,second:B,hour12:!1},it={hour:Z,minute:B,second:B,hour12:!1,timeZoneName:W},ot={hour:Z,minute:B,second:B,hour12:!1,timeZoneName:Y},at={year:Z,month:Z,day:Z,hour:Z,minute:B},st={year:Z,month:Z,day:Z,hour:Z,minute:B,second:B},ut={year:Z,month:W,day:Z,hour:Z,minute:B},lt={year:Z,month:W,day:Z,hour:Z,minute:B,second:B},ct={year:Z,month:Y,day:Z,hour:Z,minute:B,timeZoneName:W},ht={year:Z,month:Y,day:Z,hour:Z,minute:B,second:B,timeZoneName:W},dt={year:Z,month:Y,day:Z,weekday:Y,hour:Z,minute:B,timeZoneName:Y},ft={year:Z,month:Y,day:Z,weekday:Y,hour:Z,minute:B,second:B,timeZoneName:Y};function stringify(t){return JSON.stringify(t,Object.keys(t).sort())}const pt=["January","February","March","April","May","June","July","August","September","October","November","December"],mt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],yt=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(t){switch(t){case"narrow":return yt;case"short":return mt;case"long":return pt;case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const gt=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],vt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],_t=["M","T","W","T","F","S","S"];function weekdays(t){switch(t){case"narrow":return _t;case"short":return vt;case"long":return gt;case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const bt=["AM","PM"],Tt=["Before Christ","Anno Domini"],wt=["BC","AD"],Et=["B","A"];function eras(t){switch(t){case"narrow":return Et;case"short":return wt;case"long":return Tt;default:return null}}class Zone{get type(){throw new ZoneIsAbstractError}get name(){throw new ZoneIsAbstractError}get universal(){throw new ZoneIsAbstractError}offsetName(t,e){throw new ZoneIsAbstractError}formatOffset(t,e){throw new ZoneIsAbstractError}offset(t){throw new ZoneIsAbstractError}equals(t){throw new ZoneIsAbstractError}get isValid(){throw new ZoneIsAbstractError}}let St=null;class LocalZone extends Zone{static get instance(){return null===St&&(St=new LocalZone),St}get type(){return"local"}get name(){return hasIntl()?(new Intl.DateTimeFormat).resolvedOptions().timeZone:"local"}get universal(){return!1}offsetName(t,{format:e,locale:n}){return parseZoneInfo(t,e,n)}formatOffset(t,e){return formatOffset(this.offset(t),e)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return"local"===t.type}get isValid(){return!0}}const Mt=RegExp(`^${q.source}$`);let Ot={};const xt={year:0,month:1,day:2,hour:3,minute:4,second:5};let Ct={};class IANAZone extends Zone{static create(t){return Ct[t]||(Ct[t]=new IANAZone(t)),Ct[t]}static resetCache(){Ct={},Ot={}}static isValidSpecifier(t){return!(!t||!t.match(Mt))}static isValidZone(t){try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch(t){return!1}}static parseGMTOffset(t){if(t){const e=t.match(/^Etc\/GMT([+-]\d{1,2})$/i);if(e)return-60*parseInt(e[1])}return null}constructor(t){super(),this.zoneName=t,this.valid=IANAZone.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get universal(){return!1}offsetName(t,{format:e,locale:n}){return parseZoneInfo(t,e,n,this.name)}formatOffset(t,e){return formatOffset(this.offset(t),e)}offset(t){const e=new Date(t),n=function makeDTF(t){return Ot[t]||(Ot[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),Ot[t]}(this.name),[r,i,o,a,s,u]=n.formatToParts?function partsOffset(t,e){const n=t.formatToParts(e),r=[];for(let t=0;t<n.length;t++){const{type:e,value:i}=n[t],o=xt[e];isUndefined(o)||(r[o]=parseInt(i,10))}return r}(n,e):function hackyOffset(t,e){const n=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n),[,i,o,a,s,u,l]=r;return[a,i,o,s,u,l]}(n,e),l=objToLocalTS({year:r,month:i,day:o,hour:a,minute:s,second:u,millisecond:0});let c=e.valueOf();return(l-(c-=c%1e3))/6e4}equals(t){return"iana"===t.type&&t.name===this.name}get isValid(){return this.valid}}let Pt=null;class FixedOffsetZone extends Zone{static get utcInstance(){return null===Pt&&(Pt=new FixedOffsetZone(0)),Pt}static instance(t){return 0===t?FixedOffsetZone.utcInstance:new FixedOffsetZone(t)}static parseSpecifier(t){if(t){const e=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(e)return new FixedOffsetZone(signedOffset(e[1],e[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${formatOffset(this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,e){return formatOffset(this.fixed,e)}get universal(){return!0}offset(){return this.fixed}equals(t){return"fixed"===t.type&&t.fixed===this.fixed}get isValid(){return!0}}class InvalidZone extends Zone{constructor(t){super(),this.zoneName=t}get type(){return"invalid"}get name(){return this.zoneName}get universal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function normalizeZone(t,e){let n;if(isUndefined(t)||null===t)return e;if(t instanceof Zone)return t;if(function isString(t){return"string"==typeof t}(t)){const r=t.toLowerCase();return"local"===r?e:"utc"===r||"gmt"===r?FixedOffsetZone.utcInstance:null!=(n=IANAZone.parseGMTOffset(t))?FixedOffsetZone.instance(n):IANAZone.isValidSpecifier(r)?IANAZone.create(t):FixedOffsetZone.parseSpecifier(r)||new InvalidZone(t)}return isNumber(t)?FixedOffsetZone.instance(t):"object"==typeof t&&t.offset&&"number"==typeof t.offset?t:new InvalidZone(t)}let It=()=>Date.now(),Rt=null,Lt=null,kt=null,At=null,Dt=!1;class Settings{static get now(){return It}static set now(t){It=t}static get defaultZoneName(){return Settings.defaultZone.name}static set defaultZoneName(t){Rt=t?normalizeZone(t):null}static get defaultZone(){return Rt||LocalZone.instance}static get defaultLocale(){return Lt}static set defaultLocale(t){Lt=t}static get defaultNumberingSystem(){return kt}static set defaultNumberingSystem(t){kt=t}static get defaultOutputCalendar(){return At}static set defaultOutputCalendar(t){At=t}static get throwOnInvalid(){return Dt}static set throwOnInvalid(t){Dt=t}static resetCaches(){Locale.resetCache(),IANAZone.resetCache()}}function stringifyTokens(t,e){let n="";for(const r of t)r.literal?n+=r.val:n+=e(r.val);return n}const jt={D:K,DD:H,DDD:X,DDDD:$,t:Q,tt:J,ttt:tt,tttt:et,T:nt,TT:rt,TTT:it,TTTT:ot,f:at,ff:ut,fff:ct,ffff:dt,F:st,FF:lt,FFF:ht,FFFF:ft};class Formatter{static create(t,e={}){return new Formatter(t,e)}static parseFormat(t){let e=null,n="",r=!1;const i=[];for(let o=0;o<t.length;o++){const a=t.charAt(o);"'"===a?(n.length>0&&i.push({literal:r,val:n}),e=null,n="",r=!r):r?n+=a:a===e?n+=a:(n.length>0&&i.push({literal:!1,val:n}),n=a,e=a)}return n.length>0&&i.push({literal:r,val:n}),i}constructor(t,e){this.opts=e,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,e){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,Object.assign({},this.opts,e)).format()}formatDateTime(t,e={}){return this.loc.dtFormatter(t,Object.assign({},this.opts,e)).format()}formatDateTimeParts(t,e={}){return this.loc.dtFormatter(t,Object.assign({},this.opts,e)).formatToParts()}resolvedOptions(t,e={}){return this.loc.dtFormatter(t,Object.assign({},this.opts,e)).resolvedOptions()}num(t,e=0){if(this.opts.forceSimple)return padStart(t,e);const n=Object.assign({},this.opts);return e>0&&(n.padTo=e),this.loc.numberFormatter(n).format(t)}formatDateTimeFromString(t,e){const n="en"===this.loc.listingMode(),r=(e,n)=>this.loc.extract(t,e,n),i=e=>t.isOffsetFixed&&0===t.offset&&e.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,e.format):"",o=()=>n?function meridiemForDateTime(t){return bt[t.hour<12?0:1]}(t):r({hour:"numeric",hour12:!0},"dayperiod"),a=(e,i)=>n?function monthForDateTime(t,e){return months(e)[t.month-1]}(t,e):r(i?{month:e}:{month:e,day:"numeric"},"month"),s=(e,i)=>n?function weekdayForDateTime(t,e){return weekdays(e)[t.weekday-1]}(t,e):r(i?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday"),u=e=>{const n=jt[e];return n?this.formatWithSystemDefault(t,n):e},l=e=>n?function eraForDateTime(t,e){return eras(e)[t.year<0?0:1]}(t,e):r({era:e},"era");return stringifyTokens(Formatter.parseFormat(e),e=>{const n=this.loc.outputCalendar;switch(e){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12==0?12:t.hour%12);case"hh":return this.num(t.hour%12==0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return i({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return i({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return i({format:"techie",allowZ:!1});case"ZZZZ":return t.offsetNameShort;case"ZZZZZ":return t.offsetNameLong;case"z":return t.zoneName;case"a":return o();case"d":return n?r({day:"numeric"},"day"):this.num(t.day);case"dd":return n?r({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return s("short",!0);case"cccc":return s("long",!0);case"ccccc":return s("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return s("short",!1);case"EEEE":return s("long",!1);case"EEEEE":return s("narrow",!1);case"L":return n?r({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return n?r({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return a("short",!0);case"LLLL":return a("long",!0);case"LLLLL":return a("narrow",!0);case"M":return n?r({month:"numeric"},"month"):this.num(t.month);case"MM":return n?r({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return a("short",!1);case"MMMM":return a("long",!1);case"MMMMM":return a("narrow",!1);case"y":return n?r({year:"numeric"},"year"):this.num(t.year);case"yy":return n?r({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return n?r({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return n?r({year:"numeric"},"year"):this.num(t.year,6);case"G":return l("short");case"GG":return l("long");case"GGGGG":return l("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return u(e)}})}formatDurationFromString(t,e){const n=t=>{switch(t[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"M":return"month";case"y":return"year";default:return null}},r=Formatter.parseFormat(e),i=r.reduce((t,{literal:e,val:n})=>e?t:t.concat(n),[]);return stringifyTokens(r,(t=>e=>{const r=n(e);return r?this.num(t.get(r),e.length):e})(t.shiftTo(...i.map(n).filter(t=>t))))}}let Nt={};function getCachedDTF(t,e={}){const n=JSON.stringify([t,e]);let r=Nt[n];return r||(r=new Intl.DateTimeFormat(t,e),Nt[n]=r),r}let Ft={};let Ut={};let Gt=null;function listStuff(t,e,n,r,i){const o=t.listingMode(n);return"error"===o?null:"en"===o?r(e):i(e)}class PolyNumberFormatter{constructor(t,e,n){if(this.padTo=n.padTo||0,this.floor=n.floor||!1,!e&&hasIntl()){const e={useGrouping:!1};n.padTo>0&&(e.minimumIntegerDigits=n.padTo),this.inf=function getCachendINF(t,e={}){const n=JSON.stringify([t,e]);let r=Ft[n];return r||(r=new Intl.NumberFormat(t,e),Ft[n]=r),r}(t,e)}}format(t){if(this.inf){const e=this.floor?Math.floor(t):t;return this.inf.format(e)}return padStart(this.floor?Math.floor(t):roundTo(t,3),this.padTo)}}class PolyDateFormatter{constructor(t,e,n){let r;if(this.opts=n,this.hasIntl=hasIntl(),t.zone.universal&&this.hasIntl?(r="UTC",n.timeZoneName?this.dt=t:this.dt=0===t.offset?t:DateTime.fromMillis(t.ts+60*t.offset*1e3)):"local"===t.zone.type?this.dt=t:(this.dt=t,r=t.zone.name),this.hasIntl){const t=Object.assign({},this.opts);r&&(t.timeZone=r),this.dtf=getCachedDTF(e,t)}}format(){if(this.hasIntl)return this.dtf.format(this.dt.toJSDate());{const t=function formatString(t){switch(stringify(pick(t,["weekday","era","year","month","day","hour","minute","second","timeZoneName","hour12"]))){case stringify(K):return"M/d/yyyy";case stringify(H):return"LLL d, yyyy";case stringify(X):return"LLLL d, yyyy";case stringify($):return"EEEE, LLLL d, yyyy";case stringify(Q):return"h:mm a";case stringify(J):return"h:mm:ss a";case stringify(tt):case stringify(et):return"h:mm a";case stringify(nt):return"HH:mm";case stringify(rt):return"HH:mm:ss";case stringify(it):case stringify(ot):return"HH:mm";case stringify(at):return"M/d/yyyy, h:mm a";case stringify(ut):return"LLL d, yyyy, h:mm a";case stringify(ct):return"LLLL d, yyyy, h:mm a";case stringify(dt):return"EEEE, LLLL d, yyyy, h:mm a";case stringify(st):return"M/d/yyyy, h:mm:ss a";case stringify(lt):return"LLL d, yyyy, h:mm:ss a";case stringify(ht):return"LLLL d, yyyy, h:mm:ss a";case stringify(ft):return"EEEE, LLLL d, yyyy, h:mm:ss a";default:return"EEEE, LLLL d, yyyy, h:mm a"}}(this.opts),e=Locale.create("en-US");return Formatter.create(e).formatDateTimeFromString(this.dt,t)}}formatToParts(){return this.hasIntl&&hasFormatToParts()?this.dtf.formatToParts(this.dt.toJSDate()):[]}resolvedOptions(){return this.hasIntl?this.dtf.resolvedOptions():{locale:"en-US",numberingSystem:"latn",outputCalendar:"gregory"}}}class PolyRelFormatter{constructor(t,e,n){this.opts=Object.assign({style:"long"},n),!e&&hasRelative()&&(this.rtf=function getCachendRTF(t,e={}){const n=JSON.stringify([t,e]);let r=Ut[n];return r||(r=new Intl.RelativeTimeFormat(t,e),Ut[n]=r),r}(t,n))}format(t,e){return this.rtf?this.rtf.format(t,e):function formatRelativeTime(t,e,n="always",r=!1){const i={years:["year","yr."],quarters:["quarer","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=-1===["hours","minutes","seconds"].indexOf(t);if("auto"===n&&o){const n="days"===t;switch(e){case 1:return n?"tomorrow":`next ${i[t][0]}`;case-1:return n?"yesterday":`last ${i[t][0]}`;case 0:return n?"today":`this ${i[t][0]}`}}const a=Object.is(e,-0)||e<0,s=Math.abs(e),u=r?i[t][1]:1===s?i[t][0]:t;return a?`${s} ${u} ago`:`in ${s} ${u}`}(e,t,this.opts.numeric,"long"!==this.opts.style)}formatToParts(t,e){return this.rtf?this.rtf.formatToParts(t,e):[]}}class Locale{static fromOpts(t){return Locale.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)}static create(t,e,n,r=!1){const i=t||Settings.defaultLocale,o=i||(r?"en-US":function systemLocale(){if(Gt)return Gt;if(hasIntl()){const t=(new Intl.DateTimeFormat).resolvedOptions().locale;return Gt="und"===t?"en-US":t}return Gt="en-US"}()),a=e||Settings.defaultNumberingSystem,s=n||Settings.defaultOutputCalendar;return new Locale(o,a,s,i)}static resetCache(){Gt=null,Nt={},Ft={}}static fromObject({locale:t,numberingSystem:e,outputCalendar:n}={}){return Locale.create(t,e,n)}constructor(t,e,n,r){let[i,o,a]=function parseLocaleString(t){const e=t.indexOf("-u-");if(-1===e)return[t];{let n;const r=t.substring(0,e);try{n=getCachedDTF(t).resolvedOptions()}catch(t){n=getCachedDTF(r).resolvedOptions()}const{numberingSystem:i,calendar:o}=n;return[r,i,o]}}(t);this.locale=i,this.numberingSystem=e||o||null,this.outputCalendar=n||a||null,this.intl=function intlConfigString(t,e,n){return hasIntl()?n||e?(t+="-u",n&&(t+=`-ca-${n}`),e&&(t+=`-nu-${e}`),t):t:[]}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=r,this.fastNumbersCached=null}get fastNumbers(){return null==this.fastNumbersCached&&(this.fastNumbersCached=function supportsFastNumbers(t){return(!t.numberingSystem||"latn"===t.numberingSystem)&&("latn"===t.numberingSystem||!t.locale||t.locale.startsWith("en")||hasIntl()&&"latn"===Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem)}(this)),this.fastNumbersCached}listingMode(t=!0){const e=hasIntl()&&hasFormatToParts(),n=this.isEnglish(),r=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e||n&&r||t?!e||n&&r?"en":"intl":"error"}clone(t){return t&&0!==Object.getOwnPropertyNames(t).length?Locale.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1):this}redefaultToEN(t={}){return this.clone(Object.assign({},t,{defaultToEN:!0}))}redefaultToSystem(t={}){return this.clone(Object.assign({},t,{defaultToEN:!1}))}months(t,e=!1,n=!0){return listStuff(this,t,n,months,()=>{const n=e?{month:t,day:"numeric"}:{month:t},r=e?"format":"standalone";return this.monthsCache[r][t]||(this.monthsCache[r][t]=function mapMonths(t){const e=[];for(let n=1;n<=12;n++){const r=DateTime.utc(2016,n,1);e.push(t(r))}return e}(t=>this.extract(t,n,"month"))),this.monthsCache[r][t]})}weekdays(t,e=!1,n=!0){return listStuff(this,t,n,weekdays,()=>{const n=e?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},r=e?"format":"standalone";return this.weekdaysCache[r][t]||(this.weekdaysCache[r][t]=function mapWeekdays(t){const e=[];for(let n=1;n<=7;n++){const r=DateTime.utc(2016,11,13+n);e.push(t(r))}return e}(t=>this.extract(t,n,"weekday"))),this.weekdaysCache[r][t]})}meridiems(t=!0){return listStuff(this,void 0,t,()=>bt,()=>{if(!this.meridiemCache){const t={hour:"numeric",hour12:!0};this.meridiemCache=[DateTime.utc(2016,11,13,9),DateTime.utc(2016,11,13,19)].map(e=>this.extract(e,t,"dayperiod"))}return this.meridiemCache})}eras(t,e=!0){return listStuff(this,t,e,eras,()=>{const e={era:t};return this.eraCache[t]||(this.eraCache[t]=[DateTime.utc(-40,1,1),DateTime.utc(2017,1,1)].map(t=>this.extract(t,e,"era"))),this.eraCache[t]})}extract(t,e,n){const r=this.dtFormatter(t,e).formatToParts().find(t=>t.type.toLowerCase()===n);return r?r.value:null}numberFormatter(t={}){return new PolyNumberFormatter(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,e={}){return new PolyDateFormatter(t,this.intl,e)}relFormatter(t={}){return new PolyRelFormatter(this.intl,this.isEnglish(),t)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||hasIntl()&&Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}}function combineRegexes(...t){const e=t.reduce((t,e)=>t+e.source,"");return RegExp(`^${e}$`)}function combineExtractors(...t){return e=>t.reduce(([t,n,r],i)=>{const[o,a,s]=i(e,r);return[Object.assign(t,o),n||a,s]},[{},null,1]).slice(0,2)}function parse(t,...e){if(null==t)return[null,null];for(const[n,r]of e){const e=n.exec(t);if(e)return r(e)}return[null,null]}function simpleParse(...t){return(e,n)=>{const r={};let i;for(i=0;i<t.length;i++)r[t[i]]=parseInteger(e[n+i]);return[r,null,n+i]}}const zt=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Vt=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,9}))?)?)?/,qt=RegExp(`${Vt.source}${zt.source}?`),Zt=RegExp(`(?:T${qt.source})?`),Wt=simpleParse("weekYear","weekNumber","weekDay"),Yt=simpleParse("year","ordinal"),Bt=RegExp(`${Vt.source} ?(?:${zt.source}|(${q.source}))?`),Kt=RegExp(`(?: ${Bt.source})?`);function extractISOYmd(t,e){return[{year:parseInteger(t[e]),month:parseInteger(t[e+1])||1,day:parseInteger(t[e+2])||1},null,e+3]}function extractISOTime(t,e){return[{hour:parseInteger(t[e])||0,minute:parseInteger(t[e+1])||0,second:parseInteger(t[e+2])||0,millisecond:parseMillis(t[e+3])},null,e+4]}function extractISOOffset(t,e){const n=!t[e]&&!t[e+1],r=signedOffset(t[e+1],t[e+2]);return[{},n?null:FixedOffsetZone.instance(r),e+3]}function extractIANAZone(t,e){return[{},t[e]?IANAZone.create(t[e]):null,e+1]}const Ht=/^P(?:(?:(-?\d{1,9})Y)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})W)?(?:(-?\d{1,9})D)?(?:T(?:(-?\d{1,9})H)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})(?:[.,](-?\d{1,9}))?S)?)?)$/;function extractISODuration(t){const[,e,n,r,i,o,a,s,u]=t;return[{years:parseInteger(e),months:parseInteger(n),weeks:parseInteger(r),days:parseInteger(i),hours:parseInteger(o),minutes:parseInteger(a),seconds:parseInteger(s),milliseconds:parseMillis(u)}]}const Xt={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function fromStrings(t,e,n,r,i,o,a){const s={year:2===e.length?untruncateYear(parseInteger(e)):parseInteger(e),month:mt.indexOf(n)+1,day:parseInteger(r),hour:parseInteger(i),minute:parseInteger(o)};return a&&(s.second=parseInteger(a)),t&&(s.weekday=t.length>3?gt.indexOf(t)+1:vt.indexOf(t)+1),s}const $t=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(t){const[,e,n,r,i,o,a,s,u,l,c,h]=t,d=fromStrings(e,i,r,n,o,a,s);let f;return f=u?Xt[u]:l?0:signedOffset(c,h),[d,new FixedOffsetZone(f)]}const Qt=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Jt=/^(Monday|Tuesday|Wedsday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,te=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(t){const[,e,n,r,i,o,a,s]=t;return[fromStrings(e,i,r,n,o,a,s),FixedOffsetZone.utcInstance]}function extractASCII(t){const[,e,n,r,i,o,a,s]=t;return[fromStrings(e,s,n,r,i,o,a),FixedOffsetZone.utcInstance]}const ee=combineRegexes(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Zt),ne=combineRegexes(/(\d{4})-?W(\d\d)(?:-?(\d))?/,Zt),re=combineRegexes(/(\d{4})-?(\d{3})/,Zt),ie=combineRegexes(qt),oe=combineExtractors(extractISOYmd,extractISOTime,extractISOOffset),ae=combineExtractors(Wt,extractISOTime,extractISOOffset),se=combineExtractors(Yt,extractISOTime),ue=combineExtractors(extractISOTime,extractISOOffset);const le=combineRegexes(/(\d{4})-(\d\d)-(\d\d)/,Kt),ce=combineRegexes(Bt),he=combineExtractors(extractISOYmd,extractISOTime,extractISOOffset,extractIANAZone),de=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);class Invalid{constructor(t,e){this.reason=t,this.explanation=e}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const fe="Invalid Duration",pe={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},me=Object.assign({years:{months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},pe),ye=Object.assign({years:{months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},pe),ge=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],ve=ge.slice(0).reverse();function clone$1(t,e,n=!1){const r={values:n?e.values:Object.assign({},t.values,e.values||{}),loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy};return new Duration(r)}function convert(t,e,n,r,i){const o=t[i][n],a=e[n]/o,s=!(Math.sign(a)===Math.sign(r[i]))&&0!==r[i]&&Math.abs(a)<=1?function antiTrunc(t){return t<0?Math.floor(t):Math.ceil(t)}(a):Math.trunc(a);r[i]+=s,e[n]-=s*o}function normalizeValues(t,e){ve.reduce((n,r)=>isUndefined(e[r])?n:(n&&convert(t,e,n,e,r),r),null)}class Duration{constructor(t){const e="longterm"===t.conversionAccuracy||!1;this.values=t.values,this.loc=t.loc||Locale.create(),this.conversionAccuracy=e?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=e?ye:me,this.isLuxonDuration=!0}static fromMillis(t,e){return Duration.fromObject(Object.assign({milliseconds:t},e))}static fromObject(t){if(null==t||"object"!=typeof t)throw new InvalidArgumentError(`Duration.fromObject: argument expected to be an object, got ${typeof t}`);return new Duration({values:normalizeObject(t,Duration.normalizeUnit,["locale","numberingSystem","conversionAccuracy","zone"]),loc:Locale.fromObject(t),conversionAccuracy:t.conversionAccuracy})}static fromISO(t,e){const[n]=function parseISODuration(t){return parse(t,[Ht,extractISODuration])}(t);if(n){const t=Object.assign(n,e);return Duration.fromObject(t)}return Duration.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,e=null){if(!t)throw new InvalidArgumentError("need to specify a reason the Duration is invalid");const n=t instanceof Invalid?t:new Invalid(t,e);if(Settings.throwOnInvalid)throw new InvalidDurationError(n);return new Duration({invalid:n})}static normalizeUnit(t){const e={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t?t.toLowerCase():t];if(!e)throw new InvalidUnitError(t);return e}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,e={}){const n=Object.assign({},e,{floor:!1!==e.round&&!1!==e.floor});return this.isValid?Formatter.create(this.loc,n).formatDurationFromString(this,t):fe}toObject(t={}){if(!this.isValid)return{};const e=Object.assign({},this.values);return t.includeConfig&&(e.conversionAccuracy=this.conversionAccuracy,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e}toISO(){if(!this.isValid)return null;let t="P";return 0!==this.years&&(t+=this.years+"Y"),0===this.months&&0===this.quarters||(t+=this.months+3*this.quarters+"M"),0!==this.weeks&&(t+=this.weeks+"W"),0!==this.days&&(t+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(t+="T"),0!==this.hours&&(t+=this.hours+"H"),0!==this.minutes&&(t+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(t+=this.seconds+this.milliseconds/1e3+"S"),"P"===t&&(t+="T0S"),t}toJSON(){return this.toISO()}toString(){return this.toISO()}valueOf(){return this.as("milliseconds")}plus(t){if(!this.isValid)return this;const e=friendlyDuration(t),n={};for(const t of ge)(e.values.hasOwnProperty(t)||this.values.hasOwnProperty(t))&&(n[t]=e.get(t)+this.get(t));return clone$1(this,{values:n},!0)}minus(t){if(!this.isValid)return this;const e=friendlyDuration(t);return this.plus(e.negate())}get(t){return this[Duration.normalizeUnit(t)]}set(t){if(!this.isValid)return this;return clone$1(this,{values:Object.assign(this.values,normalizeObject(t,Duration.normalizeUnit,[]))})}reconfigure({locale:t,numberingSystem:e,conversionAccuracy:n}={}){const r={loc:this.loc.clone({locale:t,numberingSystem:e})};return n&&(r.conversionAccuracy=n),clone$1(this,r)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;const t=this.toObject();return normalizeValues(this.matrix,t),Duration.fromObject(t)}shiftTo(...t){if(!this.isValid)return this;if(0===t.length)return this;t=t.map(t=>Duration.normalizeUnit(t));const e={},n={},r=this.toObject();let i;normalizeValues(this.matrix,r);for(const o of ge)if(t.indexOf(o)>=0){i=o;let t=0;for(const e in n)t+=this.matrix[e][o]*n[e],n[e]=0;isNumber(r[o])&&(t+=r[o]);const a=Math.trunc(t);e[o]=a,n[o]=t-a;for(const t in r)ge.indexOf(t)>ge.indexOf(o)&&convert(this.matrix,r,t,e,o)}else isNumber(r[o])&&(n[o]=r[o]);for(const t in n)0!==n[t]&&(e[i]+=t===i?n[t]:n[t]/this.matrix[i][t]);return clone$1(this,{values:e},!0)}negate(){if(!this.isValid)return this;const t={};for(const e of Object.keys(this.values))t[e]=-this.values[e];return clone$1(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid)return!1;if(!this.loc.equals(t.loc))return!1;for(const e of ge)if(this.values[e]!==t.values[e])return!1;return!0}}function friendlyDuration(t){if(isNumber(t))return Duration.fromMillis(t);if(Duration.isDuration(t))return t;if("object"==typeof t)return Duration.fromObject(t);throw new InvalidArgumentError(`Unknown duration argument ${t} of type ${typeof t}`)}const _e="Invalid Interval";function validateStartEnd(t,e){return t&&t.isValid?e&&e.isValid?e<t?new Invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null:new Invalid("missing or invalid end"):new Invalid("missing or invalid start")}class Interval{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,e=null){if(!t)throw new InvalidArgumentError("need to specify a reason the Interval is invalid");const n=t instanceof Invalid?t:new Invalid(t,e);if(Settings.throwOnInvalid)throw new InvalidIntervalError(n);return new Interval({invalid:n})}static fromDateTimes(t,e){const n=friendlyDateTime(t),r=friendlyDateTime(e);return new Interval({start:n,end:r,invalid:validateStartEnd(n,r)})}static after(t,e){const n=friendlyDuration(e),r=friendlyDateTime(t);return Interval.fromDateTimes(r,r.plus(n))}static before(t,e){const n=friendlyDuration(e),r=friendlyDateTime(t);return Interval.fromDateTimes(r.minus(n),r)}static fromISO(t,e){const[n,r]=(t||"").split("/",2);if(n&&r){const t=DateTime.fromISO(n,e),i=DateTime.fromISO(r,e);if(t.isValid&&i.isValid)return Interval.fromDateTimes(t,i);if(t.isValid){const n=Duration.fromISO(r,e);if(n.isValid)return Interval.after(t,n)}else if(i.isValid){const t=Duration.fromISO(n,e);if(t.isValid)return Interval.before(i,t)}}return Interval.invalid("unparsable",`the input "${t}" can't be parsed asISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds"){if(!this.isValid)return NaN;const e=this.start.startOf(t),n=this.end.startOf(t);return Math.floor(n.diff(e,t).get(t))+1}hasSame(t){return!!this.isValid&&this.e.minus(1).hasSame(this.s,t)}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return!!this.isValid&&this.s>t}isBefore(t){return!!this.isValid&&this.e<=t}contains(t){return!!this.isValid&&(this.s<=t&&this.e>t)}set({start:t,end:e}={}){return this.isValid?Interval.fromDateTimes(t||this.s,e||this.e):this}splitAt(...t){if(!this.isValid)return[];const e=t.map(friendlyDateTime).sort(),n=[];let{s:r}=this,i=0;for(;r<this.e;){const t=e[i]||this.e,o=+t>+this.e?this.e:t;n.push(Interval.fromDateTimes(r,o)),r=o,i+=1}return n}splitBy(t){const e=friendlyDuration(t);if(!this.isValid||!e.isValid||0===e.as("milliseconds"))return[];let n,r,{s:i}=this;const o=[];for(;i<this.e;)r=+(n=i.plus(e))>+this.e?this.e:n,o.push(Interval.fromDateTimes(i,r)),i=r;return o}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return!!this.isValid&&+this.e==+t.s}abutsEnd(t){return!!this.isValid&&+t.e==+this.s}engulfs(t){return!!this.isValid&&(this.s<=t.s&&this.e>=t.e)}equals(t){return!(!this.isValid||!t.isValid)&&(this.s.equals(t.s)&&this.e.equals(t.e))}intersection(t){if(!this.isValid)return this;const e=this.s>t.s?this.s:t.s,n=this.e<t.e?this.e:t.e;return e>n?null:Interval.fromDateTimes(e,n)}union(t){if(!this.isValid)return this;const e=this.s<t.s?this.s:t.s,n=this.e>t.e?this.e:t.e;return Interval.fromDateTimes(e,n)}static merge(t){const[e,n]=t.sort((t,e)=>t.s-e.s).reduce(([t,e],n)=>e?e.overlaps(n)||e.abutsStart(n)?[t,e.union(n)]:[t.concat([e]),n]:[t,n],[[],null]);return n&&e.push(n),e}static xor(t){let e=null,n=0;const r=[],i=t.map(t=>[{time:t.s,type:"s"},{time:t.e,type:"e"}]),o=Array.prototype.concat(...i).sort((t,e)=>t.time-e.time);for(const t of o)1===(n+="s"===t.type?1:-1)?e=t.time:(e&&+e!=+t.time&&r.push(Interval.fromDateTimes(e,t.time)),e=null);return Interval.merge(r)}difference(...t){return Interval.xor([this].concat(t)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:_e}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:_e}toFormat(t,{separator:e="  "}={}){return this.isValid?`${this.s.toFormat(t)}${e}${this.e.toFormat(t)}`:_e}toDuration(t,e){return this.isValid?this.e.diff(this.s,t,e):Duration.invalid(this.invalidReason)}mapEndpoints(t){return Interval.fromDateTimes(t(this.s),t(this.e))}}class Info{static hasDST(t=Settings.defaultZone){const e=DateTime.local().setZone(t).set({month:12});return!t.universal&&e.offset!==e.set({month:6}).offset}static isValidIANAZone(t){return IANAZone.isValidSpecifier(t)&&IANAZone.isValidZone(t)}static normalizeZone(t){return normalizeZone(t,Settings.defaultZone)}static months(t="long",{locale:e=null,numberingSystem:n=null,outputCalendar:r="gregory"}={}){return Locale.create(e,n,r).months(t)}static monthsFormat(t="long",{locale:e=null,numberingSystem:n=null,outputCalendar:r="gregory"}={}){return Locale.create(e,n,r).months(t,!0)}static weekdays(t="long",{locale:e=null,numberingSystem:n=null}={}){return Locale.create(e,n,null).weekdays(t)}static weekdaysFormat(t="long",{locale:e=null,numberingSystem:n=null}={}){return Locale.create(e,n,null).weekdays(t,!0)}static meridiems({locale:t=null}={}){return Locale.create(t).meridiems()}static eras(t="short",{locale:e=null}={}){return Locale.create(e,null,"gregory").eras(t)}static features(){let t=!1,e=!1,n=!1,r=hasRelative();if(hasIntl()){t=!0,e=hasFormatToParts();try{n="America/New_York"===new Intl.DateTimeFormat("en",{timeZone:"America/New_York"}).resolvedOptions().timeZone}catch(t){n=!1}}return{intl:t,intlTokens:e,zones:n,relative:r}}}function dayDiff(t,e){const n=t=>t.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=n(e)-n(t);return Math.floor(Duration.fromMillis(r).as("days"))}function diff(t,e,n,r){let[i,o,a,s]=function highOrderDiffs(t,e,n){const r=[["years",(t,e)=>e.year-t.year],["months",(t,e)=>e.month-t.month+12*(e.year-t.year)],["weeks",(t,e)=>{const n=dayDiff(t,e);return(n-n%7)/7}],["days",dayDiff]],i={};let o,a;for(const[s,u]of r)if(n.indexOf(s)>=0){o=s;let n=u(t,e);(a=t.plus({[s]:n}))>e?(t=t.plus({[s]:n-1}),n-=1):t=a,i[s]=n}return[t,i,a,o]}(t,e,n);const u=e-i,l=n.filter(t=>["hours","minutes","seconds","milliseconds"].indexOf(t)>=0);0===l.length&&(a<e&&(a=i.plus({[s]:1})),a!==i&&(o[s]=(o[s]||0)+u/(a-i)));const c=Duration.fromObject(Object.assign(o,r));return l.length>0?Duration.fromMillis(u,r).shiftTo(...l).plus(c):c}const be={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},Te={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},we=be.hanidec.replace(/[\[|\]]/g,"").split("");function digitRegex({numberingSystem:t},e=""){return new RegExp(`${be[t||"latn"]}${e}`)}const Ee="missing Intl.DateTimeFormat.formatToParts support";function intUnit(t,e=(t=>t)){return{regex:t,deser:([t])=>e(function parseDigits(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);if(-1!==t[n].search(be.hanidec))e+=we.indexOf(t[n]);else for(let t in Te){const[n,i]=Te[t];r>=n&&r<=i&&(e+=r-n)}}return parseInt(e,10)}return e}(t))}}function fixListRegex(t){return t.replace(/\./,"\\.?")}function stripInsensitivities(t){return t.replace(/\./,"").toLowerCase()}function oneOf(t,e){return null===t?null:{regex:RegExp(t.map(fixListRegex).join("|")),deser:([n])=>t.findIndex(t=>stripInsensitivities(n)===stripInsensitivities(t))+e}}function offset(t,e){return{regex:t,deser:([,t,e])=>signedOffset(t,e),groups:e}}function simple(t){return{regex:t,deser:([t])=>t}}function escapeToken(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function explainFromTokens(t,e,n){const r=Formatter.parseFormat(n),i=r.map(e=>(function unitForToken(t,e){const n=digitRegex(e),r=digitRegex(e,"{2}"),i=digitRegex(e,"{3}"),o=digitRegex(e,"{4}"),a=digitRegex(e,"{6}"),s=digitRegex(e,"{1,2}"),u=digitRegex(e,"{1,3}"),l=digitRegex(e,"{1,6}"),c=digitRegex(e,"{1,9}"),h=digitRegex(e,"{2,4}"),d=digitRegex(e,"{4,6}"),f=t=>({regex:RegExp(escapeToken(t.val)),deser:([t])=>t,literal:!0}),p=(p=>{if(t.literal)return f(p);switch(p.val){case"G":return oneOf(e.eras("short",!1),0);case"GG":return oneOf(e.eras("long",!1),0);case"y":return intUnit(l);case"yy":return intUnit(h,untruncateYear);case"yyyy":return intUnit(o);case"yyyyy":return intUnit(d);case"yyyyyy":return intUnit(a);case"M":return intUnit(s);case"MM":return intUnit(r);case"MMM":return oneOf(e.months("short",!0,!1),1);case"MMMM":return oneOf(e.months("long",!0,!1),1);case"L":return intUnit(s);case"LL":return intUnit(r);case"LLL":return oneOf(e.months("short",!1,!1),1);case"LLLL":return oneOf(e.months("long",!1,!1),1);case"d":return intUnit(s);case"dd":return intUnit(r);case"o":return intUnit(u);case"ooo":return intUnit(i);case"HH":return intUnit(r);case"H":return intUnit(s);case"hh":return intUnit(r);case"h":return intUnit(s);case"mm":return intUnit(r);case"m":case"s":return intUnit(s);case"ss":return intUnit(r);case"S":return intUnit(u);case"SSS":return intUnit(i);case"u":return simple(c);case"a":return oneOf(e.meridiems(),0);case"kkkk":return intUnit(o);case"kk":return intUnit(h,untruncateYear);case"W":return intUnit(s);case"WW":return intUnit(r);case"E":case"c":return intUnit(n);case"EEE":return oneOf(e.weekdays("short",!1,!1),1);case"EEEE":return oneOf(e.weekdays("long",!1,!1),1);case"ccc":return oneOf(e.weekdays("short",!0,!1),1);case"cccc":return oneOf(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return offset(new RegExp(`([+-]${s.source})(?::(${r.source}))?`),2);case"ZZZ":return offset(new RegExp(`([+-]${s.source})(${r.source})?`),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);default:return f(p)}})(t)||{invalidReason:Ee};return p.token=t,p})(e,t)),o=i.find(t=>t.invalidReason);if(o)return{input:e,tokens:r,invalidReason:o.invalidReason};{const[t,n]=function buildRegex(t){return[`^${t.map(t=>t.regex).reduce((t,e)=>`${t}(${e.source})`,"")}$`,t]}(i),o=RegExp(t,"i"),[a,s]=function match(t,e,n){const r=t.match(e);if(r){const t={};let e=1;for(const i in n)if(n.hasOwnProperty(i)){const o=n[i],a=o.groups?o.groups+1:1;!o.literal&&o.token&&(t[o.token.val[0]]=o.deser(r.slice(e,e+a))),e+=a}return[r,t]}return[r,{}]}(e,o,n),[u,l]=s?function dateTimeFromMatches(t){let e;return e=isUndefined(t.Z)?isUndefined(t.z)?null:IANAZone.create(t.z):new FixedOffsetZone(t.Z),isUndefined(t.h)||(t.h<12&&1===t.a?t.h+=12:12===t.h&&0===t.a&&(t.h=0)),0===t.G&&t.y&&(t.y=-t.y),isUndefined(t.u)||(t.S=parseMillis(t.u)),[Object.keys(t).reduce((e,n)=>{const r=(t=>{switch(t){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";default:return null}})(n);return r&&(e[r]=t[n]),e},{}),e]}(s):[null,null];return{input:e,tokens:r,regex:o,rawMatches:a,matches:s,result:u,zone:l}}}const Se=[0,31,59,90,120,151,181,212,243,273,304,334],Me=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(t,e){return new Invalid("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function dayOfWeek(t,e,n){const r=new Date(Date.UTC(t,e-1,n)).getUTCDay();return 0===r?7:r}function computeOrdinal(t,e,n){return n+(isLeapYear(t)?Me:Se)[e-1]}function uncomputeOrdinal(t,e){const n=isLeapYear(t)?Me:Se,r=n.findIndex(t=>t<e);return{month:r+1,day:e-n[r]}}function gregorianToWeek(t){const{year:e,month:n,day:r}=t,i=computeOrdinal(e,n,r),o=dayOfWeek(e,n,r);let a,s=Math.floor((i-o+10)/7);return s<1?s=weeksInWeekYear(a=e-1):s>weeksInWeekYear(e)?(a=e+1,s=1):a=e,Object.assign({weekYear:a,weekNumber:s,weekday:o},timeObject(t))}function weekToGregorian(t){const{weekYear:e,weekNumber:n,weekday:r}=t,i=dayOfWeek(e,1,4),o=daysInYear(e);let a,s=7*n+r-i-3;s<1?s+=daysInYear(a=e-1):s>o?(a=e+1,s-=daysInYear(e)):a=e;const{month:u,day:l}=uncomputeOrdinal(a,s);return Object.assign({year:a,month:u,day:l},timeObject(t))}function gregorianToOrdinal(t){const{year:e,month:n,day:r}=t,i=computeOrdinal(e,n,r);return Object.assign({year:e,ordinal:i},timeObject(t))}function ordinalToGregorian(t){const{year:e,ordinal:n}=t,{month:r,day:i}=uncomputeOrdinal(e,n);return Object.assign({year:e,month:r,day:i},timeObject(t))}function hasInvalidGregorianData(t){const e=isNumber(t.year),n=numberBetween(t.month,1,12),r=numberBetween(t.day,1,daysInMonth(t.year,t.month));return e?n?!r&&unitOutOfRange("day",t.day):unitOutOfRange("month",t.month):unitOutOfRange("year",t.year)}function hasInvalidTimeData(t){const{hour:e,minute:n,second:r,millisecond:i}=t,o=numberBetween(e,0,23)||24===e&&0===n&&0===r&&0===i,a=numberBetween(n,0,59),s=numberBetween(r,0,59),u=numberBetween(i,0,999);return o?a?s?!u&&unitOutOfRange("millisecond",i):unitOutOfRange("second",r):unitOutOfRange("minute",n):unitOutOfRange("hour",e)}const Oe="Invalid DateTime";function unsupportedZone(t){return new Invalid("unsupported zone",`the zone "${t.name}" is not supported`)}function possiblyCachedWeekData(t){return null===t.weekData&&(t.weekData=gregorianToWeek(t.c)),t.weekData}function clone$2(t,e){const n={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new DateTime(Object.assign({},n,e,{old:n}))}function fixOffset(t,e,n){let r=t-60*e*1e3;const i=n.offset(r);if(e===i)return[r,e];r-=60*(i-e)*1e3;const o=n.offset(r);return i===o?[r,i]:[t-60*Math.min(i,o)*1e3,Math.max(i,o)]}function tsToObj(t,e){const n=new Date(t+=60*e*1e3);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function objToTS(t,e,n){return fixOffset(objToLocalTS(t),e,n)}function adjustTime(t,e){const n=t.o,r=t.c.year+e.years,i=t.c.month+e.months+3*e.quarters,o=Object.assign({},t.c,{year:r,month:i,day:Math.min(t.c.day,daysInMonth(r,i))+e.days+7*e.weeks}),a=Duration.fromObject({hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),s=objToLocalTS(o);let[u,l]=fixOffset(s,n,t.zone);return 0!==a&&(u+=a,l=t.zone.offset(u)),{ts:u,o:l}}function parseDataToDateTime(t,e,n,r,i){const{setZone:o,zone:a}=n;if(t&&0!==Object.keys(t).length){const r=e||a,i=DateTime.fromObject(Object.assign(t,n,{zone:r,setZone:void 0}));return o?i:i.setZone(a)}return DateTime.invalid(new Invalid("unparsable",`the input "${i}" can't be parsed as ${r}`))}function toTechFormat(t,e){return t.isValid?Formatter.create(Locale.create("en-US"),{allowZ:!0,forceSimple:!0}).formatDateTimeFromString(t,e):null}function toTechTimeFormat(t,{suppressSeconds:e=!1,suppressMilliseconds:n=!1,includeOffset:r,includeZone:i=!1,spaceZone:o=!1}){let a="HH:mm";return e&&0===t.second&&0===t.millisecond||(a+=":ss",n&&0===t.millisecond||(a+=".SSS")),(i||r)&&o&&(a+=" "),i?a+="z":r&&(a+="ZZ"),toTechFormat(t,a)}const xe={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Ce={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Pe={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Ie=["year","month","day","hour","minute","second","millisecond"],Re=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Le=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnit(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new InvalidUnitError(t);return e}function quickDT(t,e){for(const e of Ie)isUndefined(t[e])&&(t[e]=xe[e]);const n=hasInvalidGregorianData(t)||hasInvalidTimeData(t);if(n)return DateTime.invalid(n);const r=Settings.now(),i=e.offset(r),[o,a]=objToTS(t,i,e);return new DateTime({ts:o,zone:e,o:a})}function diffRelative(t,e,n){const r=!!isUndefined(n.round)||n.round,i=(t,i)=>{return t=roundTo(t,r||n.calendary?0:2,!0),e.loc.clone(n).relFormatter(n).format(t,i)},o=r=>n.calendary?e.hasSame(t,r)?0:e.startOf(r).diff(t.startOf(r),r).get(r):e.diff(t,r).get(r);if(n.unit)return i(o(n.unit),n.unit);for(const t of n.units){const e=o(t);if(Math.abs(e)>=1)return i(e,t)}return i(0,n.units[n.units.length-1])}class DateTime{constructor(t){const e=t.zone||Settings.defaultZone,n=t.invalid||(Number.isNaN(t.ts)?new Invalid("invalid input"):null)||(e.isValid?null:unsupportedZone(e));this.ts=isUndefined(t.ts)?Settings.now():t.ts;let r=null,i=null;if(!n){const n=t.old&&t.old.ts===this.ts&&t.old.zone.equals(e);r=n?t.old.c:tsToObj(this.ts,e.offset(this.ts)),i=n?t.old.o:e.offset(this.ts)}this._zone=e,this.loc=t.loc||Locale.create(),this.invalid=n,this.weekData=null,this.c=r,this.o=i,this.isLuxonDateTime=!0}static local(t,e,n,r,i,o,a){return isUndefined(t)?new DateTime({ts:Settings.now()}):quickDT({year:t,month:e,day:n,hour:r,minute:i,second:o,millisecond:a},Settings.defaultZone)}static utc(t,e,n,r,i,o,a){return isUndefined(t)?new DateTime({ts:Settings.now(),zone:FixedOffsetZone.utcInstance}):quickDT({year:t,month:e,day:n,hour:r,minute:i,second:o,millisecond:a},FixedOffsetZone.utcInstance)}static fromJSDate(t,e={}){const n=function isDate(t){return"[object Date]"===Object.prototype.toString.call(t)}(t)?t.valueOf():NaN;if(Number.isNaN(n))return DateTime.invalid("invalid input");const r=normalizeZone(e.zone,Settings.defaultZone);return r.isValid?new DateTime({ts:n,zone:r,loc:Locale.fromObject(e)}):DateTime.invalid(unsupportedZone(r))}static fromMillis(t,e={}){if(isNumber(t))return new DateTime({ts:t,zone:normalizeZone(e.zone,Settings.defaultZone),loc:Locale.fromObject(e)});throw new InvalidArgumentError("fromMillis requires a numerical input")}static fromSeconds(t,e={}){if(isNumber(t))return new DateTime({ts:1e3*t,zone:normalizeZone(e.zone,Settings.defaultZone),loc:Locale.fromObject(e)});throw new InvalidArgumentError("fromSeconds requires a numerical input")}static fromObject(t){const e=normalizeZone(t.zone,Settings.defaultZone);if(!e.isValid)return DateTime.invalid(unsupportedZone(e));const n=Settings.now(),r=e.offset(n),i=normalizeObject(t,normalizeUnit,["zone","locale","outputCalendar","numberingSystem"]),o=!isUndefined(i.ordinal),a=!isUndefined(i.year),s=!isUndefined(i.month)||!isUndefined(i.day),u=a||s,l=i.weekYear||i.weekNumber,c=Locale.fromObject(t);if((u||o)&&l)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(s&&o)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");const h=l||i.weekday&&!u;let d,f,p=tsToObj(n,r);h?(d=Re,f=Ce,p=gregorianToWeek(p)):o?(d=Le,f=Pe,p=gregorianToOrdinal(p)):(d=Ie,f=xe);let m=!1;for(const t of d){isUndefined(i[t])?i[t]=m?f[t]:p[t]:m=!0}const y=(h?function hasInvalidWeekData(t){const e=isNumber(t.weekYear),n=numberBetween(t.weekNumber,1,weeksInWeekYear(t.weekYear)),r=numberBetween(t.weekday,1,7);return e?n?!r&&unitOutOfRange("weekday",t.weekday):unitOutOfRange("week",t.week):unitOutOfRange("weekYear",t.weekYear)}(i):o?function hasInvalidOrdinalData(t){const e=isNumber(t.year),n=numberBetween(t.ordinal,1,daysInYear(t.year));return e?!n&&unitOutOfRange("ordinal",t.ordinal):unitOutOfRange("year",t.year)}(i):hasInvalidGregorianData(i))||hasInvalidTimeData(i);if(y)return DateTime.invalid(y);const g=h?weekToGregorian(i):o?ordinalToGregorian(i):i,[v,_]=objToTS(g,r,e),b=new DateTime({ts:v,zone:e,o:_,loc:c});return i.weekday&&u&&t.weekday!==b.weekday?DateTime.invalid("mismatched weekday",`you can't specify both a weekday of ${i.weekday} and a date of ${b.toISO()}`):b}static fromISO(t,e={}){const[n,r]=function parseISODate(t){return parse(t,[ee,oe],[ne,ae],[re,se],[ie,ue])}(t);return parseDataToDateTime(n,r,e,"ISO 8601",t)}static fromRFC2822(t,e={}){const[n,r]=function parseRFC2822Date(t){return parse(function preprocessRFC2822(t){return t.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(t),[$t,extractRFC2822])}(t);return parseDataToDateTime(n,r,e,"RFC 2822",t)}static fromHTTP(t,e={}){const[n,r]=function parseHTTPDate(t){return parse(t,[Qt,extractRFC1123Or850],[Jt,extractRFC1123Or850],[te,extractASCII])}(t);return parseDataToDateTime(n,r,e,"HTTP",e)}static fromFormat(t,e,n={}){if(isUndefined(t)||isUndefined(e))throw new InvalidArgumentError("fromFormat requires an input string and a format");const{locale:r=null,numberingSystem:i=null}=n,o=Locale.fromOpts({locale:r,numberingSystem:i,defaultToEN:!0}),[a,s,u]=function parseFromTokens(t,e,n){const{result:r,zone:i,invalidReason:o}=explainFromTokens(t,e,n);return[r,i,o]}(o,t,e);return u?DateTime.invalid(u):parseDataToDateTime(a,s,n,`format ${e}`,t)}static fromString(t,e,n={}){return DateTime.fromFormat(t,e,n)}static fromSQL(t,e={}){const[n,r]=function parseSQL(t){return parse(t,[le,he],[ce,de])}(t);return parseDataToDateTime(n,r,e,"SQL",t)}static invalid(t,e=null){if(!t)throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");const n=t instanceof Invalid?t:new Invalid(t,e);if(Settings.throwOnInvalid)throw new InvalidDateTimeError(n);return new DateTime({invalid:n})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}get(t){return this[t]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN}get weekNumber(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN}get weekday(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN}get ordinal(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN}get monthShort(){return this.isValid?Info.months("short",{locale:this.locale})[this.month-1]:null}get monthLong(){return this.isValid?Info.months("long",{locale:this.locale})[this.month-1]:null}get weekdayShort(){return this.isValid?Info.weekdays("short",{locale:this.locale})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Info.weekdays("long",{locale:this.locale})[this.weekday-1]:null}get offset(){return this.isValid?this.zone.offset(this.ts):NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.universal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1}).offset||this.offset>this.set({month:5}).offset)}get isInLeapYear(){return isLeapYear(this.year)}get daysInMonth(){return daysInMonth(this.year,this.month)}get daysInYear(){return this.isValid?daysInYear(this.year):NaN}get weeksInWeekYear(){return this.isValid?weeksInWeekYear(this.weekYear):NaN}resolvedLocaleOpts(t={}){const{locale:e,numberingSystem:n,calendar:r}=Formatter.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:e,numberingSystem:n,outputCalendar:r}}toUTC(t=0,e={}){return this.setZone(FixedOffsetZone.instance(t),e)}toLocal(){return this.setZone(Settings.defaultZone)}setZone(t,{keepLocalTime:e=!1,keepCalendarTime:n=!1}={}){if((t=normalizeZone(t,Settings.defaultZone)).equals(this.zone))return this;if(t.isValid){let r=this.ts;if(e||n){const e=this.o-t.offset(this.ts),n=this.toObject();[r]=objToTS(n,e,t)}return clone$2(this,{ts:r,zone:t})}return DateTime.invalid(unsupportedZone(t))}reconfigure({locale:t,numberingSystem:e,outputCalendar:n}={}){return clone$2(this,{loc:this.loc.clone({locale:t,numberingSystem:e,outputCalendar:n})})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;const e=normalizeObject(t,normalizeUnit,[]);let n;!isUndefined(e.weekYear)||!isUndefined(e.weekNumber)||!isUndefined(e.weekday)?n=weekToGregorian(Object.assign(gregorianToWeek(this.c),e)):isUndefined(e.ordinal)?(n=Object.assign(this.toObject(),e),isUndefined(e.day)&&(n.day=Math.min(daysInMonth(n.year,n.month),n.day))):n=ordinalToGregorian(Object.assign(gregorianToOrdinal(this.c),e));const[r,i]=objToTS(n,this.o,this.zone);return clone$2(this,{ts:r,o:i})}plus(t){if(!this.isValid)return this;return clone$2(this,adjustTime(this,friendlyDuration(t)))}minus(t){if(!this.isValid)return this;return clone$2(this,adjustTime(this,friendlyDuration(t).negate()))}startOf(t){if(!this.isValid)return this;const e={},n=Duration.normalizeUnit(t);switch(n){case"years":e.month=1;case"quarters":case"months":e.day=1;case"weeks":case"days":e.hour=0;case"hours":e.minute=0;case"minutes":e.second=0;case"seconds":e.millisecond=0}if("weeks"===n&&(e.weekday=1),"quarters"===n){const t=Math.ceil(this.month/3);e.month=3*(t-1)+1}return this.set(e)}endOf(t){return this.isValid?this.plus({[t]:1}).startOf(t).minus(1):this}toFormat(t,e={}){return this.isValid?Formatter.create(this.loc.redefaultToEN(e)).formatDateTimeFromString(this,t):Oe}toLocaleString(t=K){return this.isValid?Formatter.create(this.loc.clone(t),t).formatDateTime(this):Oe}toLocaleParts(t={}){return this.isValid?Formatter.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO(t={}){return this.isValid?`${this.toISODate()}T${this.toISOTime(t)}`:null}toISODate(){let t="yyyy-MM-dd";return this.year>9999&&(t="+"+t),toTechFormat(this,t)}toISOWeekDate(){return toTechFormat(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:e=!1,includeOffset:n=!0}={}){return toTechTimeFormat(this,{suppressSeconds:e,suppressMilliseconds:t,includeOffset:n})}toRFC2822(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ")}toHTTP(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return toTechFormat(this,"yyyy-MM-dd")}toSQLTime({includeOffset:t=!0,includeZone:e=!1}={}){return toTechTimeFormat(this,{includeOffset:t,includeZone:e,spaceZone:!0})}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():Oe}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};const e=Object.assign({},this.c);return t.includeConfig&&(e.outputCalendar=this.outputCalendar,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,e="milliseconds",n={}){if(!this.isValid||!t.isValid)return Duration.invalid(this.invalid||t.invalid,"created by diffing an invalid DateTime");const r=Object.assign({locale:this.locale,numberingSystem:this.numberingSystem},n),i=function maybeArray(t){return Array.isArray(t)?t:[t]}(e).map(Duration.normalizeUnit),o=t.valueOf()>this.valueOf(),a=diff(o?this:t,o?t:this,i,r);return o?a.negate():a}diffNow(t="milliseconds",e={}){return this.diff(DateTime.local(),t,e)}until(t){return this.isValid?Interval.fromDateTimes(this,t):this}hasSame(t,e){if(!this.isValid)return!1;if("millisecond"===e)return this.valueOf()===t.valueOf();{const n=t.valueOf();return this.startOf(e)<=n&&n<=this.endOf(e)}}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;const e=t.base||DateTime.fromObject({zone:this.zone}),n=t.padding?this<e?-t.padding:t.padding:0;return diffRelative(e,this.plus(n),Object.assign(t,{numeric:"always",units:["years","months","days","hours","minutes","seconds"]}))}toRelativeCalendar(t={}){return this.isValid?diffRelative(t.base||DateTime.fromObject({zone:this.zone}),this,Object.assign(t,{numeric:"auto",units:["years","months","days"],calendary:!0})):null}static min(...t){return bestBy(t,t=>t.valueOf(),Math.min)}static max(...t){return bestBy(t,t=>t.valueOf(),Math.max)}static fromFormatExplain(t,e,n={}){const{locale:r=null,numberingSystem:i=null}=n;return explainFromTokens(Locale.fromOpts({locale:r,numberingSystem:i,defaultToEN:!0}),t,e)}static fromStringExplain(t,e,n={}){return DateTime.fromFormatExplain(t,e,n)}static get DATE_SHORT(){return K}static get DATE_MED(){return H}static get DATE_FULL(){return X}static get DATE_HUGE(){return $}static get TIME_SIMPLE(){return Q}static get TIME_WITH_SECONDS(){return J}static get TIME_WITH_SHORT_OFFSET(){return tt}static get TIME_WITH_LONG_OFFSET(){return et}static get TIME_24_SIMPLE(){return nt}static get TIME_24_WITH_SECONDS(){return rt}static get TIME_24_WITH_SHORT_OFFSET(){return it}static get TIME_24_WITH_LONG_OFFSET(){return ot}static get DATETIME_SHORT(){return at}static get DATETIME_SHORT_WITH_SECONDS(){return st}static get DATETIME_MED(){return ut}static get DATETIME_MED_WITH_SECONDS(){return lt}static get DATETIME_FULL(){return ct}static get DATETIME_FULL_WITH_SECONDS(){return ht}static get DATETIME_HUGE(){return dt}static get DATETIME_HUGE_WITH_SECONDS(){return ft}}function friendlyDateTime(t){if(DateTime.isDateTime(t))return t;if(t&&t.valueOf&&isNumber(t.valueOf()))return DateTime.fromJSDate(t);if(t&&"object"==typeof t)return DateTime.fromObject(t);throw new InvalidArgumentError(`Unknown datetime argument: ${t}, of type ${typeof t}`)}var ke=Object.freeze({__proto__:null,DateTime:DateTime,Duration:Duration,Interval:Interval,Info:Info,Zone:Zone,FixedOffsetZone:FixedOffsetZone,IANAZone:IANAZone,InvalidZone:InvalidZone,LocalZone:LocalZone,Settings:Settings}),Ae=function unwrapExports(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(createCommonjsModule((function(t,e){!function webpackUniversalModuleDefinition(e,n){t.exports=n(ke)}("undefined"!=typeof self&&self,(function(t){return function(t){var e={};function __webpack_require__(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.d=function(t,e,n){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.t=function(t,e){if(1&e&&(t=__webpack_require__(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)__webpack_require__.d(n,r,function(e){return t[e]}.bind(null,r));return n},__webpack_require__.n=function(t){var e=t&&t.__esModule?function getDefault(){return t.default}:function getModuleExports(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1)}([function(t,e,n){n.d(e,"f",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"j",(function(){return a})),n.d(e,"k",(function(){return s})),n.d(e,"m",(function(){return u})),n.d(e,"h",(function(){return padStart})),n.d(e,"l",(function(){return l})),n.d(e,"i",(function(){return c})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return d})),n.d(e,"g",(function(){return f})),n.d(e,"c",(function(){return p}));var r=function(t){return null!=t},i=function(t){return"number"==typeof t},o=Array.isArray,a=function(t,e){void 0===e&&(e=t),1===arguments.length&&(e=t,t=0);for(var n=[],r=t;r<e;r++)n.push(r);return n},s=function(t,e){var n=0,r=[];if(o(t))for(;n<e;n++)r[n]=[].concat(t);else for(;n<e;n++)r[n]=t;return r},u=function(t){return o(t)?t:[t]};function padStart(t,e,n){void 0===n&&(n=" ");var r=String(t);return e>>=0,r.length>e?String(r):((e-=r.length)>n.length&&(n+=s(n,e/n.length)),n.slice(0,e)+String(r))}var l=function(t,e,n){var r=t.split(e);return n?r.slice(0,n).concat([r.slice(n).join(e)]):r},c=function(t,e){var n=t%e;return n*e<0?n+e:n},h=function(t,e){return{div:Math.floor(t/e),mod:c(t,e)}},d=function(t){return!r(t)||0===t.length},f=function(t){return!d(t)},p=function(t,e){return f(t)&&-1!==t.indexOf(e)}},function(t,e,n){n.r(e);var r,i,o=n(0);(i=r||(r={})).MONTH_DAYS=[31,28,31,30,31,30,31,31,30,31,30,31],i.ONE_DAY=864e5,i.MAXYEAR=9999,i.ORDINAL_BASE=new Date(Date.UTC(1970,0,1)),i.PY_WEEKDAYS=[6,0,1,2,3,4,5],i.getYearDay=function(t){var e=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate());return Math.ceil((e.valueOf()-new Date(t.getUTCFullYear(),0,1).valueOf())/i.ONE_DAY)+1},i.isLeapYear=function(t){return t%4==0&&t%100!=0||t%400==0},i.isDate=function(t){return t instanceof Date},i.isValidDate=function(t){return i.isDate(t)&&!isNaN(t.getTime())},i.tzOffset=function(t){return 60*t.getTimezoneOffset()*1e3},i.daysBetween=function(t,e){var n=t.getTime()-i.tzOffset(t)-(e.getTime()-i.tzOffset(e));return Math.round(n/i.ONE_DAY)},i.toOrdinal=function(t){return i.daysBetween(t,i.ORDINAL_BASE)},i.fromOrdinal=function(t){return new Date(i.ORDINAL_BASE.getTime()+t*i.ONE_DAY)},i.getMonthDays=function(t){var e=t.getUTCMonth();return 1===e&&i.isLeapYear(t.getUTCFullYear())?29:i.MONTH_DAYS[e]},i.getWeekday=function(t){return i.PY_WEEKDAYS[t.getUTCDay()]},i.monthRange=function(t,e){var n=new Date(Date.UTC(t,e,1));return[i.getWeekday(n),i.getMonthDays(n)]},i.combine=function(t,e){return e=e||t,new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))},i.clone=function(t){return new Date(t.getTime())},i.cloneDates=function(t){for(var e=[],n=0;n<t.length;n++)e.push(i.clone(t[n]));return e},i.sort=function(t){t.sort((function(t,e){return t.getTime()-e.getTime()}))},i.timeToUntilString=function(t,e){void 0===e&&(e=!0);var n=new Date(t);return[Object(o.h)(n.getUTCFullYear().toString(),4,"0"),Object(o.h)(n.getUTCMonth()+1,2,"0"),Object(o.h)(n.getUTCDate(),2,"0"),"T",Object(o.h)(n.getUTCHours(),2,"0"),Object(o.h)(n.getUTCMinutes(),2,"0"),Object(o.h)(n.getUTCSeconds(),2,"0"),e?"Z":""].join("")},i.untilStringToDate=function(t){var e=/^(\d{4})(\d{2})(\d{2})(T(\d{2})(\d{2})(\d{2})Z?)?$/.exec(t);if(!e)throw new Error("Invalid UNTIL value: "+t);return new Date(Date.UTC(parseInt(e[1],10),parseInt(e[2],10)-1,parseInt(e[3],10),parseInt(e[5],10)||0,parseInt(e[6],10)||0,parseInt(e[7],10)||0))};var a=r,s=function(){function IterResult(t,e){this.minDate=null,this.maxDate=null,this._result=[],this.total=0,this.method=t,this.args=e,"between"===t?(this.maxDate=e.inc?e.before:new Date(e.before.getTime()-1),this.minDate=e.inc?e.after:new Date(e.after.getTime()+1)):"before"===t?this.maxDate=e.inc?e.dt:new Date(e.dt.getTime()-1):"after"===t&&(this.minDate=e.inc?e.dt:new Date(e.dt.getTime()+1))}return IterResult.prototype.accept=function(t){++this.total;var e=this.minDate&&t<this.minDate,n=this.maxDate&&t>this.maxDate;if("between"===this.method){if(e)return!0;if(n)return!1}else if("before"===this.method){if(n)return!1}else if("after"===this.method)return!!e||(this.add(t),!1);return this.add(t)},IterResult.prototype.add=function(t){return this._result.push(t),!0},IterResult.prototype.getValue=function(){var t=this._result;switch(this.method){case"all":case"between":return t;case"before":case"after":default:return t.length?t[t.length-1]:null}},IterResult.prototype.clone=function(){return new IterResult(this.method,this.args)},IterResult}(),u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function __extends(t,e){function __(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}var l,c=function(){return(c=Object.assign||function __assign(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},h=function(t){function CallbackIterResult(e,n,r){var i=t.call(this,e,n)||this;return i.iterator=r,i}return __extends(CallbackIterResult,t),CallbackIterResult.prototype.add=function(t){return!!this.iterator(t,this._result.length)&&(this._result.push(t),!0)},CallbackIterResult}(s);function freqIsDailyOrGreater(t){return t<l.HOURLY}!function(t){t[t.YEARLY=0]="YEARLY",t[t.MONTHLY=1]="MONTHLY",t[t.WEEKLY=2]="WEEKLY",t[t.DAILY=3]="DAILY",t[t.HOURLY=4]="HOURLY",t[t.MINUTELY=5]="MINUTELY",t[t.SECONDLY=6]="SECONDLY"}(l||(l={}));var d=["MO","TU","WE","TH","FR","SA","SU"],f=function(){function Weekday(t,e){if(0===e)throw new Error("Can't create weekday with n == 0");this.weekday=t,this.n=e}return Weekday.prototype.nth=function(t){return this.n===t?this:new Weekday(this.weekday,t)},Weekday.prototype.equals=function(t){return this.weekday===t.weekday&&this.n===t.n},Weekday.prototype.toString=function(){var t=d[this.weekday];return this.n&&(t=(this.n>0?"+":"")+String(this.n)+t),t},Weekday.prototype.getJsWeekday=function(){return 6===this.weekday?0:this.weekday+1},Weekday}(),p=function(){function Time(t,e,n,r){this.hour=t,this.minute=e,this.second=n,this.millisecond=r||0}return Time.prototype.getHours=function(){return this.hour},Time.prototype.getMinutes=function(){return this.minute},Time.prototype.getSeconds=function(){return this.second},Time.prototype.getMilliseconds=function(){return this.millisecond},Time.prototype.getTime=function(){return 1e3*(60*this.hour*60+60*this.minute+this.second)+this.millisecond},Time}(),m=function(t){function DateTime(e,n,r,i,o,a,s){var u=t.call(this,i,o,a,s)||this;return u.year=e,u.month=n,u.day=r,u}return __extends(DateTime,t),DateTime.fromDate=function(t){return new this(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.valueOf()%1e3)},DateTime.prototype.getWeekday=function(){return r.getWeekday(new Date(this.getTime()))},DateTime.prototype.getTime=function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond)).getTime()},DateTime.prototype.getDay=function(){return this.day},DateTime.prototype.getMonth=function(){return this.month},DateTime.prototype.getYear=function(){return this.year},DateTime.prototype.addYears=function(t){this.year+=t},DateTime.prototype.addMonths=function(t){if(this.month+=t,this.month>12){var e=Math.floor(this.month/12),n=Object(o.i)(this.month,12);this.month=n,this.year+=e,0===this.month&&(this.month=12,--this.year)}},DateTime.prototype.addWeekly=function(t,e){e>this.getWeekday()?this.day+=-(this.getWeekday()+1+(6-e))+7*t:this.day+=-(this.getWeekday()-e)+7*t,this.fixDay()},DateTime.prototype.addDaily=function(t){this.day+=t,this.fixDay()},DateTime.prototype.addHours=function(t,e,n){for(e&&(this.hour+=Math.floor((23-this.hour)/t)*t);;){this.hour+=t;var r=Object(o.a)(this.hour,24),i=r.div,a=r.mod;if(i&&(this.hour=a,this.addDaily(i)),Object(o.b)(n)||Object(o.c)(n,this.hour))break}},DateTime.prototype.addMinutes=function(t,e,n,r){for(e&&(this.minute+=Math.floor((1439-(60*this.hour+this.minute))/t)*t);;){this.minute+=t;var i=Object(o.a)(this.minute,60),a=i.div,s=i.mod;if(a&&(this.minute=s,this.addHours(a,!1,n)),(Object(o.b)(n)||Object(o.c)(n,this.hour))&&(Object(o.b)(r)||Object(o.c)(r,this.minute)))break}},DateTime.prototype.addSeconds=function(t,e,n,r,i){for(e&&(this.second+=Math.floor((86399-(3600*this.hour+60*this.minute+this.second))/t)*t);;){this.second+=t;var a=Object(o.a)(this.second,60),s=a.div,u=a.mod;if(s&&(this.second=u,this.addMinutes(s,!1,n,r)),(Object(o.b)(n)||Object(o.c)(n,this.hour))&&(Object(o.b)(r)||Object(o.c)(r,this.minute))&&(Object(o.b)(i)||Object(o.c)(i,this.second)))break}},DateTime.prototype.fixDay=function(){if(!(this.day<=28)){var t=r.monthRange(this.year,this.month-1)[1];if(!(this.day<=t))for(;this.day>t;){if(this.day-=t,++this.month,13===this.month&&(this.month=1,++this.year,this.year>r.MAXYEAR))return;t=r.monthRange(this.year,this.month-1)[1]}}},DateTime.prototype.add=function(t,e){var n=t.freq,r=t.interval,i=t.wkst,o=t.byhour,a=t.byminute,s=t.bysecond;switch(n){case l.YEARLY:return this.addYears(r);case l.MONTHLY:return this.addMonths(r);case l.WEEKLY:return this.addWeekly(r,i);case l.DAILY:return this.addDaily(r);case l.HOURLY:return this.addHours(r,e,o);case l.MINUTELY:return this.addMinutes(r,e,o,a);case l.SECONDLY:return this.addSeconds(r,e,o,a,s)}},DateTime}(p);function initializeOptions(t){var e=[],n=Object.keys(t),r={};if(n.forEach((function(n){var i=t[n];r[n]=i,Object(o.c)(G,n)||e.push(n),a.isDate(i)&&!a.isValidDate(i)&&e.push(n)})),e.length)throw new Error("Invalid options: "+e.join(", "));return r}function parseString(t){var e=t.split("\n").map(parseLine).filter((function(t){return null!==t}));return c({},e[0],e[1])}function parseDtstart(t){var e={},n=/DTSTART(?:;TZID=([^:=]+?))?(?::|=)([^;\s]+)/i.exec(t);if(!n)return e;n[0];var r=n[1],i=n[2];return r&&(e.tzid=r),e.dtstart=a.untilStringToDate(i),e}function parseLine(t){if(!(t=t.replace(/^\s+|\s+$/,"")).length)return null;var e=/^([A-Z]+?)[:;]/.exec(t.toUpperCase());if(!e)return parseRrule(t);e[0];var n=e[1];switch(n.toUpperCase()){case"RRULE":case"EXRULE":return parseRrule(t);case"DTSTART":return parseDtstart(t);default:throw new Error("Unsupported RFC prop "+n+" in "+t)}}function parseRrule(t){var e=parseDtstart(t.replace(/^RRULE:/i,""));return t.replace(/^(?:RRULE|EXRULE):/i,"").split(";").forEach((function(n){var r=n.split("="),i=r[0],o=r[1];switch(i.toUpperCase()){case"FREQ":e.freq=l[o.toUpperCase()];break;case"WKST":e.wkst=F[o.toUpperCase()];break;case"COUNT":case"INTERVAL":case"BYSETPOS":case"BYMONTH":case"BYMONTHDAY":case"BYYEARDAY":case"BYWEEKNO":case"BYHOUR":case"BYMINUTE":case"BYSECOND":var s=function parseNumber(t){if(-1!==t.indexOf(",")){return t.split(",").map(parseIndividualNumber)}return parseIndividualNumber(t)}(o),u=i.toLowerCase();e[u]=s;break;case"BYWEEKDAY":case"BYDAY":e.byweekday=function parseWeekday(t){return t.split(",").map((function(t){if(2===t.length)return F[t];var e=t.match(/^([+-]?\d{1,2})([A-Z]{2})$/),n=Number(e[1]),r=e[2],i=F[r].weekday;return new f(i,n)}))}(o);break;case"DTSTART":case"TZID":var c=parseDtstart(t);e.tzid=c.tzid,e.dtstart=c.dtstart;break;case"UNTIL":e.until=a.untilStringToDate(o);break;case"BYEASTER":e.byeaster=Number(o);break;default:throw new Error("Unknown RRULE property '"+i+"'")}})),e}function parseIndividualNumber(t){return/^[+-]?\d+$/.test(t)?Number(t):t}var y=n(2),g=function(){function DateWithZone(t,e){this.date=t,this.tzid=e}return Object.defineProperty(DateWithZone.prototype,"isUTC",{get:function(){return!this.tzid||"UTC"===this.tzid.toUpperCase()},enumerable:!0,configurable:!0}),DateWithZone.prototype.toString=function(){var t=a.timeToUntilString(this.date.getTime(),this.isUTC);return this.isUTC?":"+t:";TZID="+this.tzid+":"+t},DateWithZone.prototype.getTime=function(){return this.date.getTime()},DateWithZone.prototype.rezonedDate=function(){if(this.isUTC)return this.date;try{return y.DateTime.fromJSDate(this.date).setZone(this.tzid,{keepLocalTime:!0}).toJSDate()}catch(t){return t instanceof TypeError&&console.error("Using TZID without Luxon available is unsupported. Returned times are in UTC, not the requested time zone"),this.date}},DateWithZone}();function optionsToString(t){for(var e=[],n="",r=Object.keys(t),i=Object.keys(U),s=0;s<r.length;s++)if("tzid"!==r[s]&&Object(o.c)(i,r[s])){var u=r[s].toUpperCase(),l=t[r[s]],c="";if(Object(o.f)(l)&&(!Object(o.d)(l)||l.length)){switch(u){case"FREQ":c=z.FREQUENCIES[t.freq];break;case"WKST":c=Object(o.e)(l)?new f(l).toString():l.toString();break;case"BYWEEKDAY":u="BYDAY",c=Object(o.m)(l).map((function(t){return t instanceof f?t:Object(o.d)(t)?new f(t[0],t[1]):new f(t)})).toString();break;case"DTSTART":n=buildDtstart(l,t.tzid);break;case"UNTIL":c=a.timeToUntilString(l,!t.tzid);break;default:if(Object(o.d)(l)){for(var h=[],d=0;d<l.length;d++)h[d]=String(l[d]);c=h.toString()}else c=String(l)}c&&e.push([u,c])}}var p=e.map((function(t){return t[0]+"="+t[1].toString()})).join(";"),m="";return""!==p&&(m="RRULE:"+p),[n,m].filter((function(t){return!!t})).join("\n")}function buildDtstart(t,e){return t?"DTSTART"+new g(new Date(t),e).toString():""}var v=function(){function Cache(){this.all=!1,this.before=[],this.after=[],this.between=[]}return Cache.prototype._cacheAdd=function(t,e,n){e&&(e=e instanceof Date?a.clone(e):a.cloneDates(e)),"all"===t?this.all=e:(n._value=e,this[t].push(n))},Cache.prototype._cacheGet=function(t,e){var n=!1,r=e?Object.keys(e):[],i=function(t){for(var n=0;n<r.length;n++){var i=r[n];if(String(e[i])!==String(t[i]))return!0}return!1},u=this[t];if("all"===t)n=this.all;else if(Object(o.d)(u))for(var l=0;l<u.length;l++){var c=u[l];if(!r.length||!i(c)){n=c._value;break}}if(!n&&this.all){var h=new s(t,e);for(l=0;l<this.all.length&&h.accept(this.all[l]);l++);n=h.getValue(),this._cacheAdd(t,n,e)}return Object(o.d)(n)?a.cloneDates(n):n instanceof Date?a.clone(n):n},Cache}(),_=Object(o.k)(1,31).concat(Object(o.k)(2,28),Object(o.k)(3,31),Object(o.k)(4,30),Object(o.k)(5,31),Object(o.k)(6,30),Object(o.k)(7,31),Object(o.k)(8,31),Object(o.k)(9,30),Object(o.k)(10,31),Object(o.k)(11,30),Object(o.k)(12,31),Object(o.k)(1,7)),b=Object(o.k)(1,31).concat(Object(o.k)(2,29),Object(o.k)(3,31),Object(o.k)(4,30),Object(o.k)(5,31),Object(o.k)(6,30),Object(o.k)(7,31),Object(o.k)(8,31),Object(o.k)(9,30),Object(o.k)(10,31),Object(o.k)(11,30),Object(o.k)(12,31),Object(o.k)(1,7)),T=Object(o.j)(1,29),w=Object(o.j)(1,30),E=Object(o.j)(1,31),S=Object(o.j)(1,32),M=S.concat(w,S,E,S,E,S,S,E,S,E,S,S.slice(0,7)),O=S.concat(T,S,E,S,E,S,S,E,S,E,S,S.slice(0,7)),x=Object(o.j)(-28,0),C=Object(o.j)(-29,0),P=Object(o.j)(-30,0),I=Object(o.j)(-31,0),R=I.concat(C,I,P,I,P,I,I,P,I,P,I,I.slice(0,7)),L=I.concat(x,I,P,I,P,I,I,P,I,P,I,I.slice(0,7)),k=[0,31,60,91,121,152,182,213,244,274,305,335,366],A=[0,31,59,90,120,151,181,212,243,273,304,334,365],D=function(){for(var t=[],e=0;e<55;e++)t=t.concat(Object(o.j)(7));return t}();function rebuildYear(t,e){var n,r,i=new Date(Date.UTC(t,0,1)),s=a.isLeapYear(t)?366:365,u=a.isLeapYear(t+1)?366:365,l=a.toOrdinal(i),h=a.getWeekday(i),d=c({yearlen:s,nextyearlen:u,yearordinal:l,yearweekday:h},function baseYearMasks(t){var e=a.isLeapYear(t)?366:365,n=new Date(Date.UTC(t,0,1)),r=a.getWeekday(n);if(365===e)return{mmask:_,mdaymask:O,nmdaymask:L,wdaymask:D.slice(r),mrange:A};return{mmask:b,mdaymask:M,nmdaymask:R,wdaymask:D.slice(r),mrange:k}}(t),{wnomask:null});if(Object(o.b)(e.byweekno))return d;d.wnomask=Object(o.k)(0,s+7);var f=n=Object(o.i)(7-h+e.wkst,7);f>=4?(f=0,r=d.yearlen+Object(o.i)(h-e.wkst,7)):r=s-f;for(var p=Math.floor(r/7),m=Object(o.i)(r,7),y=Math.floor(p+m/4),g=0;g<e.byweekno.length;g++){var v=e.byweekno[g];if(v<0&&(v+=y+1),v>0&&v<=y){var T=void 0;v>1?(T=f+7*(v-1),f!==n&&(T-=7-n)):T=f;for(var w=0;w<7&&(d.wnomask[T]=1,T++,d.wdaymask[T]!==e.wkst);w++);}}if(Object(o.c)(e.byweekno,1)){T=f+7*y;if(f!==n&&(T-=7-n),T<s)for(g=0;g<7&&(d.wnomask[T]=1,T+=1,d.wdaymask[T]!==e.wkst);g++);}if(f){var E=void 0;if(Object(o.c)(e.byweekno,-1))E=-1;else{var S=a.getWeekday(new Date(Date.UTC(t-1,0,1))),x=Object(o.i)(7-S.valueOf()+e.wkst,7),C=a.isLeapYear(t-1)?366:365,P=void 0;x>=4?(x=0,P=C+Object(o.i)(S-e.wkst,7)):P=s-f,E=Math.floor(52+Object(o.i)(P,7)/4)}if(Object(o.c)(e.byweekno,E))for(T=0;T<f;T++)d.wnomask[T]=1}return d}var j=function(){function Iterinfo(t){this.options=t}return Iterinfo.prototype.rebuild=function(t,e){var n=this.options;if(t!==this.lastyear&&(this.yearinfo=rebuildYear(t,n)),Object(o.g)(n.bynweekday)&&(e!==this.lastmonth||t!==this.lastyear)){var r=this.yearinfo,i=r.yearlen,a=r.mrange,s=r.wdaymask;this.monthinfo=function rebuildMonth(t,e,n,r,i,a){var s={lastyear:t,lastmonth:e,nwdaymask:[]},u=[];if(a.freq===z.YEARLY)if(Object(o.b)(a.bymonth))u=[[0,n]];else for(var l=0;l<a.bymonth.length;l++)e=a.bymonth[l],u.push(r.slice(e-1,e+1));else a.freq===z.MONTHLY&&(u=[r.slice(e-1,e+1)]);if(Object(o.b)(u))return s;for(s.nwdaymask=Object(o.k)(0,n),l=0;l<u.length;l++)for(var c=u[l],h=c[0],d=c[1]-1,f=0;f<a.bynweekday.length;f++){var p=void 0,m=a.bynweekday[f],y=m[0],g=m[1];g<0?(p=d+7*(g+1),p-=Object(o.i)(i[p]-y,7)):(p=h+7*(g-1),p+=Object(o.i)(7-i[p]+y,7)),h<=p&&p<=d&&(s.nwdaymask[p]=1)}return s}(t,e,i,a,s,n)}Object(o.f)(n.byeaster)&&(this.eastermask=function easter(t,e){void 0===e&&(e=0);var n=t%19,r=Math.floor(t/100),i=t%100,o=Math.floor(r/4),a=r%4,s=Math.floor((r+8)/25),u=Math.floor((r-s+1)/3),l=Math.floor(19*n+r-o-u+15)%30,c=Math.floor(i/4),h=i%4,d=Math.floor(32+2*a+2*c-l-h)%7,f=Math.floor((n+11*l+22*d)/451),p=Math.floor((l+d-7*f+114)/31),m=(l+d-7*f+114)%31+1,y=Date.UTC(t,p-1,m+e),g=Date.UTC(t,0,1);return[Math.ceil((y-g)/864e5)]}(t,n.byeaster))},Object.defineProperty(Iterinfo.prototype,"lastyear",{get:function(){return this.monthinfo?this.monthinfo.lastyear:null},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"lastmonth",{get:function(){return this.monthinfo?this.monthinfo.lastmonth:null},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"yearlen",{get:function(){return this.yearinfo.yearlen},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"yearordinal",{get:function(){return this.yearinfo.yearordinal},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"mrange",{get:function(){return this.yearinfo.mrange},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"wdaymask",{get:function(){return this.yearinfo.wdaymask},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"mmask",{get:function(){return this.yearinfo.mmask},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"wnomask",{get:function(){return this.yearinfo.wnomask},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"nwdaymask",{get:function(){return this.monthinfo?this.monthinfo.nwdaymask:[]},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"nextyearlen",{get:function(){return this.yearinfo.nextyearlen},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"mdaymask",{get:function(){return this.yearinfo.mdaymask},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"nmdaymask",{get:function(){return this.yearinfo.nmdaymask},enumerable:!0,configurable:!0}),Iterinfo.prototype.ydayset=function(){return[Object(o.j)(this.yearlen),0,this.yearlen]},Iterinfo.prototype.mdayset=function(t,e,n){for(var r=this.mrange[e-1],i=this.mrange[e],a=Object(o.k)(null,this.yearlen),s=r;s<i;s++)a[s]=s;return[a,r,i]},Iterinfo.prototype.wdayset=function(t,e,n){for(var r=Object(o.k)(null,this.yearlen+7),i=a.toOrdinal(new Date(Date.UTC(t,e-1,n)))-this.yearordinal,s=i,u=0;u<7&&(r[i]=i,++i,this.wdaymask[i]!==this.options.wkst);u++);return[r,s,i]},Iterinfo.prototype.ddayset=function(t,e,n){var r=Object(o.k)(null,this.yearlen),i=a.toOrdinal(new Date(Date.UTC(t,e-1,n)))-this.yearordinal;return r[i]=i,[r,i,i+1]},Iterinfo.prototype.htimeset=function(t,e,n,r){var i=this,o=[];return this.options.byminute.forEach((function(e){o=o.concat(i.mtimeset(t,e,n,r))})),a.sort(o),o},Iterinfo.prototype.mtimeset=function(t,e,n,r){var i=this.options.bysecond.map((function(n){return new p(t,e,n,r)}));return a.sort(i),i},Iterinfo.prototype.stimeset=function(t,e,n,r){return[new p(t,e,n,r)]},Iterinfo.prototype.getdayset=function(t){switch(t){case l.YEARLY:return this.ydayset.bind(this);case l.MONTHLY:return this.mdayset.bind(this);case l.WEEKLY:return this.wdayset.bind(this);case l.DAILY:default:return this.ddayset.bind(this)}},Iterinfo.prototype.gettimeset=function(t){switch(t){case l.HOURLY:return this.htimeset.bind(this);case l.MINUTELY:return this.mtimeset.bind(this);case l.SECONDLY:return this.stimeset.bind(this)}},Iterinfo}();function buildPoslist(t,e,n,r,i,s){for(var u=[],l=0;l<t.length;l++){var c=void 0,h=void 0,d=t[l];d<0?(c=Math.floor(d/e.length),h=Object(o.i)(d,e.length)):(c=Math.floor((d-1)/e.length),h=Object(o.i)(d-1,e.length));for(var f=[],p=n;p<r;p++){var m=s[p];Object(o.f)(m)&&f.push(m)}var y=void 0;y=c<0?f.slice(c)[0]:f[c];var g=e[h],v=a.fromOrdinal(i.yearordinal+y),_=a.combine(v,g);Object(o.c)(u,_)||u.push(_)}return a.sort(u),u}function iter(t,e){var n=e.dtstart,r=e.freq,i=e.interval,s=e.until,u=e.bysetpos,l=e.count;if(0===l||0===i)return emitResult(t);var c=m.fromDate(n),h=new j(e);h.rebuild(c.year,c.month);for(var d=function makeTimeset(t,e,n){var r=n.freq,i=n.byhour,a=n.byminute,s=n.bysecond;if(freqIsDailyOrGreater(r))return function buildTimeset(t){var e=t.dtstart.getTime()%1e3;if(!freqIsDailyOrGreater(t.freq))return[];var n=[];return t.byhour.forEach((function(r){t.byminute.forEach((function(i){t.bysecond.forEach((function(t){n.push(new p(r,i,t,e))}))}))})),n}(n);if(r>=z.HOURLY&&Object(o.g)(i)&&!Object(o.c)(i,e.hour)||r>=z.MINUTELY&&Object(o.g)(a)&&!Object(o.c)(a,e.minute)||r>=z.SECONDLY&&Object(o.g)(s)&&!Object(o.c)(s,e.second))return[];return t.gettimeset(r)(e.hour,e.minute,e.second,e.millisecond)}(h,c,e);;){var f=h.getdayset(r)(c.year,c.month,c.day),y=f[0],g=f[1],v=f[2],_=removeFilteredDays(y,g,v,h,e);if(Object(o.g)(u))for(var b=buildPoslist(u,d,g,v,h,y),T=0;T<b.length;T++){var w=b[T];if(s&&w>s)return emitResult(t);if(w>=n){var E=rezoneIfNeeded(w,e);if(!t.accept(E))return emitResult(t);if(l&&!--l)return emitResult(t)}}else for(T=g;T<v;T++){var S=y[T];if(Object(o.f)(S))for(var M=a.fromOrdinal(h.yearordinal+S),O=0;O<d.length;O++){var x=d[O];w=a.combine(M,x);if(s&&w>s)return emitResult(t);if(w>=n){E=rezoneIfNeeded(w,e);if(!t.accept(E))return emitResult(t);if(l&&!--l)return emitResult(t)}}}if(0===e.interval)return emitResult(t);if(c.add(e,_),c.year>a.MAXYEAR)return emitResult(t);freqIsDailyOrGreater(r)||(d=h.gettimeset(r)(c.hour,c.minute,c.second,0)),h.rebuild(c.year,c.month)}}function isFiltered(t,e,n){var r=n.bymonth,i=n.byweekno,a=n.byweekday,s=n.byeaster,u=n.bymonthday,l=n.bynmonthday,c=n.byyearday;return Object(o.g)(r)&&!Object(o.c)(r,t.mmask[e])||Object(o.g)(i)&&!t.wnomask[e]||Object(o.g)(a)&&!Object(o.c)(a,t.wdaymask[e])||Object(o.g)(t.nwdaymask)&&!t.nwdaymask[e]||null!==s&&!Object(o.c)(t.eastermask,e)||(Object(o.g)(u)||Object(o.g)(l))&&!Object(o.c)(u,t.mdaymask[e])&&!Object(o.c)(l,t.nmdaymask[e])||Object(o.g)(c)&&(e<t.yearlen&&!Object(o.c)(c,e+1)&&!Object(o.c)(c,-t.yearlen+e)||e>=t.yearlen&&!Object(o.c)(c,e+1-t.yearlen)&&!Object(o.c)(c,-t.nextyearlen+e-t.yearlen))}function rezoneIfNeeded(t,e){return new g(t,e.tzid).rezonedDate()}function emitResult(t){return t.getValue()}function removeFilteredDays(t,e,n,r,i){for(var o=!1,a=e;a<n;a++){var s=t[a];(o=isFiltered(r,s,i))&&(t[s]=null)}return o}var N=function(){return N._nlp||(N._nlp=n(3)),N._nlp},F={MO:new f(0),TU:new f(1),WE:new f(2),TH:new f(3),FR:new f(4),SA:new f(5),SU:new f(6)},U={freq:l.YEARLY,dtstart:null,interval:1,wkst:F.MO,count:null,until:null,tzid:null,bysetpos:null,bymonth:null,bymonthday:null,bynmonthday:null,byyearday:null,byweekno:null,byweekday:null,bynweekday:null,byhour:null,byminute:null,bysecond:null,byeaster:null},G=Object.keys(U),z=function(){function RRule(t,e){void 0===t&&(t={}),void 0===e&&(e=!1),this._cache=e?null:new v,this.origOptions=initializeOptions(t);var n=function parseOptions(t){var e=initializeOptions(t),n=Object.keys(t);if(G.forEach((function(t){Object(o.c)(n,t)&&Object(o.f)(e[t])||(e[t]=U[t])})),Object(o.f)(e.byeaster)&&(e.freq=z.YEARLY),!Object(o.f)(e.freq)||!z.FREQUENCIES[e.freq])throw new Error("Invalid frequency: "+e.freq+" "+t.freq);if(e.dtstart||(e.dtstart=new Date((new Date).setMilliseconds(0))),Object(o.f)(e.wkst)?Object(o.e)(e.wkst)||(e.wkst=e.wkst.weekday):e.wkst=z.MO.weekday,Object(o.f)(e.bysetpos)){Object(o.e)(e.bysetpos)&&(e.bysetpos=[e.bysetpos]);for(var r=0;r<e.bysetpos.length;r++){if(0===(u=e.bysetpos[r])||!(u>=-366&&u<=366))throw new Error("bysetpos must be between 1 and 366, or between -366 and -1")}}if(!(Boolean(e.byweekno)||Object(o.g)(e.byweekno)||Object(o.g)(e.byyearday)||Boolean(e.bymonthday)||Object(o.g)(e.bymonthday)||Object(o.f)(e.byweekday)||Object(o.f)(e.byeaster)))switch(e.freq){case z.YEARLY:e.bymonth||(e.bymonth=e.dtstart.getUTCMonth()+1),e.bymonthday=e.dtstart.getUTCDate();break;case z.MONTHLY:e.bymonthday=e.dtstart.getUTCDate();break;case z.WEEKLY:e.byweekday=[a.getWeekday(e.dtstart)]}if(Object(o.f)(e.bymonth)&&!Object(o.d)(e.bymonth)&&(e.bymonth=[e.bymonth]),Object(o.f)(e.byyearday)&&!Object(o.d)(e.byyearday)&&Object(o.e)(e.byyearday)&&(e.byyearday=[e.byyearday]),Object(o.f)(e.bymonthday))if(Object(o.d)(e.bymonthday)){var i=[],s=[];for(r=0;r<e.bymonthday.length;r++){var u;(u=e.bymonthday[r])>0?i.push(u):u<0&&s.push(u)}e.bymonthday=i,e.bynmonthday=s}else e.bymonthday<0?(e.bynmonthday=[e.bymonthday],e.bymonthday=[]):(e.bynmonthday=[],e.bymonthday=[e.bymonthday]);else e.bymonthday=[],e.bynmonthday=[];if(Object(o.f)(e.byweekno)&&!Object(o.d)(e.byweekno)&&(e.byweekno=[e.byweekno]),Object(o.f)(e.byweekday))if(Object(o.e)(e.byweekday))e.byweekday=[e.byweekday],e.bynweekday=null;else if(e.byweekday instanceof f)!e.byweekday.n||e.freq>z.MONTHLY?(e.byweekday=[e.byweekday.weekday],e.bynweekday=null):(e.bynweekday=[[e.byweekday.weekday,e.byweekday.n]],e.byweekday=null);else{var l=[],c=[];for(r=0;r<e.byweekday.length;r++){var h=e.byweekday[r];if(Object(o.e)(h))l.push(h);else{var d=h;!d.n||e.freq>z.MONTHLY?l.push(d.weekday):c.push([d.weekday,d.n])}}e.byweekday=Object(o.g)(l)?l:null,e.bynweekday=Object(o.g)(c)?c:null}else e.bynweekday=null;return Object(o.f)(e.byhour)?Object(o.e)(e.byhour)&&(e.byhour=[e.byhour]):e.byhour=e.freq<z.HOURLY?[e.dtstart.getUTCHours()]:null,Object(o.f)(e.byminute)?Object(o.e)(e.byminute)&&(e.byminute=[e.byminute]):e.byminute=e.freq<z.MINUTELY?[e.dtstart.getUTCMinutes()]:null,Object(o.f)(e.bysecond)?Object(o.e)(e.bysecond)&&(e.bysecond=[e.bysecond]):e.bysecond=e.freq<z.SECONDLY?[e.dtstart.getUTCSeconds()]:null,{parsedOptions:e}}(t).parsedOptions;this.options=n}return RRule.parseText=function(t,e){return N().parseText(t,e)},RRule.fromText=function(t,e){return N().fromText(t,e)},RRule.fromString=function(t){return new RRule(RRule.parseString(t)||void 0)},RRule.prototype._iter=function(t){return iter(t,this.options)},RRule.prototype._cacheGet=function(t,e){return!!this._cache&&this._cache._cacheGet(t,e)},RRule.prototype._cacheAdd=function(t,e,n){if(this._cache)return this._cache._cacheAdd(t,e,n)},RRule.prototype.all=function(t){if(t)return this._iter(new h("all",{},t));var e=this._cacheGet("all");return!1===e&&(e=this._iter(new s("all",{})),this._cacheAdd("all",e)),e},RRule.prototype.between=function(t,e,n,r){if(void 0===n&&(n=!1),!a.isValidDate(t)||!a.isValidDate(e))throw new Error("Invalid date passed in to RRule.between");var i={before:e,after:t,inc:n};if(r)return this._iter(new h("between",i,r));var o=this._cacheGet("between",i);return!1===o&&(o=this._iter(new s("between",i)),this._cacheAdd("between",o,i)),o},RRule.prototype.before=function(t,e){if(void 0===e&&(e=!1),!a.isValidDate(t))throw new Error("Invalid date passed in to RRule.before");var n={dt:t,inc:e},r=this._cacheGet("before",n);return!1===r&&(r=this._iter(new s("before",n)),this._cacheAdd("before",r,n)),r},RRule.prototype.after=function(t,e){if(void 0===e&&(e=!1),!a.isValidDate(t))throw new Error("Invalid date passed in to RRule.after");var n={dt:t,inc:e},r=this._cacheGet("after",n);return!1===r&&(r=this._iter(new s("after",n)),this._cacheAdd("after",r,n)),r},RRule.prototype.count=function(){return this.all().length},RRule.prototype.toString=function(){return optionsToString(this.origOptions)},RRule.prototype.toText=function(t,e,n){return N().toText(this,t,e,n)},RRule.prototype.isFullyConvertibleToText=function(){return N().isFullyConvertible(this)},RRule.prototype.clone=function(){return new RRule(this.origOptions)},RRule.FREQUENCIES=["YEARLY","MONTHLY","WEEKLY","DAILY","HOURLY","MINUTELY","SECONDLY"],RRule.YEARLY=l.YEARLY,RRule.MONTHLY=l.MONTHLY,RRule.WEEKLY=l.WEEKLY,RRule.DAILY=l.DAILY,RRule.HOURLY=l.HOURLY,RRule.MINUTELY=l.MINUTELY,RRule.SECONDLY=l.SECONDLY,RRule.MO=F.MO,RRule.TU=F.TU,RRule.WE=F.WE,RRule.TH=F.TH,RRule.FR=F.FR,RRule.SA=F.SA,RRule.SU=F.SU,RRule.parseString=parseString,RRule.optionsToString=optionsToString,RRule}();var V={dtstart:null,cache:!1,unfold:!1,forceset:!1,compatible:!1,tzid:null};function parseInput(t,e){var n=[],r=[],i=[],a=[],s=parseDtstart(t),u=s.dtstart,l=s.tzid;return function splitIntoLines(t,e){void 0===e&&(e=!1);if(!(t=t&&t.trim()))throw new Error("Invalid empty string");if(!e)return t.split(/\s/);var n=t.split("\n"),r=0;for(;r<n.length;){var i=n[r]=n[r].replace(/\s+$/g,"");i?r>0&&" "===i[0]?(n[r-1]+=i.slice(1),n.splice(r,1)):r+=1:n.splice(r,1)}return n}(t,e.unfold).forEach((function(t){if(t){var e=function breakDownLine(t){var e=function extractName(t){if(-1===t.indexOf(":"))return{name:"RRULE",value:t};var e=Object(o.l)(t,":",1),n=e[0],r=e[1];return{name:n,value:r}}(t),n=e.name,r=e.value,i=n.split(";");if(!i)throw new Error("empty property name");return{name:i[0].toUpperCase(),parms:i.slice(1),value:r}}(t),s=e.name,u=e.parms,c=e.value;switch(s.toUpperCase()){case"RRULE":if(u.length)throw new Error("unsupported RRULE parm: "+u.join(","));n.push(parseString(t));break;case"RDATE":var h=/RDATE(?:;TZID=([^:=]+))?/i.exec(t),d=(h[0],h[1]);d&&!l&&(l=d),r=r.concat(parseRDate(c,u));break;case"EXRULE":if(u.length)throw new Error("unsupported EXRULE parm: "+u.join(","));i.push(parseString(c));break;case"EXDATE":a=a.concat(parseRDate(c,u));break;case"DTSTART":break;default:throw new Error("unsupported property: "+s)}}})),{dtstart:u,tzid:l,rrulevals:n,rdatevals:r,exrulevals:i,exdatevals:a}}function rrulestr(t,e){return void 0===e&&(e={}),function buildRule(t,e){var n=parseInput(t,e),r=n.rrulevals,i=n.rdatevals,o=n.exrulevals,a=n.exdatevals,s=n.dtstart,u=n.tzid,l=!1===e.cache;if(e.compatible&&(e.forceset=!0,e.unfold=!0),e.forceset||r.length>1||i.length||o.length||a.length){var c=new q(l);return c.dtstart(s),c.tzid(u||void 0),r.forEach((function(t){c.rrule(new z(groomRruleOptions(t,s,u),l))})),i.forEach((function(t){c.rdate(t)})),o.forEach((function(t){c.exrule(new z(groomRruleOptions(t,s,u),l))})),a.forEach((function(t){c.exdate(t)})),e.compatible&&e.dtstart&&c.rdate(s),c}var h=r[0]||{};return new z(groomRruleOptions(h,h.dtstart||e.dtstart||s,h.tzid||e.tzid||u),l)}(t,function rrulestr_initializeOptions(t){var e=[],n=Object.keys(t),r=Object.keys(V);if(n.forEach((function(t){Object(o.c)(r,t)||e.push(t)})),e.length)throw new Error("Invalid options: "+e.join(", "));var i=c({},t);return r.forEach((function(t){Object(o.c)(n,t)||(i[t]=V[t])})),i}(e))}function groomRruleOptions(t,e,n){return c({},t,{dtstart:e,tzid:n})}function parseRDate(t,e){return function validateDateParm(t){t.forEach((function(t){if(!/(VALUE=DATE(-TIME)?)|(TZID=)/.test(t))throw new Error("unsupported RDATE/EXDATE parm: "+t)}))}(e),t.split(",").map((function(t){return a.untilStringToDate(t)}))}function createGetterSetter(t){var e=this;return function(n){if(void 0!==n&&(e["_"+t]=n),void 0!==e["_"+t])return e["_"+t];for(var r=0;r<e._rrule.length;r++){var i=e._rrule[r].origOptions[t];if(i)return i}}}var q=function(t){function RRuleSet(e){void 0===e&&(e=!1);var n=t.call(this,{},e)||this;return n.dtstart=createGetterSetter.apply(n,["dtstart"]),n.tzid=createGetterSetter.apply(n,["tzid"]),n._rrule=[],n._rdate=[],n._exrule=[],n._exdate=[],n}return __extends(RRuleSet,t),RRuleSet.prototype._iter=function(t){return function iterSet(t,e,n,r,i,o){var s={},u=t.accept;function evalExdate(t,e){n.forEach((function(n){n.between(t,e,!0).forEach((function(t){s[Number(t)]=!0}))}))}i.forEach((function(t){var e=new g(t,o).rezonedDate();s[Number(e)]=!0})),t.accept=function(t){var e=Number(t);return!(!s[e]&&(evalExdate(new Date(e-1),new Date(e+1)),!s[e]))||(s[e]=!0,u.call(this,t))},"between"===t.method&&(evalExdate(t.args.after,t.args.before),t.accept=function(t){var e=Number(t);return!!s[e]||(s[e]=!0,u.call(this,t))});for(var l=0;l<r.length;l++){var c=new g(r[l],o).rezonedDate();if(!t.accept(new Date(c.getTime())))break}e.forEach((function(e){iter(t,e.options)}));var h=t._result;switch(a.sort(h),t.method){case"all":case"between":return h;case"before":return h.length&&h[h.length-1]||null;case"after":default:return h.length&&h[0]||null}}(t,this._rrule,this._exrule,this._rdate,this._exdate,this.tzid())},RRuleSet.prototype.rrule=function(t){_addRule(t,this._rrule)},RRuleSet.prototype.exrule=function(t){_addRule(t,this._exrule)},RRuleSet.prototype.rdate=function(t){_addDate(t,this._rdate)},RRuleSet.prototype.exdate=function(t){_addDate(t,this._exdate)},RRuleSet.prototype.rrules=function(){return this._rrule.map((function(t){return rrulestr(t.toString())}))},RRuleSet.prototype.exrules=function(){return this._exrule.map((function(t){return rrulestr(t.toString())}))},RRuleSet.prototype.rdates=function(){return this._rdate.map((function(t){return new Date(t.getTime())}))},RRuleSet.prototype.exdates=function(){return this._exdate.map((function(t){return new Date(t.getTime())}))},RRuleSet.prototype.valueOf=function(){var t=[];return!this._rrule.length&&this._dtstart&&(t=t.concat(optionsToString({dtstart:this._dtstart}))),this._rrule.forEach((function(e){t=t.concat(e.toString().split("\n"))})),this._exrule.forEach((function(e){t=t.concat(e.toString().split("\n").map((function(t){return t.replace(/^RRULE:/,"EXRULE:")})).filter((function(t){return!/^DTSTART/.test(t)})))})),this._rdate.length&&t.push(rdatesToString("RDATE",this._rdate,this.tzid())),this._exdate.length&&t.push(rdatesToString("EXDATE",this._exdate,this.tzid())),t},RRuleSet.prototype.toString=function(){return this.valueOf().join("\n")},RRuleSet.prototype.clone=function(){var t=new RRuleSet(!!this._cache);return this._rrule.forEach((function(e){return t.rrule(e.clone())})),this._exrule.forEach((function(e){return t.exrule(e.clone())})),this._rdate.forEach((function(e){return t.rdate(new Date(e.getTime()))})),this._exdate.forEach((function(e){return t.exdate(new Date(e.getTime()))})),t},RRuleSet}(z);function _addRule(t,e){if(!(t instanceof z))throw new TypeError(String(t)+" is not RRule instance");Object(o.c)(e.map(String),String(t))||e.push(t)}function _addDate(t,e){if(!(t instanceof Date))throw new TypeError(String(t)+" is not Date instance");Object(o.c)(e.map(Number),Number(t))||(e.push(t),a.sort(e))}function rdatesToString(t,e,n){var r=!n||"UTC"===n.toUpperCase();return""+(r?t+":":t+";TZID="+n+":")+e.map((function(t){return a.timeToUntilString(t.valueOf(),r)})).join(",")}n.d(e,"Frequency",(function(){return l})),n.d(e,"Weekday",(function(){return f})),n.d(e,"RRule",(function(){return z})),n.d(e,"RRuleSet",(function(){return q})),n.d(e,"rrulestr",(function(){return rrulestr}));
/*!
   * rrule.js - Library for working with recurrence rules for calendar dates.
   * https://github.com/jakubroztocil/rrule
   *
   * Copyright 2010, Jakub Roztocil and Lars Schoning
   * Licenced under the BSD licence.
   * https://github.com/jakubroztocil/rrule/blob/master/LICENCE
   *
   * Based on:
   * python-dateutil - Extensions to the standard Python datetime module.
   * Copyright (c) 2003-2011 - Gustavo Niemeyer <gustavo@niemeyer.net>
   * Copyright (c) 2012 - Tomi Pievilinen <tomi.pievilainen@iki.fi>
   * https://github.com/jakubroztocil/rrule/blob/master/LICENCE
   *
   */e.default=z},function(e,n){e.exports=t},function(t,e,n){n.r(e);var r={dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],tokens:{SKIP:/^[ \r\n\t]+|^\.$/,number:/^[1-9][0-9]*/,numberAsText:/^(one|two|three)/i,every:/^every/i,"day(s)":/^days?/i,"weekday(s)":/^weekdays?/i,"week(s)":/^weeks?/i,"hour(s)":/^hours?/i,"minute(s)":/^minutes?/i,"month(s)":/^months?/i,"year(s)":/^years?/i,on:/^(on|in)/i,at:/^(at)/i,the:/^the/i,first:/^first/i,second:/^second/i,third:/^third/i,nth:/^([1-9][0-9]*)(\.|th|nd|rd|st)/i,last:/^last/i,for:/^for/i,"time(s)":/^times?/i,until:/^(un)?til/i,monday:/^mo(n(day)?)?/i,tuesday:/^tu(e(s(day)?)?)?/i,wednesday:/^we(d(n(esday)?)?)?/i,thursday:/^th(u(r(sday)?)?)?/i,friday:/^fr(i(day)?)?/i,saturday:/^sa(t(urday)?)?/i,sunday:/^su(n(day)?)?/i,january:/^jan(uary)?/i,february:/^feb(ruary)?/i,march:/^mar(ch)?/i,april:/^apr(il)?/i,may:/^may/i,june:/^june?/i,july:/^july?/i,august:/^aug(ust)?/i,september:/^sep(t(ember)?)?/i,october:/^oct(ober)?/i,november:/^nov(ember)?/i,december:/^dec(ember)?/i,comma:/^(,\s*|(and|or)\s*)+/i}},i=n(1),o=n(0),a=function(t,e){return-1!==t.indexOf(e)},s=function(t){return t.toString()},u=function(t,e,n){return e+" "+n+", "+t},l=function(){function ToText(t,e,n,i){if(void 0===e&&(e=s),void 0===n&&(n=r),void 0===i&&(i=u),this.text=[],this.language=n||r,this.gettext=e,this.dateFormatter=i,this.rrule=t,this.options=t.options,this.origOptions=t.origOptions,this.origOptions.bymonthday){var a=[].concat(this.options.bymonthday),l=[].concat(this.options.bynmonthday);a.sort((function(t,e){return t-e})),l.sort((function(t,e){return e-t})),this.bymonthday=a.concat(l),this.bymonthday.length||(this.bymonthday=null)}if(Object(o.f)(this.origOptions.byweekday)){var c=Object(o.d)(this.origOptions.byweekday)?this.origOptions.byweekday:[this.origOptions.byweekday],h=String(c);this.byweekday={allWeeks:c.filter((function(t){return!t.n})),someWeeks:c.filter((function(t){return Boolean(t.n)})),isWeekdays:-1!==h.indexOf("MO")&&-1!==h.indexOf("TU")&&-1!==h.indexOf("WE")&&-1!==h.indexOf("TH")&&-1!==h.indexOf("FR")&&-1===h.indexOf("SA")&&-1===h.indexOf("SU"),isEveryDay:-1!==h.indexOf("MO")&&-1!==h.indexOf("TU")&&-1!==h.indexOf("WE")&&-1!==h.indexOf("TH")&&-1!==h.indexOf("FR")&&-1!==h.indexOf("SA")&&-1!==h.indexOf("SU")};var d=function(t,e){return t.weekday-e.weekday};this.byweekday.allWeeks.sort(d),this.byweekday.someWeeks.sort(d),this.byweekday.allWeeks.length||(this.byweekday.allWeeks=null),this.byweekday.someWeeks.length||(this.byweekday.someWeeks=null)}else this.byweekday=null}return ToText.isFullyConvertible=function(t){if(!(t.options.freq in ToText.IMPLEMENTED))return!1;if(t.origOptions.until&&t.origOptions.count)return!1;for(var e in t.origOptions){if(a(["dtstart","wkst","freq"],e))return!0;if(!a(ToText.IMPLEMENTED[t.options.freq],e))return!1}return!0},ToText.prototype.isFullyConvertible=function(){return ToText.isFullyConvertible(this.rrule)},ToText.prototype.toString=function(){var t=this.gettext;if(!(this.options.freq in ToText.IMPLEMENTED))return t("RRule error: Unable to fully convert this rrule to text");if(this.text=[t("every")],this[i.default.FREQUENCIES[this.options.freq]](),this.options.until){this.add(t("until"));var e=this.options.until;this.add(this.dateFormatter(e.getUTCFullYear(),this.language.monthNames[e.getUTCMonth()],e.getUTCDate()))}else this.options.count&&this.add(t("for")).add(this.options.count.toString()).add(this.plural(this.options.count)?t("times"):t("time"));return this.isFullyConvertible()||this.add(t("(~ approximate)")),this.text.join("")},ToText.prototype.HOURLY=function(){var t=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("hours"):t("hour"))},ToText.prototype.MINUTELY=function(){var t=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()),this.add((this.plural(this.options.interval),t("minutes")))},ToText.prototype.DAILY=function(){var t=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()),this.byweekday&&this.byweekday.isWeekdays?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(this.plural(this.options.interval)?t("days"):t("day")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday?this._byweekday():this.origOptions.byhour&&this._byhour()},ToText.prototype.WEEKLY=function(){var t=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()).add(this.plural(this.options.interval)?t("weeks"):t("week")),this.byweekday&&this.byweekday.isWeekdays?1===this.options.interval?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(t("on")).add(t("weekdays")):this.byweekday&&this.byweekday.isEveryDay?this.add(this.plural(this.options.interval)?t("days"):t("day")):(1===this.options.interval&&this.add(t("week")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday())},ToText.prototype.MONTHLY=function(){var t=this.gettext;this.origOptions.bymonth?(1!==this.options.interval&&(this.add(this.options.interval.toString()).add(t("months")),this.plural(this.options.interval)&&this.add(t("in"))),this._bymonth()):(1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("months"):t("month"))),this.bymonthday?this._bymonthday():this.byweekday&&this.byweekday.isWeekdays?this.add(t("on")).add(t("weekdays")):this.byweekday&&this._byweekday()},ToText.prototype.YEARLY=function(){var t=this.gettext;this.origOptions.bymonth?(1!==this.options.interval&&(this.add(this.options.interval.toString()),this.add(t("years"))),this._bymonth()):(1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("years"):t("year"))),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.options.byyearday&&this.add(t("on the")).add(this.list(this.options.byyearday,this.nth,t("and"))).add(t("day")),this.options.byweekno&&this.add(t("in")).add(this.plural(this.options.byweekno.length)?t("weeks"):t("week")).add(this.list(this.options.byweekno,void 0,t("and")))},ToText.prototype._bymonthday=function(){var t=this.gettext;this.byweekday&&this.byweekday.allWeeks?this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext,t("or"))).add(t("the")).add(this.list(this.bymonthday,this.nth,t("or"))):this.add(t("on the")).add(this.list(this.bymonthday,this.nth,t("and")))},ToText.prototype._byweekday=function(){var t=this.gettext;this.byweekday.allWeeks&&!this.byweekday.isWeekdays&&this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext)),this.byweekday.someWeeks&&(this.byweekday.allWeeks&&this.add(t("and")),this.add(t("on the")).add(this.list(this.byweekday.someWeeks,this.weekdaytext,t("and"))))},ToText.prototype._byhour=function(){var t=this.gettext;this.add(t("at")).add(this.list(this.origOptions.byhour,void 0,t("and")))},ToText.prototype._bymonth=function(){this.add(this.list(this.options.bymonth,this.monthtext,this.gettext("and")))},ToText.prototype.nth=function(t){var e,n;t=parseInt(t.toString(),10);var r=this.gettext;if(-1===t)return r("last");switch(n=Math.abs(t)){case 1:case 21:case 31:e=n+r("st");break;case 2:case 22:e=n+r("nd");break;case 3:case 23:e=n+r("rd");break;default:e=n+r("th")}return t<0?e+" "+r("last"):e},ToText.prototype.monthtext=function(t){return this.language.monthNames[t-1]},ToText.prototype.weekdaytext=function(t){var e=Object(o.e)(t)?(t+1)%7:t.getJsWeekday();return(t.n?this.nth(t.n)+" ":"")+this.language.dayNames[e]},ToText.prototype.plural=function(t){return t%100!=1},ToText.prototype.add=function(t){return this.text.push(" "),this.text.push(t),this},ToText.prototype.list=function(t,e,n,r){void 0===r&&(r=","),Object(o.d)(t)||(t=[t]);e=e||function(t){return t.toString()};var i=this,a=function(t){return e&&e.call(i,t)};return n?function(t,e,n){for(var r="",i=0;i<t.length;i++)0!==i&&(i===t.length-1?r+=" "+n+" ":r+=e+" "),r+=t[i];return r}(t.map(a),r,n):t.map(a).join(r+" ")},ToText}(),c=function(){function Parser(t){this.done=!0,this.rules=t}return Parser.prototype.start=function(t){return this.text=t,this.done=!1,this.nextSymbol()},Parser.prototype.isDone=function(){return this.done&&null===this.symbol},Parser.prototype.nextSymbol=function(){var t,e;this.symbol=null,this.value=null;do{if(this.done)return!1;for(var n in t=null,this.rules){var r=this.rules[n].exec(this.text);r&&(null===t||r[0].length>t[0].length)&&(t=r,e=n)}if(null!=t&&(this.text=this.text.substr(t[0].length),""===this.text&&(this.done=!0)),null==t)return this.done=!0,this.symbol=null,void(this.value=null)}while("SKIP"===e);return this.symbol=e,this.value=t,!0},Parser.prototype.accept=function(t){if(this.symbol===t){if(this.value){var e=this.value;return this.nextSymbol(),e}return this.nextSymbol(),!0}return!1},Parser.prototype.acceptNumber=function(){return this.accept("number")},Parser.prototype.expect=function(t){if(this.accept(t))return!0;throw new Error("expected "+t+" but found "+this.symbol)},Parser}();function parseText(t,e){void 0===e&&(e=r);var n={},o=new c(e.tokens);return o.start(t)?(function S(){o.expect("every");var t=o.acceptNumber();t&&(n.interval=parseInt(t[0],10));if(o.isDone())throw new Error("Unexpected end");switch(o.symbol){case"day(s)":n.freq=i.default.DAILY,o.nextSymbol()&&(!function AT(){if(!o.accept("at"))return;do{var t=o.acceptNumber();if(!t)throw new Error("Unexpected symbol "+o.symbol+", expected hour");for(n.byhour=[parseInt(t[0],10)];o.accept("comma");){if(!(t=o.acceptNumber()))throw new Error("Unexpected symbol "+o.symbol+"; expected hour");n.byhour.push(parseInt(t[0],10))}}while(o.accept("comma")||o.accept("at"))}(),F());break;case"weekday(s)":n.freq=i.default.WEEKLY,n.byweekday=[i.default.MO,i.default.TU,i.default.WE,i.default.TH,i.default.FR],o.nextSymbol(),F();break;case"week(s)":n.freq=i.default.WEEKLY,o.nextSymbol()&&(ON(),F());break;case"hour(s)":n.freq=i.default.HOURLY,o.nextSymbol()&&(ON(),F());break;case"minute(s)":n.freq=i.default.MINUTELY,o.nextSymbol()&&(ON(),F());break;case"month(s)":n.freq=i.default.MONTHLY,o.nextSymbol()&&(ON(),F());break;case"year(s)":n.freq=i.default.YEARLY,o.nextSymbol()&&(ON(),F());break;case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":n.freq=i.default.WEEKLY;var e=o.symbol.substr(0,2).toUpperCase();if(n.byweekday=[i.default[e]],!o.nextSymbol())return;for(;o.accept("comma");){if(o.isDone())throw new Error("Unexpected end");var r=decodeWKD();if(!r)throw new Error("Unexpected symbol "+o.symbol+", expected weekday");n.byweekday.push(i.default[r]),o.nextSymbol()}!function MDAYs(){o.accept("on"),o.accept("the");var t=decodeNTH();if(!t)return;n.bymonthday=[t],o.nextSymbol();for(;o.accept("comma");){if(!(t=decodeNTH()))throw new Error("Unexpected symbol "+o.symbol+"; expected monthday");n.bymonthday.push(t),o.nextSymbol()}}(),F();break;case"january":case"february":case"march":case"april":case"may":case"june":case"july":case"august":case"september":case"october":case"november":case"december":if(n.freq=i.default.YEARLY,n.bymonth=[decodeM()],!o.nextSymbol())return;for(;o.accept("comma");){if(o.isDone())throw new Error("Unexpected end");var a=decodeM();if(!a)throw new Error("Unexpected symbol "+o.symbol+", expected month");n.bymonth.push(a),o.nextSymbol()}ON(),F();break;default:throw new Error("Unknown symbol")}}(),n):null;function ON(){var t=o.accept("on"),e=o.accept("the");if(t||e)do{var r=decodeNTH(),a=decodeWKD(),s=decodeM();if(r)a?(o.nextSymbol(),n.byweekday||(n.byweekday=[]),n.byweekday.push(i.default[a].nth(r))):(n.bymonthday||(n.bymonthday=[]),n.bymonthday.push(r),o.accept("day(s)"));else if(a)o.nextSymbol(),n.byweekday||(n.byweekday=[]),n.byweekday.push(i.default[a]);else if("weekday(s)"===o.symbol)o.nextSymbol(),n.byweekday||(n.byweekday=[i.default.MO,i.default.TU,i.default.WE,i.default.TH,i.default.FR]);else if("week(s)"===o.symbol){o.nextSymbol();var u=o.acceptNumber();if(!u)throw new Error("Unexpected symbol "+o.symbol+", expected week number");for(n.byweekno=[parseInt(u[0],10)];o.accept("comma");){if(!(u=o.acceptNumber()))throw new Error("Unexpected symbol "+o.symbol+"; expected monthday");n.byweekno.push(parseInt(u[0],10))}}else{if(!s)return;o.nextSymbol(),n.bymonth||(n.bymonth=[]),n.bymonth.push(s)}}while(o.accept("comma")||o.accept("the")||o.accept("on"))}function decodeM(){switch(o.symbol){case"january":return 1;case"february":return 2;case"march":return 3;case"april":return 4;case"may":return 5;case"june":return 6;case"july":return 7;case"august":return 8;case"september":return 9;case"october":return 10;case"november":return 11;case"december":return 12;default:return!1}}function decodeWKD(){switch(o.symbol){case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":return o.symbol.substr(0,2).toUpperCase();default:return!1}}function decodeNTH(){switch(o.symbol){case"last":return o.nextSymbol(),-1;case"first":return o.nextSymbol(),1;case"second":return o.nextSymbol(),o.accept("last")?-2:2;case"third":return o.nextSymbol(),o.accept("last")?-3:3;case"nth":var t=parseInt(o.value[1],10);if(t<-366||t>366)throw new Error("Nth out of range: "+t);return o.nextSymbol(),o.accept("last")?-t:t;default:return!1}}function F(){if("until"===o.symbol){var t=Date.parse(o.text);if(!t)throw new Error("Cannot parse until date:"+o.text);n.until=new Date(t)}else o.accept("for")&&(n.count=parseInt(o.value[0],10),o.expect("number"))}}n.d(e,"fromText",(function(){return h})),n.d(e,"isFullyConvertible",(function(){return p})),n.d(e,"toText",(function(){return f})),n.d(e,"parseText",(function(){return parseText}));
/*!
  * rrule.js - Library for working with recurrence rules for calendar dates.
  * https://github.com/jakubroztocil/rrule
  *
  * Copyright 2010, Jakub Roztocil and Lars Schoning
  * Licenced under the BSD licence.
  * https://github.com/jakubroztocil/rrule/blob/master/LICENCE
  *
  */
var h=function(t,e){return void 0===e&&(e=r),new i.default(parseText(t,e)||void 0)},d=["count","until","interval","byweekday","bymonthday","bymonth"];l.IMPLEMENTED=[],l.IMPLEMENTED[i.default.HOURLY]=d,l.IMPLEMENTED[i.default.MINUTELY]=d,l.IMPLEMENTED[i.default.DAILY]=["byhour"].concat(d),l.IMPLEMENTED[i.default.WEEKLY]=d,l.IMPLEMENTED[i.default.MONTHLY]=d,l.IMPLEMENTED[i.default.YEARLY]=["byweekno","byyearday"].concat(d);var f=function(t,e,n,r){return new l(t,e,n,r).toString()},p=l.isFullyConvertible}])}))})));function parseTimes(t,e){var n=[];if(null==t)n=[];else if(Array.isArray(t))n=t.map((function(t){return new Date(t).getTime()}));else if("object"===_typeof(t)){new Ae(t).all().map((function(t){return DateTime.fromJSDate(t).toUTC().valueOf()})).forEach((function(t){n.includes(t)||n.push(t)}))}else if(t.includes(",")){var r=t.split(",");n=r.map((function(t){return new Date(t).getTime()}))}else if(t.includes("/")){var i=t.split("/").map((function(t){if("present"===t.toLowerCase())return{value:Date.now(),type:"date"};var e=new Date(t);if(function isValidDate(t){return t instanceof Date&&!isNaN(t)}(e))return{value:e.getTime(),type:"date"};try{return{value:Duration.fromISO(t).toObject(),type:"period"}}catch(t){return{value:null,type:null}}}));if(2===i.length);else if(3===i.length&&"date"===i[0].type&&"date"===i[1].type&&"period"===i[2].type)for(var o=Duration.fromObject(i[2].value).as("milliseconds"),a=0,s=i[0].value;s<=i[1].value;)n.push(s),a++,s=i[0].value+a*o}else{t.toLowerCase().split(" and ").forEach((function(t){var r,i=t.split(" ");if(i.length>=2){var o=Number(i[0]);if(!isNaN(o)&&"times"===i[1].trim())return void(n=n.concat(Array(o).fill(i.length>=3&&"history"===i[2]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY)))}try{r=Ae.fromText(t)}catch(t){return[]}if(r.options.freq===Ae.HOURLY?(r.options.byhour=Array.from(Array(24).keys()).filter((function(t){return t%r.options.interval==0})),r.options.byminute=[0],r.options.bysecond=[0],r.options.interval=1):r.options.freq===Ae.MINUTELY&&(r.options.byminute=Array.from(Array(60).keys()).filter((function(t){return t%r.options.interval==0})),r.options.bysecond=[0],r.options.interval=1),null!=e){var a=DateTime.fromJSDate(r.options.dtstart);if(null!=a){var s=Duration.fromISO(e);null!=s&&null!=(a=a.plus(s))&&(r.options.dtstart=a.toJSDate())}}var u,l=r.all().map((function(t){return DateTime.fromJSDate(t).toUTC().valueOf()}));if(t.toLowerCase().includes(" history")){var c=l.length-1;if(0===c){var h=_objectSpread2({},r.options);h.count=2;var d=new Ae(h).all();u=d[1]-d[0]}else u=(c+1)*(l[c]-l[0])/c;l=l.map((function(t){return t-u}))}l.forEach((function(t){n.includes(t)||n.push(t)}))}))}return n.sort(),n}function getBaseUrl(t){return t.split(/[?#]/)[0]}var De,je,Ne=0,Fe=0,Ue=0,Ge=1e3,ze=0,Ve=0,qe=0,Ze="object"==typeof performance&&performance.now?performance:Date,We="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function now$1(){return Ve||(We(clearNow),Ve=Ze.now()+qe)}function clearNow(){Ve=0}function Timer(){this._call=this._time=this._next=null}function wake(){Ve=(ze=Ze.now())+qe,Ne=Fe=0;try{!function timerFlush(){now$1(),++Ne;for(var t,e=De;e;)(t=Ve-e._time)>=0&&e._call.call(null,t),e=e._next;--Ne}()}finally{Ne=0,function nap(){var t,e,n=De,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:De=e);je=t,sleep(r)}(),Ve=0}}function poke(){var t=Ze.now(),e=t-ze;e>Ge&&(qe-=e,ze=t)}function sleep(t){Ne||(Fe&&(Fe=clearTimeout(Fe)),t-Ve>24?(t<1/0&&(Fe=setTimeout(wake,t-Ze.now()-qe)),Ue&&(Ue=clearInterval(Ue))):(Ue||(ze=Ze.now(),Ue=setInterval(poke,Ge)),Ne=1,We(wake)))}function timeout$1(t,e,n){var r=new Timer;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r}Timer.prototype=function timer(t,e,n){var r=new Timer;return r.restart(t,e,n),r}.prototype={constructor:Timer,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?now$1():+n)+(null==e?0:+e),this._next||je===this||(je?je._next=this:De=this,je=this),this._call=t,this._time=n,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var Ye="propertychange";function listen(t,e,n,r,i){if(r&&r!==t&&(n=n.bind(r)),i){var o=n;n=function(){t.removeEventListener(e,n),o.apply(this,arguments)}}var a={target:t,type:e,listener:n};return t.addEventListener(e,n),a}function listenOnce(t,e,n,r){return listen(t,e,n,r,!0)}function unlistenByKey(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),clear(t))}var Be=function(){function Disposable(){this.disposed_=!1}return Disposable.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},Disposable.prototype.disposeInternal=function(){},Disposable}();function numberSafeCompareFunction(t,e){return t>e?1:t<e?-1:0}function linearFindNearest(t,e,n){var r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;var i=void 0;if(n>0){for(i=1;i<r;++i)if(t[i]<e)return i-1}else if(n<0){for(i=1;i<r;++i)if(t[i]<=e)return i}else for(i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function find(t,e){for(var n,r=t.length>>>0,i=0;i<r;i++)if(e(n=t[i],i,t))return n;return null}function equals$1(t,e){var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function findIndex(t,e){var n;return!t.every((function(r,i){return n=i,!e(r,i,t)}))?n:-1}function TRUE(){return!0}function FALSE(){return!1}function VOID(){}var Ke=function(){function BaseEvent(t){this.propagationStopped,this.type=t,this.target=null}return BaseEvent.prototype.preventDefault=function(){this.propagationStopped=!0},BaseEvent.prototype.stopPropagation=function(){this.propagationStopped=!0},BaseEvent}(),He=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Xe=function(t){function Target(e){var n=t.call(this)||this;return n.target_=e,n.pendingRemovals_={},n.dispatching_={},n.listeners_={},n}return He(Target,t),Target.prototype.addEventListener=function(t,e){if(t&&e){var n=this.listeners_[t];n||(n=this.listeners_[t]=[]),-1===n.indexOf(e)&&n.push(e)}},Target.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Ke(t):t,n=e.type;e.target||(e.target=this.target_||this);var r,i=this.listeners_[n];if(i){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var o=0,a=i.length;o<a;++o)if(!1===i[o].call(this,e)||e.propagationStopped){r=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var s=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];s--;)this.removeEventListener(n,VOID);delete this.dispatching_[n]}return r}},Target.prototype.disposeInternal=function(){clear(this.listeners_)},Target.prototype.getListeners=function(t){return this.listeners_[t]},Target.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},Target.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var r=n.indexOf(e);-1!==r&&(t in this.pendingRemovals_?(n[r]=VOID,++this.pendingRemovals_[t]):(n.splice(r,1),0===n.length&&delete this.listeners_[t]))}},Target}(Be),$e={CHANGE:"change",ERROR:"error",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",WHEEL:"wheel"},Qe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Je=function(t){function Observable(){var e=t.call(this)||this;return e.revision_=0,e}return Qe(Observable,t),Observable.prototype.changed=function(){++this.revision_,this.dispatchEvent($e.CHANGE)},Observable.prototype.getRevision=function(){return this.revision_},Observable.prototype.on=function(t,e){if(Array.isArray(t)){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=listen(this,t[i],e);return r}return listen(this,t,e)},Observable.prototype.once=function(t,e){if(Array.isArray(t)){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=listenOnce(this,t[i],e);return r}return listenOnce(this,t,e)},Observable.prototype.un=function(t,e){if(Array.isArray(t))for(var n=0,r=t.length;n<r;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)},Observable}(Xe);function unByKey(t){if(Array.isArray(t))for(var e=0,n=t.length;e<n;++e)unlistenByKey(t[e]);else unlistenByKey(t)}var tn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),en=function(t){function ObjectEvent(e,n,r){var i=t.call(this,e)||this;return i.key=n,i.oldValue=r,i}return tn(ObjectEvent,t),ObjectEvent}(Ke),nn=function(t){function BaseObject(e){var n=t.call(this)||this;return getUid(n),n.values_={},void 0!==e&&n.setProperties(e),n}return tn(BaseObject,t),BaseObject.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},BaseObject.prototype.getKeys=function(){return Object.keys(this.values_)},BaseObject.prototype.getProperties=function(){return n({},this.values_)},BaseObject.prototype.notify=function(t,e){var n;n=getChangeEventType(t),this.dispatchEvent(new en(n,t,e)),n=Ye,this.dispatchEvent(new en(n,t,e))},BaseObject.prototype.set=function(t,e,n){if(n)this.values_[t]=e;else{var r=this.values_[t];this.values_[t]=e,r!==e&&this.notify(t,r)}},BaseObject.prototype.setProperties=function(t,e){for(var n in t)this.set(n,t[n],e)},BaseObject.prototype.unset=function(t,e){if(t in this.values_){var n=this.values_[t];delete this.values_[t],e||this.notify(t,n)}},BaseObject}(Je),rn={};function getChangeEventType(t){return rn.hasOwnProperty(t)?rn[t]:rn[t]="change:"+t}var on=function emptyElement(t){if(!(t instanceof HTMLElement))throw new TypeError("Expected an element");for(var e;e=t.lastChild;)t.removeChild(e);return t},an=createCommonjsModule((function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var n=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}})),sn=(an.node,an.nodeList,an.string,an.fn,9);if("undefined"!=typeof Element&&!Element.prototype.matches){var un=Element.prototype;un.matches=un.matchesSelector||un.mozMatchesSelector||un.msMatchesSelector||un.oMatchesSelector||un.webkitMatchesSelector}var ln=function closest(t,e){for(;t&&t.nodeType!==sn;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}};function _delegate(t,e,n,r,i){var o=listener.apply(this,arguments);return t.addEventListener(n,o,i),{destroy:function(){t.removeEventListener(n,o,i)}}}function listener(t,e,n,r){return function(n){n.delegateTarget=ln(n.target,e),n.delegateTarget&&r.call(t,n)}}var cn=function delegate(t,e,n,r,i){return"function"==typeof t.addEventListener?_delegate.apply(null,arguments):"function"==typeof n?_delegate.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return _delegate(t,e,n,r,i)})))};var hn=function listen$1(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!an.string(e))throw new TypeError("Second argument must be a String");if(!an.fn(n))throw new TypeError("Third argument must be a Function");if(an.node(t))return function listenNode(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}(t,e,n);if(an.nodeList(t))return function listenNodeList(t,e,n){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,n)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,n)}))}}}(t,e,n);if(an.string(t))return function listenSelector(t,e,n){return cn(document.body,t,e,n)}(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")},dn=Math.ceil,fn=Math.floor,pn=function(t){return isNaN(t=+t)?0:(t>0?fn:dn)(t)},mn=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},yn=createCommonjsModule((function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),gn=createCommonjsModule((function(t){var e=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=e)})),vn=(gn.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),_n=function(t){if(!vn(t))throw TypeError(t+" is not an object!");return t},bn=function(t){try{return!!t()}catch(t){return!0}},Tn=!bn((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),wn=yn.document,En=vn(wn)&&vn(wn.createElement),Sn=function(t){return En?wn.createElement(t):{}},Mn=!Tn&&!bn((function(){return 7!=Object.defineProperty(Sn("div"),"a",{get:function(){return 7}}).a})),On=Object.defineProperty,xn={f:Tn?Object.defineProperty:function defineProperty(t,e,n){if(_n(t),e=function(t,e){if(!vn(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!vn(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!vn(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!vn(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),_n(n),Mn)try{return On(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},Cn=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Pn=Tn?function(t,e,n){return xn.f(t,e,Cn(1,n))}:function(t,e,n){return t[e]=n,t},In={}.hasOwnProperty,Rn=function(t,e){return In.call(t,e)},Ln=0,kn=Math.random(),An=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++Ln+kn).toString(36))},Dn=createCommonjsModule((function(t){var e=yn["__core-js_shared__"]||(yn["__core-js_shared__"]={});(t.exports=function(t,n){return e[t]||(e[t]=void 0!==n?n:{})})("versions",[]).push({version:gn.version,mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})})),jn=Dn("native-function-to-string",Function.toString),Nn=createCommonjsModule((function(t){var e=An("src"),n=(""+jn).split("toString");gn.inspectSource=function(t){return jn.call(t)},(t.exports=function(t,r,i,o){var a="function"==typeof i;a&&(Rn(i,"name")||Pn(i,"name",r)),t[r]!==i&&(a&&(Rn(i,e)||Pn(i,e,t[r]?""+t[r]:n.join(String(r)))),t===yn?t[r]=i:o?t[r]?t[r]=i:Pn(t,r,i):(delete t[r],Pn(t,r,i)))})(Function.prototype,"toString",(function toString(){return"function"==typeof this&&this[e]||jn.call(this)}))})),Fn=function(t,e,n){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},Un=function(t,e,n){var r,i,o,a,s=t&Un.F,u=t&Un.G,l=t&Un.S,c=t&Un.P,h=t&Un.B,d=u?yn:l?yn[e]||(yn[e]={}):(yn[e]||{}).prototype,f=u?gn:gn[e]||(gn[e]={}),p=f.prototype||(f.prototype={});for(r in u&&(n=e),n)o=((i=!s&&d&&void 0!==d[r])?d:n)[r],a=h&&i?Fn(o,yn):c&&"function"==typeof o?Fn(Function.call,o):o,d&&Nn(d,r,o,t&Un.U),f[r]!=o&&Pn(f,r,a),c&&p[r]!=o&&(p[r]=o)};yn.core=gn,Un.F=1,Un.G=2,Un.S=4,Un.P=8,Un.B=16,Un.W=32,Un.U=64,Un.R=128;var Gn,zn=Un,Vn={},qn={}.toString,Zn=function(t){return qn.call(t).slice(8,-1)},Wn=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==Zn(t)?t.split(""):Object(t)},Yn=function(t){return Wn(mn(t))},Bn=Math.min,Kn=function(t){return t>0?Bn(pn(t),9007199254740991):0},Hn=Math.max,Xn=Math.min,$n=Dn("keys"),Qn=function(t){return $n[t]||($n[t]=An(t))},Jn=(Gn=!1,function(t,e,n){var r,i=Yn(t),o=Kn(i.length),a=function(t,e){return(t=pn(t))<0?Hn(t+e,0):Xn(t,e)}(n,o);if(Gn&&e!=e){for(;o>a;)if((r=i[a++])!=r)return!0}else for(;o>a;a++)if((Gn||a in i)&&i[a]===e)return Gn||a||0;return!Gn&&-1}),tr=Qn("IE_PROTO"),er="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),nr=Object.keys||function keys(t){return function(t,e){var n,r=Yn(t),i=0,o=[];for(n in r)n!=tr&&Rn(r,n)&&o.push(n);for(;e.length>i;)Rn(r,n=e[i++])&&(~Jn(o,n)||o.push(n));return o}(t,er)},rr=Tn?Object.defineProperties:function defineProperties(t,e){_n(t);for(var n,r=nr(e),i=r.length,o=0;i>o;)xn.f(t,n=r[o++],e[n]);return t},ir=yn.document,or=ir&&ir.documentElement,ar=Qn("IE_PROTO"),sr=function(){},ur=function(){var t,e=Sn("iframe"),n=er.length;for(e.style.display="none",or.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ur=t.F;n--;)delete ur.prototype[er[n]];return ur()},lr=Object.create||function create(t,e){var n;return null!==t?(sr.prototype=_n(t),n=new sr,sr.prototype=null,n[ar]=t):n=ur(),void 0===e?n:rr(n,e)},cr=createCommonjsModule((function(t){var e=Dn("wks"),n=yn.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:An)("Symbol."+t))}).store=e})),hr=xn.f,dr=cr("toStringTag"),fr=function(t,e,n){t&&!Rn(t=n?t:t.prototype,dr)&&hr(t,dr,{configurable:!0,value:e})},pr={};Pn(pr,cr("iterator"),(function(){return this}));var mr,yr=function(t,e,n){t.prototype=lr(pr,{next:Cn(1,n)}),fr(t,e+" Iterator")},gr=function(t){return Object(mn(t))},vr=Qn("IE_PROTO"),_r=Object.prototype,br=Object.getPrototypeOf||function(t){return t=gr(t),Rn(t,vr)?t[vr]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?_r:null},Tr=cr("iterator"),wr=!([].keys&&"next"in[].keys()),Er=function(){return this},Sr=(mr=!0,function(t,e){var n,r,i=String(mn(t)),o=pn(e),a=i.length;return o<0||o>=a?mr?"":void 0:(n=i.charCodeAt(o))<55296||n>56319||o+1===a||(r=i.charCodeAt(o+1))<56320||r>57343?mr?i.charAt(o):n:mr?i.slice(o,o+2):r-56320+(n-55296<<10)+65536});!function(t,e,n,r,i,o,a){yr(n,e,r);var s,u,l,c=function(t){if(!wr&&t in p)return p[t];switch(t){case"keys":return function keys(){return new n(this,t)};case"values":return function values(){return new n(this,t)}}return function entries(){return new n(this,t)}},h=e+" Iterator",d="values"==i,f=!1,p=t.prototype,m=p[Tr]||p["@@iterator"]||i&&p[i],y=m||c(i),g=i?d?c("entries"):y:void 0,v="Array"==e&&p.entries||m;if(v&&(l=br(v.call(new t)))!==Object.prototype&&l.next&&(fr(l,h,!0),"function"!=typeof l[Tr]&&Pn(l,Tr,Er)),d&&m&&"values"!==m.name&&(f=!0,y=function values(){return m.call(this)}),(wr||f||!p[Tr])&&Pn(p,Tr,y),Vn[e]=y,Vn[h]=Er,i)if(s={values:d?y:c("values"),keys:o?y:c("keys"),entries:g},a)for(u in s)u in p||Nn(p,u,s[u]);else zn(zn.P+zn.F*(wr||f),e,s)}(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=Sr(e,n),this._i+=t.length,{value:t,done:!1})}));var Mr=function(t,e,n,r){try{return r?e(_n(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&_n(i.call(t)),e}},Or=cr("iterator"),xr=Array.prototype,Cr=function(t){return void 0!==t&&(Vn.Array===t||xr[Or]===t)},Pr=function(t,e,n){e in t?xn.f(t,e,Cn(0,n)):t[e]=n},Ir=cr("toStringTag"),Rr="Arguments"==Zn(function(){return arguments}()),Lr=cr("iterator"),kr=gn.getIteratorMethod=function(t){if(null!=t)return t[Lr]||t["@@iterator"]||Vn[function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Ir))?n:Rr?Zn(e):"Object"==(r=Zn(e))&&"function"==typeof e.callee?"Arguments":r}(t)]},Ar=cr("iterator"),Dr=!1;try{var jr=[7][Ar]();jr.return=function(){Dr=!0},Array.from(jr,(function(){throw 2}))}catch(t){}zn(zn.S+zn.F*!function(t,e){if(!e&&!Dr)return!1;var n=!1;try{var r=[7],i=r[Ar]();i.next=function(){return{done:n=!0}},r[Ar]=function(){return i},t(r)}catch(t){}return n}((function(t){Array.from(t)})),"Array",{from:function from(t){var e,n,r,i,o=gr(t),a="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,l=void 0!==u,c=0,h=kr(o);if(l&&(u=Fn(u,s>2?arguments[2]:void 0,2)),null==h||a==Array&&Cr(h))for(n=new a(e=Kn(o.length));e>c;c++)Pr(n,c,l?u(o[c],c):o[c]);else for(i=h.call(o),n=new a;!(r=i.next()).done;c++)Pr(n,c,l?Mr(i,u,[r.value,c],!0):r.value);return n.length=c,n}});gn.Array.from;var Nr="\t\n\v\f\r \u2028\u2029\ufeff",Fr="["+Nr+"]",Ur=RegExp("^"+Fr+Fr+"*"),Gr=RegExp(Fr+Fr+"*$"),zr=function(t,e,n){var r={},i=bn((function(){return!!Nr[t]()||""!=""[t]()})),o=r[t]=i?e(Vr):Nr[t];n&&(r[n]=o),zn(zn.P+zn.F*i,"String",r)},Vr=zr.trim=function(t,e){return t=String(mn(t)),1&e&&(t=t.replace(Ur,"")),2&e&&(t=t.replace(Gr,"")),t},qr=zr,Zr=yn.parseInt,Wr=qr.trim,Yr=/^[-+]?0[xX]/,Br=8!==Zr(Nr+"08")||22!==Zr(Nr+"0x16")?function parseInt(t,e){var n=Wr(String(t),3);return Zr(n,e>>>0||(Yr.test(n)?16:10))}:Zr;zn(zn.S+zn.F*(Number.parseInt!=Br),"Number",{parseInt:Br});gn.Number.parseInt;var Kr=createCommonjsModule((function(t){(t.exports={}).forEach=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n]);if(r)return r}}})),Hr=createCommonjsModule((function(t){var e=t.exports={};e.isIE=function(t){return!!function isAnyIeVersion(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("msie")||-1!==t.indexOf("trident")||-1!==t.indexOf(" edge/")}()&&(!t||t===function(){var t=3,e=document.createElement("div"),n=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(n[0]);return t>4?t:void 0}())},e.isLegacyOpera=function(){return!!window.opera}})),Xr=createCommonjsModule((function(t){(t.exports={}).getOption=function getOption(t,e,n){var r=t[e];if(null==r&&void 0!==n)return n;return r}})),$r=function batchProcessorMaker(t){var e=(t=t||{}).reporter,n=Xr.getOption(t,"async",!0),r=Xr.getOption(t,"auto",!0);r&&!n&&(e&&e.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),n=!0);var i,o=Batch(),a=!1;function processBatch(){for(a=!0;o.size();){var t=o;o=Batch(),t.process()}a=!1}function processBatchAsync(){i=function requestFrame(t){return e=t,setTimeout(e,0);var e}(processBatch)}return{add:function addFunction(t,e){!a&&r&&n&&0===o.size()&&processBatchAsync(),o.add(t,e)},force:function forceProcessBatch(t){a||(void 0===t&&(t=n),i&&(!function cancelFrame(t){return clearTimeout(t)}(i),i=null),t?processBatchAsync():processBatch())}}};function Batch(){var t={},e=0,n=0,r=0;return{add:function add(i,o){o||(o=i,i=0),i>n?n=i:i<r&&(r=i),t[i]||(t[i]=[]),t[i].push(o),e++},process:function process(){for(var e=r;e<=n;e++)for(var i=t[e],o=0;o<i.length;o++){(0,i[o])()}},size:function getSize(){return e}}}var Qr="_erd";function getState(t){return t[Qr]}var Jr={initState:function initState(t){return t[Qr]={},getState(t)},getState:getState,cleanState:function cleanState(t){delete t[Qr]}},ti=Kr.forEach,ei=function(t){var e=(t=t||{}).reporter,n=t.batchProcessor,r=t.stateHandler.getState,i=(t.stateHandler.hasState,t.idHandler);if(!n)throw new Error("Missing required dependency: batchProcessor");if(!e)throw new Error("Missing required dependency: reporter.");var o=function getScrollbarSizes(){var t=document.createElement("div");t.style.cssText="position: absolute; width: 1000px; height: 1000px; visibility: hidden; margin: 0; padding: 0;";var e=document.createElement("div");e.style.cssText="position: absolute; width: 500px; height: 500px; overflow: scroll; visibility: none; top: -1500px; left: -1500px; visibility: hidden; margin: 0; padding: 0;",e.appendChild(t),document.body.insertBefore(e,document.body.firstChild);var n=500-e.clientWidth,r=500-e.clientHeight;return document.body.removeChild(e),{width:n,height:r}}(),a="erd_scroll_detection_container";function addEvent(t,n,r){if(t.addEventListener)t.addEventListener(n,r);else{if(!t.attachEvent)return e.error("[scroll] Don't know how to add event listeners.");t.attachEvent("on"+n,r)}}function removeEvent(t,n,r){if(t.removeEventListener)t.removeEventListener(n,r);else{if(!t.detachEvent)return e.error("[scroll] Don't know how to remove event listeners.");t.detachEvent("on"+n,r)}}function getExpandElement(t){return r(t).container.childNodes[0].childNodes[0].childNodes[0]}function getShrinkElement(t){return r(t).container.childNodes[0].childNodes[0].childNodes[1]}return function injectScrollStyle(t,e){if(!document.getElementById(t)){var n=e+"_animation",r="/* Created by the element-resize-detector library. */\n";r+="."+e+" > div::-webkit-scrollbar { display: none; }\n\n",r+="."+(e+"_animation_active")+" { -webkit-animation-duration: 0.1s; animation-duration: 0.1s; -webkit-animation-name: "+n+"; animation-name: "+n+"; }\n",r+="@-webkit-keyframes "+n+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",function injectStyle(e,n){n=n||function(t){document.head.appendChild(t)};var r=document.createElement("style");return r.innerHTML=e,r.id=t,n(r),r}(r+="@keyframes "+n+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}("erd_scroll_detection_scrollbar_style",a),{makeDetectable:function makeDetectable(t,s,u){function debug(){if(t.debug){var n=Array.prototype.slice.call(arguments);if(n.unshift(i.get(s),"Scroll: "),e.log.apply)e.log.apply(null,n);else for(var r=0;r<n.length;r++)e.log(n[r])}}function isUnrendered(t){var e=r(t).container.childNodes[0],n=window.getComputedStyle(e);return!n.width||-1===n.width.indexOf("px")}function getStyle(){var t=window.getComputedStyle(s),e={};return e.position=t.position,e.width=s.offsetWidth,e.height=s.offsetHeight,e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left,e.widthCSS=t.width,e.heightCSS=t.height,e}function storeStyle(){if(debug("storeStyle invoked."),r(s)){var t=getStyle();r(s).style=t}else debug("Aborting because element has been uninstalled")}function storeCurrentSize(t,e,n){r(t).lastWidth=e,r(t).lastHeight=n}function getWidthOffset(){return 2*o.width+1}function getHeightOffset(){return 2*o.height+1}function getExpandWidth(t){return t+10+getWidthOffset()}function getExpandHeight(t){return t+10+getHeightOffset()}function positionScrollbars(t,e,n){var r=getExpandElement(t),i=getShrinkElement(t),o=getExpandWidth(e),a=getExpandHeight(n),s=function getShrinkWidth(t){return 2*t+getWidthOffset()}(e),u=function getShrinkHeight(t){return 2*t+getHeightOffset()}(n);r.scrollLeft=o,r.scrollTop=a,i.scrollLeft=s,i.scrollTop=u}function injectContainerElement(){var t=r(s).container;if(!t){(t=document.createElement("div")).className=a,t.style.cssText="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0; padding: 0;",r(s).container=t,function addAnimationClass(t){t.className+=" "+a+"_animation_active"}(t),s.appendChild(t);var e=function(){r(s).onRendered&&r(s).onRendered()};addEvent(t,"animationstart",e),r(s).onAnimationStart=e}return t}function injectScrollElements(){if(debug("Injecting elements"),r(s)){!function alterPositionStyles(){var t=r(s).style;if("static"===t.position){s.style.position="relative";var n=function(t,e,n,r){var i=n[r];"auto"!==i&&"0"!==function getNumericalValue(t){return t.replace(/[^-\d\.]/g,"")}(i)&&(t.warn("An element that is positioned static has style."+r+"="+i+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+r+" will be set to 0. Element: ",e),e.style[r]=0)};n(e,s,t,"top"),n(e,s,t,"right"),n(e,s,t,"bottom"),n(e,s,t,"left")}}();var t=r(s).container;t||(t=injectContainerElement());var n=o.width,i=o.height,u="position: absolute; flex: none; overflow: hidden; z-index: -1; visibility: hidden; "+function getLeftTopBottomRightCssText(t,e,n,r){return"left: "+(t=t?t+"px":"0")+"; top: "+(e=e?e+"px":"0")+"; right: "+(r=r?r+"px":"0")+"; bottom: "+(n=n?n+"px":"0")+";"}(-(1+n),-(1+i),-i,-n),l=document.createElement("div"),c=document.createElement("div"),h=document.createElement("div"),d=document.createElement("div"),f=document.createElement("div"),p=document.createElement("div");l.dir="ltr",l.style.cssText="position: absolute; flex: none; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;",l.className=a,c.className=a,c.style.cssText=u,h.style.cssText="position: absolute; flex: none; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;",d.style.cssText="position: absolute; left: 0; top: 0;",f.style.cssText="position: absolute; flex: none; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;",p.style.cssText="position: absolute; width: 200%; height: 200%;",h.appendChild(d),f.appendChild(p),c.appendChild(h),c.appendChild(f),l.appendChild(c),t.appendChild(l),addEvent(h,"scroll",onExpandScroll),addEvent(f,"scroll",onShrinkScroll),r(s).onExpandScroll=onExpandScroll,r(s).onShrinkScroll=onShrinkScroll}else debug("Aborting because element has been uninstalled");function onExpandScroll(){r(s).onExpand&&r(s).onExpand()}function onShrinkScroll(){r(s).onShrink&&r(s).onShrink()}}function registerListenersAndPositionElements(){function updateChildSizes(t,e,n){var r=function getExpandChildElement(t){return getExpandElement(t).childNodes[0]}(t),i=getExpandWidth(e),o=getExpandHeight(n);r.style.width=i+"px",r.style.height=o+"px"}function updateDetectorElements(o){var a=s.offsetWidth,u=s.offsetHeight;debug("Storing current size",a,u),storeCurrentSize(s,a,u),n.add(0,(function performUpdateChildSizes(){if(r(s))if(areElementsInjected()){if(t.debug){var n=s.offsetWidth,o=s.offsetHeight;n===a&&o===u||e.warn(i.get(s),"Scroll: Size changed before updating detector elements.")}updateChildSizes(s,a,u)}else debug("Aborting because element container has not been initialized");else debug("Aborting because element has been uninstalled")})),n.add(1,(function updateScrollbars(){r(s)?areElementsInjected()?positionScrollbars(s,a,u):debug("Aborting because element container has not been initialized"):debug("Aborting because element has been uninstalled")})),o&&n.add(2,(function(){r(s)?areElementsInjected()?o():debug("Aborting because element container has not been initialized"):debug("Aborting because element has been uninstalled")}))}function areElementsInjected(){return!!r(s).container}function notifyListenersIfNeeded(){debug("notifyListenersIfNeeded invoked");var t=r(s);return function isFirstNotify(){return void 0===r(s).lastNotifiedWidth}()&&t.lastWidth===t.startSize.width&&t.lastHeight===t.startSize.height?debug("Not notifying: Size is the same as the start size, and there has been no notification yet."):t.lastWidth===t.lastNotifiedWidth&&t.lastHeight===t.lastNotifiedHeight?debug("Not notifying: Size already notified"):(debug("Current size not notified, notifying..."),t.lastNotifiedWidth=t.lastWidth,t.lastNotifiedHeight=t.lastHeight,void ti(r(s).listeners,(function(t){t(s)})))}function handleScroll(){if(debug("Scroll detected."),isUnrendered(s))debug("Scroll event fired while unrendered. Ignoring...");else{var t=s.offsetWidth,e=s.offsetHeight;t!==r(s).lastWidth||e!==r(s).lastHeight?(debug("Element size changed."),updateDetectorElements(notifyListenersIfNeeded)):debug("Element size has not changed ("+t+"x"+e+").")}}if(debug("registerListenersAndPositionElements invoked."),r(s)){r(s).onRendered=function handleRender(){if(debug("startanimation triggered."),isUnrendered(s))debug("Ignoring since element is still unrendered...");else{debug("Element rendered.");var t=getExpandElement(s),e=getShrinkElement(s);0!==t.scrollLeft&&0!==t.scrollTop&&0!==e.scrollLeft&&0!==e.scrollTop||(debug("Scrollbars out of sync. Updating detector elements..."),updateDetectorElements(notifyListenersIfNeeded))}},r(s).onExpand=handleScroll,r(s).onShrink=handleScroll;var o=r(s).style;updateChildSizes(s,o.width,o.height)}else debug("Aborting because element has been uninstalled")}function finalizeDomMutation(){if(debug("finalizeDomMutation invoked."),r(s)){var t=r(s).style;storeCurrentSize(s,t.width,t.height),positionScrollbars(s,t.width,t.height)}else debug("Aborting because element has been uninstalled")}function ready(){u(s)}function install(){debug("Installing..."),function initListeners(){r(s).listeners=[]}(),function storeStartSize(){var t=getStyle();r(s).startSize={width:t.width,height:t.height},debug("Element start size",r(s).startSize)}(),n.add(0,storeStyle),n.add(1,injectScrollElements),n.add(2,registerListenersAndPositionElements),n.add(3,finalizeDomMutation),n.add(4,ready)}u||(u=s,s=t,t=null),t=t||{},debug("Making detectable..."),!function isDetached(t){return!function isInDocument(t){return t===t.ownerDocument.body||t.ownerDocument.body.contains(t)}(t)||null===window.getComputedStyle(t)}(s)?install():(debug("Element is detached"),injectContainerElement(),debug("Waiting until element is attached..."),r(s).onRendered=function(){debug("Element is now attached"),install()})},addListener:function addListener(t,e){if(!r(t).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");r(t).listeners.push(e)},uninstall:function uninstall(t){var e=r(t);e&&(e.onExpandScroll&&removeEvent(getExpandElement(t),"scroll",e.onExpandScroll),e.onShrinkScroll&&removeEvent(getShrinkElement(t),"scroll",e.onShrinkScroll),e.onAnimationStart&&removeEvent(e.container,"animationstart",e.onAnimationStart),e.container&&t.removeChild(e.container))}}},ni=Kr.forEach;function isCollection(t){return Array.isArray(t)||void 0!==t.length}function toArray(t){if(Array.isArray(t))return t;var e=[];return ni(t,(function(t){e.push(t)})),e}function isElement(t){return t&&1===t.nodeType}var ri=function(t){var e,n;if((t=t||{}).idHandler)e={get:function(e){return t.idHandler.get(e,!0)},set:t.idHandler.set};else{var r=function(t){var e=t.idGenerator,n=t.stateHandler.getState;return{get:function getId(t){var e=n(t);return e&&void 0!==e.id?e.id:null},set:function setId(t){var r=n(t);if(!r)throw new Error("setId required the element to have a resize detection state.");var i=e.generate();return r.id=i,i}}}({idGenerator:(n=1,{generate:function generate(){return n++}}),stateHandler:Jr});e=r}var i=t.reporter;i||(i=function(t){function noop(){}var e={log:noop,warn:noop,error:noop};if(!t&&window.console){var n=function(t,e){t[e]=function reporterProxy(){var t=console[e];if(t.apply)t.apply(console,arguments);else for(var n=0;n<arguments.length;n++)t(arguments[n])}};n(e,"log"),n(e,"warn"),n(e,"error")}return e}(!1===i));var o=getOption(t,"batchProcessor",$r({reporter:i})),a={};a.callOnAdd=!!getOption(t,"callOnAdd",!0),a.debug=!!getOption(t,"debug",!1);var s,u=function(t){var e={};function getListeners(n){var r=t.get(n);return void 0===r?[]:e[r]||[]}return{get:getListeners,add:function addListener(n,r){var i=t.get(n);e[i]||(e[i]=[]),e[i].push(r)},removeListener:function removeListener(t,e){for(var n=getListeners(t),r=0,i=n.length;r<i;++r)if(n[r]===e){n.splice(r,1);break}},removeAllListeners:function removeAllListeners(t){var e=getListeners(t);e&&(e.length=0)}}}(e),l=function(t){var e=t.stateHandler.getState;return{isDetectable:function isDetectable(t){var n=e(t);return n&&!!n.isDetectable},markAsDetectable:function markAsDetectable(t){e(t).isDetectable=!0},isBusy:function isBusy(t){return!!e(t).busy},markBusy:function markBusy(t,n){e(t).busy=!!n}}}({stateHandler:Jr}),c=getOption(t,"strategy","object"),h={reporter:i,batchProcessor:o,stateHandler:Jr,idHandler:e};if("scroll"===c&&(Hr.isLegacyOpera()?(i.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),c="object"):Hr.isIE(9)&&(i.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),c="object")),"scroll"===c)s=ei(h);else{if("object"!==c)throw new Error("Invalid strategy name: "+c);s=function(t){var e=(t=t||{}).reporter,n=t.batchProcessor,r=t.stateHandler.getState;if(!e)throw new Error("Missing required dependency: reporter.");function getObject(t){return r(t).object}return{makeDetectable:function makeDetectable(t,i,o){o||(o=i,i=t,t=null),(t=t||{}).debug,Hr.isIE(8)?o(i):function injectObject(t,i){var o="display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; padding: 0; margin: 0; opacity: 0; z-index: -1000; pointer-events: none;",a=!1,s=window.getComputedStyle(t),u=t.offsetWidth,l=t.offsetHeight;function mutateDom(){function alterPositionStyles(){if("static"===s.position){t.style.position="relative";var n=function(t,e,n,r){var i=n[r];"auto"!==i&&"0"!==function getNumericalValue(t){return t.replace(/[^-\d\.]/g,"")}(i)&&(t.warn("An element that is positioned static has style."+r+"="+i+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+r+" will be set to 0. Element: ",e),e.style[r]=0)};n(e,t,s,"top"),n(e,t,s,"right"),n(e,t,s,"bottom"),n(e,t,s,"left")}}""!==s.position&&(alterPositionStyles(),a=!0);var n=document.createElement("object");n.style.cssText=o,n.tabIndex=-1,n.type="text/html",n.setAttribute("aria-hidden","true"),n.onload=function onObjectLoad(){a||alterPositionStyles(),function getDocument(t,e){t.contentDocument?e(t.contentDocument):setTimeout((function checkForObjectDocument(){getDocument(t,e)}),100)}(this,(function onObjectDocumentReady(e){i(t)}))},Hr.isIE()||(n.data="about:blank"),t.appendChild(n),r(t).object=n,Hr.isIE()&&(n.data="about:blank")}r(t).startSize={width:u,height:l},n?n.add(mutateDom):mutateDom()}(i,o)},addListener:function addListener(t,e){if(!getObject(t))throw new Error("Element is not detectable by this strategy.");function listenerProxy(){e(t)}Hr.isIE(8)?(r(t).object={proxy:listenerProxy},t.attachEvent("onresize",listenerProxy)):getObject(t).contentDocument.defaultView.addEventListener("resize",listenerProxy)},uninstall:function uninstall(t){Hr.isIE(8)?t.detachEvent("onresize",r(t).object.proxy):t.removeChild(getObject(t)),delete r(t).object}}}(h)}var d={};return{listenTo:function listenTo(t,n,r){function onResizeCallback(t){var e=u.get(t);ni(e,(function callListenerProxy(e){e(t)}))}function addListener(t,e,n){u.add(e,n),t&&n(e)}if(r||(r=n,n=t,t={}),!n)throw new Error("At least one element required.");if(!r)throw new Error("Listener required.");if(isElement(n))n=[n];else{if(!isCollection(n))return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");n=toArray(n)}var o=0,c=getOption(t,"callOnAdd",a.callOnAdd),h=getOption(t,"onReady",(function noop(){})),f=getOption(t,"debug",a.debug);ni(n,(function attachListenerToElement(t){Jr.getState(t)||(Jr.initState(t),e.set(t));var a=e.get(t);if(f&&i.log("Attaching listener to element",a,t),!l.isDetectable(t))return f&&i.log(a,"Not detectable."),l.isBusy(t)?(f&&i.log(a,"System busy making it detectable"),addListener(c,t,r),d[a]=d[a]||[],void d[a].push((function onReady(){++o===n.length&&h()}))):(f&&i.log(a,"Making detectable..."),l.markBusy(t,!0),s.makeDetectable({debug:f},t,(function onElementDetectable(t){if(f&&i.log(a,"onElementDetectable"),Jr.getState(t)){l.markAsDetectable(t),l.markBusy(t,!1),s.addListener(t,onResizeCallback),addListener(c,t,r);var e=Jr.getState(t);if(e&&e.startSize){var u=t.offsetWidth,p=t.offsetHeight;e.startSize.width===u&&e.startSize.height===p||onResizeCallback(t)}d[a]&&ni(d[a],(function(t){t()}))}else f&&i.log(a,"Element uninstalled before being detectable.");delete d[a],++o===n.length&&h()})));f&&i.log(a,"Already detecable, adding listener."),addListener(c,t,r),o++})),o===n.length&&h()},removeListener:u.removeListener,removeAllListeners:u.removeAllListeners,uninstall:function uninstall(t){if(!t)return i.error("At least one element is required.");if(isElement(t))t=[t];else{if(!isCollection(t))return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");t=toArray(t)}ni(t,(function(t){u.removeAllListeners(t),s.uninstall(t),Jr.cleanState(t)}))}}};function getOption(t,e,n){var r=t[e];return null==r&&void 0!==n?n:r}var ii=function TimeFrame(t){_classCallCheck(this,TimeFrame),this.beginTime=t.beginTime,this.endTime=t.endTime,this.useDateFormat=!1,this.element=document.createElement("div"),this.element.style["flex-grow"]=t.weight,this.element.classList.add("fmi-metoclient-timeslider-frame"),this.element.classList.add(t.type),this.element.dataset.time=this.endTime,this.dragListenerElement=document.createElement("div"),this.dragListenerElement.classList.add("fmi-metoclient-timeslider-drag-listener"),this.dragListenerElement.style.pointerEvents="none",this.element.appendChild(this.dragListenerElement),this.keyboardAccessibleElement=document.createElement("button"),this.keyboardAccessibleElement.classList.add("fmi-metoclient-timeslider-keyboard-accessible"),this.keyboardAccessibleElement.style.pointerEvents="none",this.element.appendChild(this.keyboardAccessibleElement)},oi=2147483647,ai=1e3,si="fmi-metoclient-timeslider-frames-container",ui="fmi-metoclient-timeslider-frame-tick",li="fmi-metoclient-timeslider-frame-text-wrapper",ci="fmi-metoclient-timeslider-frame-text",hi="fmi-metoclient-timeslider-indicator",di="fmi-metoclient-timeslider-hidden",fi=9e5,pi={sources:{},time:null,timeZone:"Europe/Helsinki",timeZoneLabel:"",container:"map",resolutions:[2048,1024,512,256,128,64],metadata:{refreshInterval:"map"},delay:ai,periodDelay:2*ai,texts:{"Zoom In":"Zoom In","Zoom Out":"Zoom Out"}},mi="postrender",yi="movestart",gi="moveend";
/**
   * @fileoverview Constant definitions for the animator.
   * @author Finnish Meteorological Institute
   * @license MIT
   */function createCanvasContext2D(t,e){var n=document.createElement("canvas");return t&&(n.width=t),e&&(n.height=e),n.getContext("2d")}function replaceNode(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)}function removeNode(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var vi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),_i=function(t){function Control(e){var n=t.call(this)||this;return n.element=e.element?e.element:null,n.target_=null,n.map_=null,n.listenerKeys=[],n.render=e.render?e.render:VOID,e.target&&n.setTarget(e.target),n}return vi(Control,t),Control.prototype.disposeInternal=function(){removeNode(this.element),t.prototype.disposeInternal.call(this)},Control.prototype.getMap=function(){return this.map_},Control.prototype.setMap=function(t){this.map_&&removeNode(this.element);for(var e=0,n=this.listenerKeys.length;e<n;++e)unlistenByKey(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==VOID&&this.listenerKeys.push(listen(t,mi,this.render,this)),t.render())},Control.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},Control}(nn),bi=function(t){function TimeSlider(t){var e;_classCallCheck(this,TimeSlider);var n=t||{},r=document.createElement("div");return r.className="ol-unselectable ol-control fmi-metoclient-timeslider",(e=_possibleConstructorReturn(this,_getPrototypeOf(TimeSlider).call(this,{element:r,target:n.target}))).container_=r,e.config_=n,e.callbacks_=n.callbacks,e.visualPointer_=null,e.playButton_=null,e.animationPlay_=!1,e.frames_=[],e.locale_=n.locale,e.timeZone_=n.timeZone,e.timeZoneLabel_=n.timeZoneLabel,e.previousTickTextTop_=Number.POSITIVE_INFINITY,e.previousTickTextRight_=Number.NEGATIVE_INFINITY,e.previousTickTextBottom_=Number.NEGATIVE_INFINITY,e.previousTickTextLeft_=Number.POSITIVE_INFINITY,e.previousTickIndex_=-1,e.mouseListeners_=[],e.dragging_=!1,e.resizeDetector=ri(),e.timeListener=null,e.playingListener=null,e}return _inherits(TimeSlider,t),_createClass(TimeSlider,[{key:"createTimeSlider",value:function createTimeSlider(t){var e=this;this.clear(),this.createContainers(t),this.createFrames(t),this.createIndicators(),this.createTicks(),this.createPointer(),null!=this.getMap().get("time")&&this.updatePointer(this.getMap().get("time")),null!=this.callbacks_&&"function"==typeof this.callbacks_.timeSliderCreated&&this.callbacks_.timeSliderCreated(t),this.timeListener=this.getMap().on("change:time",(function(t){e.setAnimationTime(t.target.get("time"))})),this.playingListener=this.getMap().on("change:playing",(function(t){e.setAnimationPlay(t.target.get("playing"))}))}},{key:"step",value:function step(t){t>0?this.getMap().dispatchEvent("next"):t<0&&this.getMap().dispatchEvent("previous")}},{key:"createContainers",value:function createContainers(t){var e=this,n=document.createElement("div");n.classList.add("fmi-metoclient-timeslider-clickable-container"),n.appendChild(this.createPreMargin()),n.appendChild(this.createPreTools());var r=document.createElement("div");r.classList.add(si),n.appendChild(r),n.appendChild(this.createPostTools(t));var i=document.createElement("div");i.classList.add("fmi-metoclient-timeslider-post-margin"),this.mouseListeners_.push(hn(i,"click",(function(t){e.step(1)}))),n.appendChild(i),n.appendChild(this.createTimeZoneLabel()),this.container_.appendChild(n),this.container_.classList.add("noselect"),this.mouseListeners_.push(hn(this.container_,"mouseup",(function(t){e.setDragging(!1),document.activeElement.blur()}))),this.mouseListeners_.push(hn(this.container_,"touchend",(function(t){e.setDragging(!1),document.activeElement.blur()}))),this.resizeDetector.listenTo(this.container_.getElementsByClassName(si)[0],(function(t){e.createTicks()}))}},{key:"createPreMargin",value:function createPreMargin(){var t=this,e=document.createElement("div");return e.classList.add("fmi-metoclient-timeslider-pre-margin"),this.mouseListeners_.push(hn(e,"click",(function(){t.step(-1)}))),e}},{key:"createPreTools",value:function createPreTools(){var t=this,e=document.createElement("div");e.classList.add("fmi-metoclient-timeslider-pre-tools");var n=document.createElement("button");return n.classList.add("fmi-metoclient-timeslider-play-button"),n.tabIndex=100,this.animationPlay_&&n.classList.add("playing"),this.mouseListeners_.push(hn(n,"click",(function(){event.preventDefault();var e=t.getMap();e.set("playing",!e.get("playing"))}))),this.playButton_=n,e.appendChild(n),e}},{key:"createPostTools",value:function createPostTools(t){var e=this,n=this,r=document.createElement("div");r.classList.add("fmi-metoclient-timeslider-post-tools");var i=document.createElement("button");return i.classList.add("fmi-metoclient-timeslider-step-button"),i.tabIndex=110+t.length,r.appendChild(i),this.mouseListeners_.push(hn(i,"click",(function(){e.config_.showTimeSliderMenu||null!=n.callbacks_&&"function"==typeof n.callbacks_.toolClicked&&e.callbacks_.toolClicked("timeslider-right-button")}))),this.config_.showTimeSliderMenu,r}},{key:"createTimeZoneLabel",value:function createTimeZoneLabel(){var t=document.createElement("div");return t.innerHTML=this.timeZoneLabel_,t.classList.add("fmi-metoclient-timeslider-timezone"),t}},{key:"createFrames",value:function createFrames(t){var e,n,r,i,o,a,s=t.length,u=Date.now(),l=this.container_.getElementsByClassName(si)[0];if(on(l),!(s<2)){var c=t[s-1]-t[0];for(e=0;e<s;e++)n=0===e?2*t[0]-t[1]:t[e-1],r=t[e],i=t[e]<=u?"history":"future",o=100*(r-n)/c,(a=this.createFrame(n,r,i,o)).element.getElementsByClassName("fmi-metoclient-timeslider-keyboard-accessible")[0].tabIndex=100+e,l.appendChild(a.element),this.frames_.push(a)}}},{key:"createFrame",value:function createFrame(t,e,n,r){var i,o,a=this,s=this,u=new ii({beginTime:t,endTime:e,type:n,weight:r}),l=0,c=0;return this.mouseListeners_.push(hn(u.element,"mousedown",(function(){i=setTimeout((function(){clearTimeout(c),i=null,a.getMap().set("time",u.endTime)}),500)}))),this.mouseListeners_.push(hn(u.element,"mouseup",(function(){null==i||s.dragging_||(clearTimeout(i),1===++l?c=setTimeout((function(){clearTimeout(i),l=0,u.endTime===a.getMap().get("time")?a.getMap().set("time",u.beginTime):s.step(u.endTime-a.getMap().get("time"))}),300):2===l&&(clearTimeout(c),l=0,a.getMap().set("time",u.endTime)))}))),this.mouseListeners_.push(hn(u.element,"mouseout",(function(){null!=i&&clearTimeout(i)}))),this.mouseListeners_.push(hn(u.element,"touchstart",(function(){o=setTimeout((function(){o=null,a.getMap().set("time",u.endTime)}),500)}))),this.mouseListeners_.push(hn(u.element,"touchend",(function(){null!=o&&clearTimeout(o)}))),this.mouseListeners_.push(hn(u.element,"touchcancel",(function(){null!=o&&clearTimeout(o)}))),this.mouseListeners_.push(hn(u.dragListenerElement,"mousemove",(function(t){s.dragging_&&(document.activeElement.blur(),a.getMap().set("time",u.endTime))}))),this.mouseListeners_.push(hn(u.element,"touchmove",(function(t){if(s.dragging_&&void 0!==t.changedTouches[0]){for(var e,n,r=t.changedTouches[0].clientX,i=a.frames_.length,o=0;o<i;o++)if((n=a.frames_[o].element.getBoundingClientRect()).left<=r&&r<=n.right){e=a.frames_[o];break}document.activeElement.blur(),a.getMap().set("time",e.endTime)}}))),u}},{key:"createIndicators",value:function createIndicators(){this.frames_.forEach((function(t,e,n){var r=document.createElement("div");r.classList.add(hi),0===e?r.classList.add("first"):e===n.length-1&&r.classList.add("last"),t.element.appendChild(r)}))}},{key:"createTicks",value:function createTicks(){var t,e,n,r,i=[6e4,12e4,3e5,6e5,9e5,12e5,18e5,36e5,72e5,108e5,144e5,216e5,288e5,432e5,864e5],o=i.length,a=0,s=0,u=!0;do{if(s>10){this.configureTicks();break}if(n=a,u=this.configureTicks(n),t=0,e=-1,a=s>0?n:Number.POSITIVE_INFINITY,this.frames_.forEach((function(n,r,i){n.element.getElementsByClassName(ui).length>0&&(e>=0&&(t=n.endTime-i[e].endTime,(0===s&&t<a||0!==s&&t>a)&&(a=t)),e=r)})),a!==n&&(a<36e5&&36e5%a!=0||a>36e5&&a%36e5!=0||a<864e5&&864e5%a!=0))for(r=0;r<o;r++)if(a<i[r]){a=i[r];break}s++}while(u&&a!==n);this.showTicks()}},{key:"configureTicks",value:function configureTicks(){var t,e,n,r,i=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=this,s=0,u=!1,l=!1,c=!1,h=!1;this.previousTickTextTop_=null,this.previousTickTextRight_=Number.NEGATIVE_INFINITY,this.previousTickTextBottom_=null,this.previousTickTextLeft_=null,this.previousTickValue_=null,this.previousTickIndex_=null;var d=function clearFrame(t){var e=function removeChildrenByClass(e){Array.from(t.element.getElementsByClassName(e)).forEach((function(t){t.parentElement.removeChild(t)}))};e(li),e(ui)};this.frames_.forEach((function(t,e,n){d(t);var r=document.createElement("div");r.classList.add(li);var o=document.createElement("span");o.classList.add(ci),o.classList.add("noselect");var a=i.getTickText(t.endTime);o.textContent=a.content,t.useDateFormat=a.useDateFormat,r.appendChild(o),t.element.appendChild(r),t.element.style.display="none"})),this.frames_.forEach((function(t,e,r){var i,o=e+1;if(t.element.style.display="",DateTime.fromMillis(t.endTime).setZone(a.timeZone_).startOf("day").valueOf()===t.endTime&&(l=!0),o!==r.length){var d=t.element.querySelector("span."+ci).getBoundingClientRect();s<d.width&&(s=d.width),i=r[o].endTime-t.endTime,DateTime.fromMillis(t.endTime).setZone(a.timeZone_).isInDST&&i<864e5?c=!0:h=!0,null==n?(u=!0,n=i):u&&i!==n&&(u=!1)}})),c&&h&&(u=!1),u&&(n*=2),e=Math.round(s)+"px",Array.from(this.container_.getElementsByClassName(li)).forEach((function(t){t.style.width=e}));var f=function createTick(e,n,r,i){a.previousTickTextTop_=r.top,a.previousTickTextRight_=r.right,a.previousTickTextBottom_=r.bottom,a.previousTickTextLeft_=r.left,a.previousTickValue_=i,a.previousTickIndex_=n,(t=document.createElement("div")).classList.add(ui),t.classList.add(di),e.element.appendChild(t)};return(r=Array.from(this.container_.getElementsByClassName(si))).length>0&&(r=r[0].getBoundingClientRect()),this.frames_.forEach((function(t,e,i){var s,c,h=Array.from(t.element.getElementsByClassName(li));0!==h.length&&(c=(s=h.shift()).getBoundingClientRect(),0===r.length||r.left<=c.left&&r.right>=c.right&&r.top<=c.top&&r.bottom>=c.bottom?(a.previousTickTextRight_<c.left||a.previousTickTextLeft_>c.right||a.previousTickTextBottom_<c.top||a.previousTickTextTop_>c.bottom)&&(null==a.previousTickIndex_||t.endTime-i[a.previousTickIndex_].endTime>=o)?f(t,e,c,t.endTime):e>0&&a.previousTickIndex_>=0&&null!=i[a.previousTickIndex_]&&(0===o&&(t.endTime%36e5==0&&i[a.previousTickIndex_].endTime%36e5!=0||u&&t.endTime%36e5%n==0&&i[a.previousTickIndex_].endTime%36e5%n!=0||t.endTime%36e5==0&&i[a.previousTickIndex_].endTime%36e5==0&&DateTime.fromMillis(t.endTime).setZone(a.timeZone_).hour%2==0&&DateTime.fromMillis(i[a.previousTickIndex_].endTime).setZone(a.timeZone_).hour%2!=0)&&!i[a.previousTickIndex_].useDateFormat||t.useDateFormat||o>0&&(o>=36e5&&i[a.previousTickIndex_].endTime%36e5!=0||i[a.previousTickIndex_].endTime%36e5%o!=0||l&&DateTime.fromMillis(i[a.previousTickIndex_].endTime).setZone(a.timeZone_).hour%(o/36e5)!=0))?(d(i[a.previousTickIndex_]),f(t,e,c,t.endTime)):t.element.removeChild(s):t.element.removeChild(s))})),u}},{key:"showTicks",value:function showTicks(){Array.from(this.container_.getElementsByClassName(ui)).forEach((function(t){t.classList.remove(di)}))}},{key:"createPointer",value:function createPointer(){var t=this,e=document.createElement("div");e.classList.add("fmi-metoclient-timeslider-pointer");var n=document.createElement("div");n.classList.add("fmi-metoclient-timeslider-pointer-wrapper");var r=document.createElement("span");r.classList.add("fmi-metoclient-timeslider-pointer-text"),r.classList.add("noselect"),r.innerHTML="",n.appendChild(r),e.appendChild(n);var i=document.createElement("div");i.classList.add("fmi-metoclient-timeslider-pointer-handle"),e.appendChild(i);var o=document.createElement("div");o.classList.add("fmi-metoclient-timeslider-pointer-infotip"),o.style.display="none",e.appendChild(o),this.mouseListeners_.push(hn(e,"mousedown",(function(e){t.setDragging(!0)}))),this.mouseListeners_.push(hn(e,"touchstart",(function(e){t.setDragging(!0)}))),this.visualPointer_=e}},{key:"setAnimationTime",value:function setAnimationTime(t){if(t!==this.getMap().get("time")){var e,n,r,i=this.frames_.length,o=!0;if(this.animationPlay_){for(e=0;e<i;e++)if(this.getMap().get("time")<=this.frames_[e].endTime){n=e;break}null==n&&(n=i-1),r=(n+1)%i,Array.from(this.frames_[n].element.getElementsByClassName(hi)).forEach((function(t){"working"===t.getAttribute("data-status")&&(o=!1)})),o&&Array.from(this.frames_[r].element.getElementsByClassName(hi)).forEach((function(t){"working"===t.getAttribute("data-status")&&(o=!1)}))}o&&(this.getMap().set("time",t),this.updatePointer(t))}else this.updatePointer(t)}},{key:"updatePointer",value:function updatePointer(t){if(null!=this.visualPointer_){var e,n,r,i,o=this.frames_.length;for(e=0;e<o;e++)if(t<=this.frames_[e].endTime){n=e;break}null!=n&&(null==this.visualPointer_.parentElement?r=!0:Number.parseInt(this.visualPointer_.parentElement.dataset.time)!==t&&(this.visualPointer_.parentElement.removeChild(this.visualPointer_),r=!0),r&&(this.frames_[n].element.appendChild(this.visualPointer_),i=this.getTickText(this.frames_[n].endTime,!1).content,Array.from(this.visualPointer_.getElementsByClassName("fmi-metoclient-timeslider-pointer-text")).forEach((function(t){t.innerHTML=i})),Array.from(this.container_.getElementsByClassName("fmi-metoclient-timeslider-pointer-infotip")).forEach((function(t){t.innerHTML=i}))))}}},{key:"updateTimeLoaderVis",value:function updateTimeLoaderVis(t){if(this.config_.showTimeSlider){var e,n=t.length,r=n!==this.frames_.length,i=[];if(!r)for(e=0;e<n;e++)if(t[e].endTime!==this.frames_[e].endTime){r=!0;break}if(r){for(e=0;e<n;e++)i.push(t[e].endTime);this.createTimeSlider(i)}this.frames_.forEach((function(e,n){Array.from(e.element.getElementsByClassName(hi)).forEach((function(e){var n,r,i,o,a;if(null!=e.parentElement&&null!=e.parentElement.dataset&&(o=e.parentElement.dataset.time),null!=o&&null!=(i=parseInt(o)))for(n=t.length,r=0;r<n;r++)if(null!=(a=t[r].endTime)&&a===i){e.setAttribute("data-status",t[r].status);break}}))}))}}},{key:"setDragging",value:function setDragging(t){this.dragging_=t;var e=t?"auto":"none";Array.from(this.container_.getElementsByClassName("fmi-metoclient-timeslider-drag-listener")).forEach((function(t){t.style.pointerEvents=e})),Array.from(this.container_.getElementsByClassName("fmi-metoclient-timeslider-pointer")).forEach((function(e){t?e.classList.add("dragging"):e.classList.remove("dragging")}));var n=t?"block":"none";Array.from(this.container_.getElementsByClassName("fmi-metoclient-timeslider-pointer-infotip")).forEach((function(t){t.style.display=n}))}},{key:"setAnimationPlay",value:function setAnimationPlay(t){this.animationPlay_=t,this.animationPlay_?this.playButton_.classList.add("playing"):this.playButton_.classList.remove("playing")}},{key:"setTimeZone",value:function setTimeZone(t){var e=this;this.timeZone_=t,this.frames_.forEach((function(t){var n=e.getTickText(t.endTime),r=t.element.getElementsByClassName(ci);r.length>0&&(r[0].textContent=n.content)}))}},{key:"setTimeZoneLabel",value:function setTimeZoneLabel(t){var e=this;this.timeZoneLabel_=t,Array.from(this.container_.getElementsByClassName("fmi-metoclient-timeslider-timezone")).forEach((function(t){t.innerHTML=e.timeZoneLabel_}))}},{key:"setCallbacks",value:function setCallbacks(t){this.callbacks_=t}},{key:"getTickText",value:function getTickText(t){var e,n,r,i,o,a,s,u=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],l="HH:mm",c=" d.M.",h=!1,d=this.frames_.length>0?this.frames_[0].endTime:Number.NEGATIVE_INFINITY;if(null==d)return"";t<d&&(t=d);var f=(e=DateTime.fromMillis(t).setZone(this.timeZone_).setLocale(this.locale_)).ordinal,p=e.year;if(u){for(n=this.frames_.length,r=0;r<n&&!((i=this.frames_[r].endTime)>=t);r++)Array.from(this.frames_[r].element.getElementsByClassName(li)).length>0&&(o=i);s=DateTime.local().setZone(this.timeZone_),null!=o?f===(a=DateTime.fromMillis(o).setZone(this.timeZone_)).ordinal&&p===a.year||(h=!0):t!==d||f===s.ordinal&&p===s.year||(h=!0)}return{content:h?e.weekdayShort+e.toFormat(c):e.toFormat(l),useDateFormat:h}}},{key:"clear",value:function clear(){null!=this.timeListener&&unByKey(this.timeListener),null!=this.playingListener&&unByKey(this.playingListener),this.mouseListeners_.forEach((function(t){t.destroy()})),this.resizeDetector.removeAllListeners(this.container_),on(this.container_),this.frames_=[]}},{key:"destroy",value:function destroy(){this.clear()}}]),TimeSlider}(_i),Ti={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"},wi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Ei=function(t){function BaseLayer(e){var r=t.call(this)||this,i=n({},e);return i[Ti.OPACITY]=void 0!==e.opacity?e.opacity:1,assert("number"==typeof i[Ti.OPACITY],64),i[Ti.VISIBLE]=void 0===e.visible||e.visible,i[Ti.Z_INDEX]=e.zIndex,i[Ti.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,i[Ti.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,i[Ti.MIN_ZOOM]=void 0!==e.minZoom?e.minZoom:-1/0,i[Ti.MAX_ZOOM]=void 0!==e.maxZoom?e.maxZoom:1/0,r.className_=void 0!==i.className?e.className:"ol-layer",delete i.className,r.setProperties(i),r.state_=null,r}return wi(BaseLayer,t),BaseLayer.prototype.getClassName=function(){return this.className_},BaseLayer.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t,hasOverlay:!1};return e.opacity=clamp(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=this.getZIndex()||(!1===e.managed?1/0:0),e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},BaseLayer.prototype.getLayersArray=function(t){return abstract()},BaseLayer.prototype.getLayerStatesArray=function(t){return abstract()},BaseLayer.prototype.getExtent=function(){return this.get(Ti.EXTENT)},BaseLayer.prototype.getMaxResolution=function(){return this.get(Ti.MAX_RESOLUTION)},BaseLayer.prototype.getMinResolution=function(){return this.get(Ti.MIN_RESOLUTION)},BaseLayer.prototype.getMinZoom=function(){return this.get(Ti.MIN_ZOOM)},BaseLayer.prototype.getMaxZoom=function(){return this.get(Ti.MAX_ZOOM)},BaseLayer.prototype.getOpacity=function(){return this.get(Ti.OPACITY)},BaseLayer.prototype.getSourceState=function(){return abstract()},BaseLayer.prototype.getVisible=function(){return this.get(Ti.VISIBLE)},BaseLayer.prototype.getZIndex=function(){return this.get(Ti.Z_INDEX)},BaseLayer.prototype.setExtent=function(t){this.set(Ti.EXTENT,t)},BaseLayer.prototype.setMaxResolution=function(t){this.set(Ti.MAX_RESOLUTION,t)},BaseLayer.prototype.setMinResolution=function(t){this.set(Ti.MIN_RESOLUTION,t)},BaseLayer.prototype.setMaxZoom=function(t){this.set(Ti.MAX_ZOOM,t)},BaseLayer.prototype.setMinZoom=function(t){this.set(Ti.MIN_ZOOM,t)},BaseLayer.prototype.setOpacity=function(t){assert("number"==typeof t,64),this.set(Ti.OPACITY,t)},BaseLayer.prototype.setVisible=function(t){this.set(Ti.VISIBLE,t)},BaseLayer.prototype.setZIndex=function(t){this.set(Ti.Z_INDEX,t)},BaseLayer}(nn),Si="prerender",Mi="postrender",Oi="precompose",xi="postcompose",Ci="rendercomplete",Pi={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},Ii=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Ri=function(t){function Layer(e){var r=this,i=n({},e);delete i.source,(r=t.call(this,i)||this).mapPrecomposeKey_=null,r.mapRenderKey_=null,r.sourceChangeKey_=null,r.renderer_=null,e.render&&(r.render=e.render),e.map&&r.setMap(e.map),r.addEventListener(getChangeEventType(Ti.SOURCE),r.handleSourcePropertyChange_);var o=e.source?e.source:null;return r.setSource(o),r}return Ii(Layer,t),Layer.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},Layer.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},Layer.prototype.getSource=function(){return this.get(Ti.SOURCE)||null},Layer.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Pi.UNDEFINED},Layer.prototype.handleSourceChange_=function(){this.changed()},Layer.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=listen(t,$e.CHANGE,this.handleSourceChange_,this)),this.changed()},Layer.prototype.render=function(t,e){var n=this.getRenderer();if(n.prepareFrame(t))return n.renderFrame(t,e)},Layer.prototype.setMap=function(t){this.mapPrecomposeKey_&&(unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=listen(t,Oi,(function(t){t.frameState.layerStatesArray.push(this.getLayerState(!1))}),this),this.mapRenderKey_=listen(this,$e.CHANGE,t.render,t),this.changed())},Layer.prototype.setSource=function(t){this.set(Ti.SOURCE,t)},Layer.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},Layer.prototype.hasRenderer=function(){return!!this.renderer_},Layer.prototype.createRenderer=function(){return null},Layer}(Ei);function inView(t,e){if(!t.visible)return!1;var n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;var r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}var Li="preload",ki="useInterimTilesOnError",Ai=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Di=function(t){function BaseTileLayer(e){var r=this,i=e||{},o=n({},i);return delete o.preload,delete o.useInterimTilesOnError,(r=t.call(this,o)||this).setPreload(void 0!==i.preload?i.preload:0),r.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),r}return Ai(BaseTileLayer,t),BaseTileLayer.prototype.getPreload=function(){return this.get(Li)},BaseTileLayer.prototype.setPreload=function(t){this.set(Li,t)},BaseTileLayer.prototype.getUseInterimTilesOnError=function(){return this.get(ki)},BaseTileLayer.prototype.setUseInterimTilesOnError=function(t){this.set(ki,t)},BaseTileLayer}(Ri),ji=function(){function TileRange(t,e,n,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=r}return TileRange.prototype.contains=function(t){return this.containsXY(t[1],t[2])},TileRange.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},TileRange.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},TileRange.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},TileRange.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},TileRange.prototype.getHeight=function(){return this.maxY-this.minY+1},TileRange.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},TileRange.prototype.getWidth=function(){return this.maxX-this.minX+1},TileRange.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},TileRange}();function createOrUpdate$1(t,e,n,r,i){return void 0!==i?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new ji(t,e,n,r)}var Ni={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5},Fi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Ui=function(t){function RenderEvent(e,n,r,i){var o=t.call(this,e)||this;return o.inversePixelTransform=n,o.frameState=r,o.context=i,o}return Fi(RenderEvent,t),RenderEvent}(Ke),Gi="ol-hidden",zi="ol-unselectable",Vi="ol-control",qi="ol-collapsed";new Array(6);function apply(t,e){var n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function compose(t,e,n,r,i,o,a,s){var u=Math.sin(o),l=Math.cos(o);return t[0]=r*l,t[1]=i*u,t[2]=-r*u,t[3]=i*l,t[4]=a*r*l-s*r*u+e,t[5]=a*i*u+s*i*l+n,t}function makeInverse(t,e){var n=function determinant(t){return t[0]*t[3]-t[1]*t[2]}(e);assert(0!==n,32);var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5];return t[0]=a/n,t[1]=-i/n,t[2]=-o/n,t[3]=r/n,t[4]=(o*u-a*s)/n,t[5]=-(r*u-i*s)/n,t}function toString$1(t){return"matrix("+t.join(", ")+")"}var Zi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Wi=function(t){function LRUCache(e){var n=t.call(this)||this;return n.highWaterMark=void 0!==e?e:2048,n.count_=0,n.entries_={},n.oldest_=null,n.newest_=null,n}return Zi(LRUCache,t),LRUCache.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},LRUCache.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent($e.CLEAR)},LRUCache.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},LRUCache.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},LRUCache.prototype.get=function(t,e){var n=this.entries_[t];return assert(void 0!==n,15),n===this.newest_?n.value_:(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n,n.value_)},LRUCache.prototype.remove=function(t){var e=this.entries_[t];return assert(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},LRUCache.prototype.getCount=function(){return this.count_},LRUCache.prototype.getKeys=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.key_;return e},LRUCache.prototype.getValues=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.value_;return e},LRUCache.prototype.peekLast=function(){return this.oldest_.value_},LRUCache.prototype.peekLastKey=function(){return this.oldest_.key_},LRUCache.prototype.peekFirstKey=function(){return this.newest_.key_},LRUCache.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},LRUCache.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},LRUCache.prototype.set=function(t,e){assert(!(t in this.entries_),16);var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_},LRUCache.prototype.setSize=function(t){this.highWaterMark=t},LRUCache}(Xe),Yi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Bi=new(function(t){function LabelCache(e){var n=t.call(this,e)||this;return n.consumers={},n}return Yi(LabelCache,t),LabelCache.prototype.clear=function(){this.consumers={},t.prototype.clear.call(this)},LabelCache.prototype.get=function(e,n){var r=t.prototype.get.call(this,e),i=getUid(n);return i in this.consumers||(this.consumers[i]={}),this.consumers[i][e]=!0,r},LabelCache.prototype.prune=function(){t:for(;this.canExpireCache();){var t=this.peekLastKey();for(var e in this.consumers)if(t in this.consumers[e])break t;var n=this.pop();for(var e in n.width=n.height=0,this.consumers)delete this.consumers[e][t]}},LabelCache.prototype.release=function(t){delete this.consumers[getUid(t)]},LabelCache}(Wi));function rotateAtOffset(t,e,n,r){0!==e&&(t.translate(n,r),t.rotate(e),t.translate(-n,-r))}var Ki={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},Hi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Xi=function(t){function LayerRenderer(e){var n=t.call(this)||this;return n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=e,n}return Hi(LayerRenderer,t),LayerRenderer.prototype.prepareFrame=function(t){return abstract()},LayerRenderer.prototype.renderFrame=function(t,e){return abstract()},LayerRenderer.prototype.loadedTileCallback=function(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n},LayerRenderer.prototype.createLoadedTileFinder=function(t,e,n){return function(r,i){var o=this.loadedTileCallback.bind(this,n,r);return t.forEachLoadedTile(e,r,i,o)}.bind(this)},LayerRenderer.prototype.forEachFeatureAtCoordinate=function(t,e,n,r,i){},LayerRenderer.prototype.getDataAtPixel=function(t,e,n){return abstract()},LayerRenderer.prototype.getLayer=function(){return this.layer_},LayerRenderer.prototype.handleFontsChanged=function(){},LayerRenderer.prototype.handleImageChange_=function(t){t.target.getState()===Ki.LOADED&&this.renderIfReadyAndVisible()},LayerRenderer.prototype.loadImage=function(t){var e=t.getState();return e!=Ki.LOADED&&e!=Ki.ERROR&&t.addEventListener($e.CHANGE,this.boundHandleImageChange_),e==Ki.IDLE&&(t.load(),e=t.getState()),e==Ki.LOADED},LayerRenderer.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Pi.READY&&t.changed()},LayerRenderer}(Je),$i=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Qi=function(t){function CanvasLayerRenderer(e){var n=t.call(this,e)||this;return n.container=null,n.renderedResolution,n.tempTransform_=[1,0,0,1,0,0],n.pixelTransform=[1,0,0,1,0,0],n.inversePixelTransform=[1,0,0,1,0,0],n.context=null,n.containerReused=!1,n}return $i(CanvasLayerRenderer,t),CanvasLayerRenderer.prototype.useContainer=function(t,e,n){var r,i,o=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===o&&((s=t.firstElementChild)instanceof HTMLCanvasElement&&(i=s.getContext("2d")));if(i&&i.canvas.style.transform===toString$1(e)?(this.container=t,this.context=i,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(r=document.createElement("div")).className=o;var a=r.style;a.position="absolute",a.width="100%",a.height="100%";var s=(i=createCanvasContext2D()).canvas;r.appendChild(s),(a=s.style).position="absolute",a.transformOrigin="top left",this.container=r,this.context=i}},CanvasLayerRenderer.prototype.clip=function(t,e,n){var r=e.pixelRatio,i=e.size[0]*r/2,o=e.size[1]*r/2,a=e.viewState.rotation,s=getTopLeft(n),u=getTopRight(n),l=getBottomRight(n),c=getBottomLeft(n);apply(e.coordinateToPixelTransform,s),apply(e.coordinateToPixelTransform,u),apply(e.coordinateToPixelTransform,l),apply(e.coordinateToPixelTransform,c),t.save(),rotateAtOffset(t,-a,i,o),t.beginPath(),t.moveTo(s[0]*r,s[1]*r),t.lineTo(u[0]*r,u[1]*r),t.lineTo(l[0]*r,l[1]*r),t.lineTo(c[0]*r,c[1]*r),t.clip(),rotateAtOffset(t,a,i,o)},CanvasLayerRenderer.prototype.clipUnrotated=function(t,e,n){var r=getTopLeft(n),i=getTopRight(n),o=getBottomRight(n),a=getBottomLeft(n);apply(e.coordinateToPixelTransform,r),apply(e.coordinateToPixelTransform,i),apply(e.coordinateToPixelTransform,o),apply(e.coordinateToPixelTransform,a);var s=this.inversePixelTransform;apply(s,r),apply(s,i),apply(s,o),apply(s,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()},CanvasLayerRenderer.prototype.dispatchRenderEvent_=function(t,e,n){var r=this.getLayer();if(r.hasListener(t)){var i=new Ui(t,this.inversePixelTransform,n,e);r.dispatchEvent(i)}},CanvasLayerRenderer.prototype.preRender=function(t,e){this.dispatchRenderEvent_(Si,t,e)},CanvasLayerRenderer.prototype.postRender=function(t,e){this.dispatchRenderEvent_(Mi,t,e)},CanvasLayerRenderer.prototype.getRenderTransform=function(t,e,n,r){var i=t.viewState,o=e/2,a=n/2,s=t.pixelRatio/i.resolution,u=-s,l=-i.center[0]+r,c=-i.center[1];return compose(this.tempTransform_,o,a,s,u,-i.rotation,l,c)},CanvasLayerRenderer.prototype.getDataAtPixel=function(t,e,n){var r,i=apply(this.inversePixelTransform,t.slice()),o=this.context;try{r=o.getImageData(Math.round(i[0]),Math.round(i[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:r}return 0===r[3]?null:r},CanvasLayerRenderer}(Xi),Ji=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),to=function(t){function CanvasTileLayerRenderer(e){var n=t.call(this,e)||this;return n.extentChanged=!0,n.renderedExtent_=null,n.renderedRevision,n.renderedTiles=[],n.newTiles_=!1,n.tmpExtent=[1/0,1/0,-1/0,-1/0],n.tmpTileRange_=new ji(0,0,0,0),n}return Ji(CanvasTileLayerRenderer,t),CanvasTileLayerRenderer.prototype.isDrawableTile=function(t){var e=this.getLayer(),n=t.getState(),r=e.getUseInterimTilesOnError();return n==Ni.LOADED||n==Ni.EMPTY||n==Ni.ERROR&&!r},CanvasTileLayerRenderer.prototype.getTile=function(t,e,n,r){var i=r.pixelRatio,o=r.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(t,e,n,i,o);return s.getState()==Ni.ERROR&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):s.setState(Ni.LOADED)),this.isDrawableTile(s)||(s=s.getInterimTile()),s},CanvasTileLayerRenderer.prototype.loadedTileCallback=function(e,n,r){return!!this.isDrawableTile(r)&&t.prototype.loadedTileCallback.call(this,e,n,r)},CanvasTileLayerRenderer.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},CanvasTileLayerRenderer.prototype.renderFrame=function(t,e){var n=t.layerStatesArray[t.layerIndex],r=t.viewState,i=r.projection,o=r.resolution,a=r.center,s=r.rotation,u=t.pixelRatio,l=this.getLayer(),c=l.getSource(),h=c.getRevision(),d=c.getTileGridForProjection(i),f=d.getZForResolution(o,c.zDirection),p=d.getResolution(f),m=t.extent,y=n.extent&&fromUserExtent(n.extent,i);y&&(m=getIntersection(m,fromUserExtent(n.extent,i)));var g=c.getTilePixelRatio(u),v=Math.round(t.size[0]*g),_=Math.round(t.size[1]*g);s&&(v=_=Math.round(Math.sqrt(v*v+_*_)));var b=p*v/2/g,T=p*_/2/g,w=[a[0]-b,a[1]-T,a[0]+b,a[1]+T],E=d.getTileRangeForExtentAndZ(m,f),S={};S[f]={};var M=this.createLoadedTileFinder(c,i,S),O=this.tmpExtent,x=this.tmpTileRange_;this.newTiles_=!1;for(var C=E.minX;C<=E.maxX;++C)for(var P=E.minY;P<=E.maxY;++P){var I=this.getTile(f,C,P,t);if(this.isDrawableTile(I)){var R=getUid(this);if(I.getState()==Ni.LOADED){S[f][I.tileCoord.toString()]=I;var L=I.inTransition(R);this.newTiles_||!L&&-1!==this.renderedTiles.indexOf(I)||(this.newTiles_=!0)}if(1===I.getAlpha(R,t.time))continue}var k=d.getTileCoordChildTileRange(I.tileCoord,x,O),A=!1;k&&(A=M(f+1,k)),A||d.forEachTileCoordParentTileRange(I.tileCoord,M,x,O)}var D=p/o;compose(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/g,1/g,s,-v/2,-_/2),this.useContainer(e,this.pixelTransform,n.opacity);var j=this.context,N=j.canvas;makeInverse(this.inversePixelTransform,this.pixelTransform),compose(this.tempTransform_,v/2,_/2,D,D,0,-v/2,-_/2),N.width!=v||N.height!=_?(N.width=v,N.height=_):this.containerReused||j.clearRect(0,0,v,_),y&&this.clipUnrotated(j,t,y),this.preRender(j,t),this.renderedTiles.length=0;var F,U,G,z=Object.keys(S).map(Number);z.sort(numberSafeCompareFunction),1!==n.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(F=[],U=[]):z=z.reverse();for(var V=z.length-1;V>=0;--V){var q=z[V],Z=c.getTilePixelSize(q,u,i),W=d.getResolution(q)/p,Y=Z[0]*W*D,B=Z[1]*W*D,K=d.getTileCoordForCoordAndZ(getTopLeft(w),q),H=d.getTileCoordExtent(K),X=apply(this.tempTransform_,[g*(H[0]-w[0])/p,g*(w[3]-H[3])/p]),$=g*c.getGutterForProjection(i),Q=S[q];for(var J in Q){var tt=(I=Q[J]).tileCoord,et=X[0]-(K[1]-tt[1])*Y,nt=Math.round(et+Y),rt=X[1]-(K[2]-tt[2])*B,it=Math.round(rt+B),ot=nt-(C=Math.round(et)),at=it-(P=Math.round(rt)),st=f===q;if(!(L=st&&1!==I.getAlpha(getUid(this),t.time)))if(F){j.save(),G=[C,P,C+ot,P,C+ot,P+at,C,P+at];for(var ut=0,lt=F.length;ut<lt;++ut)if(f!==q&&q<U[ut]){var ct=F[ut];j.beginPath(),j.moveTo(G[0],G[1]),j.lineTo(G[2],G[3]),j.lineTo(G[4],G[5]),j.lineTo(G[6],G[7]),j.moveTo(ct[6],ct[7]),j.lineTo(ct[4],ct[5]),j.lineTo(ct[2],ct[3]),j.lineTo(ct[0],ct[1]),j.clip()}F.push(G),U.push(q)}else j.clearRect(C,P,ot,at);this.drawTileImage(I,t,C,P,ot,at,$,st,n.opacity),F&&!L&&j.restore(),this.renderedTiles.push(I),this.updateUsedTiles(t.usedTiles,c,I)}}this.renderedRevision=h,this.renderedResolution=p,this.extentChanged=!this.renderedExtent_||!equals(this.renderedExtent_,w),this.renderedExtent_=w,this.manageTilePyramid(t,c,d,u,i,m,f,l.getPreload()),this.updateCacheSize_(t,c),this.scheduleExpireCache(t,c),this.postRender(j,t),n.extent&&j.restore();var ht=toString$1(this.pixelTransform);return ht!==N.style.transform&&(N.style.transform=ht),this.container},CanvasTileLayerRenderer.prototype.drawTileImage=function(t,e,n,r,i,o,a,s,u){var l=this.getTileImage(t);if(l){var c=getUid(this),h=s?t.getAlpha(c,e.time):1,d=u*h,f=d!==this.context.globalAlpha;f&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(l,a,a,l.width-2*a,l.height-2*a,n,r,i,o),f&&this.context.restore(),1!==h?e.animate=!0:s&&t.endTransition(c)}},CanvasTileLayerRenderer.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},CanvasTileLayerRenderer.prototype.getTileImage=function(t){return t.getImage()},CanvasTileLayerRenderer.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var n=function(t,e,n){var r=getUid(t);r in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[r])}.bind(null,e);t.postRenderFunctions.push(n)}},CanvasTileLayerRenderer.prototype.updateUsedTiles=function(t,e,n){var r=getUid(e);r in t||(t[r]={}),t[r][n.getKey()]=!0},CanvasTileLayerRenderer.prototype.updateCacheSize_=function(t,e){var n=getUid(e),r=0;n in t.usedTiles&&(r+=Object.keys(t.usedTiles[n]).length),n in t.wantedTiles&&(r+=Object.keys(t.wantedTiles[n]).length);var i=e.tileCache;i.highWaterMark<r&&(i.highWaterMark=r)},CanvasTileLayerRenderer.prototype.manageTilePyramid=function(t,e,n,r,i,o,a,s,u){var l=getUid(e);l in t.wantedTiles||(t.wantedTiles[l]={});var c,h,d,f,p,m,y=t.wantedTiles[l],g=t.tileQueue;for(m=n.getMinZoom();m<=a;++m)for(h=n.getTileRangeForExtentAndZ(o,m,h),d=n.getResolution(m),f=h.minX;f<=h.maxX;++f)for(p=h.minY;p<=h.maxY;++p)a-m<=s?((c=e.getTile(m,f,p,r,i)).getState()==Ni.IDLE&&(y[c.getKey()]=!0,g.isKeyQueued(c.getKey())||g.enqueue([c,l,n.getTileCoordCenter(c.tileCoord),d])),void 0!==u&&u(c)):e.useTile(m,f,p,i)},CanvasTileLayerRenderer}(Qi);to.prototype.getLayer;var eo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),no=function(t){function TileLayer(e){return t.call(this,e)||this}return eo(TileLayer,t),TileLayer.prototype.createRenderer=function(){return new to(this)},TileLayer}(Di),ro=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),io=function(t){function BaseImageLayer(e){var n=e||{};return t.call(this,n)||this}return ro(BaseImageLayer,t),BaseImageLayer}(Ri),oo=.5,ao=0,so=1,uo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),lo=function(t){function CanvasImageLayerRenderer(e){var n=t.call(this,e)||this;return n.image_=null,n}return uo(CanvasImageLayerRenderer,t),CanvasImageLayerRenderer.prototype.getImage=function(){return this.image_?this.image_.getImage():null},CanvasImageLayerRenderer.prototype.prepareFrame=function(t){var e=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,r=t.viewState,i=r.resolution,o=this.getLayer().getSource(),a=t.viewHints,s=t.extent;if(void 0!==e.extent&&(s=getIntersection(s,fromUserExtent(e.extent,r.projection))),!a[ao]&&!a[so]&&!isEmpty(s)){var u=r.projection,l=o.getImage(s,i,n,u);l&&this.loadImage(l)&&(this.image_=l)}return!!this.image_},CanvasImageLayerRenderer.prototype.renderFrame=function(t,e){var n=this.image_,r=n.getExtent(),i=n.getResolution(),o=n.getPixelRatio(),a=t.layerStatesArray[t.layerIndex],s=t.pixelRatio,u=t.viewState,l=u.center,c=u.resolution,h=t.size,d=s*i/(c*o),f=Math.round(h[0]*s),p=Math.round(h[1]*s),m=u.rotation;m&&(f=p=Math.round(Math.sqrt(f*f+p*p)));compose(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/s,1/s,m,-f/2,-p/2),makeInverse(this.inversePixelTransform,this.pixelTransform),this.useContainer(e,this.pixelTransform,a.opacity);var y=this.context,g=y.canvas;g.width!=f||g.height!=p?(g.width=f,g.height=p):this.containerReused||y.clearRect(0,0,f,p);var v=!1;if(a.extent){var _=fromUserExtent(a.extent,u.projection);(v=!containsExtent(_,t.extent)&&intersects(_,t.extent))&&this.clipUnrotated(y,t,_)}var b=n.getImage(),T=compose(this.tempTransform_,f/2,p/2,d,d,0,o*(r[0]-l[0])/i,o*(l[1]-r[3])/i);this.renderedResolution=i*s/o;var w=T[4],E=T[5],S=b.width*T[0],M=b.height*T[3];if(this.preRender(y,t),S>=.5&&M>=.5){var O=a.opacity,x=void 0;1!==O&&(x=this.context.globalAlpha,this.context.globalAlpha=O),this.context.drawImage(b,0,0,+b.width,+b.height,Math.round(w),Math.round(E),Math.round(S),Math.round(M)),1!==O&&(this.context.globalAlpha=x)}this.postRender(y,t),v&&y.restore();var C=toString$1(this.pixelTransform);return C!==g.style.transform&&(g.style.transform=C),this.container},CanvasImageLayerRenderer}(Qi),co=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ho=function(t){function ImageLayer(e){return t.call(this,e)||this}return co(ImageLayer,t),ImageLayer.prototype.createRenderer=function(){return new lo(this)},ImageLayer}(io),fo="1.3.0",po=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),mo=function(t){function ImageBase(e,n,r,i){var o=t.call(this)||this;return o.extent=e,o.pixelRatio_=r,o.resolution=n,o.state=i,o}return po(ImageBase,t),ImageBase.prototype.changed=function(){this.dispatchEvent($e.CHANGE)},ImageBase.prototype.getExtent=function(){return this.extent},ImageBase.prototype.getImage=function(){return abstract()},ImageBase.prototype.getPixelRatio=function(){return this.pixelRatio_},ImageBase.prototype.getResolution=function(){return this.resolution},ImageBase.prototype.getState=function(){return this.state},ImageBase.prototype.load=function(){abstract()},ImageBase}(Xe),yo="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",go=-1!==yo.indexOf("firefox"),vo=(-1!==yo.indexOf("safari")&&yo.indexOf("chrom"),-1!==yo.indexOf("webkit")&&-1==yo.indexOf("edge")),_o=-1!==yo.indexOf("macintosh"),bo=window.devicePixelRatio||1,To="undefined"!=typeof Image&&Image.prototype.decode,wo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Eo=function(t){function ImageWrapper(e,n,r,i,o,a){var s=t.call(this,e,n,r,Ki.IDLE)||this;return s.src_=i,s.image_=new Image,null!==o&&(s.image_.crossOrigin=o),s.unlisten_=null,s.state=Ki.IDLE,s.imageLoadFunction_=a,s}return wo(ImageWrapper,t),ImageWrapper.prototype.getImage=function(){return this.image_},ImageWrapper.prototype.handleImageError_=function(){this.state=Ki.ERROR,this.unlistenImage_(),this.changed()},ImageWrapper.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=getHeight(this.extent)/this.image_.height),this.state=Ki.LOADED,this.unlistenImage_(),this.changed()},ImageWrapper.prototype.load=function(){this.state!=Ki.IDLE&&this.state!=Ki.ERROR||(this.state=Ki.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=listenImage(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},ImageWrapper.prototype.setImage=function(t){this.image_=t},ImageWrapper.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},ImageWrapper}(mo);function listenImage(t,e,n){var r=t;if(r.src&&To){var i=r.decode(),o=!0;return i.then((function(){o&&e()})).catch((function(t){o&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():n())})),function(){o=!1}}var a=[listenOnce(r,$e.LOAD,e),listenOnce(r,$e.ERROR,n)];return function unlisten(){a.forEach(unlistenByKey)}}function calculateSourceResolution(t,e,n,r){var i=transform(n,e,t),o=getPointResolution(e,r,n),a=e.getMetersPerUnit();void 0!==a&&(o*=a);var s=t.getMetersPerUnit();void 0!==s&&(o/=s);var u=t.getExtent();if(!u||containsCoordinate(u,i)){var l=getPointResolution(t,o,i)/o;isFinite(l)&&l>0&&(o/=l)}return o}function enlargeClipPoint(t,e,n,r){var i=n-t,o=r-e,a=Math.sqrt(i*i+o*o);return[Math.round(n+i/a),Math.round(r+o/a)]}function render(t,e,n,r,i,o,a,s,u,l,c){var h=createCanvasContext2D(Math.round(n*t),Math.round(n*e));if(0===u.length)return h.canvas;h.scale(n,n);var d=[1/0,1/0,-1/0,-1/0];u.forEach((function(t,e,n){!function extend(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}(d,t.extent)}));var f=getWidth(d),p=getHeight(d),m=createCanvasContext2D(Math.round(n*f/r),Math.round(n*p/r)),y=n/r;u.forEach((function(t,e,n){var r=t.extent[0]-d[0],i=-(t.extent[3]-d[3]),o=getWidth(t.extent),a=getHeight(t.extent);m.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,r*y,i*y,o*y,a*y)}));var g=getTopLeft(a);return s.getTriangles().forEach((function(t,e,i){var a=t.source,s=t.target,u=a[0][0],l=a[0][1],c=a[1][0],f=a[1][1],p=a[2][0],y=a[2][1],v=(s[0][0]-g[0])/o,_=-(s[0][1]-g[1])/o,b=(s[1][0]-g[0])/o,T=-(s[1][1]-g[1])/o,w=(s[2][0]-g[0])/o,E=-(s[2][1]-g[1])/o,S=u,M=l;u=0,l=0;var O=function solveLinearSystem(t){for(var e=t.length,n=0;n<e;n++){for(var r=n,i=Math.abs(t[n][n]),o=n+1;o<e;o++){var a=Math.abs(t[o][n]);a>i&&(i=a,r=o)}if(0===i)return null;var s=t[r];t[r]=t[n],t[n]=s;for(var u=n+1;u<e;u++)for(var l=-t[u][n]/t[n][n],c=n;c<e+1;c++)n==c?t[u][c]=0:t[u][c]+=l*t[n][c]}for(var h=new Array(e),d=e-1;d>=0;d--){h[d]=t[d][e]/t[d][d];for(var f=d-1;f>=0;f--)t[f][e]-=t[f][d]*h[d]}return h}([[c-=S,f-=M,0,0,b-v],[p-=S,y-=M,0,0,w-v],[0,0,c,f,T-_],[0,0,p,y,E-_]]);if(O){h.save(),h.beginPath();var x=(v+b+w)/3,C=(_+T+E)/3,P=enlargeClipPoint(x,C,v,_),I=enlargeClipPoint(x,C,b,T),R=enlargeClipPoint(x,C,w,E);h.moveTo(I[0],I[1]),h.lineTo(P[0],P[1]),h.lineTo(R[0],R[1]),h.clip(),h.transform(O[0],O[2],O[1],O[3],v,_),h.translate(d[0]-S,d[3]-M),h.scale(r/n,-r/n),h.drawImage(m.canvas,0,0),h.restore()}})),c&&(h.save(),h.strokeStyle="black",h.lineWidth=1,s.getTriangles().forEach((function(t,e,n){var r=t.target,i=(r[0][0]-g[0])/o,a=-(r[0][1]-g[1])/o,s=(r[1][0]-g[0])/o,u=-(r[1][1]-g[1])/o,l=(r[2][0]-g[0])/o,c=-(r[2][1]-g[1])/o;h.beginPath(),h.moveTo(s,u),h.lineTo(i,a),h.lineTo(l,c),h.closePath(),h.stroke()})),h.restore()),h.canvas}var So=10,Mo=function(){function Triangulation(t,e,n,r,i){this.sourceProj_=t,this.targetProj_=e;var o={},a=getTransform(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=r,this.errorThresholdSquared_=i*i,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&getWidth(r)==getWidth(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?getWidth(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?getWidth(this.targetProj_.getExtent()):null;var s=getTopLeft(n),u=getTopRight(n),l=getBottomRight(n),c=getBottomLeft(n),h=this.transformInv_(s),d=this.transformInv_(u),f=this.transformInv_(l),p=this.transformInv_(c);if(this.addQuad_(s,u,l,c,h,d,f,p,So),this.wrapsXInSource_){var m=1/0;this.triangles_.forEach((function(t,e,n){m=Math.min(m,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-m>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-m>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-m>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-m>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var n=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-n<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}o={}}return Triangulation.prototype.addTriangle_=function(t,e,n,r,i,o){this.triangles_.push({source:[r,i,o],target:[t,e,n]})},Triangulation.prototype.addQuad_=function(t,e,n,r,i,o,a,s,u){var l=boundingExtent([i,o,a,s]),c=this.sourceWorldWidth_?getWidth(l)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&c>.5&&c<1,f=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)f=getWidth(boundingExtent([t,e,n,r]))/this.targetWorldWidth_>.25||f;!d&&this.sourceProj_.isGlobal()&&c&&(f=c>.25||f)}if(f||!this.maxSourceExtent_||intersects(l,this.maxSourceExtent_)){if(!(f||isFinite(i[0])&&isFinite(i[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(s[0])&&isFinite(s[1]))){if(!(u>0))return;f=!0}if(u>0){if(!f){var p=[(t[0]+n[0])/2,(t[1]+n[1])/2],m=this.transformInv_(p),y=void 0;if(d)y=(modulo(i[0],h)+modulo(a[0],h))/2-modulo(m[0],h);else y=(i[0]+a[0])/2-m[0];var g=(i[1]+a[1])/2-m[1];f=y*y+g*g>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var v=[(e[0]+n[0])/2,(e[1]+n[1])/2],_=this.transformInv_(v),b=[(r[0]+t[0])/2,(r[1]+t[1])/2],T=this.transformInv_(b);this.addQuad_(t,e,v,b,i,o,_,T,u-1),this.addQuad_(b,v,n,r,T,_,a,s,u-1)}else{var w=[(t[0]+e[0])/2,(t[1]+e[1])/2],E=this.transformInv_(w),S=[(n[0]+r[0])/2,(n[1]+r[1])/2],M=this.transformInv_(S);this.addQuad_(t,w,S,r,i,E,M,s,u-1),this.addQuad_(w,e,n,S,E,o,a,M,u-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,n,r,i,a,s),this.addTriangle_(t,e,n,i,o,a)}},Triangulation.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,n,r){var i=e.source;extendCoordinate(t,i[0]),extendCoordinate(t,i[1]),extendCoordinate(t,i[2])})),t},Triangulation.prototype.getTriangles=function(){return this.triangles_},Triangulation}(),Oo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),xo=function(t){function ReprojImage(e,n,r,i,o,a){var s=this,u=e.getExtent(),l=n.getExtent(),c=l?getIntersection(r,l):r,h=calculateSourceResolution(e,n,getCenter(c),i),d=new Mo(e,n,c,u,h*oo),f=a(d.calculateSourceExtent(),h,o),p=f?Ki.IDLE:Ki.EMPTY,m=f?f.getPixelRatio():1;return(s=t.call(this,r,i,m,p)||this).targetProj_=n,s.maxSourceExtent_=u,s.triangulation_=d,s.targetResolution_=i,s.targetExtent_=r,s.sourceImage_=f,s.sourcePixelRatio_=m,s.canvas_=null,s.sourceListenerKey_=null,s}return Oo(ReprojImage,t),ReprojImage.prototype.disposeInternal=function(){this.state==Ki.LOADING&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},ReprojImage.prototype.getImage=function(){return this.canvas_},ReprojImage.prototype.getProjection=function(){return this.targetProj_},ReprojImage.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==Ki.LOADED){var e=getWidth(this.targetExtent_)/this.targetResolution_,n=getHeight(this.targetExtent_)/this.targetResolution_;this.canvas_=render(e,n,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},ReprojImage.prototype.load=function(){if(this.state==Ki.IDLE){this.state=Ki.LOADING,this.changed();var t=this.sourceImage_.getState();t==Ki.LOADED||t==Ki.ERROR?this.reproject_():(this.sourceListenerKey_=listen(this.sourceImage_,$e.CHANGE,(function(t){var e=this.sourceImage_.getState();e!=Ki.LOADED&&e!=Ki.ERROR||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}},ReprojImage.prototype.unlistenSource_=function(){unlistenByKey(this.sourceListenerKey_),this.sourceListenerKey_=null},ReprojImage}(mo),Co=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Po=function(t){function Source(e){var n=t.call(this)||this;return n.projection_=get$3(e.projection),n.attributions_=adaptAttributions(e.attributions),n.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,n.loading=!1,n.state_=void 0!==e.state?e.state:Pi.READY,n.wrapX_=void 0!==e.wrapX&&e.wrapX,n}return Co(Source,t),Source.prototype.getAttributions=function(){return this.attributions_},Source.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},Source.prototype.getProjection=function(){return this.projection_},Source.prototype.getResolutions=function(){return abstract()},Source.prototype.getState=function(){return this.state_},Source.prototype.getWrapX=function(){return this.wrapX_},Source.prototype.refresh=function(){this.changed()},Source.prototype.setAttributions=function(t){this.attributions_=adaptAttributions(t),this.changed()},Source.prototype.setState=function(t){this.state_=t,this.changed()},Source}(nn);function adaptAttributions(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var Io=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Ro="imageloadstart",Lo="imageloadend",ko="imageloaderror",Ao=function(t){function ImageSourceEvent(e,n){var r=t.call(this,e)||this;return r.image=n,r}return Io(ImageSourceEvent,t),ImageSourceEvent}(Ke),Do=function(t){function ImageSource(e){var n=t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state})||this;return n.resolutions_=void 0!==e.resolutions?e.resolutions:null,n.reprojectedImage_=null,n.reprojectedRevision_=0,n}return Io(ImageSource,t),ImageSource.prototype.getResolutions=function(){return this.resolutions_},ImageSource.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=linearFindNearest(this.resolutions_,t,0);t=this.resolutions_[e]}return t},ImageSource.prototype.getImage=function(t,e,n,r){var i=this.getProjection();if(i&&r&&!equivalent(i,r)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&equivalent(this.reprojectedImage_.getProjection(),r)&&this.reprojectedImage_.getResolution()==e&&equals(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new xo(i,r,t,e,n,function(t,e,n){return this.getImageInternal(t,e,n,i)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return i&&(r=i),this.getImageInternal(t,e,n,r)},ImageSource.prototype.getImageInternal=function(t,e,n,r){return abstract()},ImageSource.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case Ki.LOADING:this.loading=!0,this.dispatchEvent(new Ao(Ro,e));break;case Ki.LOADED:this.loading=!1,this.dispatchEvent(new Ao(Lo,e));break;case Ki.ERROR:this.loading=!1,this.dispatchEvent(new Ao(ko,e))}},ImageSource}(Po);function defaultImageLoadFunction(t,e){t.getImage().src=e}var jo="carmentaserver",No="geoserver",Fo="mapserver",Uo="qgis";function compareVersions(t,e){for(var n=(""+t).split("."),r=(""+e).split("."),i=0;i<Math.max(n.length,r.length);i++){var o=parseInt(n[i]||"0",10),a=parseInt(r[i]||"0",10);if(o>a)return 1;if(a>o)return-1}return 0}function appendParams(t,e){var n=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&n.push(t+"="+encodeURIComponent(e[t]))}));var r=n.join("&");return(t=-1===(t=t.replace(/[?&]$/,"")).indexOf("?")?t+"?":t+"&")+r}var Go=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),zo=[101,101],Vo=function(t){function ImageWMS(e){var n=this,r=e||{};return(n=t.call(this,{attributions:r.attributions,projection:r.projection,resolutions:r.resolutions})||this).crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null,n.url_=r.url,n.imageLoadFunction_=void 0!==r.imageLoadFunction?r.imageLoadFunction:defaultImageLoadFunction,n.params_=r.params||{},n.v13_=!0,n.updateV13_(),n.serverType_=r.serverType,n.hidpi_=void 0===r.hidpi||r.hidpi,n.image_=null,n.imageSize_=[0,0],n.renderedRevision_=0,n.ratio_=void 0!==r.ratio?r.ratio:1.5,n}return Go(ImageWMS,t),ImageWMS.prototype.getFeatureInfoUrl=function(t,e,r,i){if(void 0!==this.url_){var o=get$3(r),a=this.getProjection();a&&a!==o&&(e=calculateSourceResolution(a,o,t,e),t=transform(t,o,a));var s=getForViewAndSize(t,e,0,zo),u={SERVICE:"WMS",VERSION:fo,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};n(u,this.params_,i);var l=Math.floor((t[0]-s[0])/e),c=Math.floor((s[3]-t[1])/e);return u[this.v13_?"I":"X"]=l,u[this.v13_?"J":"Y"]=c,this.getRequestUrl_(s,zo,1,a||o,u)}},ImageWMS.prototype.getLegendUrl=function(t,e){if(void 0!==this.url_){var r={SERVICE:"WMS",VERSION:fo,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){var i=this.params_.LAYERS;if(!(!Array.isArray(i)||1===i.length))return;r.LAYER=i}if(void 0!==t){var o=this.getProjection()?this.getProjection().getMetersPerUnit():1;r.SCALE=t*o*39.37*(25.4/.28)}return n(r,e),appendParams(this.url_,r)}},ImageWMS.prototype.getParams=function(){return this.params_},ImageWMS.prototype.getImageInternal=function(t,e,r,i){if(void 0===this.url_)return null;e=this.findNearestResolution(e),1==r||this.hidpi_&&void 0!==this.serverType_||(r=1);var o=e/r,a=getCenter(t),s=getForViewAndSize(a,o,0,[Math.ceil(getWidth(t)/o),Math.ceil(getHeight(t)/o)]),u=getForViewAndSize(a,o,0,[Math.ceil(this.ratio_*getWidth(t)/o),Math.ceil(this.ratio_*getHeight(t)/o)]),l=this.image_;if(l&&this.renderedRevision_==this.getRevision()&&l.getResolution()==e&&l.getPixelRatio()==r&&containsExtent(l.getExtent(),s))return l;var c={SERVICE:"WMS",VERSION:fo,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};n(c,this.params_),this.imageSize_[0]=Math.round(getWidth(u)/o),this.imageSize_[1]=Math.round(getHeight(u)/o);var h=this.getRequestUrl_(u,this.imageSize_,r,i,c);return this.image_=new Eo(u,e,r,h,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener($e.CHANGE,this.handleImageChange.bind(this)),this.image_},ImageWMS.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},ImageWMS.prototype.getRequestUrl_=function(t,e,n,r,i){if(assert(void 0!==this.url_,9),i[this.v13_?"CRS":"SRS"]=r.getCode(),"STYLES"in this.params_||(i.STYLES=""),1!=n)switch(this.serverType_){case No:var o=90*n+.5|0;"FORMAT_OPTIONS"in i?i.FORMAT_OPTIONS+=";dpi:"+o:i.FORMAT_OPTIONS="dpi:"+o;break;case Fo:i.MAP_RESOLUTION=90*n;break;case jo:case Uo:i.DPI=90*n;break;default:assert(!1,8)}i.WIDTH=e[0],i.HEIGHT=e[1];var a,s=r.getAxisOrientation();return a=this.v13_&&"ne"==s.substr(0,2)?[t[1],t[0],t[3],t[2]]:t,i.BBOX=a.join(","),appendParams(this.url_,i)},ImageWMS.prototype.getUrl=function(){return this.url_},ImageWMS.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},ImageWMS.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},ImageWMS.prototype.updateParams=function(t){n(this.params_,t),this.updateV13_(),this.image_=null,this.changed()},ImageWMS.prototype.updateV13_=function(){var t=this.params_.VERSION||fo;this.v13_=compareVersions(t,"1.3")>=0},ImageWMS}(Do);function buffer$1(t,e,n){return void 0===n&&(n=[0,0]),n[0]=t[0]+2*e,n[1]=t[1]+2*e,n}function scale(t,e,n){return void 0===n&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function toSize(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)}function easeIn(t){return Math.pow(t,3)}function easeOut(t){return 1-easeIn(1-t)}function inAndOut(t){return 3*t*t-2*t*t*t}function linear(t){return t}var qo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Zo=function(t){function Tile(e,n,r){var i=t.call(this)||this,o=r||{};return i.tileCoord=e,i.state=n,i.interimTile=null,i.hifi=!0,i.key="",i.transition_=void 0===o.transition?250:o.transition,i.transitionStarts_={},i}return qo(Tile,t),Tile.prototype.changed=function(){this.dispatchEvent($e.CHANGE)},Tile.prototype.getKey=function(){return this.key+"/"+this.tileCoord},Tile.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==Ni.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},Tile.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==Ni.LOADED){t.interimTile=null;break}t.getState()==Ni.LOADING?e=t:t.getState()==Ni.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},Tile.prototype.getTileCoord=function(){return this.tileCoord},Tile.prototype.getState=function(){return this.state},Tile.prototype.setState=function(t){if(this.state!==Ni.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},Tile.prototype.load=function(){abstract()},Tile.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;var r=e-n+1e3/60;return r>=this.transition_?1:easeIn(r/this.transition_)},Tile.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},Tile.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},Tile}(Xe),Wo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Yo=function(t){function ImageTile(e,n,r,i,o,a){var s=t.call(this,e,n,a)||this;return s.crossOrigin_=i,s.src_=r,s.image_=new Image,null!==i&&(s.image_.crossOrigin=i),s.unlisten_=null,s.tileLoadFunction_=o,s}return Wo(ImageTile,t),ImageTile.prototype.disposeInternal=function(){this.state==Ni.LOADING&&(this.unlistenImage_(),this.image_=getBlankImage()),this.interimTile&&this.interimTile.dispose(),this.state=Ni.ABORT,this.changed(),t.prototype.disposeInternal.call(this)},ImageTile.prototype.getImage=function(){return this.image_},ImageTile.prototype.getKey=function(){return this.src_},ImageTile.prototype.handleImageError_=function(){this.state=Ni.ERROR,this.unlistenImage_(),this.image_=getBlankImage(),this.changed()},ImageTile.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=Ni.LOADED:this.state=Ni.EMPTY,this.unlistenImage_(),this.changed()},ImageTile.prototype.load=function(){this.state==Ni.ERROR&&(this.state=Ni.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ni.IDLE&&(this.state=Ni.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=listenImage(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},ImageTile.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},ImageTile}(Zo);function getBlankImage(){var t=createCanvasContext2D(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}function createOrUpdate$2(t,e,n,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function getKeyZXY(t,e,n){return t+"/"+e+"/"+n}function getKey(t){return getKeyZXY(t[0],t[1],t[2])}function hash(t){return(t[1]<<t[0])+t[2]}var Bo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Ko=function(t){function TileCache(e){return t.call(this,e)||this}return Bo(TileCache,t),TileCache.prototype.expireCache=function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().dispose()}},TileCache.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function fromKey(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(getKey(e.tileCoord)),e.dispose())}.bind(this))}},TileCache}(Wi),Ho=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Xo=function(t){function ReprojTile(e,n,r,i,o,a,s,u,l,c,h){var d=t.call(this,o,Ni.IDLE)||this;d.renderEdges_=void 0!==h&&h,d.pixelRatio_=s,d.gutter_=u,d.canvas_=null,d.sourceTileGrid_=n,d.targetTileGrid_=i,d.wrappedTileCoord_=a||o,d.sourceTiles_=[],d.sourcesListenerKeys_=null,d.sourceZ_=0;var f=i.getTileCoordExtent(d.wrappedTileCoord_),p=d.targetTileGrid_.getExtent(),m=d.sourceTileGrid_.getExtent(),y=p?getIntersection(f,p):f;if(0===getArea(y))return d.state=Ni.EMPTY,d;var g=e.getExtent();g&&(m=m?getIntersection(m,g):g);var v=i.getResolution(d.wrappedTileCoord_[0]),_=calculateSourceResolution(e,r,getCenter(y),v);if(!isFinite(_)||_<=0)return d.state=Ni.EMPTY,d;var b=void 0!==c?c:oo;if(d.triangulation_=new Mo(e,r,y,m,_*b),0===d.triangulation_.getTriangles().length)return d.state=Ni.EMPTY,d;d.sourceZ_=n.getZForResolution(_);var T=d.triangulation_.calculateSourceExtent();if(m&&(e.canWrapX()?(T[1]=clamp(T[1],m[1],m[3]),T[3]=clamp(T[3],m[1],m[3])):T=getIntersection(T,m)),getArea(T)){for(var w=n.getTileRangeForExtentAndZ(T,d.sourceZ_),E=w.minX;E<=w.maxX;E++)for(var S=w.minY;S<=w.maxY;S++){var M=l(d.sourceZ_,E,S,s);M&&d.sourceTiles_.push(M)}0===d.sourceTiles_.length&&(d.state=Ni.EMPTY)}else d.state=Ni.EMPTY;return d}return Ho(ReprojTile,t),ReprojTile.prototype.disposeInternal=function(){this.state==Ni.LOADING&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},ReprojTile.prototype.getImage=function(){return this.canvas_},ReprojTile.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,n,r){e&&e.getState()==Ni.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=Ni.ERROR;else{var e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),r="number"==typeof n?n:n[0],i="number"==typeof n?n:n[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=render(r,i,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,s,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=Ni.LOADED}this.changed()},ReprojTile.prototype.load=function(){if(this.state==Ni.IDLE){this.state=Ni.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,n,r){var i=e.getState();if(i==Ni.IDLE||i==Ni.LOADING){t++;var o=listen(e,$e.CHANGE,(function(n){var r=e.getState();r!=Ni.LOADED&&r!=Ni.ERROR&&r!=Ni.EMPTY||(unlistenByKey(o),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(o)}}.bind(this)),this.sourceTiles_.forEach((function(t,e,n){t.getState()==Ni.IDLE&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},ReprojTile.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(unlistenByKey),this.sourcesListenerKeys_=null},ReprojTile}(Zo);function createFromTemplate(t,e){var n=/\{z\}/g,r=/\{x\}/g,i=/\{y\}/g,o=/\{-y\}/g;return function(a,s,u){return a?t.replace(n,a[0].toString()).replace(r,a[1].toString()).replace(i,a[2].toString()).replace(o,(function(){var t=a[0],n=e.getFullTileRange(t);return assert(n,55),(n.getHeight()-a[2]-1).toString()})):void 0}}function createFromTileUrlFunctions(t){return 1===t.length?t[0]:function(e,n,r){if(e){var i=modulo(hash(e),t.length);return t[i](e,n,r)}}}function nullTileUrlFunction(t,e,n){}function expandUrl(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var r=n[1].charCodeAt(0),i=n[2].charCodeAt(0),o=void 0;for(o=r;o<=i;++o)e.push(t.replace(n[0],String.fromCharCode(o)));return e}if(n=n=/\{(\d+)-(\d+)\}/.exec(t)){for(var a=parseInt(n[2],10),s=parseInt(n[1],10);s<=a;s++)e.push(t.replace(n[0],s.toString()));return e}return e.push(t),e}var $o=42,Qo=256,Jo=[0,0,0],ta=function(){function TileGrid(t){var e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,assert(function isSorted(t,e,n){var r=e||numberSafeCompareFunction;return t.every((function(e,i){if(0===i)return!0;var o=r(t[i-1],e);return!(o>0||n&&0===o)}))}(this.resolutions_,(function(t,e){return e-t}),!0),17),!t.origins)for(var n=0,r=this.resolutions_.length-1;n<r;++n)if(e){if(this.resolutions_[n]/this.resolutions_[n+1]!==e){e=void 0;break}}else e=this.resolutions_[n]/this.resolutions_[n+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,assert(this.origins_.length==this.resolutions_.length,20));var i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=getTopLeft(i)),assert(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,assert(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:Qo,assert(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){return new ji(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):i&&this.calculateTileRanges_(i)}return TileGrid.prototype.forEachTileCoord=function(t,e,n){for(var r=this.getTileRangeForExtentAndZ(t,e),i=r.minX,o=r.maxX;i<=o;++i)for(var a=r.minY,s=r.maxY;a<=s;++a)n([e,i,a])},TileGrid.prototype.forEachTileCoordParentTileRange=function(t,e,n,r){var i,o,a=null,s=t[0]-1;for(2===this.zoomFactor_?(i=t[1],o=t[2]):a=this.getTileCoordExtent(t,r);s>=this.minZoom;){if(e(s,2===this.zoomFactor_?createOrUpdate$1(i=Math.floor(i/2),i,o=Math.floor(o/2),o,n):this.getTileRangeForExtentAndZ(a,s,n)))return!0;--s}return!1},TileGrid.prototype.getExtent=function(){return this.extent_},TileGrid.prototype.getMaxZoom=function(){return this.maxZoom},TileGrid.prototype.getMinZoom=function(){return this.minZoom},TileGrid.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},TileGrid.prototype.getResolution=function(t){return this.resolutions_[t]},TileGrid.prototype.getResolutions=function(){return this.resolutions_},TileGrid.prototype.getTileCoordChildTileRange=function(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*t[1],i=2*t[2];return createOrUpdate$1(r,r+1,i,i+1,e)}var o=this.getTileCoordExtent(t,n);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},TileGrid.prototype.getTileRangeExtent=function(t,e,n){var r=this.getOrigin(t),i=this.getResolution(t),o=toSize(this.getTileSize(t),this.tmpSize_),a=r[0]+e.minX*o[0]*i,s=r[0]+(e.maxX+1)*o[0]*i;return createOrUpdate(a,r[1]+e.minY*o[1]*i,s,r[1]+(e.maxY+1)*o[1]*i,n)},TileGrid.prototype.getTileRangeForExtentAndZ=function(t,e,n){var r=Jo;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,r);var i=r[1],o=r[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,r),createOrUpdate$1(i,r[1],o,r[2],n)},TileGrid.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=toSize(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]},TileGrid.prototype.getTileCoordExtent=function(t,e){var n=this.getOrigin(t[0]),r=this.getResolution(t[0]),i=toSize(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*i[0]*r,a=n[1]-(t[2]+1)*i[1]*r;return createOrUpdate(o,a,o+i[0]*r,a+i[1]*r,e)},TileGrid.prototype.getTileCoordForCoordAndResolution=function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)},TileGrid.prototype.getTileCoordForXYAndResolution_=function(t,e,n,r,i){var o=this.getZForResolution(n),a=n/this.getResolution(o),s=this.getOrigin(o),u=toSize(this.getTileSize(o),this.tmpSize_),l=r?.5:0,c=r?.5:0,h=Math.floor((t-s[0])/n+l),d=Math.floor((s[1]-e)/n+c),f=a*h/u[0],p=a*d/u[1];return r?(f=Math.ceil(f)-1,p=Math.ceil(p)-1):(f=Math.floor(f),p=Math.floor(p)),createOrUpdate$2(o,f,p,i)},TileGrid.prototype.getTileCoordForXYAndZ_=function(t,e,n,r,i){var o=this.getOrigin(n),a=this.getResolution(n),s=toSize(this.getTileSize(n),this.tmpSize_),u=r?.5:0,l=r?.5:0,c=Math.floor((t-o[0])/a+u),h=Math.floor((o[1]-e)/a+l),d=c/s[0],f=h/s[1];return r?(d=Math.ceil(d)-1,f=Math.ceil(f)-1):(d=Math.floor(d),f=Math.floor(f)),createOrUpdate$2(n,d,f,i)},TileGrid.prototype.getTileCoordForCoordAndZ=function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)},TileGrid.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},TileGrid.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},TileGrid.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},TileGrid.prototype.getZForResolution=function(t,e){return clamp(linearFindNearest(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},TileGrid.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,n=new Array(e),r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n},TileGrid}();function getForProjection(t){var e=t.getDefaultTileGrid();return e||(e=function createForProjection(t,e,n,r){return function createForExtent(t,e,n,r){var i=void 0!==r?r:g.TOP_LEFT,o=function resolutionsFromExtent(t,e,n){for(var r=void 0!==e?e:$o,i=getHeight(t),o=getWidth(t),a=toSize(void 0!==n?n:Qo),s=Math.max(o/a[0],i/a[1]),u=r+1,l=new Array(u),c=0;c<u;++c)l[c]=s/Math.pow(2,c);return l}(t,e,n);return new ta({extent:t,origin:getCorner(t,i),resolutions:o,tileSize:n})}(extentFromProjection(t),e,n,r)}(t),t.setDefaultTileGrid(e)),e}function extentFromProjection(t){var e=(t=get$3(t)).getExtent();if(!e){var n=180*b[_.DEGREES]/t.getMetersPerUnit();e=createOrUpdate(-n,-n,n,n)}return e}var ea=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),na=function(t){function TileSource(e){var n=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX})||this;n.opaque_=void 0!==e.opaque&&e.opaque,n.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,n.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;var r=e.cacheSize;if(void 0===r){var i=[256,256],o=e.tileGrid;o&&toSize(o.getTileSize(o.getMinZoom()),i);var a="undefined"!=typeof screen,s=a?screen.availWidth||screen.width:1920,u=a?screen.availHeight||screen.height:1080;r=4*Math.ceil(s/i[0])*Math.ceil(u/i[1])}return n.tileCache=new Ko(r),n.tmpSize=[0,0],n.key_=e.key||"",n.tileOptions={transition:e.transition},n.zDirection=e.zDirection?e.zDirection:0,n}return ea(TileSource,t),TileSource.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},TileSource.prototype.expireCache=function(t,e){var n=this.getTileCacheForProjection(t);n&&n.expireCache(e)},TileSource.prototype.forEachLoadedTile=function(t,e,n,r){var i=this.getTileCacheForProjection(t);if(!i)return!1;for(var o,a,s,u=!0,l=n.minX;l<=n.maxX;++l)for(var c=n.minY;c<=n.maxY;++c)a=getKeyZXY(e,l,c),s=!1,i.containsKey(a)&&(s=(o=i.get(a)).getState()===Ni.LOADED)&&(s=!1!==r(o)),s||(u=!1);return u},TileSource.prototype.getGutterForProjection=function(t){return 0},TileSource.prototype.getKey=function(){return this.key_},TileSource.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},TileSource.prototype.getOpaque=function(t){return this.opaque_},TileSource.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},TileSource.prototype.getTile=function(t,e,n,r,i){return abstract()},TileSource.prototype.getTileGrid=function(){return this.tileGrid},TileSource.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:getForProjection(t)},TileSource.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!equivalent(e,t)?null:this.tileCache},TileSource.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},TileSource.prototype.getTilePixelSize=function(t,e,n){var r=this.getTileGridForProjection(n),i=this.getTilePixelRatio(e),o=toSize(r.getTileSize(t),this.tmpSize);return 1==i?o:scale(o,i,this.tmpSize)},TileSource.prototype.getTileCoordForTileUrlFunction=function(t,e){var n=void 0!==e?e:this.getProjection(),r=this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=function wrapX(t,e,n){var r=e[0],i=t.getTileCoordCenter(e),o=extentFromProjection(n);if(containsCoordinate(o,i))return e;var a=getWidth(o),s=Math.ceil((o[0]-i[0])/a);return i[0]+=a*s,t.getTileCoordForCoordAndZ(i,r)}(r,t,n)),function withinExtentAndZ(t,e){var n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;var o,a=e.getExtent();return!(o=a?e.getTileRangeForExtentAndZ(a,n):e.getFullTileRange(n))||o.containsXY(r,i)}(t,r)?t:null},TileSource.prototype.clear=function(){this.tileCache.clear()},TileSource.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},TileSource.prototype.useTile=function(t,e,n,r){},TileSource}(Po),ra=function(t){function TileSourceEvent(e,n){var r=t.call(this,e)||this;return r.tile=n,r}return ea(TileSourceEvent,t),TileSourceEvent}(Ke),ia="tileloadstart",oa="tileloadend",aa="tileloaderror",sa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ua=function(t){function UrlTile(e){var n=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return n.generateTileUrlFunction_=!e.tileUrlFunction,n.tileLoadFunction=e.tileLoadFunction,n.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(n):nullTileUrlFunction,n.urls=null,e.urls?n.setUrls(e.urls):e.url&&n.setUrl(e.url),n.tileLoadingKeys_={},n}return sa(UrlTile,t),UrlTile.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},UrlTile.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},UrlTile.prototype.getUrls=function(){return this.urls},UrlTile.prototype.handleTileChange=function(t){var e,n=t.target,r=getUid(n),i=n.getState();i==Ni.LOADING?(this.tileLoadingKeys_[r]=!0,e=ia):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],e=i==Ni.ERROR?aa:i==Ni.LOADED||i==Ni.ABORT?oa:void 0),null!=e&&this.dispatchEvent(new ra(e,n))},UrlTile.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},UrlTile.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},UrlTile.prototype.setUrl=function(t){var e=this.urls=expandUrl(t);this.setUrls(e)},UrlTile.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function createFromTemplates(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=createFromTemplate(t[i],e);return createFromTileUrlFunctions(r)}(t,this.tileGrid),e):this.setKey(e)},UrlTile.prototype.useTile=function(t,e,n){var r=getKeyZXY(t,e,n);this.tileCache.containsKey(r)&&this.tileCache.get(r)},UrlTile}(na),la=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ca=function(t){function TileImage(e){var n=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:defaultTileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return n.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,n.tileClass=void 0!==e.tileClass?e.tileClass:Yo,n.tileCacheForProjection={},n.tileGridForProjection={},n.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,n.renderReprojectionEdges_=!1,n}return la(TileImage,t),TileImage.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},TileImage.prototype.expireCache=function(t,e){var n=this.getTileCacheForProjection(t);for(var r in this.tileCache.expireCache(this.tileCache==n?e:{}),this.tileCacheForProjection){var i=this.tileCacheForProjection[r];i.expireCache(i==n?e:{})}},TileImage.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!equivalent(this.getProjection(),t)?0:this.getGutter()},TileImage.prototype.getGutter=function(){return 0},TileImage.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!equivalent(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},TileImage.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!equivalent(e,t)){var n=getUid(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=getForProjection(t)),this.tileGridForProjection[n]}return this.tileGrid},TileImage.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||equivalent(e,t))return this.tileCache;var n=getUid(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new Ko(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]},TileImage.prototype.createTile_=function(t,e,n,r,i,o){var a=[t,e,n],s=this.getTileCoordForTileUrlFunction(a,i),u=s?this.tileUrlFunction(s,r,i):void 0,l=new this.tileClass(a,void 0!==u?Ni.IDLE:Ni.EMPTY,void 0!==u?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=o,l.addEventListener($e.CHANGE,this.handleTileChange.bind(this)),l},TileImage.prototype.getTile=function(t,e,n,r,i){var o=this.getProjection();if(o&&i&&!equivalent(o,i)){var a=this.getTileCacheForProjection(i),s=[t,e,n],u=void 0,l=getKey(s);a.containsKey(l)&&(u=a.get(l));var c=this.getKey();if(u&&u.key==c)return u;var h=this.getTileGridForProjection(o),d=this.getTileGridForProjection(i),f=this.getTileCoordForTileUrlFunction(s,i),p=new Xo(o,h,i,d,s,f,this.getTilePixelRatio(r),this.getGutter(),function(t,e,n,r){return this.getTileInternal(t,e,n,r,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return p.key=c,u?(p.interimTile=u,p.refreshInterimChain(),a.replace(l,p)):a.set(l,p),p}return this.getTileInternal(t,e,n,r,o||i)},TileImage.prototype.getTileInternal=function(t,e,n,r,i){var o=null,a=getKeyZXY(t,e,n),s=this.getKey();if(this.tileCache.containsKey(a)){if((o=this.tileCache.get(a)).key!=s){var u=o;o=this.createTile_(t,e,n,r,i,s),u.getState()==Ni.IDLE?o.interimTile=u.interimTile:o.interimTile=u,o.refreshInterimChain(),this.tileCache.replace(a,o)}}else o=this.createTile_(t,e,n,r,i,s),this.tileCache.set(a,o);return o},TileImage.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},TileImage.prototype.setTileGridForProjection=function(t,e){var n=get$3(t);if(n){var r=getUid(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}},TileImage}(ua);function defaultTileLoadFunction(t,e){t.getImage().src=e}var ha=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),da=function(t){function TileWMS(e){var n=this,r=e||{},i=r.params||{},o=!("TRANSPARENT"in i)||i.TRANSPARENT;return(n=t.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,opaque:!o,projection:r.projection,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileClass:r.tileClass,tileGrid:r.tileGrid,tileLoadFunction:r.tileLoadFunction,tileUrlFunction:tileUrlFunction,url:r.url,urls:r.urls,wrapX:void 0===r.wrapX||r.wrapX,transition:r.transition})||this).gutter_=void 0!==r.gutter?r.gutter:0,n.params_=i,n.v13_=!0,n.serverType_=r.serverType,n.hidpi_=void 0===r.hidpi||r.hidpi,n.tmpExtent_=[1/0,1/0,-1/0,-1/0],n.updateV13_(),n.setKey(n.getKeyForParams_()),n}return ha(TileWMS,t),TileWMS.prototype.getFeatureInfoUrl=function(t,e,r,i){var o=get$3(r),a=this.getProjection(),s=this.getTileGrid();s||(s=this.getTileGridForProjection(o));var u=s.getZForResolution(e,this.zDirection),l=s.getTileCoordForCoordAndZ(t,u);if(!(s.getResolutions().length<=l[0])){var c=s.getResolution(l[0]),h=s.getTileCoordExtent(l,this.tmpExtent_),d=toSize(s.getTileSize(l[0]),this.tmpSize),f=this.gutter_;0!==f&&(d=buffer$1(d,f,this.tmpSize),h=buffer(h,c*f,h)),a&&a!==o&&(c=calculateSourceResolution(a,o,t,c),h=transformExtent(h,o,a),t=transform(t,o,a));var p={SERVICE:"WMS",VERSION:fo,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};n(p,this.params_,i);var m=Math.floor((t[0]-h[0])/c),y=Math.floor((h[3]-t[1])/c);return p[this.v13_?"I":"X"]=m,p[this.v13_?"J":"Y"]=y,this.getRequestUrl_(l,d,h,1,a||o,p)}},TileWMS.prototype.getLegendUrl=function(t,e){if(void 0!==this.urls[0]){var r={SERVICE:"WMS",VERSION:fo,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){var i=this.params_.LAYERS;if(!(!Array.isArray(i)||1===i.length))return;r.LAYER=i}if(void 0!==t){var o=this.getProjection()?this.getProjection().getMetersPerUnit():1;r.SCALE=t*o*39.37*(25.4/.28)}return n(r,e),appendParams(this.urls[0],r)}},TileWMS.prototype.getGutter=function(){return this.gutter_},TileWMS.prototype.getParams=function(){return this.params_},TileWMS.prototype.getRequestUrl_=function(t,e,n,r,i,o){var a=this.urls;if(a){if(o.WIDTH=e[0],o.HEIGHT=e[1],o[this.v13_?"CRS":"SRS"]=i.getCode(),"STYLES"in this.params_||(o.STYLES=""),1!=r)switch(this.serverType_){case No:var s=90*r+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+s:o.FORMAT_OPTIONS="dpi:"+s;break;case Fo:o.MAP_RESOLUTION=90*r;break;case jo:case Uo:o.DPI=90*r;break;default:assert(!1,52)}var u,l=i.getAxisOrientation(),c=n;if(this.v13_&&"ne"==l.substr(0,2)){var h=void 0;h=n[0],c[0]=n[1],c[1]=h,h=n[2],c[2]=n[3],c[3]=h}if(o.BBOX=c.join(","),1==a.length)u=a[0];else u=a[modulo(hash(t),a.length)];return appendParams(u,o)}},TileWMS.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},TileWMS.prototype.getKeyForParams_=function(){var t=0,e=[];for(var n in this.params_)e[t++]=n+"-"+this.params_[n];return e.join("/")},TileWMS.prototype.updateParams=function(t){n(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())},TileWMS.prototype.updateV13_=function(){var t=this.params_.VERSION||fo;this.v13_=compareVersions(t,"1.3")>=0},TileWMS}(ca);function tileUrlFunction(t,e,r){var i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),!(i.getResolutions().length<=t[0])){1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);var o=i.getResolution(t[0]),a=i.getTileCoordExtent(t,this.tmpExtent_),s=toSize(i.getTileSize(t[0]),this.tmpSize),u=this.gutter_;0!==u&&(s=buffer$1(s,u,this.tmpSize),a=buffer(a,o*u,a)),1!=e&&(s=scale(s,e,this.tmpSize));var l={SERVICE:"WMS",VERSION:fo,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return n(l,this.params_),this.getRequestUrl_(t,s,a,e,r,l)}}var fa={KVP:"KVP",REST:"REST"},pa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ma=function(t){function WMTSTileGrid(e){var n=t.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes})||this;return n.matrixIds_=e.matrixIds,n}return pa(WMTSTileGrid,t),WMTSTileGrid.prototype.getMatrixId=function(t){return this.matrixIds_[t]},WMTSTileGrid.prototype.getMatrixIds=function(){return this.matrixIds_},WMTSTileGrid}(ta);var ya=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ga=function(t){function WMTS(e){var n=this,r=void 0!==e.requestEncoding?e.requestEncoding:fa.KVP,i=e.tileGrid,o=e.urls;return void 0===o&&void 0!==e.url&&(o=expandUrl(e.url)),(n=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:nullTileUrlFunction,urls:o,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition})||this).version_=void 0!==e.version?e.version:"1.0.0",n.format_=void 0!==e.format?e.format:"image/jpeg",n.dimensions_=void 0!==e.dimensions?e.dimensions:{},n.layer_=e.layer,n.matrixSet_=e.matrixSet,n.style_=e.style,n.requestEncoding_=r,n.setKey(n.getKeyForDimensions_()),o&&o.length>0&&(n.tileUrlFunction=createFromTileUrlFunctions(o.map(createFromWMTSTemplate.bind(n)))),n}return ya(WMTS,t),WMTS.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(createFromTileUrlFunctions(t.map(createFromWMTSTemplate.bind(this))),e)},WMTS.prototype.getDimensions=function(){return this.dimensions_},WMTS.prototype.getFormat=function(){return this.format_},WMTS.prototype.getLayer=function(){return this.layer_},WMTS.prototype.getMatrixSet=function(){return this.matrixSet_},WMTS.prototype.getRequestEncoding=function(){return this.requestEncoding_},WMTS.prototype.getStyle=function(){return this.style_},WMTS.prototype.getVersion=function(){return this.version_},WMTS.prototype.getKeyForDimensions_=function(){var t=0,e=[];for(var n in this.dimensions_)e[t++]=n+"-"+this.dimensions_[n];return e.join("/")},WMTS.prototype.updateDimensions=function(t){n(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())},WMTS}(ca);function optionsFromCapabilities(t,e){var n=find(t.Contents.Layer,(function(t,n,r){return t.Identifier==e.layer}));if(null===n)return null;var r,i=t.Contents.TileMatrixSet;(r=n.TileMatrixSetLink.length>1?findIndex(n.TileMatrixSetLink,"projection"in e?function(t,n,r){var o=find(i,(function(e){return e.Identifier==t.TileMatrixSet})).SupportedCRS,a=get$3(o.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||get$3(o),s=get$3(e.projection);return a&&s?equivalent(a,s):o==e.projection}:function(t,n,r){return t.TileMatrixSet==e.matrixSet}):0)<0&&(r=0);var o=n.TileMatrixSetLink[r].TileMatrixSet,a=n.TileMatrixSetLink[r].TileMatrixSetLimits,s=n.Format[0];"format"in e&&(s=e.format),(r=findIndex(n.Style,(function(t,n,r){return"style"in e?t.Title==e.style:t.isDefault})))<0&&(r=0);var u=n.Style[r].Identifier,l={};"Dimension"in n&&n.Dimension.forEach((function(t,e,n){var r=t.Identifier,i=t.Default;void 0===i&&(i=t.Value[0]),l[r]=i}));var c,h=find(t.Contents.TileMatrixSet,(function(t,e,n){return t.Identifier==o})),d=h.SupportedCRS;if(d&&(c=get$3(d.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||get$3(d)),"projection"in e){var f=get$3(e.projection);f&&(c&&!equivalent(f,c)||(c=f))}var p,m,y=n.WGS84BoundingBox;if(void 0!==y){var g=get$3("EPSG:4326").getExtent();m=y[0]==g[0]&&y[2]==g[2],p=transformExtent(y,"EPSG:4326",c);var v=c.getExtent();v&&(containsExtent(v,p)||(p=void 0))}var _,b,T=function createFromCapabilitiesMatrixSet(t,e,n){var r=[],i=[],o=[],a=[],s=[],u=void 0!==n?n:[],l=t.SupportedCRS,c=get$3(l.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||get$3(l),h=c.getMetersPerUnit(),d="ne"==c.getAxisOrientation().substr(0,2);return t.TileMatrix.sort((function(t,e){return e.ScaleDenominator-t.ScaleDenominator})),t.TileMatrix.forEach((function(e){if(!(u.length>0)||find(u,(function(n){return e.Identifier==n.TileMatrix||-1===e.Identifier.indexOf(":")&&t.Identifier+":"+e.Identifier===n.TileMatrix}))){i.push(e.Identifier);var n=28e-5*e.ScaleDenominator/h,l=e.TileWidth,c=e.TileHeight;d?o.push([e.TopLeftCorner[1],e.TopLeftCorner[0]]):o.push(e.TopLeftCorner),r.push(n),a.push(l==c?l:[l,c]),s.push([e.MatrixWidth,e.MatrixHeight])}})),new ma({extent:e,origins:o,resolutions:r,matrixIds:i,tileSizes:a,sizes:s})}(h,p,a),w=[],E=e.requestEncoding;if(E=void 0!==E?E:"","OperationsMetadata"in t&&"GetTile"in t.OperationsMetadata)for(var S=t.OperationsMetadata.GetTile.DCP.HTTP.Get,M=0,O=S.length;M<O;++M)if(S[M].Constraint){var x=find(S[M].Constraint,(function(t){return"GetEncoding"==t.name})).AllowedValues.Value;if(""===E&&(E=x[0]),E!==fa.KVP)break;_=x,b=fa.KVP,_.indexOf(b)>=0&&w.push(S[M].href)}else S[M].href&&(E=fa.KVP,w.push(S[M].href));return 0===w.length&&(E=fa.REST,n.ResourceURL.forEach((function(t){"tile"===t.resourceType&&(s=t.format,w.push(t.template))}))),{urls:w,layer:e.layer,matrixSet:o,format:s,projection:c,requestEncoding:E,tileGrid:T,style:u,dimensions:l,wrapX:m,crossOrigin:e.crossOrigin}}function createFromWMTSTemplate(t){var e=this.requestEncoding_,r={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};e==fa.KVP&&n(r,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t=e==fa.KVP?appendParams(t,r):t.replace(/\{(\w+?)\}/g,(function(t,e){return e.toLowerCase()in r?r[e.toLowerCase()]:t}));var i=this.tileGrid,o=this.dimensions_;return function(r,a,s){if(r){var u={TileMatrix:i.getMatrixId(r[0]),TileCol:r[1],TileRow:r[2]};n(u,o);var l=t;return l=e==fa.KVP?appendParams(l,u):l.replace(/\{(\w+?)\}/g,(function(t,e){return u[e]}))}}}var va=function(){function SourceCreator(){_classCallCheck(this,SourceCreator)}return _createClass(SourceCreator,null,[{key:"wms",value:function wms(t,e){var n=e.sources[t.source];if(null==n)return null;var r=n.tiles[0],i=new V(r),o=Object.keys(i.query).reduce((function(t,e){return t["string"==typeof e?e.toUpperCase():e]=i.query[e],t}),{});Object.keys(t.url).forEach((function(e){o[e.toUpperCase()]=t.url[e].toString()}));var a=null!=t.time&&t.time.data.includes(e.time);a&&(o.TIME=new Date(e.time).toISOString());var s=new da({url:getBaseUrl(r),params:o,tileGrid:new ta({extent:null!=n.bounds?n.bounds:get(e.projection).getExtent(),resolutions:e.resolutions,tileSize:null!=n.tileSize?n.tileSize:1024}),transition:0});return a&&s.set("metoclient:time",e.time),s}},{key:"wmts",value:function wmts(t,e,n){if(null==e.sources[t.source]||"wmts"!==n.type)return null;var r=optionsFromCapabilities(n.data,{layer:t.url.layer,matrixSet:t.url.tilematrixset});if(null==r)return null;var i=null!=t.time&&t.time.data.includes(e.time);i&&(r.tileLoadFunction=function(t,n){t.getImage().src=n+"&Time="+new Date(e.time).toISOString()}),r.transition=0;var o=new ga(r);return null!=i&&o.set("metoclient:time",e.time),o}}]),SourceCreator}(),_a=function(){function LayerCreator(){_classCallCheck(this,LayerCreator)}return _createClass(LayerCreator,null,[{key:"tiled",value:function tiled(t,e,n){if(null==e.sources[t.source])return null;var r=t.url.service.toLowerCase();if("function"==typeof va[r]){var i=va[r](t,e,n);return null!=i?new no({source:i,preload:0,opacity:0,type:t.metadata&&t.metadata.type?t.metadata.type:"",title:t.metadata&&t.metadata.title?t.metadata.title:"",previous:null!=t.previous?t.previous:e.layers.find((function(t){return t.next===t.id})),next:null!=t.next?t.next:e.layers.find((function(t){return t.previous===t.id})),id:t.id}):null}}},{key:"image",value:function image(t,e,n){var r=e.sources[t.source];if(null==r||null==r.tiles[0]||0===r.tiles[0].length)return null;var i=getBaseUrl(r.tiles[0]),o=null!=t.time&&t.time.data.includes(e.time);if(o){var a=new Date(e.time).toISOString();t.url.TIME=a}var s=new Vo({url:i,params:t.url});return null==s?null:(o&&s.set("metoclient:time",e.time),new ho({source:s,preload:0,opacity:0,type:t.metadata&&t.metadata.type?t.metadata.type:"",title:t.metadata&&t.metadata.title?t.metadata.title:"",previous:null!=t.previous?t.previous:e.layers.find((function(t){return t.next===t.id})),next:null!=t.next?t.next:e.layers.find((function(t){return t.previous===t.id})),id:t.id}))}}]),LayerCreator}(),ba=function(){function SourceUpdater(){_classCallCheck(this,SourceUpdater)}return _createClass(SourceUpdater,null,[{key:"TileWMS",value:function TileWMS(t,e){var n=new Date(e).toISOString();t.set("metoclient:time",e),t.updateParams({TIME:n}),t.refresh()}},{key:"WMTS",value:function WMTS(t,e){var n=new Date(e).toISOString();t.set("metoclient:time",e),t.setTileLoadFunction((function(t,e){t.getImage().src=e+"&Time="+n}))}}]),SourceUpdater}(),Ta="http://www.w3.org/1999/xlink";function readHref(t){return t.getAttributeNS(Ta,"href")}document.implementation.createDocument("","",null);function getAllTextContent(t,e){return function getAllTextContent_(t,e,n){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)e?n.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):n.push(t.nodeValue);else{var r=void 0;for(r=t.firstChild;r;r=r.nextSibling)getAllTextContent_(r,e,n)}return n}(t,e,[]).join("")}function makeArrayPusher(t,e){return function(n,r){var i=t.call(void 0!==e?e:this,n,r);void 0!==i&&r[r.length-1].push(i)}}function makeObjectPropertyPusher(t,e,n){return function(r,i){var o=t.call(void 0!==n?n:this,r,i);if(void 0!==o){var a=i[i.length-1],s=void 0!==e?e:r.localName;(s in a?a[s]:a[s]=[]).push(o)}}}function makeObjectPropertySetter(t,e,n){return function(r,i){var o=t.call(void 0!==n?n:this,r,i);void 0!==o&&(i[i.length-1][void 0!==e?e:r.localName]=o)}}function makeStructureNS(t,e,n){var r,i,o=void 0!==n?n:{};for(r=0,i=t.length;r<i;++r)o[t[r]]=e;return o}function pushParseAndPop(t,e,n,r,i){return r.push(t),function parseNode(t,e,n,r){var i;for(i=e.firstElementChild;i;i=i.nextElementSibling){var o=t[i.namespaceURI];if(void 0!==o){var a=o[i.localName];void 0!==a&&a.call(r,i,n)}}}(e,n,r,i),r.pop()}var wa=function(){function XML(){}return XML.prototype.read=function(t){if(t){if("string"==typeof t){var e=function parse$1(t){return(new DOMParser).parseFromString(t,"application/xml")}(t);return this.readFromDocument(e)}return function isDocument(t){return"documentElement"in t}(t)?this.readFromDocument(t):this.readFromNode(t)}return null},XML.prototype.readFromDocument=function(t){},XML.prototype.readFromNode=function(t){},XML}();function readBooleanString(t){var e=/^\s*(true|1)|(false|0)\s*$/.exec(t);return e?void 0!==e[1]||!1:void 0}function readDecimal(t){return readDecimalString(getAllTextContent(t,!1))}function readDecimalString(t){var e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);return e?parseFloat(e[1]):void 0}function readNonNegativeInteger(t){return readNonNegativeIntegerString(getAllTextContent(t,!1))}function readNonNegativeIntegerString(t){var e=/^\s*(\d+)\s*$/.exec(t);return e?parseInt(e[1],10):void 0}function readString(t){return getAllTextContent(t,!1).trim()}var Ea=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Sa=[null,"http://www.opengis.net/wms"],Ma=makeStructureNS(Sa,{Service:makeObjectPropertySetter((function readService(t,e){return pushParseAndPop({},Ca,t,e)})),Capability:makeObjectPropertySetter((function readCapability(t,e){return pushParseAndPop({},Oa,t,e)}))}),Oa=makeStructureNS(Sa,{Request:makeObjectPropertySetter((function readRequest(t,e){return pushParseAndPop({},ja,t,e)})),Exception:makeObjectPropertySetter((function readException(t,e){return pushParseAndPop([],La,t,e)})),Layer:makeObjectPropertySetter((function readCapabilityLayer(t,e){return pushParseAndPop({},ka,t,e)}))}),xa=function(t){function WMSCapabilities(){var e=t.call(this)||this;return e.version=void 0,e}return Ea(WMSCapabilities,t),WMSCapabilities.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},WMSCapabilities.prototype.readFromNode=function(t){this.version=t.getAttribute("version").trim();var e=pushParseAndPop({version:this.version},Ma,t,[]);return e||null},WMSCapabilities}(wa),Ca=makeStructureNS(Sa,{Name:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),KeywordList:makeObjectPropertySetter(readKeywordList),OnlineResource:makeObjectPropertySetter(readHref),ContactInformation:makeObjectPropertySetter((function readContactInformation(t,e){return pushParseAndPop({},Pa,t,e)})),Fees:makeObjectPropertySetter(readString),AccessConstraints:makeObjectPropertySetter(readString),LayerLimit:makeObjectPropertySetter(readNonNegativeInteger),MaxWidth:makeObjectPropertySetter(readNonNegativeInteger),MaxHeight:makeObjectPropertySetter(readNonNegativeInteger)}),Pa=makeStructureNS(Sa,{ContactPersonPrimary:makeObjectPropertySetter((function readContactPersonPrimary(t,e){return pushParseAndPop({},Ia,t,e)})),ContactPosition:makeObjectPropertySetter(readString),ContactAddress:makeObjectPropertySetter((function readContactAddress(t,e){return pushParseAndPop({},Ra,t,e)})),ContactVoiceTelephone:makeObjectPropertySetter(readString),ContactFacsimileTelephone:makeObjectPropertySetter(readString),ContactElectronicMailAddress:makeObjectPropertySetter(readString)}),Ia=makeStructureNS(Sa,{ContactPerson:makeObjectPropertySetter(readString),ContactOrganization:makeObjectPropertySetter(readString)}),Ra=makeStructureNS(Sa,{AddressType:makeObjectPropertySetter(readString),Address:makeObjectPropertySetter(readString),City:makeObjectPropertySetter(readString),StateOrProvince:makeObjectPropertySetter(readString),PostCode:makeObjectPropertySetter(readString),Country:makeObjectPropertySetter(readString)}),La=makeStructureNS(Sa,{Format:makeArrayPusher(readString)}),ka=makeStructureNS(Sa,{Name:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),KeywordList:makeObjectPropertySetter(readKeywordList),CRS:makeObjectPropertyPusher(readString),EX_GeographicBoundingBox:makeObjectPropertySetter((function readEXGeographicBoundingBox(t,e){var n=pushParseAndPop({},Da,t,e);if(!n)return;var r=n.westBoundLongitude,i=n.southBoundLatitude,o=n.eastBoundLongitude,a=n.northBoundLatitude;if(void 0===r||void 0===i||void 0===o||void 0===a)return;return[r,i,o,a]})),BoundingBox:makeObjectPropertyPusher((function readBoundingBox(t,e){var n=[readDecimalString(t.getAttribute("minx")),readDecimalString(t.getAttribute("miny")),readDecimalString(t.getAttribute("maxx")),readDecimalString(t.getAttribute("maxy"))],r=[readDecimalString(t.getAttribute("resx")),readDecimalString(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS"),extent:n,res:r}})),Dimension:makeObjectPropertyPusher((function readDimension(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:readBooleanString(t.getAttribute("multipleValues")),nearestValue:readBooleanString(t.getAttribute("nearestValue")),current:readBooleanString(t.getAttribute("current")),values:readString(t)}})),Attribution:makeObjectPropertySetter((function readAttribution(t,e){return pushParseAndPop({},Aa,t,e)})),AuthorityURL:makeObjectPropertyPusher((function readAuthorityURL(t,e){var n=readFormatOnlineresource(t,e);if(n)return n.name=t.getAttribute("name"),n;return})),Identifier:makeObjectPropertyPusher(readString),MetadataURL:makeObjectPropertyPusher((function readMetadataURL(t,e){var n=readFormatOnlineresource(t,e);if(n)return n.type=t.getAttribute("type"),n;return})),DataURL:makeObjectPropertyPusher(readFormatOnlineresource),FeatureListURL:makeObjectPropertyPusher(readFormatOnlineresource),Style:makeObjectPropertyPusher((function readStyle(t,e){return pushParseAndPop({},Ga,t,e)})),MinScaleDenominator:makeObjectPropertySetter(readDecimal),MaxScaleDenominator:makeObjectPropertySetter(readDecimal),Layer:makeObjectPropertyPusher((function readLayer(t,e){var n=e[e.length-1],r=pushParseAndPop({},ka,t,e);if(!r)return;var i=readBooleanString(t.getAttribute("queryable"));void 0===i&&(i=n.queryable);r.queryable=void 0!==i&&i;var o=readNonNegativeIntegerString(t.getAttribute("cascaded"));void 0===o&&(o=n.cascaded);r.cascaded=o;var a=readBooleanString(t.getAttribute("opaque"));void 0===a&&(a=n.opaque);r.opaque=void 0!==a&&a;var s=readBooleanString(t.getAttribute("noSubsets"));void 0===s&&(s=n.noSubsets);r.noSubsets=void 0!==s&&s;var u=readDecimalString(t.getAttribute("fixedWidth"));u||(u=n.fixedWidth);r.fixedWidth=u;var l=readDecimalString(t.getAttribute("fixedHeight"));l||(l=n.fixedHeight);r.fixedHeight=l,["Style","CRS","AuthorityURL"].forEach((function(t){if(t in n){var e=r[t]||[];r[t]=e.concat(n[t])}}));return["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach((function(t){if(!(t in r)){var e=n[t];r[t]=e}})),r}))}),Aa=makeStructureNS(Sa,{Title:makeObjectPropertySetter(readString),OnlineResource:makeObjectPropertySetter(readHref),LogoURL:makeObjectPropertySetter(readSizedFormatOnlineresource)}),Da=makeStructureNS(Sa,{westBoundLongitude:makeObjectPropertySetter(readDecimal),eastBoundLongitude:makeObjectPropertySetter(readDecimal),southBoundLatitude:makeObjectPropertySetter(readDecimal),northBoundLatitude:makeObjectPropertySetter(readDecimal)}),ja=makeStructureNS(Sa,{GetCapabilities:makeObjectPropertySetter(readOperationType),GetMap:makeObjectPropertySetter(readOperationType),GetFeatureInfo:makeObjectPropertySetter(readOperationType)}),Na=makeStructureNS(Sa,{Format:makeObjectPropertyPusher(readString),DCPType:makeObjectPropertyPusher((function readDCPType(t,e){return pushParseAndPop({},Fa,t,e)}))}),Fa=makeStructureNS(Sa,{HTTP:makeObjectPropertySetter((function readHTTP(t,e){return pushParseAndPop({},Ua,t,e)}))}),Ua=makeStructureNS(Sa,{Get:makeObjectPropertySetter(readFormatOnlineresource),Post:makeObjectPropertySetter(readFormatOnlineresource)}),Ga=makeStructureNS(Sa,{Name:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),LegendURL:makeObjectPropertyPusher(readSizedFormatOnlineresource),StyleSheetURL:makeObjectPropertySetter(readFormatOnlineresource),StyleURL:makeObjectPropertySetter(readFormatOnlineresource)}),za=makeStructureNS(Sa,{Format:makeObjectPropertySetter(readString),OnlineResource:makeObjectPropertySetter(readHref)}),Va=makeStructureNS(Sa,{Keyword:makeArrayPusher(readString)});function readFormatOnlineresource(t,e){return pushParseAndPop({},za,t,e)}function readOperationType(t,e){return pushParseAndPop({},Na,t,e)}function readSizedFormatOnlineresource(t,e){var n=readFormatOnlineresource(t,e);if(n){var r=[readNonNegativeIntegerString(t.getAttribute("width")),readNonNegativeIntegerString(t.getAttribute("height"))];return n.size=r,n}}function readKeywordList(t,e){return pushParseAndPop([],Va,t,e)}var qa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Za=[null,"http://www.opengis.net/ows/1.1"],Wa=makeStructureNS(Za,{ServiceIdentification:makeObjectPropertySetter((function readServiceIdentification(t,e){return pushParseAndPop({},is,t,e)})),ServiceProvider:makeObjectPropertySetter((function readServiceProvider(t,e){return pushParseAndPop({},os,t,e)})),OperationsMetadata:makeObjectPropertySetter((function readOperationsMetadata(t,e){return pushParseAndPop({},ts,t,e)}))}),Ya=function(t){function OWS(){return t.call(this)||this}return qa(OWS,t),OWS.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},OWS.prototype.readFromNode=function(t){var e=pushParseAndPop({},Wa,t,[]);return e||null},OWS}(wa),Ba=makeStructureNS(Za,{DeliveryPoint:makeObjectPropertySetter(readString),City:makeObjectPropertySetter(readString),AdministrativeArea:makeObjectPropertySetter(readString),PostalCode:makeObjectPropertySetter(readString),Country:makeObjectPropertySetter(readString),ElectronicMailAddress:makeObjectPropertySetter(readString)}),Ka=makeStructureNS(Za,{Value:makeObjectPropertyPusher((function readValue(t,e){return readString(t)}))}),Ha=makeStructureNS(Za,{AllowedValues:makeObjectPropertySetter((function readAllowedValues(t,e){return pushParseAndPop({},Ka,t,e)}))}),Xa=makeStructureNS(Za,{Phone:makeObjectPropertySetter((function readPhone(t,e){return pushParseAndPop({},es,t,e)})),Address:makeObjectPropertySetter((function readAddress(t,e){return pushParseAndPop({},Ba,t,e)}))}),$a=makeStructureNS(Za,{HTTP:makeObjectPropertySetter((function readHttp(t,e){return pushParseAndPop({},Qa,t,e)}))}),Qa=makeStructureNS(Za,{Get:makeObjectPropertyPusher((function readGet(t,e){var n=readHref(t);if(!n)return;return pushParseAndPop({href:n},ns,t,e)})),Post:void 0}),Ja=makeStructureNS(Za,{DCP:makeObjectPropertySetter((function readDcp(t,e){return pushParseAndPop({},$a,t,e)}))}),ts=makeStructureNS(Za,{Operation:function readOperation(t,e){var n=t.getAttribute("name"),r=pushParseAndPop({},Ja,t,e);if(!r)return;e[e.length-1][n]=r}}),es=makeStructureNS(Za,{Voice:makeObjectPropertySetter(readString),Facsimile:makeObjectPropertySetter(readString)}),ns=makeStructureNS(Za,{Constraint:makeObjectPropertyPusher((function readConstraint(t,e){var n=t.getAttribute("name");if(!n)return;return pushParseAndPop({name:n},Ha,t,e)}))}),rs=makeStructureNS(Za,{IndividualName:makeObjectPropertySetter(readString),PositionName:makeObjectPropertySetter(readString),ContactInfo:makeObjectPropertySetter((function readContactInfo(t,e){return pushParseAndPop({},Xa,t,e)}))}),is=makeStructureNS(Za,{Abstract:makeObjectPropertySetter(readString),AccessConstraints:makeObjectPropertySetter(readString),Fees:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),ServiceTypeVersion:makeObjectPropertySetter(readString),ServiceType:makeObjectPropertySetter(readString)}),os=makeStructureNS(Za,{ProviderName:makeObjectPropertySetter(readString),ProviderSite:makeObjectPropertySetter(readHref),ServiceContact:makeObjectPropertySetter((function readServiceContact(t,e){return pushParseAndPop({},rs,t,e)}))});var as=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ss=[null,"http://www.opengis.net/wmts/1.0"],us=[null,"http://www.opengis.net/ows/1.1"],ls=makeStructureNS(ss,{Contents:makeObjectPropertySetter((function readContents(t,e){return pushParseAndPop({},hs,t,e)}))}),cs=function(t){function WMTSCapabilities(){var e=t.call(this)||this;return e.owsParser_=new Ya,e}return as(WMTSCapabilities,t),WMTSCapabilities.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},WMTSCapabilities.prototype.readFromNode=function(t){var e=t.getAttribute("version").trim(),n=this.owsParser_.readFromNode(t);return n?(n.version=e,(n=pushParseAndPop(n,ls,t,[]))||null):null},WMTSCapabilities}(wa),hs=makeStructureNS(ss,{Layer:makeObjectPropertyPusher((function readLayer$1(t,e){return pushParseAndPop({},ds,t,e)})),TileMatrixSet:makeObjectPropertyPusher((function readTileMatrixSet(t,e){return pushParseAndPop({},_s,t,e)}))}),ds=makeStructureNS(ss,{Style:makeObjectPropertyPusher((function readStyle$1(t,e){var n=pushParseAndPop({},fs,t,e);if(!n)return;var r="true"===t.getAttribute("isDefault");return n.isDefault=r,n})),Format:makeObjectPropertyPusher(readString),TileMatrixSetLink:makeObjectPropertyPusher((function readTileMatrixSetLink(t,e){return pushParseAndPop({},ps,t,e)})),Dimension:makeObjectPropertyPusher((function readDimensions(t,e){return pushParseAndPop({},gs,t,e)})),ResourceURL:makeObjectPropertyPusher((function readResourceUrl(t,e){var n=t.getAttribute("format"),r=t.getAttribute("template"),i=t.getAttribute("resourceType"),o={};n&&(o.format=n);r&&(o.template=r);i&&(o.resourceType=i);return o}))},makeStructureNS(us,{Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),WGS84BoundingBox:makeObjectPropertySetter((function readWgs84BoundingBox(t,e){var n=pushParseAndPop([],vs,t,e);if(2!=n.length)return;return boundingExtent(n)})),Identifier:makeObjectPropertySetter(readString)})),fs=makeStructureNS(ss,{LegendURL:makeObjectPropertyPusher((function readLegendUrl(t,e){var n={};return n.format=t.getAttribute("format"),n.href=readHref(t),n}))},makeStructureNS(us,{Title:makeObjectPropertySetter(readString),Identifier:makeObjectPropertySetter(readString)})),ps=makeStructureNS(ss,{TileMatrixSet:makeObjectPropertySetter(readString),TileMatrixSetLimits:makeObjectPropertySetter((function readTileMatrixLimitsList(t,e){return pushParseAndPop([],ms,t,e)}))}),ms=makeStructureNS(ss,{TileMatrixLimits:makeArrayPusher((function readTileMatrixLimits(t,e){return pushParseAndPop({},ys,t,e)}))}),ys=makeStructureNS(ss,{TileMatrix:makeObjectPropertySetter(readString),MinTileRow:makeObjectPropertySetter(readNonNegativeInteger),MaxTileRow:makeObjectPropertySetter(readNonNegativeInteger),MinTileCol:makeObjectPropertySetter(readNonNegativeInteger),MaxTileCol:makeObjectPropertySetter(readNonNegativeInteger)}),gs=makeStructureNS(ss,{Default:makeObjectPropertySetter(readString),Value:makeObjectPropertyPusher(readString)},makeStructureNS(us,{Identifier:makeObjectPropertySetter(readString)})),vs=makeStructureNS(us,{LowerCorner:makeArrayPusher(readCoordinates),UpperCorner:makeArrayPusher(readCoordinates)}),_s=makeStructureNS(ss,{WellKnownScaleSet:makeObjectPropertySetter(readString),TileMatrix:makeObjectPropertyPusher((function readTileMatrix(t,e){return pushParseAndPop({},bs,t,e)}))},makeStructureNS(us,{SupportedCRS:makeObjectPropertySetter(readString),Identifier:makeObjectPropertySetter(readString)})),bs=makeStructureNS(ss,{TopLeftCorner:makeObjectPropertySetter(readCoordinates),ScaleDenominator:makeObjectPropertySetter(readDecimal),TileWidth:makeObjectPropertySetter(readNonNegativeInteger),TileHeight:makeObjectPropertySetter(readNonNegativeInteger),MatrixWidth:makeObjectPropertySetter(readNonNegativeInteger),MatrixHeight:makeObjectPropertySetter(readNonNegativeInteger)},makeStructureNS(us,{Identifier:makeObjectPropertySetter(readString)}));function readCoordinates(t,e){var n=readString(t).split(/\s+/);if(n&&2==n.length){var r=+n[0],i=+n[1];if(!isNaN(r)&&!isNaN(i))return[r,i]}}var Ts=function(){function CapabilitiesReader(){_classCallCheck(this,CapabilitiesReader)}return _createClass(CapabilitiesReader,null,[{key:"wms",value:function wms(t){return(new xa).read(t)}},{key:"wmts",value:function wmts(t){return(new cs).read(t)}}]),CapabilitiesReader}(),ws={ADD:"add",REMOVE:"remove"},Es=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Ss="length",Ms=function(t){function CollectionEvent(e,n,r){var i=t.call(this,e)||this;return i.element=n,i.index=r,i}return Es(CollectionEvent,t),CollectionEvent}(Ke),Os=function(t){function Collection(e,n){var r=t.call(this)||this,i=n||{};if(r.unique_=!!i.unique,r.array_=e||[],r.unique_)for(var o=0,a=r.array_.length;o<a;++o)r.assertUnique_(r.array_[o],o);return r.updateLength_(),r}return Es(Collection,t),Collection.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},Collection.prototype.extend=function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this},Collection.prototype.forEach=function(t){for(var e=this.array_,n=0,r=e.length;n<r;++n)t(e[n],n,e)},Collection.prototype.getArray=function(){return this.array_},Collection.prototype.item=function(t){return this.array_[t]},Collection.prototype.getLength=function(){return this.get(Ss)},Collection.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ms(ws.ADD,e,t))},Collection.prototype.pop=function(){return this.removeAt(this.getLength()-1)},Collection.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},Collection.prototype.remove=function(t){for(var e=this.array_,n=0,r=e.length;n<r;++n)if(e[n]===t)return this.removeAt(n)},Collection.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ms(ws.REMOVE,e,t)),e},Collection.prototype.setAt=function(t,e){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(e,t);var r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ms(ws.REMOVE,r,t)),this.dispatchEvent(new Ms(ws.ADD,e,t))}else{for(var i=n;i<t;++i)this.insertAt(i,void 0);this.insertAt(t,e)}},Collection.prototype.updateLength_=function(){this.set(Ss,this.array_.length)},Collection.prototype.assertUnique_=function(t,e){for(var n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==e)throw new y(58)},Collection}(nn),xs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Cs=function(t){function MapEvent(e,n,r){var i=t.call(this,e)||this;return i.map=n,i.frameState=void 0!==r?r:null,i}return xs(MapEvent,t),MapEvent}(Ke),Ps=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Is=function(t){function MapBrowserEvent(e,n,r,i,o){var a=t.call(this,e,n,o)||this;return a.originalEvent=r,a.pixel_=null,a.coordinate_=null,a.dragging=void 0!==i&&i,a}return Ps(MapBrowserEvent,t),Object.defineProperty(MapBrowserEvent.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!0,configurable:!0}),Object.defineProperty(MapBrowserEvent.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!0,configurable:!0}),MapBrowserEvent.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},MapBrowserEvent.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},MapBrowserEvent}(Cs),Rs=(createCommonjsModule((function(t,e){
/*!
   * PEP v0.5.3 | https://github.com/jquery/PEP
   * Copyright jQuery Foundation and other contributors | http://jquery.org/license
   */
t.exports=function(){var t=["bubbles","cancelable","view","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],e=[!1,!1,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function PointerEvent(n,r){r=r||Object.create(null);var i=document.createEvent("Event");i.initEvent(n,r.bubbles||!1,r.cancelable||!1);for(var o,a=2;a<t.length;a++)i[o=t[a]]=r[o]||e[a];i.buttons=r.buttons||0;var s=0;return s=void 0!==r.pressure&&i.buttons?r.pressure:i.buttons?.5:0,i.x=i.clientX,i.y=i.clientY,i.pointerId=r.pointerId||0,i.width=r.width||1,i.height=r.height||1,i.pressure=s,i.tiltX=r.tiltX||0,i.tiltY=r.tiltY||0,i.twist=r.twist||0,i.tangentialPressure=r.tangentialPressure||0,i.pointerType=r.pointerType||"",i.hwTimestamp=r.hwTimestamp||0,i.isPrimary=r.isPrimary||!1,i.detail=0,i}var n=window.Map&&window.Map.prototype.forEach?Map:SparseArrayMap;function SparseArrayMap(){this.array=[],this.size=0}SparseArrayMap.prototype={set:function(t,e){if(void 0===e)return this.delete(t);this.has(t)||this.size++,this.array[t]=e},has:function(t){return void 0!==this.array[t]},delete:function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,e){return this.array.forEach((function(n,r){t.call(e,n,r,this)}),this)}};var r=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],i=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],o={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},a="undefined"!=typeof SVGElementInstance,s={pointermap:new n,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(t,e){var n=e,r=n.events;r&&(r.forEach((function(t){n[t]&&(this.eventMap[t]=n[t].bind(n))}),this),this.eventSources[t]=n,this.eventSourceList.push(n))},register:function(t){for(var e,n=this.eventSourceList.length,r=0;r<n&&(e=this.eventSourceList[r]);r++)e.register.call(e,t)},unregister:function(t){for(var e,n=this.eventSourceList.length,r=0;r<n&&(e=this.eventSourceList[r]);r++)e.unregister.call(e,t)},contains:function(t,e){try{return t.contains(e)}catch(t){return!1}},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){t.bubbles=!1,this.fireEvent("pointerenter",t)},leave:function(t){t.bubbles=!1,this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.propagate(t,this.leave,!1)},enterOver:function(t){this.over(t),this.propagate(t,this.enter,!0)},eventHandler:function(t){if(!t._handledByPE){var e=t.type,n=this.eventMap&&this.eventMap[e];n&&n(t),t._handledByPE=!0}},listen:function(t,e){e.forEach((function(e){this.addEvent(t,e)}),this)},unlisten:function(t,e){e.forEach((function(e){this.removeEvent(t,e)}),this)},addEvent:function(t,e){t.addEventListener(e,this.boundHandler)},removeEvent:function(t,e){t.removeEventListener(e,this.boundHandler)},makeEvent:function(t,e){this.captureInfo[e.pointerId]&&(e.relatedTarget=null);var n=new PointerEvent(t,e);return e.preventDefault&&(n.preventDefault=e.preventDefault),n._target=n._target||e.target,n},fireEvent:function(t,e){var n=this.makeEvent(t,e);return this.dispatchEvent(n)},cloneEvent:function(t){for(var e,n=Object.create(null),o=0;o<r.length;o++)n[e=r[o]]=t[e]||i[o],!a||"target"!==e&&"relatedTarget"!==e||n[e]instanceof SVGElementInstance&&(n[e]=n[e].correspondingUseElement);return t.preventDefault&&(n.preventDefault=function(){t.preventDefault()}),n},getTarget:function(t){var e=this.captureInfo[t.pointerId];return e?t._target!==e&&t.type in o?void 0:e:t._target},propagate:function(t,e,n){for(var r=t.target,i=[];null!=r&&r!==document&&!r.contains(t.relatedTarget);)if(i.push(r),!(r=r.parentNode))return;n&&i.reverse(),i.forEach((function(n){t.target=n,e.call(this,t)}),this)},setCapture:function(t,e,n){this.captureInfo[t]&&this.releaseCapture(t,n),this.captureInfo[t]=e,this.implicitRelease=this.releaseCapture.bind(this,t,n),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var r=new PointerEvent("gotpointercapture",{bubbles:!0});r.pointerId=t,r._target=e,n||this.asyncDispatchEvent(r)},releaseCapture:function(t,e){var n=this.captureInfo[t];if(n){this.captureInfo[t]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var r=new PointerEvent("lostpointercapture",{bubbles:!0});r.pointerId=t,r._target=n,e||this.asyncDispatchEvent(r)}},dispatchEvent:function(t){var e=this.getTarget(t);if(e)return e.dispatchEvent(t)},asyncDispatchEvent:function(t){requestAnimationFrame(this.dispatchEvent.bind(this,t))}};s.boundHandler=s.eventHandler.bind(s);var u={shadow:function(t){if(t)return t.shadowRoot||t.webkitShadowRoot},canTarget:function(t){return t&&Boolean(t.elementFromPoint)},targetingShadow:function(t){var e=this.shadow(t);if(this.canTarget(e))return e},olderShadow:function(t){var e=t.olderShadowRoot;if(!e){var n=t.querySelector("shadow");n&&(e=n.olderShadowRoot)}return e},allShadows:function(t){for(var e=[],n=this.shadow(t);n;)e.push(n),n=this.olderShadow(n);return e},searchRoot:function(t,e,n){if(t){var r,i,o=t.elementFromPoint(e,n);for(i=this.targetingShadow(o);i;){if(r=i.elementFromPoint(e,n)){var a=this.targetingShadow(r);return this.searchRoot(a,e,n)||r}i=this.olderShadow(i)}return o}},owner:function(t){for(var e=t;e.parentNode;)e=e.parentNode;return e.nodeType!==Node.DOCUMENT_NODE&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(e=document),e},findTarget:function(t){var e=t.clientX,n=t.clientY,r=this.owner(t.target);return r.elementFromPoint(e,n)||(r=document),this.searchRoot(r,e,n)}},l=Array.prototype.forEach.call.bind(Array.prototype.forEach),c=Array.prototype.map.call.bind(Array.prototype.map),h=Array.prototype.slice.call.bind(Array.prototype.slice),d=Array.prototype.filter.call.bind(Array.prototype.filter),f=window.MutationObserver||window.WebKitMutationObserver,p={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function Installer(t,e,n,r){this.addCallback=t.bind(r),this.removeCallback=e.bind(r),this.changedCallback=n.bind(r),f&&(this.observer=new f(this.mutationWatcher.bind(this)))}function rule(t){return"{ -ms-touch-action: "+t+"; touch-action: "+t+"; }"}Installer.prototype={watchSubtree:function(t){this.observer&&u.canTarget(t)&&this.observer.observe(t,p)},enableOnSubtree:function(t){this.watchSubtree(t),t===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(t)},installNewSubtree:function(t){l(this.findElements(t),this.addElement,this)},findElements:function(t){return t.querySelectorAll?t.querySelectorAll("[touch-action]"):[]},removeElement:function(t){this.removeCallback(t)},addElement:function(t){this.addCallback(t)},elementChanged:function(t,e){this.changedCallback(t,e)},concatLists:function(t,e){return t.concat(h(e))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(t){return t.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(t){var e=c(t,this.findElements,this);return e.push(d(t,this.isElement)),e.reduce(this.concatLists,[])},mutationWatcher:function(t){t.forEach(this.mutationHandler,this)},mutationHandler:function(t){"childList"===t.type?(this.flattenMutationTree(t.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(t.removedNodes).forEach(this.removeElement,this)):"attributes"===t.type&&this.elementChanged(t.target,t.oldValue)}};var m=[{selector:'[touch-action="none"]',value:"none"},{selector:'[touch-action="auto"]',value:"auto"},{selector:'[touch-action~="pan-x"]',value:"pan-x"},{selector:'[touch-action~="pan-y"]',value:"pan-y"},{selector:'[touch-action~="pan-up"]',value:"pan-up"},{selector:'[touch-action~="pan-down"]',value:"pan-down"},{selector:'[touch-action~="pan-left"]',value:"pan-left"},{selector:'[touch-action~="pan-right"]',value:"pan-right"}],y="",g=window.PointerEvent||window.MSPointerEvent,v=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,_=s.pointermap,b=[1,4,2,8,16],T=!1;try{T=1===new MouseEvent("test",{buttons:1}).buttons}catch(t){}var w,E={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","webkitmouseforcechanged","mousemove","mouseup","mouseover","mouseout"],register:function(t){s.listen(t,this.events)},unregister:function(t){s.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,n=this.lastTouches,r=t.clientX,i=t.clientY,o=0,a=n.length;o<a&&(e=n[o]);o++){var s=Math.abs(r-e.x),u=Math.abs(i-e.y);if(s<=25&&u<=25)return!0}},prepareEvent:function(t){var e=s.cloneEvent(t),n=e.preventDefault;return e.preventDefault=function(){t.preventDefault(),n()},e.pointerId=this.POINTER_ID,e.isPrimary=!0,e.pointerType=this.POINTER_TYPE,"webkitForce"in t&&(e.pressure=t.webkitForce-MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN),e},prepareButtonsForMove:function(t,e){var n=_.get(this.POINTER_ID);0!==e.which&&n?t.buttons=n.buttons:t.buttons=0,e.buttons=t.buttons},mousedown:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=_.get(this.POINTER_ID),n=this.prepareEvent(t);T||(n.buttons=b[n.button],e&&(n.buttons|=e.buttons),t.buttons=n.buttons),_.set(this.POINTER_ID,t),e&&0!==e.buttons?s.move(n):s.down(n)}},webkitmouseforcechanged:function(t){this.mousemove(t)},mousemove:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);T||this.prepareButtonsForMove(e,t),e.button=-1,_.set(this.POINTER_ID,t),s.move(e)}},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=_.get(this.POINTER_ID),n=this.prepareEvent(t);if(!T){var r=b[n.button];n.buttons=e?e.buttons&~r:0,t.buttons=n.buttons}_.set(this.POINTER_ID,t),n.buttons&=~b[n.button],0===n.buttons?s.up(n):s.move(n)}},mouseover:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);T||this.prepareButtonsForMove(e,t),e.button=-1,_.set(this.POINTER_ID,t),s.enterOver(e)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);T||this.prepareButtonsForMove(e,t),e.button=-1,s.leaveOut(e)}},cancel:function(t){var e=this.prepareEvent(t);s.cancel(e),this.deactivateMouse()},deactivateMouse:function(){_.delete(this.POINTER_ID)}},S=s.captureInfo,M=u.findTarget.bind(u),O=u.allShadows.bind(u),x=s.pointermap,C={events:["touchstart","touchmove","touchforcechange","touchend","touchcancel"],register:function(t){w.enableOnSubtree(t)},unregister:function(){},elementAdded:function(t){var e=t.getAttribute("touch-action"),n=this.touchActionToScrollType(e);"number"==typeof n&&(t._scrollType=n,s.listen(t,this.events),O(t).forEach((function(t){t._scrollType=n,s.listen(t,this.events)}),this))},elementRemoved:function(t){if(x.size>0){var e=this.events;t.addEventListener("touchend",(function(){t._scrollType=void 0,s.unlisten(t,e)}))}else t._scrollType=void 0,s.unlisten(t,this.events);O(t).forEach((function(t){t._scrollType=void 0,s.unlisten(t,this.events)}),this)},elementChanged:function(t,e){var n=t.getAttribute("touch-action"),r=this.touchActionToScrollType(n),i=this.touchActionToScrollType(e);"number"==typeof r&&"number"==typeof i?(t._scrollType=r,O(t).forEach((function(t){t._scrollType=r}),this)):"number"==typeof i?this.elementRemoved(t):"number"==typeof r&&this.elementAdded(t)},scrollTypes:{UP:function(t){return t.includes("pan-y")||t.includes("pan-up")?1:0},DOWN:function(t){return t.includes("pan-y")||t.includes("pan-down")?2:0},LEFT:function(t){return t.includes("pan-x")||t.includes("pan-left")?4:0},RIGHT:function(t){return t.includes("pan-x")||t.includes("pan-right")?8:0}},touchActionToScrollType:function(t){if(t){if("auto"===t)return 15;if("none"===t)return 0;var e=t.split(" "),n=this.scrollTypes;return n.UP(e)|n.DOWN(e)|n.LEFT(e)|n.RIGHT(e)}},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===x.size||1===x.size&&x.has(1))&&(this.firstTouch=t.identifier,this.firstXY={X:t.clientX,Y:t.clientY},this.scrolling=!1)},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.firstXY=null)},typeToButtons:function(t){var e=0;return"touchstart"!==t&&"touchmove"!==t&&"touchforcechange"!==t||(e=1),e},touchToPointer:function(t){var e=this.currentTouchEvent,n=s.cloneEvent(t),r=n.pointerId=t.identifier+2;if(n.target=S[r]||M(n),n.bubbles=!0,n.cancelable=!0,n.button=0,n.buttons=this.typeToButtons(e.type),n.width=2*(t.radiusX||t.webkitRadiusX||0),n.height=2*(t.radiusY||t.webkitRadiusY||0),n.pressure=void 0!==t.force?t.force:void 0!==t.webkitForce?t.webkitForce:void 0,n.isPrimary=this.isPrimaryTouch(t),t.altitudeAngle){var i=Math.tan(t.altitudeAngle),o=180/Math.PI;n.tiltX=Math.atan(Math.cos(t.azimuthAngle)/i)*o,n.tiltY=Math.atan(Math.sin(t.azimuthAngle)/i)*o}else n.tiltX=0,n.tiltY=0;"stylus"===t.touchType?n.pointerType="pen":n.pointerType=this.POINTER_TYPE,n.altKey=e.altKey,n.ctrlKey=e.ctrlKey,n.metaKey=e.metaKey,n.shiftKey=e.shiftKey;var a=this;return n.preventDefault=function(){a.scrolling=!1,a.firstXY=null,e.preventDefault()},n},processTouches:function(t,e){var n=t.changedTouches;this.currentTouchEvent=t;for(var r,i=0;i<n.length;i++)r=n[i],e.call(this,this.touchToPointer(r))},shouldScroll:function(t){if(this.firstXY){var e,n=t.currentTarget._scrollType;if(0===n)e=!1;else if(15===n)e=!0;else{var r=t.changedTouches[0],i=r.clientY-this.firstXY.Y,o=Math.abs(i),a=r.clientX-this.firstXY.X,s=Math.abs(a),u=1&n,l=2&n,c=4&n,h=8&n;c&&h?e=s>o:c?e=s>o&&a>0:h&&(e=s>o&&a<0),e||(u&&l?e=s<o:u?e=s<o&&i>0:l&&(e=s<o&&i<0))}return this.firstXY=null,e}},findTouch:function(t,e){for(var n,r=0,i=t.length;r<i&&(n=t[r]);r++)if(n.identifier===e)return!0},vacuumTouches:function(t){var e=t.touches;if(x.size>=e.length){var n=[];x.forEach((function(t,r){if(1!==r&&!this.findTouch(e,r-2)){var i=t.out;n.push(i)}}),this),n.forEach(this.cancelOut,this)}},touchstart:function(t){this.vacuumTouches(t),this.setPrimaryTouch(t.changedTouches[0]),this.dedupSynthMouse(t),this.scrolling||this.processTouches(t,this.overDown)},overDown:function(t){x.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),s.enterOver(t),s.down(t)},touchforcechange:function(t){this.touchmove(t)},touchmove:function(t){this.scrolling||(this.shouldScroll(t)?(this.scrolling=!0,this.touchcancel(t)):("touchforcechange"!==t.type&&t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var e=t,n=x.get(e.pointerId);if(n){var r=n.out,i=n.outTarget;s.move(e),r&&i!==e.target&&(r.relatedTarget=e.target,e.relatedTarget=i,r.target=i,e.target?(s.leaveOut(r),s.enterOver(e)):(e.target=i,e.relatedTarget=null,this.cancelOut(e))),n.out=e,n.outTarget=e.target}},touchend:function(t){this.dedupSynthMouse(t),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(s.up(t),s.leaveOut(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){s.cancel(t),s.leaveOut(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){x.delete(t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var e=E.lastTouches,n=t.changedTouches[0];if(this.isPrimaryTouch(n)){var r={x:n.clientX,y:n.clientY};e.push(r);var i=function(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}.bind(null,e,r);setTimeout(i,2500)}}};w=new Installer(C.elementAdded,C.elementRemoved,C.elementChanged,C);var P,I,R,L=s.pointermap,k=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,A={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){s.listen(t,this.events)},unregister:function(t){s.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var e=t;return k&&((e=s.cloneEvent(t)).pointerType=this.POINTER_TYPES[t.pointerType]),e},cleanup:function(t){L.delete(t)},MSPointerDown:function(t){L.set(t.pointerId,t);var e=this.prepareEvent(t);s.down(e)},MSPointerMove:function(t){var e=this.prepareEvent(t);s.move(e)},MSPointerUp:function(t){var e=this.prepareEvent(t);s.up(e),this.cleanup(t.pointerId)},MSPointerOut:function(t){var e=this.prepareEvent(t);s.leaveOut(e)},MSPointerOver:function(t){var e=this.prepareEvent(t);s.enterOver(e)},MSPointerCancel:function(t){var e=this.prepareEvent(t);s.cancel(e),this.cleanup(t.pointerId)},MSLostPointerCapture:function(t){var e=s.makeEvent("lostpointercapture",t);s.dispatchEvent(e)},MSGotPointerCapture:function(t){var e=s.makeEvent("gotpointercapture",t);s.dispatchEvent(e)}};function assertActive(t){if(!s.pointermap.has(t)){var e=new Error("NotFoundError");throw e.name="NotFoundError",e}}function assertConnected(t){for(var e=t.parentNode;e&&e!==t.ownerDocument;)e=e.parentNode;if(!e){var n=new Error("InvalidStateError");throw n.name="InvalidStateError",n}}function inActiveButtonState(t){return 0!==s.pointermap.get(t).buttons}return window.navigator.msPointerEnabled?(P=function(t){assertActive(t),assertConnected(this),inActiveButtonState(t)&&(s.setCapture(t,this,!0),this.msSetPointerCapture(t))},I=function(t){assertActive(t),s.releaseCapture(t,!0),this.msReleasePointerCapture(t)}):(P=function setPointerCapture(t){assertActive(t),assertConnected(this),inActiveButtonState(t)&&s.setCapture(t,this)},I=function releasePointerCapture(t){assertActive(t),s.releaseCapture(t)}),R=function hasPointerCapture(t){return!!s.captureInfo[t]},function applyAttributeStyles(){if(g){m.forEach((function(t){y+=t.selector+rule(t.value)+"\n",v&&(y+=function shadowSelector(t){return"body /shadow-deep/ "+t}(t.selector)+rule(t.value)+"\n")}));var t=document.createElement("style");t.textContent=y,document.head.appendChild(t)}}(),function applyPolyfill(){if(!window.PointerEvent){if(window.PointerEvent=PointerEvent,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0}),s.registerSource("ms",A)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),s.registerSource("mouse",E),void 0!==window.ontouchstart&&s.registerSource("touch",C);s.register(document)}}(),function applyPolyfill$1(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:P},releasePointerCapture:{value:I},hasPointerCapture:{value:R}})}(),{dispatcher:s,Installer:Installer,PointerEvent:PointerEvent,PointerMap:n,targetFinding:u}}()})),{SINGLECLICK:"singleclick",CLICK:$e.CLICK,DBLCLICK:$e.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}),Ls=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ks=function(t){function MapBrowserPointerEvent(e,n,r,i,o){var a=t.call(this,e,n,r,i,o)||this;return a.pointerEvent=r,a}return Ls(MapBrowserPointerEvent,t),MapBrowserPointerEvent}(Is),As={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Ds=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),js=function(t){function MapBrowserEventHandler(e,n){var r=t.call(this,e)||this;r.map_=e,r.clickTimeoutId_,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=n?n*bo:bo,r.down_=null;var i=r.map_.getViewport();return i.setAttribute("touch-action","none"),r.activePointers_=0,r.trackedTouches_={},r.element_=i,r.pointerdownListenerKey_=listen(i,As.POINTERDOWN,r.handlePointerDown_,r),r.relayedListenerKey_=listen(i,As.POINTERMOVE,r.relayEvent_,r),r}return Ds(MapBrowserEventHandler,t),MapBrowserEventHandler.prototype.emulateClick_=function(t){var e=new ks(Rs.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new ks(Rs.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new ks(Rs.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},MapBrowserEventHandler.prototype.updateActivePointers_=function(t){var e=t;e.type==Rs.POINTERUP||e.type==Rs.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==Rs.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},MapBrowserEventHandler.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new ks(Rs.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},MapBrowserEventHandler.prototype.isMouseActionButton_=function(t){return 0===t.button},MapBrowserEventHandler.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new ks(Rs.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&this.dragListenerKeys_.push(listen(document,Rs.POINTERMOVE,this.handlePointerMove_,this),listen(document,Rs.POINTERUP,this.handlePointerUp_,this),listen(this.element_,Rs.POINTERCANCEL,this.handlePointerUp_,this))},MapBrowserEventHandler.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new ks(Rs.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}},MapBrowserEventHandler.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new ks(t.type,this.map_,t,e))},MapBrowserEventHandler.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},MapBrowserEventHandler.prototype.disposeInternal=function(){this.relayedListenerKey_&&(unlistenByKey(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(unlistenByKey(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(unlistenByKey),this.dragListenerKeys_.length=0,this.element_=null,t.prototype.disposeInternal.call(this)},MapBrowserEventHandler}(Xe),Ns={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},Fs=function(){function PriorityQueue(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return PriorityQueue.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,clear(this.queuedElements_)},PriorityQueue.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var r=this.keyFunction_(n);return delete this.queuedElements_[r],n},PriorityQueue.prototype.enqueue=function(t){assert(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},PriorityQueue.prototype.getCount=function(){return this.elements_.length},PriorityQueue.prototype.getLeftChildIndex_=function(t){return 2*t+1},PriorityQueue.prototype.getRightChildIndex_=function(t){return 2*t+2},PriorityQueue.prototype.getParentIndex_=function(t){return t-1>>1},PriorityQueue.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},PriorityQueue.prototype.isEmpty=function(){return 0===this.elements_.length},PriorityQueue.prototype.isKeyQueued=function(t){return t in this.queuedElements_},PriorityQueue.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},PriorityQueue.prototype.siftUp_=function(t){for(var e=this.elements_,n=this.priorities_,r=e.length,i=e[t],o=n[t],a=t;t<r>>1;){var s=this.getLeftChildIndex_(t),u=this.getRightChildIndex_(t),l=u<r&&n[u]<n[s]?u:s;e[t]=e[l],n[t]=n[l],t=l}e[t]=i,n[t]=o,this.siftDown_(a,t)},PriorityQueue.prototype.siftDown_=function(t,e){for(var n=this.elements_,r=this.priorities_,i=n[e],o=r[e];e>t;){var a=this.getParentIndex_(e);if(!(r[a]>o))break;n[e]=n[a],r[e]=r[a],e=a}n[e]=i,r[e]=o},PriorityQueue.prototype.reprioritize=function(){var t,e,n,r=this.priorityFunction_,i=this.elements_,o=this.priorities_,a=0,s=i.length;for(e=0;e<s;++e)(n=r(t=i[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(o[a]=n,i[a++]=t);i.length=a,o.length=a,this.heapify_()},PriorityQueue}(),Us=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Gs=function(t){function TileQueue(e,n){var r=t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()}))||this;return r.boundHandleTileChange_=r.handleTileChange.bind(r),r.tileChangeCallback_=n,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return Us(TileQueue,t),TileQueue.prototype.enqueue=function(e){var n=t.prototype.enqueue.call(this,e);n&&e[0].addEventListener($e.CHANGE,this.boundHandleTileChange_);return n},TileQueue.prototype.getTilesLoading=function(){return this.tilesLoading_},TileQueue.prototype.handleTileChange=function(t){var e=t.target,n=e.getState();if(e.hifi&&n===Ni.LOADED||n===Ni.ERROR||n===Ni.EMPTY||n===Ni.ABORT){e.removeEventListener($e.CHANGE,this.boundHandleTileChange_);var r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}},TileQueue.prototype.loadMoreTiles=function(t,e){for(var n,r,i,o=0,a=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)i=(r=this.dequeue()[0]).getKey(),(n=r.getState())===Ni.ABORT?a=!0:n!==Ni.IDLE||i in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[i]=!0,++this.tilesLoading_,++o,r.load());0===o&&a&&this.tileChangeCallback_()},TileQueue}(Fs);function createExtent(t,e,n){return function(r,i,o,a){if(r){var s=e?0:o[0]*i,u=e?0:o[1]*i,l=t[0]+s/2,c=t[2]-s/2,h=t[1]+u/2,d=t[3]-u/2;l>c&&(l=c=(c+l)/2),h>d&&(h=d=(d+h)/2);var f=clamp(r[0],l,c),p=clamp(r[1],h,d),m=30*i;return a&&n&&(f+=-m*Math.log(1+Math.max(0,l-r[0])/m)+m*Math.log(1+Math.max(0,r[0]-c)/m),p+=-m*Math.log(1+Math.max(0,h-r[1])/m)+m*Math.log(1+Math.max(0,r[1]-d)/m)),[f,p]}}}function none(t){return t}function getViewportClampedResolution(t,e,n){var r=getWidth(e)/n[0],i=getHeight(e)/n[1];return Math.min(t,Math.min(r,i))}function getSmoothClampedResolution(t,e,n){var r=Math.min(t,e);return r*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(r=Math.max(r,n),r/=Math.log(1+50*Math.max(0,n/t-1))/50+1),clamp(r,n/2,2*e)}function createMinMaxResolution(t,e,n,r){return function(i,o,a,s){if(void 0!==i){var u=r?getViewportClampedResolution(t,r,a):t;return(void 0===n||n)&&s?getSmoothClampedResolution(i,u,e):clamp(i,e,u)}}}function disable(t){return void 0!==t?0:void 0}function none$1(t){return void 0!==t?t:void 0}var zs="center",Vs="resolution",qs="rotation";function equals$2(t,e){for(var n=!0,r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function rotate(t,e){var n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,o=t[1]*n+t[0]*r;return t[0]=i,t[1]=o,t}var Zs={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};var Ws=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Ys=[1,0,0,1,0,0],Bs=function(t){function Geometry(){var e=t.call(this)||this;return e.extent_=[1/0,1/0,-1/0,-1/0],e.extentRevision_=-1,e.simplifiedGeometryMaxMinSquaredTolerance=0,e.simplifiedGeometryRevision=0,e.simplifyTransformedInternal=function memoizeOne(t){var e,n,r,i=!1;return function(){var o=Array.prototype.slice.call(arguments);return i&&this===r&&equals$1(o,n)||(i=!0,r=this,n=o,e=t.apply(this,arguments)),e}}((function(t,e,n){if(!n)return this.getSimplifiedGeometry(e);var r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(e)})),e}return Ws(Geometry,t),Geometry.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},Geometry.prototype.clone=function(){return abstract()},Geometry.prototype.closestPointXY=function(t,e,n,r){return abstract()},Geometry.prototype.containsXY=function(t,e){var n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e},Geometry.prototype.getClosestPoint=function(t,e){var n=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],n,1/0),n},Geometry.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},Geometry.prototype.computeExtent=function(t){return abstract()},Geometry.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function returnOrUpdate(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},Geometry.prototype.rotate=function(t,e){abstract()},Geometry.prototype.scale=function(t,e,n){abstract()},Geometry.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},Geometry.prototype.getSimplifiedGeometry=function(t){return abstract()},Geometry.prototype.getType=function(){return abstract()},Geometry.prototype.applyTransform=function(t){abstract()},Geometry.prototype.intersectsExtent=function(t){return abstract()},Geometry.prototype.translate=function(t,e){abstract()},Geometry.prototype.transform=function(t,e){var n=get$3(t),r=n.getUnits()==_.TILE_PIXELS?function(t,r,i){var o=n.getExtent(),a=n.getWorldExtent(),s=getHeight(a)/getHeight(o);return compose(Ys,a[0],a[3],s,-s,0,0,0),function transform2D(t,e,n,r,i,o){for(var a=o||[],s=0,u=e;u<n;u+=r){var l=t[u],c=t[u+1];a[s++]=i[0]*l+i[2]*c+i[4],a[s++]=i[1]*l+i[3]*c+i[5]}return o&&a.length!=s&&(a.length=s),a}(t,0,t.length,i,Ys,r),getTransform(n,e)(t,r,i)}:getTransform(n,e);return this.applyTransform(r),this},Geometry}(nn),Ks=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Hs=function(t){function SimpleGeometry(){var e=t.call(this)||this;return e.layout=Zs.XY,e.stride=2,e.flatCoordinates=null,e}return Ks(SimpleGeometry,t),SimpleGeometry.prototype.computeExtent=function(t){return function createOrUpdateFromFlatCoordinates(t,e,n,r,i){return extendFlatCoordinates(createOrUpdateEmpty(i),t,e,n,r)}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},SimpleGeometry.prototype.getCoordinates=function(){return abstract()},SimpleGeometry.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},SimpleGeometry.prototype.getFlatCoordinates=function(){return this.flatCoordinates},SimpleGeometry.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},SimpleGeometry.prototype.getLayout=function(){return this.layout},SimpleGeometry.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},SimpleGeometry.prototype.getSimplifiedGeometryInternal=function(t){return this},SimpleGeometry.prototype.getStride=function(){return this.stride},SimpleGeometry.prototype.setFlatCoordinates=function(t,e){this.stride=getStrideForLayout(t),this.layout=t,this.flatCoordinates=e},SimpleGeometry.prototype.setCoordinates=function(t,e){abstract()},SimpleGeometry.prototype.setLayout=function(t,e,n){var r;if(t)r=getStrideForLayout(t);else{for(var i=0;i<n;++i){if(0===e.length)return this.layout=Zs.XY,void(this.stride=2);e=e[0]}t=function getLayoutForStride(t){var e;2==t?e=Zs.XY:3==t?e=Zs.XYZ:4==t&&(e=Zs.XYZM);return(e)}(r=e.length)}this.layout=t,this.stride=r},SimpleGeometry.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},SimpleGeometry.prototype.rotate=function(t,e){var n=this.getFlatCoordinates();if(n){var r=this.getStride();!function rotate$1(t,e,n,r,i,o,a){for(var s=a||[],u=Math.cos(i),l=Math.sin(i),c=o[0],h=o[1],d=0,f=e;f<n;f+=r){var p=t[f]-c,m=t[f+1]-h;s[d++]=c+p*u-m*l,s[d++]=h+p*l+m*u;for(var y=f+2;y<f+r;++y)s[d++]=t[y]}return a&&s.length!=d&&(s.length=d),s}(n,0,n.length,r,t,e,n),this.changed()}},SimpleGeometry.prototype.scale=function(t,e,n){var r=e;void 0===r&&(r=t);var i=n;i||(i=getCenter(this.getExtent()));var o=this.getFlatCoordinates();if(o){var a=this.getStride();!function scale$2(t,e,n,r,i,o,a,s){for(var u=s||[],l=a[0],c=a[1],h=0,d=e;d<n;d+=r){var f=t[d]-l,p=t[d+1]-c;u[h++]=l+i*f,u[h++]=c+o*p;for(var m=d+2;m<d+r;++m)u[h++]=t[m]}return s&&u.length!=h&&(u.length=h),u}(o,0,o.length,a,t,r,i,o),this.changed()}},SimpleGeometry.prototype.translate=function(t,e){var n=this.getFlatCoordinates();if(n){var r=this.getStride();!function translate(t,e,n,r,i,o,a){for(var s=a||[],u=0,l=e;l<n;l+=r){s[u++]=t[l]+i,s[u++]=t[l+1]+o;for(var c=l+2;c<l+r;++c)s[u++]=t[c]}return a&&s.length!=u&&(s.length=u),s}(n,0,n.length,r,t,e,n),this.changed()}},SimpleGeometry}(Bs);function getStrideForLayout(t){var e;return t==Zs.XY?e=2:t==Zs.XYZ||t==Zs.XYM?e=3:t==Zs.XYZM&&(e=4),e}function linearRing(t,e,n,r){for(var i=0,o=t[n-r],a=t[n-r+1];e<n;e+=r){var s=t[e],u=t[e+1];i+=a*s-o*u,o=s,a=u}return i/2}function assignClosest(t,e,n,r,i,o,a){var s,u=t[e],l=t[e+1],c=t[n]-u,h=t[n+1]-l;if(0===c&&0===h)s=e;else{var d=((i-u)*c+(o-l)*h)/(c*c+h*h);if(d>1)s=n;else{if(d>0){for(var f=0;f<r;++f)a[f]=lerp(t[e+f],t[n+f],d);return void(a.length=r)}s=e}}for(f=0;f<r;++f)a[f]=t[s+f];a.length=r}function maxSquaredDelta(t,e,n,r,i){var o=t[e],a=t[e+1];for(e+=r;e<n;e+=r){var s=t[e],u=t[e+1],l=squaredDistance(o,a,s,u);l>i&&(i=l),o=s,a=u}return i}function assignClosestPoint(t,e,n,r,i,o,a,s,u,l,c){if(e==n)return l;var h,d;if(0===i){if((d=squaredDistance(a,s,t[e],t[e+1]))<l){for(h=0;h<r;++h)u[h]=t[e+h];return u.length=r,d}return l}for(var f=c||[NaN,NaN],p=e+r;p<n;)if(assignClosest(t,p-r,p,r,a,s,f),(d=squaredDistance(a,s,f[0],f[1]))<l){for(l=d,h=0;h<r;++h)u[h]=f[h];u.length=r,p+=r}else p+=r*Math.max((Math.sqrt(d)-Math.sqrt(l))/i|0,1);if(o&&(assignClosest(t,n-r,e,r,a,s,f),(d=squaredDistance(a,s,f[0],f[1]))<l)){for(l=d,h=0;h<r;++h)u[h]=f[h];u.length=r}return l}function deflateCoordinates(t,e,n,r){for(var i=0,o=n.length;i<o;++i)for(var a=n[i],s=0;s<r;++s)t[e++]=a[s];return e}function inflateCoordinates(t,e,n,r,i){for(var o=void 0!==i?i:[],a=0,s=e;s<n;s+=r)o[a++]=t.slice(s,s+r);return o.length=a,o}function snap(t,e){return e*Math.round(t/e)}function quantize(t,e,n,r,i,o,a){if(e==n)return a;var s,u,l=snap(t[e],i),c=snap(t[e+1],i);e+=r,o[a++]=l,o[a++]=c;do{if(s=snap(t[e],i),u=snap(t[e+1],i),(e+=r)==n)return o[a++]=s,o[a++]=u,a}while(s==l&&u==c);for(;e<n;){var h=snap(t[e],i),d=snap(t[e+1],i);if(e+=r,h!=s||d!=u){var f=s-l,p=u-c,m=h-l,y=d-c;f*y==p*m&&(f<0&&m<f||f==m||f>0&&m>f)&&(p<0&&y<p||p==y||p>0&&y>p)?(s=h,u=d):(o[a++]=s,o[a++]=u,l=s,c=u,s=h,u=d)}}return o[a++]=s,o[a++]=u,a}var Xs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),$s=function(t){function LinearRing(e,n){var r=t.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===n||Array.isArray(e[0])?r.setCoordinates(e,n):r.setFlatCoordinates(n,e),r}return Xs(LinearRing,t),LinearRing.prototype.clone=function(){return new LinearRing(this.flatCoordinates.slice(),this.layout)},LinearRing.prototype.closestPointXY=function(t,e,n,r){return r<closestSquaredDistanceXY(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(maxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),assignClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))},LinearRing.prototype.getArea=function(){return linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},LinearRing.prototype.getCoordinates=function(){return inflateCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},LinearRing.prototype.getSimplifiedGeometryInternal=function(t){var e=[];return e.length=function douglasPeucker(t,e,n,r,i,o,a){var s=(n-e)/r;if(s<3){for(;e<n;e+=r)o[a++]=t[e],o[a++]=t[e+1];return a}var u=new Array(s);u[0]=1,u[s-1]=1;for(var l=[e,n-r],c=0;l.length>0;){for(var h=l.pop(),d=l.pop(),f=0,p=t[d],m=t[d+1],y=t[h],g=t[h+1],v=d+r;v<h;v+=r){var _=squaredSegmentDistance(t[v],t[v+1],p,m,y,g);_>f&&(c=v,f=_)}f>i&&(u[(c-e)/r]=1,d+r<c&&l.push(d,c),c+r<h&&l.push(c,h))}for(v=0;v<s;++v)u[v]&&(o[a++]=t[e+v*r],o[a++]=t[e+v*r+1]);return a}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new LinearRing(e,Zs.XY)},LinearRing.prototype.getType=function(){return a},LinearRing.prototype.intersectsExtent=function(t){return!1},LinearRing.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=deflateCoordinates(this.flatCoordinates,0,t,this.stride),this.changed()},LinearRing}(Hs),Qs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Js=function(t){function Point(e,n){var r=t.call(this)||this;return r.setCoordinates(e,n),r}return Qs(Point,t),Point.prototype.clone=function(){return new Point(this.flatCoordinates.slice(),this.layout)},Point.prototype.closestPointXY=function(t,e,n,r){var i=this.flatCoordinates,o=squaredDistance(t,e,i[0],i[1]);if(o<r){for(var a=this.stride,s=0;s<a;++s)n[s]=i[s];return n.length=a,o}return r},Point.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},Point.prototype.computeExtent=function(t){return function createOrUpdateFromCoordinate(t,e){var n=t[0],r=t[1];return createOrUpdate(n,r,n,r,e)}(this.flatCoordinates,t)},Point.prototype.getType=function(){return o},Point.prototype.intersectsExtent=function(t){return containsXY(t,this.flatCoordinates[0],this.flatCoordinates[1])},Point.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function deflateCoordinate(t,e,n,r){for(var i=0,o=n.length;i<o;++i)t[e++]=n[i];return e}(this.flatCoordinates,0,t,this.stride),this.changed()},Point}(Hs);function linearRingContainsExtent(t,e,n,r,i){return!function forEachCorner(t,e){var n;return(n=e(getBottomLeft(t)))?n:(n=e(getBottomRight(t)))?n:(n=e(getTopRight(t)))?n:(n=e(getTopLeft(t)))||!1}(i,(function(i){return!linearRingContainsXY(t,e,n,r,i[0],i[1])}))}function linearRingContainsXY(t,e,n,r,i,o){for(var a=0,s=t[n-r],u=t[n-r+1];e<n;e+=r){var l=t[e],c=t[e+1];u<=o?c>o&&(l-s)*(o-u)-(i-s)*(c-u)>0&&a++:c<=o&&(l-s)*(o-u)-(i-s)*(c-u)<0&&a--,s=l,u=c}return 0!==a}function linearRingsContainsXY(t,e,n,r,i,o){if(0===n.length)return!1;if(!linearRingContainsXY(t,e,n[0],r,i,o))return!1;for(var a=1,s=n.length;a<s;++a)if(linearRingContainsXY(t,n[a-1],n[a],r,i,o))return!1;return!0}function intersectsLineString(t,e,n,r,i){var o=extendFlatCoordinates([1/0,1/0,-1/0,-1/0],t,e,n,r);return!!intersects(i,o)&&(!!containsExtent(i,o)||(o[0]>=i[0]&&o[2]<=i[2]||(o[1]>=i[1]&&o[3]<=i[3]||function forEach$2(t,e,n,r,i){for(var o,a=[t[e],t[e+1]],s=[];e+r<n;e+=r){if(s[0]=t[e+r],s[1]=t[e+r+1],o=i(a,s))return o;a[0]=s[0],a[1]=s[1]}return!1}(t,e,n,r,(function(t,e){return function intersectsSegment(t,e,n){var r=!1,i=coordinateRelationship(t,e),o=coordinateRelationship(t,n);if(i===v.INTERSECTING||o===v.INTERSECTING)r=!0;else{var a=t[0],s=t[1],u=t[2],l=t[3],c=e[0],h=e[1],d=n[0],f=n[1],p=(f-h)/(d-c),m=void 0,y=void 0;o&v.ABOVE&&!(i&v.ABOVE)&&(r=(m=d-(f-l)/p)>=a&&m<=u),r||!(o&v.RIGHT)||i&v.RIGHT||(r=(y=f-(d-u)*p)>=s&&y<=l),r||!(o&v.BELOW)||i&v.BELOW||(r=(m=d-(f-s)/p)>=a&&m<=u),r||!(o&v.LEFT)||i&v.LEFT||(r=(y=f-(d-a)*p)>=s&&y<=l)}return r}(i,t,e)})))))}function intersectsLinearRingArray(t,e,n,r,i){if(!function intersectsLinearRing(t,e,n,r,i){return!!intersectsLineString(t,e,n,r,i)||(!!linearRingContainsXY(t,e,n,r,i[0],i[1])||(!!linearRingContainsXY(t,e,n,r,i[0],i[3])||(!!linearRingContainsXY(t,e,n,r,i[2],i[1])||!!linearRingContainsXY(t,e,n,r,i[2],i[3]))))}(t,e,n[0],r,i))return!1;if(1===n.length)return!0;for(var o=1,a=n.length;o<a;++o)if(linearRingContainsExtent(t,n[o-1],n[o],r,i)&&!intersectsLineString(t,n[o-1],n[o],r,i))return!1;return!0}function coordinates(t,e,n,r){for(;e<n-r;){for(var i=0;i<r;++i){var o=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=o}e+=r,n-=r}}function linearRingIsClockwise(t,e,n,r){for(var i=0,o=t[n-r],a=t[n-r+1];e<n;e+=r){var s=t[e],u=t[e+1];i+=(s-o)*(u+a),o=s,a=u}return i>0}function orientLinearRings(t,e,n,r,i){for(var o=void 0!==i&&i,a=0,s=n.length;a<s;++a){var u=n[a],l=linearRingIsClockwise(t,e,u,r);(0===a?o&&l||!o&&!l:o&&!l||!o&&l)&&coordinates(t,e,u,r),e=u}return e}var tu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),eu=function(t){function Polygon(e,n,r){var i=t.call(this)||this;return i.ends_=[],i.flatInteriorPointRevision_=-1,i.flatInteriorPoint_=null,i.maxDelta_=-1,i.maxDeltaRevision_=-1,i.orientedRevision_=-1,i.orientedFlatCoordinates_=null,void 0!==n&&r?(i.setFlatCoordinates(n,e),i.ends_=r):i.setCoordinates(e,n),i}return tu(Polygon,t),Polygon.prototype.appendLinearRing=function(t){this.flatCoordinates?function extend$1(t,e){for(var n=Array.isArray(e)?e:[e],r=n.length,i=0;i<r;i++)t[t.length]=n[i]}(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},Polygon.prototype.clone=function(){return new Polygon(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},Polygon.prototype.closestPointXY=function(t,e,n,r){return r<closestSquaredDistanceXY(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function arrayMaxSquaredDelta(t,e,n,r,i){for(var o=0,a=n.length;o<a;++o){var s=n[o];i=maxSquaredDelta(t,e,s,r,i),e=s}return i}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function assignClosestArrayPoint(t,e,n,r,i,o,a,s,u,l,c){for(var h=c||[NaN,NaN],d=0,f=n.length;d<f;++d){var p=n[d];l=assignClosestPoint(t,e,p,r,i,o,a,s,u,l,h),e=p}return l}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))},Polygon.prototype.containsXY=function(t,e){return linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},Polygon.prototype.getArea=function(){return function linearRings(t,e,n,r){for(var i=0,o=0,a=n.length;o<a;++o){var s=n[o];i+=linearRing(t,e,s,r),e=s}return i}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},Polygon.prototype.getCoordinates=function(t){var e;return void 0!==t?orientLinearRings(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,function inflateCoordinatesArray(t,e,n,r,i){for(var o=void 0!==i?i:[],a=0,s=0,u=n.length;s<u;++s){var l=n[s];o[a++]=inflateCoordinates(t,e,l,r,o[a]),e=l}return o.length=a,o}(e,0,this.ends_,this.stride)},Polygon.prototype.getEnds=function(){return this.ends_},Polygon.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=getCenter(this.getExtent());this.flatInteriorPoint_=function getInteriorPointOfArray(t,e,n,r,i,o,a){for(var s,u,l,c,h,d,f,p=i[o+1],m=[],y=0,g=n.length;y<g;++y){var v=n[y];for(c=t[v-r],d=t[v-r+1],s=e;s<v;s+=r)h=t[s],f=t[s+1],(p<=d&&f<=p||d<=p&&p<=f)&&(l=(p-d)/(f-d)*(h-c)+c,m.push(l)),c=h,d=f}var _=NaN,b=-1/0;for(m.sort(numberSafeCompareFunction),c=m[0],s=1,u=m.length;s<u;++s){h=m[s];var T=Math.abs(h-c);T>b&&linearRingsContainsXY(t,e,n,r,l=(c+h)/2,p)&&(_=l,b=T),c=h}return isNaN(_)&&(_=i[o]),a?(a.push(_,p,b),a):[_,p,b]}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},Polygon.prototype.getInteriorPoint=function(){return new Js(this.getFlatInteriorPoint(),Zs.XYM)},Polygon.prototype.getLinearRingCount=function(){return this.ends_.length},Polygon.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new $s(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},Polygon.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[],i=0,o=0,a=n.length;o<a;++o){var s=n[o],u=new $s(e.slice(i,s),t);r.push(u),i=s}return r},Polygon.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function linearRingsAreOriented(t,e,n,r,i){for(var o=void 0!==i&&i,a=0,s=n.length;a<s;++a){var u=n[a],l=linearRingIsClockwise(t,e,u,r);if(0===a){if(o&&l||!o&&!l)return!1}else if(o&&!l||!o&&l)return!1;e=u}return!0}(t,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},Polygon.prototype.getSimplifiedGeometryInternal=function(t){var e=[],n=[];return e.length=function quantizeArray(t,e,n,r,i,o,a,s){for(var u=0,l=n.length;u<l;++u){var c=n[u];a=quantize(t,e,c,r,i,o,a),s.push(a),e=c}return a}(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new Polygon(e,Zs.XY,n)},Polygon.prototype.getType=function(){return s},Polygon.prototype.intersectsExtent=function(t){return intersectsLinearRingArray(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},Polygon.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=function deflateCoordinatesArray(t,e,n,r,i){for(var o=i||[],a=0,s=0,u=n.length;s<u;++s){var l=deflateCoordinates(t,e,n[s],r);o[a++]=l,e=l}return o.length=a,o}(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()},Polygon}(Hs);function fromExtent(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=[e,n,e,i,r,i,r,n,e,n];return new eu(o,Zs.XY,[o.length])}var nu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ru=0,iu=function(t){function View(e){var r=t.call(this)||this,i=n({},e);return r.hints_=[0,0],r.animations_=[],r.updateAnimationKey_,r.projection_=createProjection(i.projection,"EPSG:3857"),r.targetCenter_=null,r.targetResolution_,r.targetRotation_,i.center&&(i.center=fromUserCoordinate(i.center,r.projection_)),i.extent&&(i.extent=fromUserExtent(i.extent,r.projection_)),r.applyOptions_(i),r}return nu(View,t),View.prototype.applyOptions_=function(t){var e=function createResolutionConstraint(t){var e,n,r,i=void 0!==t.minZoom?t.minZoom:ru,o=void 0!==t.maxZoom?t.maxZoom:28,a=void 0!==t.zoomFactor?t.zoomFactor:2,s=void 0!==t.multiWorld&&t.multiWorld,u=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,l=createProjection(t.projection,"EPSG:3857"),c=l.getExtent(),h=t.constrainOnlyCenter,d=t.extent;s||d||!l.isGlobal()||(h=!1,d=c);if(void 0!==t.resolutions){var f=t.resolutions;n=f[i],r=void 0!==f[o]?f[o]:f[f.length-1],e=t.constrainResolution?function createSnapToResolutions(t,e,n){return function(r,i,o,a){if(void 0!==r){var s=t[0],u=t[t.length-1],l=n?getViewportClampedResolution(s,n,o):s;if(a)return void 0===e||e?getSmoothClampedResolution(r,l,u):clamp(r,u,l);var c=Math.min(l,r),h=Math.floor(linearFindNearest(t,c,i));return t[h]>l&&h<t.length-1?t[h+1]:t[h]}}}(f,u,!h&&d):createMinMaxResolution(n,r,u,!h&&d)}else{var p=(c?Math.max(getWidth(c),getHeight(c)):360*b[_.DEGREES]/l.getMetersPerUnit())/Qo/Math.pow(2,ru),m=p/Math.pow(2,28-ru);void 0!==(n=t.maxResolution)?i=0:n=p/Math.pow(a,i),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(a,o):p/Math.pow(a,o):m),o=i+Math.floor(Math.log(n/r)/Math.log(a)),r=n/Math.pow(a,o-i),e=t.constrainResolution?function createSnapToPower(t,e,n,r,i){return function(o,a,s,u){if(void 0!==o){var l=i?getViewportClampedResolution(e,i,s):e,c=void 0!==n?n:0;if(u)return void 0===r||r?getSmoothClampedResolution(o,l,c):clamp(o,c,l);var h=Math.ceil(Math.log(e/l)/Math.log(t)-1e-9),d=-a*(.5-1e-9)+.5,f=Math.min(l,o),p=Math.floor(Math.log(e/f)/Math.log(t)+d),m=Math.max(h,p);return clamp(e/Math.pow(t,m),c,l)}}}(a,n,r,u,!h&&d):createMinMaxResolution(n,r,u,!h&&d)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:i,zoomFactor:a}}(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;var n=function createCenterConstraint(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return createExtent(t.extent,t.constrainOnlyCenter,e)}var n=createProjection(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&n.isGlobal()){var r=n.getExtent().slice();return r[0]=-1/0,r[2]=1/0,createExtent(r,!1,!1)}return none}(t),r=e.constraint,i=function createRotationConstraint(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?function createSnapToZero(t){var e=t||toRadians(5);return(function(t,n){return n?t:void 0!==t?Math.abs(t)<=e?0:t:void 0})}():!1===e?none$1:"number"==typeof e?function createSnapToN(t){var e=2*Math.PI/t;return(function(t,n){return n?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0})}(e):none$1}return disable}(t);this.constraints_={center:n,resolution:r,rotation:i},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.resolveConstraints(0),this.setProperties({}),this.options_=t},View.prototype.getUpdatedOptions_=function(t){var e=n({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),n({},e,t)},View.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),r=0;r<e.length;++r){var i=arguments[r];i.center&&((i=n({},i)).center=fromUserCoordinate(i.center,this.getProjection())),i.anchor&&((i=n({},i)).anchor=fromUserCoordinate(i.anchor,this.getProjection())),e[r]=i}this.animateInternal.apply(this,e)},View.prototype.animateInternal=function(t){var e,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var r=arguments[n-1];return r.center&&this.setCenterInternal(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(e&&animationCallback(e,!0))}for(var i=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,s=this.targetRotation_,u=[],l=0;l<n;++l){var c=arguments[l],h={start:i,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||inAndOut,callback:e};if(c.center&&(h.sourceCenter=o,h.targetCenter=c.center.slice(),o=h.targetCenter),void 0!==c.zoom?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(c.zoom),a=h.targetResolution):c.resolution&&(h.sourceResolution=a,h.targetResolution=c.resolution,a=h.targetResolution),void 0!==c.rotation){h.sourceRotation=s;var d=modulo(c.rotation-s+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=s+d,s=h.targetRotation}isNoopAnimation(h)?h.complete=!0:i+=h.duration,u.push(h)}this.animations_.push(u),this.setHint(ao,1),this.updateAnimations_()},View.prototype.getAnimating=function(){return this.hints_[ao]>0},View.prototype.getInteracting=function(){return this.hints_[so]>0},View.prototype.cancelAnimations=function(){this.setHint(ao,-this.hints_[ao]);for(var t=0,e=this.animations_.length;t<e;++t){var n=this.animations_[t];n[0].callback&&animationCallback(n[0].callback,!1)}this.animations_.length=0},View.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var r=this.animations_[n],i=!0,o=0,a=r.length;o<a;++o){var s=r[o];if(!s.complete){var u=t-s.start,l=s.duration>0?u/s.duration:1;l>=1?(s.complete=!0,l=1):i=!1;var c=s.easing(l);if(s.sourceCenter){var h=s.sourceCenter[0],d=s.sourceCenter[1],f=h+c*(s.targetCenter[0]-h),p=d+c*(s.targetCenter[1]-d);this.targetCenter_=[f,p]}if(s.sourceResolution&&s.targetResolution){var m=1===c?s.targetResolution:s.sourceResolution+c*(s.targetResolution-s.sourceResolution);if(s.anchor){var y=this.getSizeFromViewport_(this.getRotation()),g=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(g,s.anchor)}this.targetResolution_=m,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){var v=1===c?modulo(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+c*(s.targetRotation-s.sourceRotation);if(s.anchor){var _=this.constraints_.rotation(v,!0);this.targetCenter_=this.calculateCenterRotate(_,s.anchor)}this.targetRotation_=v}if(this.applyTargetState_(!0),e=!0,!s.complete)break}}if(i){this.animations_[n]=null,this.setHint(ao,-1);var b=r[0].callback;b&&animationCallback(b,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},View.prototype.calculateCenterRotate=function(t,e){var n,r=this.getCenterInternal();return void 0!==r&&(rotate(n=[r[0]-e[0],r[1]-e[1]],t-this.getRotation()),function add$2(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}(n,e)),n},View.prototype.calculateCenterZoom=function(t,e){var n,r=this.getCenterInternal(),i=this.getResolution();void 0!==r&&void 0!==i&&(n=[e[0]-t*(e[0]-r[0])/i,e[1]-t*(e[1]-r[1])/i]);return n},View.prototype.getSizeFromViewport_=function(t){var e=[100,100],n='.ol-viewport[data-view="'+getUid(this)+'"]',r=document.querySelector(n);if(r){var i=getComputedStyle(r);e[0]=parseInt(i.width,10),e[1]=parseInt(i.height,10)}if(t){var o=e[0],a=e[1];e[0]=Math.abs(o*Math.cos(t))+Math.abs(a*Math.sin(t)),e[1]=Math.abs(o*Math.sin(t))+Math.abs(a*Math.cos(t))}return e},View.prototype.getCenter=function(){var t=this.getCenterInternal();return t?toUserCoordinate(t,this.getProjection()):t},View.prototype.getCenterInternal=function(){return this.get(zs)},View.prototype.getConstraints=function(){return this.constraints_},View.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},View.prototype.calculateExtent=function(t){return function toUserExtent(t,e){return N?transformExtent(t,e,N):t}(this.calculateExtentInternal(t),this.getProjection())},View.prototype.calculateExtentInternal=function(t){var e=t||this.getSizeFromViewport_(),n=this.getCenterInternal();assert(n,1);var r=this.getResolution();assert(void 0!==r,2);var i=this.getRotation();return assert(void 0!==i,3),getForViewAndSize(n,r,i,e)},View.prototype.getMaxResolution=function(){return this.maxResolution_},View.prototype.getMinResolution=function(){return this.minResolution_},View.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},View.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},View.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},View.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},View.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},View.prototype.getProjection=function(){return this.projection_},View.prototype.getResolution=function(){return this.get(Vs)},View.prototype.getResolutions=function(){return this.resolutions_},View.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(fromUserExtent(t,this.getProjection()),e)},View.prototype.getResolutionForExtentInternal=function(t,e){var n=e||this.getSizeFromViewport_(),r=getWidth(t)/n[0],i=getHeight(t)/n[1];return Math.max(r,i)},View.prototype.getResolutionForValueFunction=function(t){var e=t||2,n=this.maxResolution_,r=this.minResolution_,i=Math.log(n/r)/Math.log(e);return function(t){return n/Math.pow(e,t*i)}},View.prototype.getRotation=function(){return this.get(qs)},View.prototype.getValueForResolutionFunction=function(t){var e=t||2,n=this.maxResolution_,r=this.minResolution_,i=Math.log(n/r)/Math.log(e);return function(t){return Math.log(n/t)/Math.log(e)/i}},View.prototype.getState=function(){var t=this.getCenterInternal(),e=this.getProjection(),n=this.getResolution(),r=this.getRotation();return{center:t.slice(0),projection:void 0!==e?e:null,resolution:n,rotation:r,zoom:this.getZoom()}},View.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},View.prototype.getZoomForResolution=function(t){var e,n,r=this.minZoom_||0;if(this.resolutions_){var i=linearFindNearest(this.resolutions_,t,1);r=i,e=this.resolutions_[i],n=i==this.resolutions_.length-1?2:e/this.resolutions_[i+1]}else e=this.maxResolution_,n=this.zoomFactor_;return r+Math.log(e/t)/Math.log(n)},View.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=clamp(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,clamp(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},View.prototype.fit=function(t,e){var r,i=n({size:this.getSizeFromViewport_()},e||{});if(assert(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))assert(!isEmpty(t),25),r=fromExtent(o=fromUserExtent(t,this.getProjection()));else if(t.getType()===l){var o;(r=fromExtent(o=fromUserExtent(t.getExtent(),this.getProjection()))).rotate(this.getRotation(),getCenter(o))}else{var a=getUserProjection();r=a?r.clone().transform(a,this.getProjection()):t}this.fitInternal(r,i)},View.prototype.fitInternal=function(t,e){var n=e||{},r=n.size;r||(r=this.getSizeFromViewport_());var i,o=void 0!==n.padding?n.padding:[0,0,0,0],a=void 0!==n.nearest&&n.nearest;i=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.getResolutionForZoom(n.maxZoom):0;for(var s=t.getFlatCoordinates(),u=this.getRotation(),l=Math.cos(-u),c=Math.sin(-u),h=1/0,d=1/0,f=-1/0,p=-1/0,m=t.getStride(),y=0,g=s.length;y<g;y+=m){var v=s[y]*l-s[y+1]*c,_=s[y]*c+s[y+1]*l;h=Math.min(h,v),d=Math.min(d,_),f=Math.max(f,v),p=Math.max(p,_)}var b=this.getResolutionForExtentInternal([h,d,f,p],[r[0]-o[1]-o[3],r[1]-o[0]-o[2]]);b=isNaN(b)?i:Math.max(b,i),b=this.getConstrainedResolution(b,a?0:1),c=-c;var T=(h+f)/2,w=(d+p)/2,E=[(T+=(o[1]-o[3])/2*b)*l-(w+=(o[0]-o[2])/2*b)*c,w*l+T*c],S=n.callback?n.callback:VOID;void 0!==n.duration?this.animateInternal({resolution:b,center:this.getConstrainedCenter(E,b),duration:n.duration,easing:n.easing},S):(this.targetResolution_=b,this.targetCenter_=E,this.applyTargetState_(!1,!0),animationCallback(S,!0))},View.prototype.centerOn=function(t,e,n){this.centerOnInternal(fromUserCoordinate(t,this.getProjection()),e,n)},View.prototype.centerOnInternal=function(t,e,n){var r=this.getRotation(),i=Math.cos(-r),o=Math.sin(-r),a=t[0]*i-t[1]*o,s=t[1]*i+t[0]*o,u=this.getResolution(),l=(a+=(e[0]/2-n[0])*u)*i-(s+=(n[1]-e[1]/2)*u)*(o=-o),c=s*i+a*o;this.setCenterInternal([l,c])},View.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},View.prototype.adjustCenter=function(t){var e=toUserCoordinate(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])},View.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])},View.prototype.adjustResolution=function(t,e){var n=e&&fromUserCoordinate(e,this.getProjection());this.adjustResolutionInternal(t,n)},View.prototype.adjustResolutionInternal=function(t,e){var n=this.getAnimating()||this.getInteracting(),r=this.getSizeFromViewport_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,r,n);void 0!==e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()},View.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)},View.prototype.adjustRotation=function(t,e){e&&(e=fromUserCoordinate(e,this.getProjection())),this.adjustRotationInternal(t,e)},View.prototype.adjustRotationInternal=function(t,e){var n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);void 0!==e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()},View.prototype.setCenter=function(t){this.setCenterInternal(fromUserCoordinate(t,this.getProjection()))},View.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},View.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},View.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},View.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},View.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},View.prototype.applyTargetState_=function(t,e){var n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),i=this.getSizeFromViewport_(r),o=this.constraints_.resolution(this.targetResolution_,0,i,n),a=this.constraints_.center(this.targetCenter_,o,i,n);this.get(qs)!==r&&this.set(qs,r),this.get(Vs)!==o&&this.set(Vs,o),this.get(zs)&&equals$2(this.get(zs),a)||this.set(zs,a),this.getAnimating()&&!t&&this.cancelAnimations()},View.prototype.resolveConstraints=function(t,e,n){var r=void 0!==t?t:200,i=e||0,o=this.constraints_.rotation(this.targetRotation_),a=this.getSizeFromViewport_(o),s=this.constraints_.resolution(this.targetResolution_,i,a),u=this.constraints_.center(this.targetCenter_,s,a);if(0===r)return this.targetResolution_=s,this.targetRotation_=o,this.targetCenter_=u,void this.applyTargetState_();this.getResolution()===s&&this.getRotation()===o&&this.getCenterInternal()&&equals$2(this.getCenterInternal(),u)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:u,resolution:s,duration:r,easing:easeOut,anchor:n}))},View.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(so,1)},View.prototype.endInteraction=function(t,e,n){var r=n&&fromUserCoordinate(n,this.getProjection());this.endInteractionInternal(t,e,r)},View.prototype.endInteractionInternal=function(t,e,n){this.setHint(so,-1),this.resolveConstraints(t,e,n)},View.prototype.getConstrainedCenter=function(t,e){var n=this.getSizeFromViewport_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)},View.prototype.getConstrainedZoom=function(t,e){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))},View.prototype.getConstrainedResolution=function(t,e){var n=e||0,r=this.getSizeFromViewport_(this.getRotation());return this.constraints_.resolution(t,n,r)},View}(nn);function animationCallback(t,e){setTimeout((function(){t(e)}),0)}function isNoopAnimation(t){return!(t.sourceCenter&&t.targetCenter&&!equals$2(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}var ou=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),au={LAYERS:"layers"},su=function(t){function LayerGroup(e){var r=this,i=e||{},o=n({},i);delete o.layers;var a=i.layers;return(r=t.call(this,o)||this).layersListenerKeys_=[],r.listenerKeys_={},r.addEventListener(getChangeEventType(au.LAYERS),r.handleLayersChanged_),a?Array.isArray(a)?a=new Os(a.slice(),{unique:!0}):assert("function"==typeof a.getArray,43):a=new Os(void 0,{unique:!0}),r.setLayers(a),r}return ou(LayerGroup,t),LayerGroup.prototype.handleLayerChange_=function(){this.changed()},LayerGroup.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(unlistenByKey),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(listen(t,ws.ADD,this.handleLayersAdd_,this),listen(t,ws.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(unlistenByKey);clear(this.listenerKeys_);for(var n=t.getArray(),r=0,i=n.length;r<i;r++){var o=n[r];this.listenerKeys_[getUid(o)]=[listen(o,Ye,this.handleLayerChange_,this),listen(o,$e.CHANGE,this.handleLayerChange_,this)]}this.changed()},LayerGroup.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[getUid(e)]=[listen(e,Ye,this.handleLayerChange_,this),listen(e,$e.CHANGE,this.handleLayerChange_,this)],this.changed()},LayerGroup.prototype.handleLayersRemove_=function(t){var e=getUid(t.element);this.listenerKeys_[e].forEach(unlistenByKey),delete this.listenerKeys_[e],this.changed()},LayerGroup.prototype.getLayers=function(){return this.get(au.LAYERS)},LayerGroup.prototype.setLayers=function(t){this.set(au.LAYERS,t)},LayerGroup.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},LayerGroup.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));for(var r=this.getLayerState(),i=n,o=e.length;i<o;i++){var a=e[i];a.opacity*=r.opacity,a.visible=a.visible&&r.visible,a.maxResolution=Math.min(a.maxResolution,r.maxResolution),a.minResolution=Math.max(a.minResolution,r.minResolution),a.minZoom=Math.max(a.minZoom,r.minZoom),a.maxZoom=Math.min(a.maxZoom,r.maxZoom),void 0!==r.extent&&(void 0!==a.extent?a.extent=getIntersection(a.extent,r.extent):a.extent=r.extent)}return e},LayerGroup.prototype.getSourceState=function(){return Pi.READY},LayerGroup}(Ei),uu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),lu=function(t){function PluggableMap(e){var n=t.call(this)||this,r=function createOptionsInternal(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var n,r,i,o={},a=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new su({layers:t.layers});o[Ns.LAYERGROUP]=a,o[Ns.TARGET]=t.target,o[Ns.VIEW]=void 0!==t.view?t.view:new iu,void 0!==t.controls&&(Array.isArray(t.controls)?n=new Os(t.controls.slice()):(assert("function"==typeof t.controls.getArray,47),n=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?r=new Os(t.interactions.slice()):(assert("function"==typeof t.interactions.getArray,48),r=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?i=new Os(t.overlays.slice()):(assert("function"==typeof t.overlays.getArray,49),i=t.overlays):i=new Os;return{controls:n,interactions:r,keyboardEventTarget:e,overlays:i,values:o}}(e);n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,n.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:bo,n.postRenderTimeoutHandle_,n.animationDelayKey_,n.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(n),n.coordinateToPixelTransform_=[1,0,0,1,0,0],n.pixelToCoordinateTransform_=[1,0,0,1,0,0],n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.viewport_.style.msTouchAction="none",n.viewport_.style.touchAction="none",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=new js(n,e.moveTolerance);var i=n.handleMapBrowserEvent.bind(n);for(var o in Rs)n.mapBrowserEventHandler_.addEventListener(Rs[o],i);n.keyboardEventTarget_=r.keyboardEventTarget,n.keyHandlerKeys_=null;var a=n.handleBrowserEvent.bind(n);return n.viewport_.addEventListener($e.CONTEXTMENU,a,!1),n.viewport_.addEventListener($e.WHEEL,a,!1),n.controls=r.controls||new Os,n.interactions=r.interactions||new Os,n.labelCache_=null,n.labelCacheListenerKey_,n.overlays_=r.overlays,n.overlayIdIndex_={},n.renderer_=null,n.handleResize_,n.postRenderFunctions_=[],n.tileQueue_=new Gs(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addEventListener(getChangeEventType(Ns.LAYERGROUP),n.handleLayerGroupChanged_),n.addEventListener(getChangeEventType(Ns.VIEW),n.handleViewChanged_),n.addEventListener(getChangeEventType(Ns.SIZE),n.handleSizeChanged_),n.addEventListener(getChangeEventType(Ns.TARGET),n.handleTargetChanged_),n.setProperties(r.values),n.controls.forEach(function(t){t.setMap(this)}.bind(n)),n.controls.addEventListener(ws.ADD,function(t){t.element.setMap(this)}.bind(n)),n.controls.addEventListener(ws.REMOVE,function(t){t.element.setMap(null)}.bind(n)),n.interactions.forEach(function(t){t.setMap(this)}.bind(n)),n.interactions.addEventListener(ws.ADD,function(t){t.element.setMap(this)}.bind(n)),n.interactions.addEventListener(ws.REMOVE,function(t){t.element.setMap(null)}.bind(n)),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n.overlays_.addEventListener(ws.ADD,function(t){this.addOverlayInternal_(t.element)}.bind(n)),n.overlays_.addEventListener(ws.REMOVE,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(n)),n}return uu(PluggableMap,t),PluggableMap.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},PluggableMap.prototype.addControl=function(t){this.getControls().push(t)},PluggableMap.prototype.addInteraction=function(t){this.getInteractions().push(t)},PluggableMap.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},PluggableMap.prototype.addOverlay=function(t){this.getOverlays().push(t)},PluggableMap.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},PluggableMap.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),this.viewport_.removeEventListener($e.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener($e.WHEEL,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener($e.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},PluggableMap.prototype.forEachFeatureAtPixel=function(t,e,n){if(this.frameState_){var r=this.getCoordinateFromPixelInternal(t),i=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==n.layerFilter?n.layerFilter:TRUE,a=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,i,a,e,null,o,null)}},PluggableMap.prototype.getFeaturesAtPixel=function(t,e){var n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n},PluggableMap.prototype.forEachLayerAtPixel=function(t,e,n){if(this.frameState_){var r=n||{},i=void 0!==r.hitTolerance?r.hitTolerance*this.frameState_.pixelRatio:0,o=r.layerFilter||TRUE;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,i,e,o)}},PluggableMap.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var n=this.getCoordinateFromPixelInternal(t),r=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:TRUE,i=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,i,o,r,null)},PluggableMap.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},PluggableMap.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},PluggableMap.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),n="changedTouches"in t?t.changedTouches[0]:t;return[n.clientX-e.left,n.clientY-e.top]},PluggableMap.prototype.getTarget=function(){return this.get(Ns.TARGET)},PluggableMap.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},PluggableMap.prototype.getCoordinateFromPixel=function(t){return toUserCoordinate(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},PluggableMap.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;return e?apply(e.pixelToCoordinateTransform,t.slice()):null},PluggableMap.prototype.getControls=function(){return this.controls},PluggableMap.prototype.getOverlays=function(){return this.overlays_},PluggableMap.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},PluggableMap.prototype.getInteractions=function(){return this.interactions},PluggableMap.prototype.getLayerGroup=function(){return this.get(Ns.LAYERGROUP)},PluggableMap.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},PluggableMap.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var r=t[e].layer.getSource();if(r&&r.loading)return!0}return!1},PluggableMap.prototype.getPixelFromCoordinate=function(t){var e=fromUserCoordinate(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)},PluggableMap.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;return e?apply(e.coordinateToPixelTransform,t.slice(0,2)):null},PluggableMap.prototype.getRenderer=function(){return this.renderer_},PluggableMap.prototype.getSize=function(){return this.get(Ns.SIZE)},PluggableMap.prototype.getView=function(){return this.get(Ns.VIEW)},PluggableMap.prototype.getViewport=function(){return this.viewport_},PluggableMap.prototype.getOverlayContainer=function(){return this.overlayContainer_},PluggableMap.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},PluggableMap.prototype.getTilePriority=function(t,e,n,r){var i=this.frameState_;if(!(i&&e in i.wantedTiles))return 1/0;if(!i.wantedTiles[e][t.getKey()])return 1/0;var o=i.viewState.center,a=n[0]-o[0],s=n[1]-o[1];return 65536*Math.log(r)+Math.sqrt(a*a+s*s)/r},PluggableMap.prototype.handleBrowserEvent=function(t,e){var n=e||t.type,r=new Is(n,this,t);this.handleMapBrowserEvent(r)},PluggableMap.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){for(var e=t.originalEvent.target;e instanceof HTMLElement;){if(e.parentElement===this.overlayContainerStopEvent_)return;e=e.parentElement}t.frameState=this.frameState_;var n=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var r=n.length-1;r>=0;r--){var i=n[r];if(i.getActive())if(!i.handleEvent(t))break}}},PluggableMap.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var n=this.maxTilesLoading_,r=n;if(t){var i=t.viewHints;if(i[ao]||i[so]){var o=!To&&Date.now()-t.time>8;n=o?0:8,r=o?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,r))}!t||!this.hasListener(Ci)||t.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(Ci,t);for(var a=this.postRenderFunctions_,s=0,u=a.length;s<u;++s)a[s](this,t);a.length=0},PluggableMap.prototype.handleSizeChanged_=function(){this.getView()&&this.getView().resolveConstraints(0),this.render()},PluggableMap.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,n=this.keyHandlerKeys_.length;e<n;++e)unlistenByKey(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer());var r=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[listen(r,$e.KEYDOWN,this.handleBrowserEvent,this),listen(r,$e.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener($e.RESIZE,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),removeNode(this.viewport_),void 0!==this.handleResize_&&(removeEventListener($e.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},PluggableMap.prototype.handleTileChange_=function(){this.render()},PluggableMap.prototype.handleViewPropertyChanged_=function(){this.render()},PluggableMap.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(unlistenByKey(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(unlistenByKey(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",getUid(t)),this.viewPropertyListenerKey_=listen(t,Ye,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=listen(t,$e.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},PluggableMap.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[listen(t,Ye,this.render,this),listen(t,$e.CHANGE,this.render,this)]),this.render()},PluggableMap.prototype.isRendered=function(){return!!this.frameState_},PluggableMap.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},PluggableMap.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}},PluggableMap.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},PluggableMap.prototype.removeControl=function(t){return this.getControls().remove(t)},PluggableMap.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},PluggableMap.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},PluggableMap.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},PluggableMap.prototype.renderFrame_=function(t){var e=this.getSize(),n=this.getView(),r=this.frameState_,i=null;if(void 0!==e&&function hasArea(t){return t[0]>0&&t[1]>0}(e)&&n&&n.isDef()){var o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();i={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:r?r.declutterItems:[],extent:getForViewAndSize(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{}}}if(this.frameState_=i,this.renderer_.renderFrame(i),i){if(i.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,i.postRenderFunctions),r)(!this.previousExtent_||!isEmpty(this.previousExtent_)&&!equals(i.extent,this.previousExtent_))&&(this.dispatchEvent(new Cs(yi,this,r)),this.previousExtent_=createOrUpdateEmpty(this.previousExtent_));this.previousExtent_&&!i.viewHints[ao]&&!i.viewHints[so]&&!equals(i.extent,this.previousExtent_)&&(this.dispatchEvent(new Cs(gi,this,i)),function clone(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}(i.extent,this.previousExtent_))}this.dispatchEvent(new Cs(mi,this,i)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},PluggableMap.prototype.setLayerGroup=function(t){this.set(Ns.LAYERGROUP,t)},PluggableMap.prototype.setSize=function(t){this.set(Ns.SIZE,t)},PluggableMap.prototype.setTarget=function(t){this.set(Ns.TARGET,t)},PluggableMap.prototype.setView=function(t){this.set(Ns.VIEW,t)},PluggableMap.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},PluggableMap}(nn);var cu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),hu=function(t){function Attribution(e){var n=this,r=e||{};(n=t.call(this,{element:document.createElement("div"),render:r.render||render$1,target:r.target})||this).ulElement_=document.createElement("ul"),n.collapsed_=void 0===r.collapsed||r.collapsed,n.overrideCollapsible_=void 0!==r.collapsible,n.collapsible_=void 0===r.collapsible||r.collapsible,n.collapsible_||(n.collapsed_=!1);var i=void 0!==r.className?r.className:"ol-attribution",o=void 0!==r.tipLabel?r.tipLabel:"Attributions",a=void 0!==r.collapseLabel?r.collapseLabel:"";"string"==typeof a?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=a):n.collapseLabel_=a;var s=void 0!==r.label?r.label:"i";"string"==typeof s?(n.label_=document.createElement("span"),n.label_.textContent=s):n.label_=s;var u=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=o,l.appendChild(u),l.addEventListener($e.CLICK,n.handleClick_.bind(n),!1);var c=i+" "+zi+" "+Vi+(n.collapsed_&&n.collapsible_?" "+qi:"")+(n.collapsible_?"":" ol-uncollapsible"),h=n.element;return h.className=c,h.appendChild(n.ulElement_),h.appendChild(l),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return cu(Attribution,t),Attribution.prototype.collectSourceAttributions_=function(t){for(var e={},n=[],r=t.layerStatesArray,i=0,o=r.length;i<o;++i){var a=r[i];if(inView(a,t.viewState)){var s=a.layer.getSource();if(s){var u=s.getAttributions();if(u){var l=u(t);if(l)if(this.overrideCollapsible_||!1!==s.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(l))for(var c=0,h=l.length;c<h;++c)l[c]in e||(n.push(l[c]),e[l[c]]=!0);else l in e||(n.push(l),e[l]=!0)}}}}return n},Attribution.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!equals$1(e,this.renderedAttributions_)){!function removeChildren(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(var r=0,i=e.length;r<i;++r){var o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},Attribution.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},Attribution.prototype.handleToggle_=function(){this.element.classList.toggle(qi),this.collapsed_?replaceNode(this.collapseLabel_,this.label_):replaceNode(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},Attribution.prototype.getCollapsible=function(){return this.collapsible_},Attribution.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},Attribution.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},Attribution.prototype.getCollapsed=function(){return this.collapsed_},Attribution}(_i);function render$1(t){this.updateElement_(t.frameState)}var du=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),fu=function(t){function Rotate(e){var n=this,r=e||{};n=t.call(this,{element:document.createElement("div"),render:r.render||render$2,target:r.target})||this;var i=void 0!==r.className?r.className:"ol-rotate",o=void 0!==r.label?r.label:"";n.label_=null,"string"==typeof o?(n.label_=document.createElement("span"),n.label_.className="ol-compass",n.label_.textContent=o):(n.label_=o,n.label_.classList.add("ol-compass"));var a=r.tipLabel?r.tipLabel:"Reset rotation",s=document.createElement("button");s.className=i+"-reset",s.setAttribute("type","button"),s.title=a,s.appendChild(n.label_),s.addEventListener($e.CLICK,n.handleClick_.bind(n),!1);var u=i+" "+zi+" "+Vi,l=n.element;return l.className=u,l.appendChild(s),n.callResetNorth_=r.resetNorth?r.resetNorth:void 0,n.duration_=void 0!==r.duration?r.duration:250,n.autoHide_=void 0===r.autoHide||r.autoHide,n.rotation_=void 0,n.autoHide_&&n.element.classList.add(Gi),n}return du(Rotate,t),Rotate.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},Rotate.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:easeOut}):t.setRotation(0))},Rotate}(_i);function render$2(t){var e=t.frameState;if(e){var n=e.viewState.rotation;if(n!=this.rotation_){var r="rotate("+n+"rad)";if(this.autoHide_){var i=this.element.classList.contains(Gi);i||0!==n?i&&0!==n&&this.element.classList.remove(Gi):this.element.classList.add(Gi)}this.label_.style.transform=r}this.rotation_=n}}var pu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),mu=function(t){function Zoom(e){var n=this,r=e||{};n=t.call(this,{element:document.createElement("div"),target:r.target})||this;var i=void 0!==r.className?r.className:"ol-zoom",o=void 0!==r.delta?r.delta:1,a=void 0!==r.zoomInLabel?r.zoomInLabel:"+",s=void 0!==r.zoomOutLabel?r.zoomOutLabel:"",u=void 0!==r.zoomInTipLabel?r.zoomInTipLabel:"Zoom in",l=void 0!==r.zoomOutTipLabel?r.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=i+"-in",c.setAttribute("type","button"),c.title=u,c.appendChild("string"==typeof a?document.createTextNode(a):a),c.addEventListener($e.CLICK,n.handleClick_.bind(n,o),!1);var h=document.createElement("button");h.className=i+"-out",h.setAttribute("type","button"),h.title=l,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener($e.CLICK,n.handleClick_.bind(n,-o),!1);var d=i+" "+zi+" "+Vi,f=n.element;return f.className=d,f.appendChild(c),f.appendChild(h),n.duration_=void 0!==r.duration?r.duration:250,n}return pu(Zoom,t),Zoom.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},Zoom.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var n=e.getZoom();if(void 0!==n){var r=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:r,duration:this.duration_,easing:easeOut})):e.setZoom(r)}}},Zoom}(_i);function asString(t){return"string"==typeof t?t:function toString$2(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var r=t[2];r!=(0|r)&&(r=r+.5|0);var i=void 0===t[3]?1:t[3];return"rgba("+e+","+n+","+r+","+i+")"}(t)}function getKey$1(t,e,n){return e+":"+t+":"+(n?asString(n):"null")}var yu=new(function(){function IconImageCache(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return IconImageCache.prototype.clear=function(){this.cache_={},this.cacheSize_=0},IconImageCache.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},IconImageCache.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},IconImageCache.prototype.get=function(t,e,n){var r=getKey$1(t,e,n);return r in this.cache_?this.cache_[r]:null},IconImageCache.prototype.set=function(t,e,n,r){var i=getKey$1(t,e,n);this.cache_[i]=r,++this.cacheSize_},IconImageCache.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},IconImageCache}());var gu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),vu=function(t){function MapRenderer(e){var n=t.call(this)||this;return n.map_=e,n.declutterTree_=null,n}return gu(MapRenderer,t),MapRenderer.prototype.dispatchRenderEvent=function(t,e){abstract()},MapRenderer.prototype.calculateMatrices2D=function(t){var e=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;compose(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),makeInverse(r,n)},MapRenderer.prototype.forEachFeatureAtCoordinate=function(t,e,n,r,i,o,a,s){var u,l=e.viewState;function forEachFeatureAtCoordinate(t,e,n){return i.call(o,e,t?n:null)}var c=l.projection,h=t,d=[[0,0]];if(c.canWrapX()){var f=c.getExtent(),p=getWidth(f),m=t[0];if(m<f[0]||m>f[2])h=[m+p*Math.ceil((f[0]-m)/p),t[1]];r&&d.push([-p,0],[p,0])}var y,g=e.layerStatesArray,v=g.length;this.declutterTree_&&(y=this.declutterTree_.all().map((function(t){return t.value})));for(var _=[],b=0;b<d.length;b++)for(var T=v-1;T>=0;--T){var w=g[T],E=w.layer;if(E.hasRenderer()&&inView(w,l)&&a.call(s,E)){var S=E.getRenderer(),M=E.getSource(),O=M.getWrapX()?h:t;if(S&&M){var x=forEachFeatureAtCoordinate.bind(null,w.managed);_[0]=O[0]+d[b][0],_[1]=O[1]+d[b][1],u=S.forEachFeatureAtCoordinate(_,e,n,x,y)}if(u)return u}}},MapRenderer.prototype.forEachLayerAtPixel=function(t,e,n,r,i){return abstract()},MapRenderer.prototype.hasFeatureAtCoordinate=function(t,e,n,r,i,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,r,TRUE,this,i,o)},MapRenderer.prototype.getMap=function(){return this.map_},MapRenderer.prototype.renderFrame=function(t){this.declutterTree_=function renderDeclutterItems(t,e){e&&e.clear();for(var n=t.declutterItems,r=n.length-1;r>=0;--r)for(var i=n[r],o=i.items,a=0,s=o.length;a<s;a+=3)e=o[a].renderDeclutter(o[a+1],o[a+2],i.opacity,e);return n.length=0,e}(t,this.declutterTree_)},MapRenderer.prototype.scheduleExpireIconCache=function(t){yu.canExpireCache()&&t.postRenderFunctions.push(expireIconCache)},MapRenderer}(Be);function expireIconCache(t,e){yu.expire()}var _u=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),bu=function(t){function CompositeMapRenderer(e){var n=t.call(this,e)||this;n.labelCacheKey_=listen(Bi,$e.CLEAR,e.redrawText.bind(e)),n.element_=document.createElement("div");var r=n.element_.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",n.element_.className=zi+" ol-layers";var i=e.getViewport();return i.insertBefore(n.element_,i.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return _u(CompositeMapRenderer,t),CompositeMapRenderer.prototype.dispatchRenderEvent=function(t,e){var n=this.getMap();if(n.hasListener(t)){var r=new Ui(t,void 0,e);n.dispatchEvent(r)}},CompositeMapRenderer.prototype.disposeInternal=function(){unlistenByKey(this.labelCacheKey_),t.prototype.disposeInternal.call(this)},CompositeMapRenderer.prototype.renderFrame=function(e){if(e){this.calculateMatrices2D(e),this.dispatchRenderEvent(Oi,e);var n=e.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),r=e.viewState;this.children_.length=0;for(var i=!1,o=null,a=0,s=n.length;a<s;++a){var u=n[a];if(i=i||u.hasOverlay,e.layerIndex=a,inView(u,r)&&(u.sourceState==Pi.READY||u.sourceState==Pi.UNDEFINED)){var l=u.layer.render(e,o);if(l){var c=l.childElementCount;l===o&&a!=s-1||2!==c||i||l.removeChild(l.lastElementChild),l!==o&&(this.children_.push(l),i=2===c,o=l)}}}t.prototype.renderFrame.call(this,e),function replaceChildren(t,e){for(var n=t.childNodes,r=0;;++r){var i=n[r],o=e[r];if(!i&&!o)break;i!==o&&(i?o?t.insertBefore(o,i):(t.removeChild(i),--r):t.appendChild(o))}}(this.element_,this.children_),this.dispatchRenderEvent(xi,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},CompositeMapRenderer.prototype.forEachLayerAtPixel=function(t,e,n,r,i){for(var o=e.viewState,a=e.layerStatesArray,s=a.length-1;s>=0;--s){var u=a[s],l=u.layer;if(l.hasRenderer()&&inView(u,o)&&i(l)){var c=l.getRenderer().getDataAtPixel(t,e,n);if(c){var h=r(l,c);if(h)return h}}}},CompositeMapRenderer}(vu);var Tu=function(){function Kinetic(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return Kinetic.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},Kinetic.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},Kinetic.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var n=e-3;n>0&&this.points_[n+2]>t;)n-=3;var r=this.points_[e+2]-this.points_[n+2];if(r<1e3/60)return!1;var i=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,i),this.initialVelocity_=Math.sqrt(i*i+o*o)/r,this.initialVelocity_>this.minVelocity_},Kinetic.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},Kinetic.prototype.getAngle=function(){return this.angle_},Kinetic}(),wu="active",Eu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Su=function(t){function Interaction(e){var n=t.call(this)||this;return e.handleEvent&&(n.handleEvent=e.handleEvent),n.map_=null,n.setActive(!0),n}return Eu(Interaction,t),Interaction.prototype.getActive=function(){return this.get(wu)},Interaction.prototype.getMap=function(){return this.map_},Interaction.prototype.handleEvent=function(t){return!0},Interaction.prototype.setActive=function(t){this.set(wu,t)},Interaction.prototype.setMap=function(t){this.map_=t},Interaction}(nn);function zoomByDelta(t,e,n,r){var i=t.getZoom();if(void 0!==i){var o=t.getConstrainedZoom(i+e),a=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:n,duration:void 0!==r?r:250,easing:easeOut})}}var Mu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Ou=function(t){function DoubleClickZoom(e){var n=t.call(this,{handleEvent:handleEvent})||this,r=e||{};return n.delta_=r.delta?r.delta:1,n.duration_=void 0!==r.duration?r.duration:250,n}return Mu(DoubleClickZoom,t),DoubleClickZoom}(Su);function handleEvent(t){var e=!1;if(t.type==Rs.DBLCLICK){var n=t.originalEvent,r=t.map,i=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_;zoomByDelta(r.getView(),o,i,this.duration_),t.preventDefault(),e=!0}return!e}var xu=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Cu=function(t){return t.target.getTargetElement()===document.activeElement},Pu=TRUE,Iu=function(t){var e=t.originalEvent;return 0==e.button&&!(vo&&_o&&e.ctrlKey)},Ru=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Lu=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ku=function(t){var e=t.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},Au=function(t){var e=t.pointerEvent;return assert(void 0!==e,56),"mouse"==e.pointerType},Du=function(t){var e=t.pointerEvent;return assert(void 0!==e,56),e.isPrimary&&0===e.button},ju=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Nu=function(t){function PointerInteraction(e){var n=this,r=e||{};return n=t.call(this,r)||this,r.handleDownEvent&&(n.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(n.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(n.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(n.handleUpEvent=r.handleUpEvent),r.stopDown&&(n.stopDown=r.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return ju(PointerInteraction,t),PointerInteraction.prototype.handleDownEvent=function(t){return!1},PointerInteraction.prototype.handleDragEvent=function(t){},PointerInteraction.prototype.handleEvent=function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Rs.POINTERDRAG)this.handleDragEvent(t);else if(t.type==Rs.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==Rs.POINTERDOWN){var r=this.handleDownEvent(t);r&&t.preventDefault(),this.handlingDownUpSequence=r,e=this.stopDown(r)}else t.type==Rs.POINTERMOVE&&this.handleMoveEvent(t);return!e},PointerInteraction.prototype.handleMoveEvent=function(t){},PointerInteraction.prototype.handleUpEvent=function(t){return!1},PointerInteraction.prototype.stopDown=function(t){return t},PointerInteraction.prototype.updateTrackedPointers_=function(t){if(function isPointerDraggingEvent(t){var e=t.type;return e===Rs.POINTERDOWN||e===Rs.POINTERDRAG||e===Rs.POINTERUP}(t)){var e=t.pointerEvent,n=e.pointerId.toString();t.type==Rs.POINTERUP?delete this.trackedPointers_[n]:t.type==Rs.POINTERDOWN?this.trackedPointers_[n]=e:n in this.trackedPointers_&&(this.trackedPointers_[n]=e),this.targetPointers=r(this.trackedPointers_)}},PointerInteraction}(Su);function centroid(t){for(var e=t.length,n=0,r=0,i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return[n/e,r/e]}var Fu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Uu=function(t){function DragPan(e){var n=t.call(this,{stopDown:FALSE})||this,r=e||{};return n.kinetic_=r.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1,n.condition_=r.condition?r.condition:defaultCondition,n.noKinetic_=!1,n}return Fu(DragPan,t),DragPan.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e=this.targetPointers,n=centroid(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){var r=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],i=t.map.getView();!function scale$1(t,e){return t[0]*=e,t[1]*=e,t}(r,i.getResolution()),rotate(r,i.getRotation()),i.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=e.length},DragPan.prototype.handleUpEvent=function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),s=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(i),a[1]-r*Math.sin(i)]);n.animateInternal({center:n.getConstrainedCenter(s),duration:500,easing:easeOut})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},DragPan.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},DragPan}(Nu);function defaultCondition(t){return Ru(t)&&Du(t)}var Gu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),zu=function(t){function DragRotate(e){var n=this,r=e||{};return(n=t.call(this,{stopDown:FALSE})||this).condition_=r.condition?r.condition:xu,n.lastAngle_=void 0,n.duration_=void 0!==r.duration?r.duration:250,n}return Gu(DragRotate,t),DragRotate.prototype.handleDragEvent=function(t){if(Au(t)){var e=t.map,n=e.getView();if(n.getConstraints().rotation!==disable){var r=e.getSize(),i=t.pixel,o=Math.atan2(r[1]/2-i[1],i[0]-r[0]/2);if(void 0!==this.lastAngle_){var a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}}},DragRotate.prototype.handleUpEvent=function(t){return!Au(t)||(t.map.getView().endInteraction(this.duration_),!1)},DragRotate.prototype.handleDownEvent=function(t){return!!Au(t)&&(!(!Iu(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))},DragRotate}(Nu),Vu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),qu=function(t){function RenderBox(e){var n=t.call(this)||this;return n.geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.className="ol-box "+e,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return Vu(RenderBox,t),RenderBox.prototype.disposeInternal=function(){this.setMap(null)},RenderBox.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,n=this.element_.style;n.left=Math.min(t[0],e[0])+"px",n.top=Math.min(t[1],e[1])+"px",n.width=Math.abs(e[0]-t[0])+"px",n.height=Math.abs(e[1]-t[1])+"px"},RenderBox.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},RenderBox.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},RenderBox.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new eu([n])},RenderBox.prototype.getGeometry=function(){return this.geometry_},RenderBox}(Be),Zu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),Wu="boxstart",Yu="boxdrag",Bu="boxend",Ku=function(t){function DragBoxEvent(e,n,r){var i=t.call(this,e)||this;return i.coordinate=n,i.mapBrowserEvent=r,i}return Zu(DragBoxEvent,t),DragBoxEvent}(Ke),Hu=function(t){function DragBox(e){var n=t.call(this)||this,r=e||{};return n.box_=new qu(r.className||"ol-dragbox"),n.minArea_=void 0!==r.minArea?r.minArea:64,n.onBoxEnd_=r.onBoxEnd?r.onBoxEnd:VOID,n.startPixel_=null,n.condition_=r.condition?r.condition:Pu,n.boxEndCondition_=r.boxEndCondition?r.boxEndCondition:n.defaultBoxEndCondition,n}return Zu(DragBox,t),DragBox.prototype.defaultBoxEndCondition=function(t,e,n){var r=n[0]-e[0],i=n[1]-e[1];return r*r+i*i>=this.minArea_},DragBox.prototype.getGeometry=function(){return this.box_.getGeometry()},DragBox.prototype.handleDragEvent=function(t){Au(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Ku(Yu,t.coordinate,t)))},DragBox.prototype.handleUpEvent=function(t){return!Au(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new Ku(Bu,t.coordinate,t))),!1)},DragBox.prototype.handleDownEvent=function(t){return!!Au(t)&&(!(!Iu(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ku(Wu,t.coordinate,t)),!0))},DragBox}(Nu),Xu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),$u=function(t){function DragZoom(e){var n=this,r=e||{},i=r.condition?r.condition:Lu;return(n=t.call(this,{condition:i,className:r.className||"ol-dragzoom",minArea:r.minArea,onBoxEnd:onBoxEnd})||this).duration_=void 0!==r.duration?r.duration:200,n.out_=void 0!==r.out&&r.out,n}return Xu(DragZoom,t),DragZoom}(Hu);function onBoxEnd(){var t=this.getMap(),e=t.getView(),n=t.getSize(),r=this.getGeometry().getExtent();if(this.out_){var i=e.calculateExtentInternal(n),o=createOrUpdateFromCoordinates([t.getPixelFromCoordinateInternal(getBottomLeft(r)),t.getPixelFromCoordinateInternal(getTopRight(r))]);!function scaleFromCenter(t,e){var n=(t[2]-t[0])/2*(e-1),r=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=r,t[3]+=r}(i,1/e.getResolutionForExtentInternal(o,n)),r=i}var a=e.getConstrainedResolution(e.getResolutionForExtentInternal(r,n)),s=e.getConstrainedCenter(getCenter(r),a);e.animateInternal({resolution:a,center:s,duration:this.duration_,easing:easeOut})}var Qu={LEFT:37,UP:38,RIGHT:39,DOWN:40},Ju=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),tl=function(t){function KeyboardPan(e){var n=t.call(this,{handleEvent:handleEvent$1})||this,r=e||{};return n.defaultCondition_=function(t){return Ru(t)&&ku(t)},n.condition_=void 0!==r.condition?r.condition:n.defaultCondition_,n.duration_=void 0!==r.duration?r.duration:100,n.pixelDelta_=void 0!==r.pixelDelta?r.pixelDelta:128,n}return Ju(KeyboardPan,t),KeyboardPan}(Su);function handleEvent$1(t){var e=!1;if(t.type==$e.KEYDOWN){var n=t.originalEvent.keyCode;if(this.condition_(t)&&(n==Qu.DOWN||n==Qu.LEFT||n==Qu.RIGHT||n==Qu.UP)){var r=t.map.getView(),i=r.getResolution()*this.pixelDelta_,o=0,a=0;n==Qu.DOWN?a=-i:n==Qu.LEFT?o=-i:n==Qu.RIGHT?o=i:a=i;var s=[o,a];rotate(s,r.getRotation()),function pan(t,e,n){var r=t.getCenterInternal();if(r){var i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:linear,center:t.getConstrainedCenter(i)})}}(r,s,this.duration_),t.preventDefault(),e=!0}}return!e}var el=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),nl=function(t){function KeyboardZoom(e){var n=t.call(this,{handleEvent:handleEvent$2})||this,r=e||{};return n.condition_=r.condition?r.condition:ku,n.delta_=r.delta?r.delta:1,n.duration_=void 0!==r.duration?r.duration:100,n}return el(KeyboardZoom,t),KeyboardZoom}(Su);function handleEvent$2(t){var e=!1;if(t.type==$e.KEYDOWN||t.type==$e.KEYPRESS){var n=t.originalEvent.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var r=t.map,i=n=="+".charCodeAt(0)?this.delta_:-this.delta_;zoomByDelta(r.getView(),i,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}var rl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),il="trackpad",ol="wheel",al=function(t){function MouseWheelZoom(e){var n=this,r=e||{};return(n=t.call(this,r)||this).totalDelta_=0,n.lastDelta_=0,n.maxDelta_=void 0!==r.maxDelta?r.maxDelta:1,n.duration_=void 0!==r.duration?r.duration:250,n.timeout_=void 0!==r.timeout?r.timeout:80,n.useAnchor_=void 0===r.useAnchor||r.useAnchor,n.condition_=r.condition?r.condition:Pu,n.lastAnchor_=null,n.startTime_=void 0,n.timeoutId_,n.mode_=void 0,n.trackpadEventGap_=400,n.trackpadTimeoutId_,n.trackpadDeltaPerZoom_=300,n}return rl(MouseWheelZoom,t),MouseWheelZoom.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,Math.sign(this.lastDelta_),this.lastAnchor_)},MouseWheelZoom.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;if(t.type!==$e.WHEEL)return!0;t.preventDefault();var e,n=t.map,r=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==$e.WHEEL&&(e=r.deltaY,go&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=bo),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var i=Date.now();if(void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?il:ol),this.mode_===il){var o=n.getView();return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):o.beginInteraction(),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.trackpadEventGap_),o.adjustZoom(-e/this.trackpadDeltaPerZoom_,this.lastAnchor_),this.startTime_=i,!1}this.totalDelta_+=e;var a=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),a),!1},MouseWheelZoom.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations(),zoomByDelta(e,-clamp(this.totalDelta_,-this.maxDelta_,this.maxDelta_),this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},MouseWheelZoom.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},MouseWheelZoom}(Su),sl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),ul=function(t){function PinchRotate(e){var n=this,r=e||{},i=r;return i.stopDown||(i.stopDown=FALSE),(n=t.call(this,i)||this).anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=void 0!==r.threshold?r.threshold:.3,n.duration_=void 0!==r.duration?r.duration:250,n}return sl(PinchRotate,t),PinchRotate.prototype.handleDragEvent=function(t){var e=0,n=this.targetPointers[0],r=this.targetPointers[1],i=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(void 0!==this.lastAngle_){var o=i-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=i;var a=t.map,s=a.getView();if(s.getConstraints().rotation!==disable){var u=a.getViewport().getBoundingClientRect(),l=centroid(this.targetPointers);l[0]-=u.left,l[1]-=u.top,this.anchor_=a.getCoordinateFromPixelInternal(l),this.rotating_&&(a.render(),s.adjustRotationInternal(e,this.anchor_))}},PinchRotate.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)},PinchRotate.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},PinchRotate}(Nu),ll=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),cl=function(t){function PinchZoom(e){var n=this,r=e||{},i=r;return i.stopDown||(i.stopDown=FALSE),(n=t.call(this,i)||this).anchor_=null,n.duration_=void 0!==r.duration?r.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return ll(PinchZoom,t),PinchZoom.prototype.handleDragEvent=function(t){var e=1,n=this.targetPointers[0],r=this.targetPointers[1],i=n.clientX-r.clientX,o=n.clientY-r.clientY,a=Math.sqrt(i*i+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var s=t.map,u=s.getView();1!=e&&(this.lastScaleDelta_=e);var l=s.getViewport().getBoundingClientRect(),c=centroid(this.targetPointers);c[0]-=l.left,c[1]-=l.top,this.anchor_=s.getCoordinateFromPixelInternal(c),s.render(),u.adjustResolutionInternal(e,this.anchor_)},PinchZoom.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0},PinchZoom.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},PinchZoom}(Nu);var hl=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),dl=function(t){function Map(e){return(e=n({},e)).controls||(e.controls=function defaults(t){var e=t||{},n=new Os;return(void 0===e.zoom||e.zoom)&&n.push(new mu(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&n.push(new fu(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&n.push(new hu(e.attributionOptions)),n}()),e.interactions||(e.interactions=function defaults$1(t){var e=t||{},n=new Os,r=new Tu(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&n.push(new zu),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&n.push(new Ou({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&n.push(new Uu({condition:e.onFocusOnly?Cu:void 0,kinetic:r})),(void 0===e.pinchRotate||e.pinchRotate)&&n.push(new ul),(void 0===e.pinchZoom||e.pinchZoom)&&n.push(new cl({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(n.push(new tl),n.push(new nl({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&n.push(new al({condition:e.onFocusOnly?Cu:void 0,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&n.push(new $u({duration:e.zoomDuration})),n}()),t.call(this,e)||this}return hl(Map,t),Map.prototype.createRenderer=function(){return new bu(this)},Map}(lu),fl=createCommonjsModule((function(t,e){t.exports=function(t,e){t="default"in t?t.default:t;var n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r=function(){function defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&defineProperties(t.prototype,e),n&&defineProperties(t,n),t}}(),i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},o="layer-switcher-",a=function(t){function LayerSwitcher(t){n(this,LayerSwitcher);var e=t||{},r=e.tipLabel?e.tipLabel:"Legend",o=document.createElement("div"),a=i(this,(LayerSwitcher.__proto__||Object.getPrototypeOf(LayerSwitcher)).call(this,{element:o,target:e.target}));a.groupSelectStyle=LayerSwitcher.getGroupSelectStyle(e.groupSelectStyle),a.mapListeners=[],a.hiddenClassName="ol-unselectable ol-control layer-switcher",LayerSwitcher.isTouchDevice_()&&(a.hiddenClassName+=" touch"),a.shownClassName="shown",o.className=a.hiddenClassName;var s=document.createElement("button");s.setAttribute("title",r),o.appendChild(s),a.panel=document.createElement("div"),a.panel.className="panel",o.appendChild(a.panel),LayerSwitcher.enableTouchScroll_(a.panel);var u=a;return s.onmouseover=function(t){u.showPanel()},s.onclick=function(t){t=t||window.event,u.showPanel(),t.preventDefault()},u.panel.onmouseout=function(t){t=t||window.event,u.panel.contains(t.toElement||t.relatedTarget)||u.hidePanel()},a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(LayerSwitcher,t),r(LayerSwitcher,[{key:"setMap",value:function setMap(t){for(var n=0;n<this.mapListeners.length;n++)e.unByKey(this.mapListeners[n]);if(this.mapListeners.length=0,function get(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:get(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0}(LayerSwitcher.prototype.__proto__||Object.getPrototypeOf(LayerSwitcher.prototype),"setMap",this).call(this,t),t){var r=this;this.mapListeners.push(t.on("pointerdown",(function(){r.hidePanel()}))),this.renderPanel()}}},{key:"showPanel",value:function showPanel(){this.element.classList.contains(this.shownClassName)||(this.element.classList.add(this.shownClassName),this.renderPanel())}},{key:"hidePanel",value:function hidePanel(){this.element.classList.contains(this.shownClassName)&&this.element.classList.remove(this.shownClassName)}},{key:"renderPanel",value:function renderPanel(){LayerSwitcher.renderPanel(this.getMap(),this.panel,{groupSelectStyle:this.groupSelectStyle})}}],[{key:"renderPanel",value:function renderPanel(t,e,n){for((n=n||{}).groupSelectStyle=LayerSwitcher.getGroupSelectStyle(n.groupSelectStyle),LayerSwitcher.ensureTopVisibleBaseLayerShown_(t);e.firstChild;)e.removeChild(e.firstChild);LayerSwitcher.forEachRecursive(t,(function(t,e,n){t.set("indeterminate",!1)})),"children"===n.groupSelectStyle||"none"===n.groupSelectStyle?LayerSwitcher.setGroupVisibility(t):"group"===n.groupSelectStyle&&LayerSwitcher.setChildVisibility(t);var r=document.createElement("ul");e.appendChild(r),LayerSwitcher.renderLayers_(t,t,r,n,(function render(r){LayerSwitcher.renderPanel(t,e,n)}))}},{key:"isBaseGroup",value:function isBaseGroup(t){var e=t.getLayers?t.getLayers().getArray():[];return e.length&&"base"===e[0].get("type")}},{key:"setGroupVisibility",value:function setGroupVisibility(t){LayerSwitcher.getGroupsAndLayers(t,(function(t){return t.getLayers&&!t.get("combine")&&!LayerSwitcher.isBaseGroup(t)})).reverse().forEach((function(t){var e=t.getLayersArray().map((function(t){return t.getVisible()}));e.every((function(t){return!0===t}))?(t.setVisible(!0),t.set("indeterminate",!1)):e.every((function(t){return!1===t}))?(t.setVisible(!1),t.set("indeterminate",!1)):(t.setVisible(!0),t.set("indeterminate",!0))}))}},{key:"setChildVisibility",value:function setChildVisibility(t){LayerSwitcher.getGroupsAndLayers(t,(function(t){return t.getLayers&&!t.get("combine")&&!LayerSwitcher.isBaseGroup(t)})).forEach((function(t){var e=t.getVisible(),n=t.get("indeterminate");t.getLayers().getArray().forEach((function(t){t.set("indeterminate",!1),e&&!n||!t.getVisible()||t.set("indeterminate",!0)}))}))}},{key:"ensureTopVisibleBaseLayerShown_",value:function ensureTopVisibleBaseLayerShown_(t){var e;LayerSwitcher.forEachRecursive(t,(function(t,n,r){"base"===t.get("type")&&t.getVisible()&&(e=t)})),e&&LayerSwitcher.setVisible_(t,e,!0)}},{key:"getGroupsAndLayers",value:function getGroupsAndLayers(t,e){var n=[];return e=e||function(t,e,n){return!0},LayerSwitcher.forEachRecursive(t,(function(t,r,i){t.get("title")&&e(t,r,i)&&n.push(t)})),n}},{key:"setVisible_",value:function setVisible_(t,e,n,r){e.setVisible(n),n&&"base"===e.get("type")&&LayerSwitcher.forEachRecursive(t,(function(t,n,r){t!=e&&"base"===t.get("type")&&t.setVisible(!1)})),e.getLayers&&!e.get("combine")&&"children"===r&&e.getLayers().forEach((function(n){LayerSwitcher.setVisible_(t,n,e.getVisible(),r)}))}},{key:"renderLayer_",value:function renderLayer_(t,e,n,r,i){var a=document.createElement("li"),s=e.get("title"),u=LayerSwitcher.uuid(),l=document.createElement("label");if(e.getLayers&&!e.get("combine")){var c=LayerSwitcher.isBaseGroup(e);if(a.classList.add("group"),c&&a.classList.add(o+"base-group"),e.get("fold")){a.classList.add(o+"fold"),a.classList.add(o+e.get("fold"));var h=document.createElement("button");h.onclick=function(t){LayerSwitcher.toggleFold_(e,a)},a.appendChild(h)}if(!c&&"none"!=r.groupSelectStyle){var d=document.createElement("input");d.type="checkbox",d.id=u,d.checked=e.getVisible(),d.indeterminate=e.get("indeterminate"),d.onchange=function(n){LayerSwitcher.setVisible_(t,e,n.target.checked,r.groupSelectStyle),i(e)},a.appendChild(d),l.htmlFor=u}l.innerHTML=s,a.appendChild(l);var f=document.createElement("ul");a.appendChild(f),LayerSwitcher.renderLayers_(t,e,f,r,i)}else{a.className="layer";var p=document.createElement("input");"base"===e.get("type")?(p.type="radio",p.name="base"):p.type="checkbox",p.id=u,p.checked=e.get("visible"),p.indeterminate=e.get("indeterminate"),p.onchange=function(n){LayerSwitcher.setVisible_(t,e,n.target.checked,r.groupSelectStyle),i(e)},a.appendChild(p),l.htmlFor=u,l.innerHTML=s;var m=t.getView().getResolution();(m>e.getMaxResolution()||m<e.getMinResolution())&&(l.className+=" disabled"),a.appendChild(l)}return a}},{key:"renderLayers_",value:function renderLayers_(t,e,n,r,i){for(var o,a=e.getLayers().getArray().slice().reverse(),s=0;s<a.length;s++)(o=a[s]).get("title")&&n.appendChild(LayerSwitcher.renderLayer_(t,o,s,r,i))}},{key:"forEachRecursive",value:function forEachRecursive(t,e){t.getLayers().forEach((function(t,n,r){e(t,n,r),t.getLayers&&LayerSwitcher.forEachRecursive(t,e)}))}},{key:"uuid",value:function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}},{key:"enableTouchScroll_",value:function enableTouchScroll_(t){if(LayerSwitcher.isTouchDevice_()){var e=0;t.addEventListener("touchstart",(function(t){e=this.scrollTop+t.touches[0].pageY}),!1),t.addEventListener("touchmove",(function(t){this.scrollTop=e-t.touches[0].pageY}),!1)}}},{key:"isTouchDevice_",value:function isTouchDevice_(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}},{key:"toggleFold_",value:function toggleFold_(t,e){e.classList.remove(o+t.get("fold")),t.set("fold","open"===t.get("fold")?"close":"open"),e.classList.add(o+t.get("fold"))}},{key:"getGroupSelectStyle",value:function getGroupSelectStyle(t){return["none","children","group"].indexOf(t)>=0?t:"children"}}]),LayerSwitcher}(t);return window.ol&&window.ol.control&&(window.ol.control.LayerSwitcher=a),a}(_i,Je)})),pl=function(t){function MetOClient(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,MetOClient),t=_possibleConstructorReturn(this,_getPrototypeOf(MetOClient).call(this)),G.defs("EPSG:3067","+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),register(G),t.config_=n(pi,e),t.set("options",e,!0),t.set("map",null),t.timeSlider_=null,t.status_={},t.delay_=null!=e.refreshInterval&&e.refreshInterval<=Number.MAX_SAFE_INTEGER&&e.refreshInterval>=0?e.refreshInterval:ai,t.periodDelay_=2*ai,t.times_=[],t.playingListener_=null,t.nextListener_=null,t.previousListener_=null,t.renderComplete_=!1,t.updateNeeded_=!1,t.waitingRender_=0,t.refreshInterval_=e.refreshInterval?Math.min(Duration.fromISO(e.refreshInterval).valueOf(),oi):fi,t.capabilities_={},t.on("change:options",(function(){t.config_=n(pi,t.get("options")),t.refresh()})),t}var e;return _inherits(MetOClient,t),_createClass(MetOClient,[{key:"render",value:function render(){var t=this;return this.updateCapabilities_().then((function(){t.updateTimes_();var e=t.times_[0],n=Date.now();t.times_.some((function(t){var r=t>n;return r||(e=t),r})),null==t.config_.time&&(t.config_.time=e),t.config_.time<t.times_[0]&&(t.config_.time=t.times_[0]);var r=t.times_.length-1;t.config_.time>t.times_[r]&&(t.config_.time=t.times_[r]),Object.keys(t.config_.sources).forEach((function(n){null!=t.config_.sources[n].times&&t.config_.sources[n].times.length>0&&(t.config_.sources[n].tiles=function updateSourceTime(t,e){return t.map((function(t){var n=new V(t),r="time";for(var i in n.query)n.query.hasOwnProperty(i)&&"time"===i.toLocaleLowerCase()&&(r=i);return null!=e?n.query[r]="number"==typeof e?new Date(e).toISOString():e:delete n.query[p],n.toString()}))}(t.config_.sources[n].tiles,t.config_.sources[n].times.includes(e)?e:t.config_.sources[n].times[0]))})),t.updateMap_()}))}},{key:"refresh",value:function refresh(){var t=this.get("map");null!=t&&t.getLayers().getArray().forEach((function(t,e){var n=t.getSource();null!=n.get("metoclient:time")&&n.set("metoclient:time",null)}));this.render()}},{key:"updateCapabilities_",value:(e=function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function _next(t){asyncGeneratorStep(o,r,i,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(o,r,i,_next,_throw,"throw",t)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var t,e,n=this;return regeneratorRuntime.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return t=Date.now(),r.next=3,Promise.all(this.config_.layers.reduce((function(e,r){if(null==r.source)return e;var i=[r.source];return null==r.time||null==r.time.source||i.includes(r.time.source)||i.push(r.time.source),i.forEach((function(i){var o=n.config_.sources[i];if(null!=o){var a="";if(null!=o.capabilities&&o.capabilities.length>0)a=o.capabilities;else{if(null==o.tiles||0===o.tiles.length)return;a=o.tiles[0]}a.endsWith("/")&&(a=a.substring(0,a.length-1));var s=a.lastIndexOf("/"),u="";u=a.toLowerCase().startsWith("http")&&s>=0?a.substring(s+1).toLowerCase():r.url.service.toLowerCase(),null==n.capabilities_[a]&&(n.capabilities_[a]={updated:null,type:u,data:null}),n.capabilities_[a].updated!==t&&(e.push(a+"?service=".concat(u,"&").concat("request=GetCapabilities")),n.capabilities_[a].updated=t)}})),e}),[]).map((function(t){return fetch(t)})));case 3:return e=r.sent,r.next=6,Promise.all(e.map((function(t){return t.text().then((function(e){if(null!=e&&t.url.endsWith("request=GetCapabilities")){var r=t.url.split("?")[0],i=r.split("/"),o="";i.length>0&&(o=i[i.length-1]),o.length>0&&null!=n.capabilities_[o]&&(r=o),"function"==typeof Ts[n.capabilities_[r].type]&&(n.capabilities_[r].data=Ts[n.capabilities_[r].type](e))}})).catch((function(t){console.log(t)}))})));case 6:case"end":return r.stop()}}),_callee,this)}))),function updateCapabilities_(){return e.apply(this,arguments)})},{key:"isTiledLayer_",value:function isTiledLayer_(t){if(null==t||null==t.source)return!1;if(null!=t.url&&"string"==typeof t.url.service&&"wmts"===t.url.service.toLowerCase())return!0;var e=this.config_.sources[t.source];if(null==e||null==e.tiles)return!1;var n=Array.isArray(e.tileSize)?e.tileSize.map((function(t){return Number(t)>0})):new Array(2).fill(Number(e.tileSize)>0);if(Array.isArray(e.tiles)){var r=new V(e.tiles[0].toLowerCase());n=["width","height"].map((function(t,e){return null!=r.query&&void 0!==r.query[t]&&Number(r.query[t])>0||n[e]}))}return null!=t.url&&["width","height"].forEach((function(e,r){void 0!==t.url[e]&&(n[r]=Number(t.url[e])>0)})),n.every(Boolean)}},{key:"createLayer_",value:function createLayer_(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.config_.time,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=this.isTiledLayer_(t)?"tiled":"image",o=this.config_.sources[t.source],a=null!=t.time&&null!=t.time.data,s=r.length>0;if(s&&!a)return null;var u=_objectSpread2({},this.config_);a&&(u.time=n,t.time.data.includes(u.time)||(u.time=t.time.data.reduce((function(t,n){return n<e.config_.time&&n>t&&(t=n),t}),t.time.data[0])));var l=null!=o.capabilities&&o.capabilities.length>0?o.capabilities:o.tiles[0],c=_a[i](t,u,this.capabilities_[l]);if(null!=c){c.on("change:visible",(function(t){var n=c.getVisible();["previous","next"].forEach((function(t){e.setRelativesVisible_(c,t,n);var r=c.get("metoclient:previous");null!=r&&r.setVisible(n);var i=c.get("metoclient:next");null!=i&&i.setVisible(n)}))})),a&&c.set("times",t.time.data),c.set("displayInLayerSwitcher",!s),c.set("metoclient:opacity",null!=t.opacity?t.opacity:1);var h=c.get("id");if(c.set("metoclient:id",h),s)c.set("id","metoclient:"+h+r),c.set("title",""),this.hideLayer_(c);else{var d=c.get("previous"),f=null!=d&&d.length>0?this.config_.layers.find((function(t){return t.id===d})):null,p=null!=f&&null!=f.time?f.time.data:[];p.includes(this.config_.time)&&this.hideLayer_(c)}}return c}},{key:"createLayerSwitcherTitle_",value:function createLayerSwitcherTitle_(t){var e=t.metadata.title,n=this.config_.layers,r=t.next,i=null!=r&&r.length>0?n.find((function(t){return t.id===r})):null,o=null!=i?this.createLayerSwitcherTitle_(i):"";return null!=o&&o.length>0&&e!==o&&(e+=" / "+o),t.metadata.title="",e}},{key:"setRelativesVisible_",value:function setRelativesVisible_(t,e,n){var r=t.get(e),i=this.get("map").getLayers().getArray(),o=null!=r&&r.length>0?i.find((function(t){return t.get("id")===r})):null;if(null!=o){o.setVisible(n),this.setRelativesVisible_(o,e,n);var a=o.get("metoclient:previous");null!=a&&a.setVisible(n);var s=o.get("metoclient:next");null!=s&&s.setVisible(n)}}},{key:"createLayers_",value:function createLayers_(){var t=this,e=this.config_.layers.reduce((function(t,e){return t+(null!=e.metadata&&null!=e.metadata.type&&"base"===e.metadata.type.toLowerCase())}),0),n=new Os(this.config_.layers.reduce((function(n,r){if(null==r.time||null!=r.previous&&0!==r.previous.length||null==r.metadata||null==r.metadata.title||(r.metadata.title=t.createLayerSwitcherTitle_(r)),null!=r.url&&(r.url=Object.keys(r.url).reduce((function(t,e){return t[e.toLowerCase()]=r.url[e],t}),{})),null==r.source||null!=r.url&&"string"!=typeof r.url.service||0===r.url.service.length)return n;1===e&&null!=r.metadata&&null!=r.metadata.type&&"base"===r.metadata.type.toLowerCase()&&(r.metadata.title="");var i=t.createLayer_(r);return null!=i&&n.push(i),n}),[]));return n.getArray().forEach((function(e,r,i){var o=e.get("metoclient:opacity");if(null==e.get("times"))n.item(r).setOpacity(o);else if(e.getSource().get("metoclient:time")===t.config_.time){var a=e.get("previous");if(null!=a&&a.length>0)i.find((function(t){return t.get("id")===a})).get("times").includes(t.config_.time)||n.item(r).setOpacity(o)}})),n}},{key:"setVisible_",value:function setVisible_(t,e){e?this.showLayer_(t):this.hideLayer_(t)}},{key:"showLayer_",value:function showLayer_(t){var e=t.get("metoclient:opacity");null==e&&(e=1),t.setOpacity(e)}},{key:"hideLayer_",value:function hideLayer_(t){t.setOpacity(0)}},{key:"createView_",value:function createView_(){var t=_objectSpread2({},this.config_);return delete t.sources,delete t.layers,new iu(t)}},{key:"currentTimeRendered_",value:function currentTimeRendered_(t){var e=this,n=this.get("map");if(null!=n){var r=n.getLayers().getArray();if(r.forEach((function(t){var n=t.get("times"),i=null==n||!Array.isArray(n)||0===n.length;if(!i&&t.getSource().get("metoclient:time")===e.config_.time){i=!0;var o=t.get("previous"),a=null!=o&&o.length>0?r.find((function(t){return t.get("id")===o})):null;if(null!=a){var s=a.get("times");s[s.length-1]>=e.config_.time&&(i=!1)}}e.setVisible_(t,i)})),this.status_[this.config_.time]="success",this.timeSlider_.updateTimeLoaderVis(this.times_.map((function(t){return{endTime:t,status:e.status_[t]}}))),this.updateNeeded_)this.updateNeeded_=!1,this.renderComplete_=!0,this.timeUpdated_();else{var i=this.getPrevTime(),o=this.getNextTime();r.filter((function(t){var e=t.get("times");return!(null==e||!Array.isArray(e)||0===e.length)&&!t.get("id").startsWith("metoclient:")})).forEach((function(t){var r,a,s=t.get("id"),u=e.config_.layers.find((function(t){return t.id===s})),l=!1,c=!1,h=t.get("times"),d=t.get("previous"),f=t.get("next");n.get("playing")||i<h[0]&&null!=d&&d.length>0?l=!0:(r=h.includes(i)?i:h.reduce((function(t,e){return e<i&&i-e<t?e:t}),Number.POSITIVE_INFINITY))>i&&(r=Math.max.apply(Math,_toConsumableArray(h))),o>h[h.length-1]&&null!=f&&f.length>0?c=!0:(a=h.includes(o)?o:h.reduce((function(t,e){return e>o&&o-e>t?e:t}),Number.NEGATIVE_INFINITY))<o&&(a=Math.min.apply(Math,_toConsumableArray(h)));var p=n.getLayers(),m=t.get("metoclient:previous");if(null==m&&null!=u&&null!=r){(m=e.createLayer_(u,r,"-previous")).setVisible(t.getVisible());var y=p.getArray().findIndex((function(e){return e.get("metoclient:id")===t.get("metoclient:id")}));p.insertAt(y,m),t.set("metoclient:previous",m)}if(!l&&null!=m){var g=m.getSource();g.get("metoclient:time")!==r&&(e.hideLayer_(m),ba[g.constructor.name](g,r))}var v=t.get("metoclient:next");if(null==v&&null!=u&&null!=a){(v=e.createLayer_(u,a,"-next")).setVisible(t.getVisible());var _=p.getArray().findIndex((function(e){return e.get("metoclient:id")===t.get("metoclient:id")}));p.insertAt(_,v),t.set("metoclient:next",v)}if(!c&&null!=v){var b=v.getSource();b.get("metoclient:time")!==a&&(e.hideLayer_(v),ba[b.constructor.name](b,a))}})),n.renderSync(),n.once("rendercomplete",(function(t){e.renderComplete_=!0,e.updateNeeded_?(e.updateNeeded_=!1,e.timeUpdated_()):e.waitingRender_>0&&timeout$1(e.animate_.bind(e),Math.max(e.delay_-(Date.now()-e.waitingRender_),0))}))}}}},{key:"getLayerSwitcher_",value:function getLayerSwitcher_(){var t=this.get("map");if(null==t)return null;var e=t.getControls();return null==e?null:e.getArray().find((function(t){return null!=t.constructor&&"LayerSwitcher"===t.constructor.name}))}},{key:"timeUpdated_",value:function timeUpdated_(){var t=this;if(!this.renderComplete_){var e=this.get("map").get("time");return"success"!==this.status_[e]&&(this.status_[e]="working",this.timeSlider_.updateTimeLoaderVis(this.times_.map((function(e){return{endTime:e,status:t.status_[e]}})))),void(this.updateNeeded_=!0)}this.get("map").once("rendercomplete",this.currentTimeRendered_.bind(this)),this.status_[this.config_.time]="success",this.config_.time=this.get("map").get("time"),this.status_[this.config_.time]="working",Object.keys(this.status_).forEach((function(e){Number(e)!==t.config_.time&&"working"===t.status_[e]&&(t.status_[e]="")})),this.timeSlider_.updateTimeLoaderVis(this.times_.map((function(e){return{endTime:e,status:t.status_[e]}})));var n=this.get("map").getLayers().getArray();n.filter((function(e){var r=e.get("times");if(null==r||!Array.isArray(r)||0===r.length)return!1;if(t.config_.time<r[0]||t.config_.time>r[r.length-1])return t.hideLayer_(e),!1;var i=e.get("previous"),o=null!=i&&i.length>0?n.find((function(t){return t.get("id")===i})):null;return(null!=o?o.get("times"):[]).includes(t.config_.time)?(t.hideLayer_(e),!1):!e.get("id").startsWith("metoclient:")})).forEach((function(e){var n=e.getSource();if(n.get("metoclient:time")===t.config_.time){var r=e.get("metoclient:previous");null!=r?t.hideLayer_(r):(t.status_[t.config_.time]="success",t.timeSlider_.updateTimeLoaderVis(t.times_.map((function(e){return{endTime:e,status:t.status_[e]}}))));var i=e.get("metoclient:next");null!=i&&t.hideLayer_(i),t.showLayer_(e)}else{var o=e.get("metoclient:previous"),a=e.get("metoclient:next");if(null!=o){var s=o.getSource();if(null!=s&&s.get("metoclient:time")===t.config_.time){t.hideLayer_(e),t.showLayer_(o);var u=e.get("metoclient:id");return e.set("id","metoclient:"+u+"-next"),o.set("id",u),null!=a&&a.set("id","metoclient:"+u+"-previous"),o.set("metoclient:previous",a),o.set("metoclient:next",e),o.set("title",e.get("title")),e.set("metoclient:next",o),void e.set("title","")}}if(null!=a){var l=a.getSource();if(null!=l){if(l.get("metoclient:time")===t.config_.time){t.hideLayer_(e),t.showLayer_(a);var c=e.get("metoclient:id");return e.set("id","metoclient:"+c+"-previous"),a.set("id",c),null!=o&&o.set("id","metoclient:"+c+"-next"),a.set("metoclient:previous",e),a.set("metoclient:next",o),a.set("title",e.get("title")),e.set("metoclient:previous",a),void e.set("title","")}var h=e.get("metoclient:id");return e.set("id","metoclient:"+h+"-previous"),a.set("id",h),null!=o&&o.set("id","metoclient:"+h+"-next"),a.set("metoclient:previous",e),a.set("metoclient:next",o),a.set("title",e.get("title")),e.set("metoclient:previous",a),e.set("title",""),void ba[l.constructor.name](l,t.config_.time)}}ba[n.constructor.name](n,t.config_.time)}})),this.renderComplete_=!1,this.get("map").renderSync()}},{key:"updateTimeListener_",value:function updateTimeListener_(){this.timeListener=this.get("map").on("change:time",this.timeUpdated_.bind(this))}},{key:"createMap_",value:function createMap_(){var t=this;this.timeSlider_=new bi({locale:"fi-FI",showTimeSlider:!0,timeZone:this.config_.timeZone,timeZoneLabel:this.config_.timeZoneLabel});var e=new dl({target:this.config_.container,layers:this.createLayers_(),view:this.createView_(),controls:[new mu({zoomInTipLabel:this.config_.texts["Zoom In"],zoomOutTipLabel:this.config_.texts["Zoom Out"]}),new fl,this.timeSlider_],interactions:[new zu,new Ou,new Uu,new ul,new cl,new tl,new nl,new $u]});this.set("map",e),this.renderComplete_=!0,this.timeSlider_.createTimeSlider(this.times_),this.playingListener_=this.get("map").on("change:playing",(function(e){t.get("map").get("playing")&&t.animate_()})),this.updateTimeListener_(),this.nextListener_=this.get("map").on("next",(function(e){t.next()})),this.previousListener_=this.get("map").on("previous",(function(e){t.previous()})),e.set("time",this.config_.time),this.refreshTimer=function interval$1(t,e,n){var r=new Timer,i=e;return null==e?(r.restart(t,e,n),r):(e=+e,n=null==n?now$1():+n,r.restart((function tick(o){o+=i,r.restart(tick,i+=e,n),t(o)}),e,n),r)}(this.refresh.bind(this),this.refreshInterval_)}},{key:"updateMap_",value:function updateMap_(){var t=this.get("map");null==t?this.createMap_():(t.setTarget(this.config_.container),t.getLayerGroup().setLayers(this.createLayers_()),t.setView(this.createView_()),t.set("time",this.config_.time),this.updateTimeListener_(),this.timeUpdated_())}},{key:"updateTimes_",value:function updateTimes_(){var t=this;this.times_=[],this.status_={},this.config_.layers.forEach((function(e){if(null!=e.time&&null!=e.time.range){var n=parseTimes(e.time.range,e.time.offset),r=null!=e.time.source?t.config_.sources[e.time.source]:t.config_.sources[e.source],i=t.capabilities_[r.tiles[0]];if(null==i||null==i.data||null==i.data.Capability||null==i.data.Capability.Layer||null==i.data.Capability.Layer.Layer)return;var o,a,s=i.data.Capability.Layer.Layer.find((function(t){return[e.url.layer,e.url.layers].includes(t.Name)})),u=parseTimes(null!=s?s.Dimension.find((function(t){return"time"===t.name.toLowerCase()})).values:[]),l=Date.now(),c=0,h=0;n.forEach((function(t,e){isNaN(t)||isFinite(t)||(t<0?(null==o&&(o=u.filter((function(t){return t<l})).sort().reverse()),n[e]=o[c],c++):(null==a&&(a=u.filter((function(t){return t>=l})).sort()),n[e]=a[h],h++))})),n.sort(),e.time.data=n.filter((function(t){return u.includes(t)})),t.times_=_toConsumableArray(new Set([].concat(_toConsumableArray(t.times_),_toConsumableArray(e.time.data)))).sort()}})),this.times_.forEach((function(e){t.status_[e]=""}))}},{key:"play",value:function play(t){this.delay_=Math.sign(t.delay)>0?t.delay:ai,this.periodDelay_=Math.sign(t.periodDelay)>0?t.periodDelay:2*ai,this.get("map").set("playing",!0)}},{key:"animate_",value:function animate_(){this.get("map").get("playing")&&(this.renderComplete_?(this.waitingRender_=0,this.next(),timeout$1(this.animate_.bind(this),this.delay_)):this.waitingRender_=Date.now())}},{key:"getNextTime",value:function getNextTime(){for(var t=this.config_.time,e=this.times_.length,n=0,r=0;r<e;r++)if(this.times_[r]>t){n=r;break}return this.times_[n]}},{key:"next",value:function next(){this.isReady_()&&this.get("map").set("time",this.getNextTime())}},{key:"getPrevTime",value:function getPrevTime(){for(var t=this.config_.time,e=this.times_.length,n=e-1,r=0;r<e&&this.times_[r]<t;r++)n=r;return this.times_[n]}},{key:"previous",value:function previous(){this.isReady_()&&this.get("map").set("time",this.getPrevTime())}},{key:"isReady_",value:function isReady_(){return null!=this.get("map")&&this.times_.length>0}},{key:"stop",value:function stop(){this.get("map").set("playing",!1)}},{key:"destroy",value:function destroy(){unByKey(this.playingListener_),unByKey(this.nextListener_),unByKey(this.previousListener_),unByKey(this.timeListener),this.timeSlider_.destroy()}}],[{key:"transform",value:function transform$1(t,e,n){return G.defs("EPSG:3067","+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),register(G),transform(t,e,n)}}]),MetOClient}(nn);return t.MetOClient=pl,t.default=pl,t}({});
