<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Animator example</title>
    <script src='../../dist/metoclient.min.js'></script>
    <link href='../../dist/css/map.css' rel='stylesheet' type='text/css'>
    <link href='./styles/metweb.css' rel='stylesheet' type='text/css'>
    <link href='../../dist/css/example.css' rel='stylesheet' type='text/css'>
</head>
<body>
<div class='fmi-metweb-windows'>
    <!-- The map will be inserted here -->
</div>
<script>
  // Initialize options objects for animation.
  var resolutionTime = 60 * 60 * 1000
  var currentDate = new Date()
  var currentTime = fi.fmi.metoclient.MetOClient.floorTime(currentDate.getTime(), resolutionTime)
  var beginTime = currentTime - 10 * resolutionTime
  var endTime = currentTime
  var resolutions = [2048, 1024, 512, 256, 128, 64]
  var wmsBaseUrl = 'http://openwms.fmi.fi/geoserver/wms'
  var origins1024 = [[-118331.36640836, 8432773.1670142], [-118331.36640836, 8432773.1670142], [-118331.36640836, 7907751.53726352], [-118331.36640836, 7907751.53726352], [-118331.36640836, 7907751.53726352], [-118331.36640836, 7907751.53726352]]
  var extent = [-1000000, 5000000, 5000000, 20000000]
  // Create animation layers.
  // Animation specific configurations are located inside animation property.
  // Many of these values are given here to show them as an example.
  // Usually, default values may be enough.
  var config = {
    project: 'mymap',
    // Map view configurations
    // Layer configuration
    layers: {
      // ---------------------------------------------------------------
      'OpenStreetMap': {
        className: 'OSM',
        title: 'OpenStreetMap',
        visible: true,
        useSavedVisible: true,
        editOpacity: true,
        useSavedOpacity: true,
      },
      // ---------------------------------------------------------------
      'Stamen': {
        className: 'Stamen',
        title: 'Water Color',
        visible: false,
        useSavedVisible: true,
        editOpacity: true,
        useSavedOpacity: true,
        source: {
          layer: 'watercolor'
        }
      },
      // ---------------------------------------------------------------
      'Rain radar': {
        className: 'TileWMS',
        title: 'Rain radar',
        visible: true,
        useSavedVisible: true,
        editOpacity: true,
        useSavedOpacity: true,
        type: 'obs',
        source: {
          url: wmsBaseUrl,
          params: {
            'LAYERS': 'Radar:suomi_rr_eureffin',
            'TRANSPARENT': 'TRUE',
            'FORMAT': 'image/png'
          },
          projection: 'EPSG:3857',
          tileGridOptions: {
            origins: origins1024,
            extent: extent,
            resolutions: resolutions,
            tileSize: 1024
          }
        }
      },
      // ---------------------------------------------------------------
      'Dbz radar': {
        className: 'TileWMS',
        title: 'Dbz radar',
        visible: true,
        useSavedVisible: true,
        editOpacity: true,
        useSavedOpacity: true,
        type: 'obs',
        source: {
          url: wmsBaseUrl,
          params: {
            'LAYERS': 'Radar:suomi_dbz_eureffin',
            'TRANSPARENT': 'TRUE',
            'FORMAT': 'image/png'
          },
          projection: 'EPSG:3857',
          tileGridOptions: {
            origins: origins1024,
            extent: extent,
            resolutions: resolutions,
            tileSize: 1024
          }
        }
      }
    },
    container: 'fmi-metweb-windows',
    projection: 'EPSG:3857',
    extent: [-1000000, 5000000, 10000000, 20000000],
    resolutions: resolutions,
    defaultCenterLocation: [2750000, 8500000],
    defaultCenterProjection: 'EPSG:3857',
    defaultZoomLevel: 1,
    showLegend: true,
    showLayerSwitcher: true,
    showLoadProgress: true,
    markerImagePath: '../../img/marker.png',
    maxAsyncLoadCount: 5,
    // Disable panning and zooming
    staticControls: false,
    // Time configuration
    autoStart: false,
    waitUntilLoaded: false,
    autoReplay: true,
    refreshInterval: 15 * 60 * 1000,
    frameRate: 500,
    resolutionTime: resolutionTime,
    defaultAnimationTime: Date.now(),
    beginTime: beginTime,
    firstDataPointTime: beginTime,
    lastDataPointTime: endTime,
    modifiedResolutionTime: resolutionTime,
    endTime: endTime,
    endTimeDelay: 1000,
    showTimeSlider: true,
    showTimeSliderMenu: true,
    timeZone: 'Europe/Helsinki',

    // Localization
    localization: {
      locale: 'en',
      fi: {
        overlays: 'Sääaineistot',
        baseLayers: 'Taustakartat',
        features: 'Kohteet',
        legend: 'Selite',
        noLegend: 'Ei selitettä',
        zoomInTooltip: 'Lähennä',
        zoomOutTooltip: 'Loitonna',
        layersTooltip: 'Karttatasot',
        browserNotSupported: 'Tämä selain ei ole tuettu.'
      },
      en: {
        overlays: 'Overlays',
        baseLayers: 'Base layers',
        features: 'Features',
        legend: 'Legend',
        noLegend: 'None',
        zoomInTooltip: 'Zoom in',
        zoomOutTooltip: 'Zoom out',
        layersTooltip: 'Layers',
        browserNotSupported: 'This browser is not supported.'
      }
    }
  }
  var weatherVisualization = new fi.fmi.metoclient.MetOClient(config)
  weatherVisualization.createAnimation()
</script>
</body>
</html>
