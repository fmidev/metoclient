!function(){"use strict";var t="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1,r=arguments.length;i<r;++i){var o=arguments[i];if(null!=o)for(var a in o)o.hasOwnProperty(a)&&(n[a]=o[a])}return n};function clear(t){for(var e in t)delete t[e]}var e="function"==typeof Object.values?Object.values:function(t){var e=[];for(var n in t)e.push(t[n]);return e};function clamp(t,e,n){return Math.min(Math.max(t,e),n)}var n="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function squaredSegmentDistance(t,e,n,i,r,o){var a=r-n,s=o-i;if(0!==a||0!==s){var l=((t-n)*a+(e-i)*s)/(a*a+s*s);l>1?(n=r,i=o):l>0&&(n+=a*l,i+=s*l)}return squaredDistance(t,e,n,i)}function squaredDistance(t,e,n,i){var r=n-t,o=i-e;return r*r+o*o}function toRadians(t){return t*Math.PI/180}function modulo(t,e){var n=t%e;return n*e<0?n+e:n}function lerp(t,e,n){return t+n*(e-t)}var i="Point",r="LinearRing",o="Polygon",a="Circle",s=6371008.8;
/**
     * @license
     * Latitude/longitude spherical geodesy formulae taken from
     * http://www.movable-type.co.uk/scripts/latlong.html
     * Licensed under CC-BY-3.0.
     */function getDistance(t,e,n){var i=n||s,r=toRadians(t[1]),o=toRadians(e[1]),a=(o-r)/2,l=toRadians(e[0]-t[0])/2,u=Math.sin(a)*Math.sin(a)+Math.sin(l)*Math.sin(l)*Math.cos(r)*Math.cos(o);return 2*i*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}function abstract(){return function(){throw new Error("Unimplemented abstract method.")}()}var l=0;function getUid(t){return t.ol_uid||(t.ol_uid=String(++l))}var c,h="6.1.1",d=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function __(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}),p=function(t){function AssertionError(e){var n=this,i="Assertion failed. See https://openlayers.org/en/"+("v"+h.split("-")[0])+"/doc/errors/#"+e+" for details.";return(n=t.call(this,i)||this).code=e,n.name="AssertionError",n.message=i,n}return d(AssertionError,t),AssertionError}(Error);function assert(t,e){if(!t)throw new p(e)}var f={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},m={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function boundingExtent(t){for(var e=createEmpty(),n=0,i=t.length;n<i;++n)extendCoordinate(e,t[n]);return e}function buffer(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function closestSquaredDistanceXY(t,e,n){var i,r;return(i=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*i+(r=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*r}function containsCoordinate(t,e){return containsXY(t,e[0],e[1])}function containsExtent(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function containsXY(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function coordinateRelationship(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=e[0],s=e[1],l=m.UNKNOWN;return a<n?l|=m.LEFT:a>r&&(l|=m.RIGHT),s<i?l|=m.BELOW:s>o&&(l|=m.ABOVE),l===m.UNKNOWN&&(l=m.INTERSECTING),l}function createEmpty(){return[1/0,1/0,-1/0,-1/0]}function createOrUpdate(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function createOrUpdateEmpty(t){return createOrUpdate(1/0,1/0,-1/0,-1/0,t)}function createOrUpdateFromCoordinates(t,e){return function extendCoordinates(t,e){for(var n=0,i=e.length;n<i;++n)extendCoordinate(t,e[n]);return t}(createOrUpdateEmpty(e),t)}function equals(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function extendCoordinate(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function extendFlatCoordinates(t,e,n,i,r){for(;n<i;n+=r)extendXY(t,e[n],e[n+1]);return t}function extendXY(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function getArea(t){var e=0;return isEmpty(t)||(e=getWidth(t)*getHeight(t)),e}function getBottomLeft(t){return[t[0],t[1]]}function getBottomRight(t){return[t[2],t[1]]}function getCenter(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function getCorner(t,e){var n;return e===f.BOTTOM_LEFT?n=getBottomLeft(t):e===f.BOTTOM_RIGHT?n=getBottomRight(t):e===f.TOP_LEFT?n=getTopLeft(t):e===f.TOP_RIGHT?n=getTopRight(t):assert(!1,13),n}function getForViewAndSize(t,e,n,i,r){var o=e*i[0]/2,a=e*i[1]/2,s=Math.cos(n),l=Math.sin(n),u=o*s,c=o*l,h=a*s,d=a*l,p=t[0],f=t[1],m=p-u+d,y=p-u-d,g=p+u-d,v=p+u+d,_=f-c-h,b=f-c+h,T=f+c+h,w=f+c-h;return createOrUpdate(Math.min(m,y,g,v),Math.min(_,b,T,w),Math.max(m,y,g,v),Math.max(_,b,T,w),r)}function getHeight(t){return t[3]-t[1]}function getIntersection(t,e,n){var i=n||[1/0,1/0,-1/0,-1/0];return intersects(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):createOrUpdateEmpty(i),i}function getTopLeft(t){return[t[0],t[3]]}function getTopRight(t){return[t[2],t[3]]}function getWidth(t){return t[2]-t[0]}function intersects(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function isEmpty(t){return t[2]<t[0]||t[3]<t[1]}function applyTransform(t,e,n){var i=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(i,i,2),function _boundingExtentXYs(t,e,n){return createOrUpdate(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}([i[0],i[2],i[4],i[6]],[i[1],i[3],i[5],i[7]],n)}var y={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},g={};g[y.DEGREES]=2*Math.PI*6370997/360,g[y.FEET]=.3048,g[y.METERS]=1,g[y.USFEET]=1200/3937;var v=function(){function Projection(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return Projection.prototype.canWrapX=function(){return this.canWrapX_},Projection.prototype.getCode=function(){return this.code_},Projection.prototype.getExtent=function(){return this.extent_},Projection.prototype.getUnits=function(){return this.units_},Projection.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||g[this.units_]},Projection.prototype.getWorldExtent=function(){return this.worldExtent_},Projection.prototype.getAxisOrientation=function(){return this.axisOrientation_},Projection.prototype.isGlobal=function(){return this.global_},Projection.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},Projection.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},Projection.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},Projection.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},Projection.prototype.setWorldExtent=function(t){this.worldExtent_=t},Projection.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},Projection.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},Projection}(),_=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),b=6378137,T=Math.PI*b,w=[-T,-T,T,T],E=[-180,-85,180,85],S=function(t){function EPSG3857Projection(e){return t.call(this,{code:e,units:y.METERS,extent:w,global:!0,worldExtent:E,getPointResolution:function(t,e){return t/n(e[1]/b)}})||this}return _(EPSG3857Projection,t),EPSG3857Projection}(v),M=[new S("EPSG:3857"),new S("EPSG:102100"),new S("EPSG:102113"),new S("EPSG:900913"),new S("urn:ogc:def:crs:EPSG:6.18:3:3857"),new S("urn:ogc:def:crs:EPSG::3857"),new S("http://www.opengis.net/gml/srs/epsg.xml#3857")];function fromEPSG4326(t,e,n){var i=t.length,r=n>1?n:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(i));for(var a=T,s=0;s<i;s+=r){o[s]=a*t[s]/180;var l=b*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));l>a?l=a:l<-a&&(l=-a),o[s+1]=l}return o}function toEPSG4326(t,e,n){var i=t.length,r=n>1?n:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(i));for(var a=0;a<i;a+=r)o[a]=180*t[a]/T,o[a+1]=360*Math.atan(Math.exp(t[a+1]/b))/Math.PI-90;return o}var O=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),P=[-180,-90,180,90],C=6378137*Math.PI/180,I=function(t){function EPSG4326Projection(e,n){return t.call(this,{code:e,units:y.DEGREES,extent:P,axisOrientation:n,global:!0,metersPerUnit:C,worldExtent:P})||this}return O(EPSG4326Projection,t),EPSG4326Projection}(v),L=[new I("CRS:84"),new I("EPSG:4326","neu"),new I("urn:ogc:def:crs:EPSG::4326","neu"),new I("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new I("urn:ogc:def:crs:OGC:1.3:CRS84"),new I("urn:ogc:def:crs:OGC:2:84"),new I("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new I("urn:x-ogc:def:crs:EPSG:4326","neu")],R={};function add(t,e,n){var i=t.getCode(),r=e.getCode();i in R||(R[i]={}),R[i][r]=n}function get$1(t,e){var n;return t in R&&e in R[t]&&(n=R[t][e]),n}var k={};function cloneTransform(t,e,n){var i;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];i=e}else i=t.slice();return i}function identityTransform(t,e,n){if(void 0!==e&&t!==e){for(var i=0,r=t.length;i<r;++i)e[i]=t[i];t=e}return t}function addProjection(t){!function add$1(t,e){k[t]=e}(t.getCode(),t),add(t,t,cloneTransform)}function get$3(t){return"string"==typeof t?function get$2(t){return k[t]||null}(t):t||null}function getPointResolution(t,e,n,i){var r,o=(t=get$3(t)).getPointResolutionFunc();if(o)r=o(e,n),i&&i!==t.getUnits()&&(a=t.getMetersPerUnit())&&(r=r*a/g[i]);else if(t.getUnits()==y.DEGREES&&!i||i==y.DEGREES)r=e;else{var a,s=getTransformFromProjections(t,get$3("EPSG:4326")),l=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];r=(getDistance((l=s(l,l,2)).slice(0,2),l.slice(2,4))+getDistance(l.slice(4,6),l.slice(6,8)))/2,void 0!==(a=i?g[i]:t.getMetersPerUnit())&&(r/=a)}return r}function addEquivalentProjections(t){!function addProjections(t){t.forEach(addProjection)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&add(e,t,cloneTransform)}))}))}function createProjection(t,e){return t?"string"==typeof t?get$3(t):t:get$3(e)}function createTransformFromCoordinateTransform(t){return function(e,n,i){for(var r=e.length,o=void 0!==i?i:2,a=void 0!==n?n:new Array(r),s=0;s<r;s+=o){var l=t([e[s],e[s+1]]);a[s]=l[0],a[s+1]=l[1];for(var u=o-1;u>=2;--u)a[s+u]=e[s+u]}return a}}function equivalent(t,e){if(t===e)return!0;var n=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?n:getTransformFromProjections(t,e)===cloneTransform&&n}function getTransformFromProjections(t,e){var n=get$1(t.getCode(),e.getCode());return n||(n=identityTransform),n}function getTransform(t,e){return getTransformFromProjections(get$3(t),get$3(e))}function transform(t,e,n){return getTransform(e,n)(t,void 0,t.length)}function transformExtent(t,e,n){return applyTransform(t,getTransform(e,n))}var A=null;function getUserProjection(){return A}function toUserCoordinate(t,e){return A?transform(t,e,A):t}function fromUserCoordinate(t,e){return A?transform(t,A,e):t}function fromUserExtent(t,e){return A?transformExtent(t,A,e):t}function register(t){var e,n,i,r,o,a,s,l,u=Object.keys(t.defs),c=u.length;for(e=0;e<c;++e){var h=u[e];if(!get$3(h)){var d=t.defs(h);addProjection(new v({code:h,axisOrientation:d.axis,metersPerUnit:d.to_meter,units:d.units}))}}for(e=0;e<c;++e){var p=u[e],f=get$3(p);for(n=0;n<c;++n){var m=u[n],y=get$3(m);if(!get$1(p,m))if(t.defs[p]===t.defs[m])addEquivalentProjections([f,y]);else{var g=t(p,m);i=f,r=y,o=g.forward,a=g.inverse,s=void 0,l=void 0,s=get$3(i),l=get$3(r),add(s,l,createTransformFromCoordinateTransform(o)),add(l,s,createTransformFromCoordinateTransform(a))}}}}!function addCommon(){addEquivalentProjections(M),addEquivalentProjections(L),function addEquivalentTransforms(t,e,n,i){t.forEach((function(t){e.forEach((function(e){add(t,e,n),add(e,t,i)}))}))}(L,M,fromEPSG4326,toEPSG4326)}();var D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}var j=createCommonjsModule((function(t,e){t.exports=function(){function t(t,e){if(t[e])return t[e];for(var n,i=Object.keys(t),r=e.toLowerCase().replace(mt,""),o=-1;++o<i.length;)if((n=i[o]).toLowerCase().replace(mt,"")===r)return t[n]}function s(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=gt}function i(t){return new s(t).output()}function a(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var i=e?{}:t,r=n.reduce((function(t,e){return h(e,t),t}),i);e&&(t[e]=r)}function h(t,e){if(Array.isArray(t)){var n=t.shift();if("PARAMETER"===n&&(n=t.shift()),1===t.length)return Array.isArray(t[0])?(e[n]={},void h(t[0],e[n])):void(e[n]=t[0]);if(t.length)if("TOWGS84"!==n){var i;switch(Array.isArray(n)||(e[n]={}),n){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[n]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&h(t[2],e[n]));case"SPHEROID":case"ELLIPSOID":return e[n]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&h(t[3],e[n]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void a(e,n,t);default:for(i=-1;++i<t.length;)if(!Array.isArray(t[i]))return h(t,e[n]);return a(e,n,t)}}else e[n]=t;else e[n]=!0}else e[t]=!0}function n(t){return t*Et}function r(t){function s(e){return e*(t.to_meter||1)}"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var i=t.GEOGCS;"GEOGCS"===t.type&&(i=t),i&&(i.DATUM?t.datumCode=i.DATUM.name.toLowerCase():t.datumCode=i.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),i.DATUM&&i.DATUM.SPHEROID&&(t.ellps=i.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=i.DATUM.SPHEROID.a,t.rf=parseFloat(i.DATUM.SPHEROID.rf,10)),i.DATUM&&i.DATUM.TOWGS84&&(t.datum_params=i.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",n],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",n],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",n],["lat0","latitude_of_origin",n],["lat0","standard_parallel_1",n],["lat1","standard_parallel_1",n],["lat2","standard_parallel_2",n],["azimuth","Azimuth"],["alpha","azimuth",n],["srsCode","name"]].forEach((function(n){return function e(t,n){var i=n[0],r=n[1];!(i in t)&&r in t&&(t[i]=t[r],3===n.length&&(t[i]=n[2](t[i])))}(t,n)})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=n(t.lat1>0?90:-90),t.lat_ts=t.lat1)}function o(t){var e=this;if(2===arguments.length){var n=arguments[1];"string"==typeof n?"+"===n.charAt(0)?o[t]=yt(arguments[1]):o[t]=Ct(arguments[1]):o[t]=n}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?o.apply(e,t):o(t)}));if("string"==typeof t){if(t in o)return o[t]}else"EPSG"in t?o["EPSG:"+t.EPSG]=t:"ESRI"in t?o["ESRI:"+t.ESRI]=t:"IAU2000"in t?o["IAU2000:"+t.IAU2000]=t:console.log(t);return}}function u(e){var n=t(e,"authority");if(n){var i=t(n,"epsg");return i&&xt.indexOf(i)>-1}}function f(e){var n=t(e,"extension");if(n)return t(n,"proj4")}function p(t){if(!function l(t){return"string"==typeof t}(t))return t;if(function M(t){return t in o}(t))return o[t];if(function c(t){return Mt.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=Ct(t);if(u(e))return o["EPSG:3857"];var n=f(e);return n?yt(n):e}return function m(t){return"+"===t[0]}(t)?yt(t):void 0}function d(t){return t}function y(t,e){var n=Rt.length;return t.names?(Rt[n]=t,t.names.forEach((function(t){Lt[t.toLowerCase()]=n})),this):(console.log(e),!0)}function Projection(n,i){if(!(this instanceof Projection))return new Projection(n);i=i||function(t){if(t)throw t};var r=p(n);if("object"==typeof r){var o=Projection.projections.get(r.projName);if(o){if(r.datumCode&&"none"!==r.datumCode){var a=t(Vt,r.datumCode);a&&(r.datum_params=a.towgs84?a.towgs84.split(","):null,r.ellps=a.ellipse,r.datumName=a.datumName?a.datumName:r.datumCode)}r.k0=r.k0||1,r.axis=r.axis||"enu",r.ellps=r.ellps||"wgs84";var s=function x(e,n,i,r,o){if(!e){var a=t(Dt,r);a||(a=jt),e=a.a,n=a.b,i=a.rf}return i&&!n&&(n=(1-1/i)*e),(0===i||Math.abs(e-n)<st)&&(o=!0,n=e),{a:e,b:n,rf:i,sphere:o}}(r.a,r.b,r.rf,r.ellps,r.sphere),l=function _(t,e,n,i){var r=t*t,o=e*e,a=(r-o)/r,s=0;return i?(r=(t*=1-a*(rt+a*(ot+a*at)))*t,a=0):s=Math.sqrt(a),{es:a,e:s,ep2:(r-o)/o}}(s.a,s.b,s.rf,r.R_A),u=r.datum||function v(t,n,i,r,o,a){var s={};return s.datum_type=void 0===t||"none"===t?et:tt,n&&(s.datum_params=n.map(parseFloat),0===s.datum_params[0]&&0===s.datum_params[1]&&0===s.datum_params[2]||(s.datum_type=e),s.datum_params.length>3&&(0===s.datum_params[3]&&0===s.datum_params[4]&&0===s.datum_params[5]&&0===s.datum_params[6]||(s.datum_type=$,s.datum_params[3]*=nt,s.datum_params[4]*=nt,s.datum_params[5]*=nt,s.datum_params[6]=s.datum_params[6]/1e6+1))),s.a=i,s.b=r,s.es=o,s.ep2=a,s}(r.datumCode,r.datum_params,s.a,s.b,l.es,l.ep2);Nt(this,r),Nt(this,o),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=l.es,this.e=l.e,this.ep2=l.ep2,this.datum=u,this.init(),i(null,this)}else i(n)}else i(n)}function E(t){return t===e||t===$}function P(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function S(t,n,i){var r;return Array.isArray(i)&&(i=Ft(i)),Qt(i),t.datum&&n.datum&&function N(t,n){return(t.datum.datum_type===e||t.datum.datum_type===$)&&"WGS84"!==n.datumCode||(n.datum.datum_type===e||n.datum.datum_type===$)&&"WGS84"!==t.datumCode}(t,n)&&(i=S(t,r=new Projection("WGS84"),i),t=r),"enu"!==t.axis&&(i=Ut(t,!1,i)),"longlat"===t.projName?i={x:i.x*lt,y:i.y*lt}:(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter}),i=t.inverse(i)),t.from_greenwich&&(i.x+=t.from_greenwich),i=Bt(t.datum,n.datum,i),n.from_greenwich&&(i={x:i.x-n.from_greenwich,y:i.y}),"longlat"===n.projName?i={x:i.x*ut,y:i.y*ut}:(i=n.forward(i),n.to_meter&&(i={x:i.x/n.to_meter,y:i.y/n.to_meter})),"enu"!==n.axis?Ut(n,!0,i):i}function k(t,e,n){var i,r,o;return Array.isArray(n)?(i=S(t,e,n),3===n.length?[i.x,i.y,i.z]:[i.x,i.y]):(r=S(t,e,n),2===(o=Object.keys(n)).length?r:(o.forEach((function(t){"x"!==t&&"y"!==t&&(r[t]=n[t])})),r))}function q(t){return t instanceof Projection?t:t.oProj?t.oProj:Projection(t)}function I(t,e,n){t=q(t);var i,r=!1;return void 0===e?(e=t,t=zt,r=!0):(void 0!==e.x||Array.isArray(e))&&(n=e,e=t,t=zt,r=!0),e=q(e),n?k(t,e,n):(i={forward:function(n){return k(t,e,n)},inverse:function(n){return k(e,t,n)}},r&&(i.oProj=e),i)}function O(t,e){return e=e||5,function D(t,e){var n="00000"+t.easting,i="00000"+t.northing;return t.zoneNumber+t.zoneLetter+function B(t,e,n){var i=U(n);return function F(t,e,n){var i=n-1,r=Wt.charCodeAt(i),o=Zt.charCodeAt(i),a=r+t-1,s=o+e,l=!1;return a>$t&&(a=a-$t+Kt-1,l=!0),(a===Yt||r<Yt&&a>Yt||(a>Yt||r<Yt)&&l)&&a++,(a===Ht||r<Ht&&a>Ht||(a>Ht||r<Ht)&&l)&&++a===Yt&&a++,a>$t&&(a=a-$t+Kt-1),s>Xt?(s=s-Xt+Kt-1,l=!0):l=!1,(s===Yt||o<Yt&&s>Yt||(s>Yt||o<Yt)&&l)&&s++,(s===Ht||o<Ht&&s>Ht||(s>Ht||o<Ht)&&l)&&++s===Yt&&s++,s>Xt&&(s=s-Xt+Kt-1),String.fromCharCode(a)+String.fromCharCode(s)}(Math.floor(t/1e5),Math.floor(e/1e5)%20,i)}(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+i.substr(i.length-5,e)}(function j(t){var e,n,i,r,o,a,s=t.lat,l=t.lon,u=6378137,c=G(s),h=G(l);a=Math.floor((l+180)/6)+1,180===l&&(a=60),s>=56&&s<64&&l>=3&&l<12&&(a=32),s>=72&&s<84&&(l>=0&&l<9?a=31:l>=9&&l<21?a=33:l>=21&&l<33?a=35:l>=33&&l<42&&(a=37)),o=G(6*(a-1)-180+3),e=u/Math.sqrt(1-.00669438*Math.sin(c)*Math.sin(c)),n=Math.tan(c)*Math.tan(c),i=.006739496752268451*Math.cos(c)*Math.cos(c);var d=.9996*e*((r=Math.cos(c)*(h-o))+(1-n+i)*r*r*r/6+(5-18*n+n*n+72*i-.39089081163157013)*r*r*r*r*r/120)+5e5,p=.9996*(u*(.9983242984503243*c-.002514607064228144*Math.sin(2*c)+2639046602129982e-21*Math.sin(4*c)-3.418046101696858e-9*Math.sin(6*c))+e*Math.tan(c)*(r*r/2+(5-n+9*i+4*i*i)*r*r*r*r/24+(61-58*n+n*n+600*i-2.2240339282485886)*r*r*r*r*r*r/720));return s<0&&(p+=1e7),{northing:Math.round(p),easting:Math.round(d),zoneNumber:a,zoneLetter:z(s)}}({lat:t[1],lon:t[0]}),e)}function R(t){var e=L(Q(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function G(t){return t*(Math.PI/180)}function T(t){return t/Math.PI*180}function L(t){var e=t.northing,n=t.easting,i=t.zoneLetter,r=t.zoneNumber;if(r<0||r>60)return null;var o,a,s,l,u,c,h,d,p=6378137,f=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),m=n-5e5,y=e;i<"N"&&(y-=1e7),c=6*(r-1)-180+3,d=(h=y/.9996/6367449.145945056)+(3*f/2-27*f*f*f/32)*Math.sin(2*h)+(21*f*f/16-55*f*f*f*f/32)*Math.sin(4*h)+151*f*f*f/96*Math.sin(6*h),o=p/Math.sqrt(1-.00669438*Math.sin(d)*Math.sin(d)),a=Math.tan(d)*Math.tan(d),s=.006739496752268451*Math.cos(d)*Math.cos(d),l=.99330562*p/Math.pow(1-.00669438*Math.sin(d)*Math.sin(d),1.5),u=m/(.9996*o);var g=d-o*Math.tan(d)/l*(u*u/2-(5+3*a+10*s-4*s*s-.06065547077041606)*u*u*u*u/24+(61+90*a+298*s+45*a*a-1.6983531815716497-3*s*s)*u*u*u*u*u*u/720);g=T(g);var v,_=(u-(1+2*a+s)*u*u*u/6+(5-2*s+28*a-3*s*s+.05391597401814761+24*a*a)*u*u*u*u*u/120)/Math.cos(d);if(_=c+T(_),t.accuracy){var b=L({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});v={top:b.lat,right:b.lon,bottom:g,left:_}}else v={lat:g,lon:_};return v}function z(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function U(t){var e=t%Gt;return 0===e&&(e=Gt),e}function Q(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,n=t.length,i=null,r="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;r+=e,o++}var a=parseInt(r,10);if(0===o||o+3>n)throw"MGRSPoint bad conversion from: "+t;var s=t.charAt(o++);if(s<="A"||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+t;i=t.substring(o,o+=2);for(var l=U(a),u=function W(t,e){for(var n=Wt.charCodeAt(e-1),i=1e5,r=!1;n!==t.charCodeAt(0);){if(++n===Yt&&n++,n===Ht&&n++,n>$t){if(r)throw"Bad character: "+t;n=Kt,r=!0}i+=1e5}return i}(i.charAt(0),l),c=function H(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=Zt.charCodeAt(e-1),i=0,r=!1;n!==t.charCodeAt(0);){if(++n===Yt&&n++,n===Ht&&n++,n>Xt){if(r)throw"Bad character: "+t;n=Kt,r=!0}i+=1e5}return i}(i.charAt(1),l);c<K(s);)c+=2e6;var h=n-o;if(h%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var d,p,f,m=h/2,y=0,g=0;return m>0&&(d=1e5/Math.pow(10,m),p=t.substring(o,o+m),y=parseFloat(p)*d,f=t.substring(o+m),g=parseFloat(f)*d),{easting:y+u,northing:g+c,zoneLetter:s,zoneNumber:a,accuracy:d}}function K(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Point(t,e,n){if(!(this instanceof Point))return new Point(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var i=t.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function V(t,e,n,i){var r;return t<st?(i.value=Fe.AREA_0,r=0):(r=Math.atan2(e,n),Math.abs(r)<=ct?i.value=Fe.AREA_0:r>ct&&r<=it+ct?(i.value=Fe.AREA_1,r-=it):r>it+ct||r<=-(it+ct)?(i.value=Fe.AREA_2,r=r>=0?r-dt:r+dt):(i.value=Fe.AREA_3,r+=it)),r}function Z(t,e){var n=t+e;return n<-dt?n+=ht:n>+dt&&(n-=ht),n}var e=1,$=2,tt=4,et=5,nt=484813681109536e-20,it=Math.PI/2,rt=.16666666666666666,ot=.04722222222222222,at=.022156084656084655,st=1e-10,lt=.017453292519943295,ut=57.29577951308232,ct=Math.PI/4,ht=2*Math.PI,dt=3.14159265359,pt={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},ft={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},mt=/[\s_\-\/\(\)]/g,yt=function(e){var n,i,r,o={},a=e.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var n=e.split("=");return n.push(!0),t[n[0].toLowerCase()]=n[1],t}),{}),s={proj:"projName",datum:"datumCode",rf:function(t){o.rf=parseFloat(t)},lat_0:function(t){o.lat0=t*lt},lat_1:function(t){o.lat1=t*lt},lat_2:function(t){o.lat2=t*lt},lat_ts:function(t){o.lat_ts=t*lt},lon_0:function(t){o.long0=t*lt},lon_1:function(t){o.long1=t*lt},lon_2:function(t){o.long2=t*lt},alpha:function(t){o.alpha=parseFloat(t)*lt},lonc:function(t){o.longc=t*lt},x_0:function(t){o.x0=parseFloat(t)},y_0:function(t){o.y0=parseFloat(t)},k_0:function(t){o.k0=parseFloat(t)},k:function(t){o.k0=parseFloat(t)},a:function(t){o.a=parseFloat(t)},b:function(t){o.b=parseFloat(t)},r_a:function(){o.R_A=!0},zone:function(t){o.zone=parseInt(t,10)},south:function(){o.utmSouth=!0},towgs84:function(t){o.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){o.to_meter=parseFloat(t)},units:function(e){o.units=e;var n=t(ft,e);n&&(o.to_meter=n.to_meter)},from_greenwich:function(t){o.from_greenwich=t*lt},pm:function(e){var n=t(pt,e);o.from_greenwich=(n||parseFloat(e))*lt},nadgrids:function(t){"@null"===t?o.datumCode="none":o.nadgrids=t},axis:function(t){3===t.length&&-1!=="ewnsud".indexOf(t.substr(0,1))&&-1!=="ewnsud".indexOf(t.substr(1,1))&&-1!=="ewnsud".indexOf(t.substr(2,1))&&(o.axis=t)}};for(n in a)i=a[n],n in s?"function"==typeof(r=s[n])?r(i):o[r]=i:o[n]=i;return"string"==typeof o.datumCode&&"WGS84"!==o.datumCode&&(o.datumCode=o.datumCode.toLowerCase()),o},gt=1,vt=/\s/,_t=/[A-Za-z]/,bt=/[A-Za-z84]/,Tt=/[,\]]/,wt=/[\d\.E\-\+]/;s.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;vt.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case gt:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},s.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Tt.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},s.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=gt)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=gt,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},s.prototype.number=function(t){if(!wt.test(t)){if(Tt.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},s.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},s.prototype.keyword=function(t){if(bt.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=gt)}if(!Tt.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},s.prototype.neutral=function(t){if(_t.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(wt.test(t))return this.word=t,void(this.state=3);if(!Tt.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},s.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var Et=.017453292519943295,Ct=function(t){var e=i(t),n=e.shift(),o=e.shift();e.unshift(["name",o]),e.unshift(["type",n]);var a={};return h(e,a),r(a),a};!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(o);var Mt=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],xt=["3857","900913","3785","102113"],Nt=function(t,e){var n,i;if(t=t||{},!e)return t;for(i in e)void 0!==(n=e[i])&&(t[i]=n);return t},St=function(t,e,n){var i=t*e;return n/Math.sqrt(1-i*i)},kt=function(t){return t<0?-1:1},qt=function(t){return Math.abs(t)<=dt?t:t-kt(t)*ht},It=function(t,e,n){var i=t*n,r=.5*t;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(it-e))/i},Ot=function(t,e){for(var n,i,r=.5*t,o=it-2*Math.atan(e),a=0;a<=15;a++)if(n=t*Math.sin(o),o+=i=it-2*Math.atan(e*Math.pow((1-n)/(1+n),r))-o,Math.abs(i)<=1e-10)return o;return-9999},Pt=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=St(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,n,i=t.x,r=t.y;if(r*ut>90&&r*ut<-90&&i*ut>180&&i*ut<-180)return null;if(Math.abs(Math.abs(r)-it)<=st)return null;if(this.sphere)e=this.x0+this.a*this.k0*qt(i-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(ct+.5*r));else{var o=Math.sin(r),a=It(this.e,r,o);e=this.x0+this.a*this.k0*qt(i-this.long0),n=this.y0-this.a*this.k0*Math.log(a)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,i=t.x-this.x0,r=t.y-this.y0;if(this.sphere)n=it-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var o=Math.exp(-r/(this.a*this.k0));if(-9999===(n=Ot(this.e,o)))return null}return e=qt(this.long0+i/(this.a*this.k0)),t.x=e,t.y=n,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:d,inverse:d,names:["longlat","identity"]}],Lt={},Rt=[],At={start:function(){Pt.forEach(y)},add:y,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==Lt[e]&&Rt[Lt[e]]?Rt[Lt[e]]:void 0}},Dt={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},jt=Dt.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Dt.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Vt={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};Projection.projections=At,Projection.projections.start();var Bt=function(t,n,i){return function g(t,n){return t.datum_type===n.datum_type&&!(t.a!==n.a||Math.abs(t.es-n.es)>5e-11)&&(t.datum_type===e?t.datum_params[0]===n.datum_params[0]&&t.datum_params[1]===n.datum_params[1]&&t.datum_params[2]===n.datum_params[2]:t.datum_type!==$||t.datum_params[0]===n.datum_params[0]&&t.datum_params[1]===n.datum_params[1]&&t.datum_params[2]===n.datum_params[2]&&t.datum_params[3]===n.datum_params[3]&&t.datum_params[4]===n.datum_params[4]&&t.datum_params[5]===n.datum_params[5]&&t.datum_params[6]===n.datum_params[6])}(t,n)?i:t.datum_type===et||n.datum_type===et?i:t.es!==n.es||t.a!==n.a||E(t.datum_type)||E(n.datum_type)?(i=function b(t,e,n){var i,r,o,a,s=t.x,l=t.y,u=t.z?t.z:0;if(l<-it&&l>-1.001*it)l=-it;else if(l>it&&l<1.001*it)l=it;else{if(l<-it)return{x:-1/0,y:-1/0,z:t.z};if(l>it)return{x:1/0,y:1/0,z:t.z}}return s>Math.PI&&(s-=2*Math.PI),r=Math.sin(l),a=Math.cos(l),o=r*r,{x:((i=n/Math.sqrt(1-e*o))+u)*a*Math.cos(s),y:(i+u)*a*Math.sin(s),z:(i*(1-e)+u)*r}}(i,t.es,t.a),E(t.datum_type)&&(i=function A(t,n,i){if(n===e)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(n===$){var r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],u=i[5],c=i[6];return{x:c*(t.x-u*t.y+l*t.z)+r,y:c*(u*t.x+t.y-s*t.z)+o,z:c*(-l*t.x+s*t.y+t.z)+a}}}(i,t.datum_type,t.datum_params)),E(n.datum_type)&&(i=function C(t,n,i){if(n===e)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(n===$){var r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],u=i[5],c=i[6],h=(t.x-r)/c,d=(t.y-o)/c,p=(t.z-a)/c;return{x:h+u*d-l*p,y:-u*h+d+s*p,z:l*h-s*d+p}}}(i,n.datum_type,n.datum_params)),function w(t,e,n,i){var r,o,a,s,l,u,c,h,d,p,f,m,y,g,v,_=t.x,b=t.y,T=t.z?t.z:0;if(r=Math.sqrt(_*_+b*b),o=Math.sqrt(_*_+b*b+T*T),r/n<1e-12){if(g=0,o/n<1e-12)return v=-i,{x:t.x,y:t.y,z:t.z}}else g=Math.atan2(b,_);a=T/o,h=(s=r/o)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*s*s)),d=a*l,y=0;do{y++,u=e*(c=n/Math.sqrt(1-e*d*d))/(c+(v=r*h+T*d-c*(1-e*d*d))),m=(f=a*(l=1/Math.sqrt(1-u*(2-u)*s*s)))*h-(p=s*(1-u)*l)*d,h=p,d=f}while(m*m>1e-24&&y<30);return{x:g,y:Math.atan(f/Math.abs(p)),z:v}}(i,n.es,n.a,n.b)):i},Ut=function(t,e,n){var i,r,o,a=n.x,s=n.y,l=n.z||0,u={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==n.z)switch(0===o?(i=a,r="x"):1===o?(i=s,r="y"):(i=l,r="z"),t.axis[o]){case"e":u[r]=i;break;case"w":u[r]=-i;break;case"n":u[r]=i;break;case"s":u[r]=-i;break;case"u":void 0!==n[r]&&(u.z=i);break;case"d":void 0!==n[r]&&(u.z=-i);break;default:return null}return u},Ft=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e},Qt=function(t){P(t.x),P(t.y)},zt=Projection("WGS84"),Gt=6,Wt="AJSAJS",Zt="AFAFAF",Kt=65,Yt=73,Ht=79,Xt=86,$t=90,Jt={forward:O,inverse:function(t){var e=L(Q(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:R};Point.fromMGRS=function(t){return new Point(R(t))},Point.prototype.toMGRS=function(t){return O([this.x,this.y],t)};var te=.01068115234375,is=function(t){var e=[];e[0]=1-t*(.25+t*(.046875+t*(.01953125+t*te))),e[1]=t*(.75-t*(.046875+t*(.01953125+t*te)));var n=t*t;return e[2]=n*(.46875-t*(.013020833333333334+.007120768229166667*t)),n*=t,e[3]=n*(.3645833333333333-.005696614583333333*t),e[4]=n*t*.3076171875,e},as=function(t,e,n,i){return n*=e,e*=e,i[0]*t-n*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))},hs=function(t,e,n){for(var i=1/(1-e),r=t,o=20;o;--o){var a=Math.sin(r),s=1-e*a*a;if(r-=s=(as(r,a,Math.cos(r),n)-t)*(s*Math.sqrt(s))*i,Math.abs(s)<st)return r}return r},ee={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=is(this.es),this.ml0=as(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,n,i,r=t.x,o=t.y,a=qt(r-this.long0),s=Math.sin(o),l=Math.cos(o);if(this.es){var u=l*a,c=Math.pow(u,2),h=this.ep2*Math.pow(l,2),d=Math.pow(h,2),p=Math.abs(l)>st?Math.tan(o):0,f=Math.pow(p,2),m=Math.pow(f,2);e=1-this.es*Math.pow(s,2),u/=Math.sqrt(e);var y=as(o,s,l,this.en);n=this.a*(this.k0*u*(1+c/6*(1-f+h+c/20*(5-18*f+m+14*h-58*f*h+c/42*(61+179*m-m*f-479*f)))))+this.x0,i=this.a*(this.k0*(y-this.ml0+s*a*u/2*(1+c/12*(5-f+9*h+4*d+c/30*(61+m-58*f+270*h-330*f*h+c/56*(1385+543*m-m*f-3111*f))))))+this.y0}else{var g=l*Math.sin(a);if(Math.abs(Math.abs(g)-1)<st)return 93;if(n=.5*this.a*this.k0*Math.log((1+g)/(1-g))+this.x0,i=l*Math.cos(a)/Math.sqrt(1-Math.pow(g,2)),(g=Math.abs(i))>=1){if(g-1>st)return 93;i=0}else i=Math.acos(i);o<0&&(i=-i),i=this.a*this.k0*(i-this.lat0)+this.y0}return t.x=n,t.y=i,t},inverse:function(t){var e,n,i,r,o=(t.x-this.x0)*(1/this.a),a=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+a/this.k0,n=hs(e,this.es,this.en),Math.abs(n)<it){var s=Math.sin(n),l=Math.cos(n),u=Math.abs(l)>st?Math.tan(n):0,c=this.ep2*Math.pow(l,2),h=Math.pow(c,2),d=Math.pow(u,2),p=Math.pow(d,2);e=1-this.es*Math.pow(s,2);var f=o*Math.sqrt(e)/this.k0,m=Math.pow(f,2);i=n-(e*=u)*m/(1-this.es)*.5*(1-m/12*(5+3*d-9*c*d+c-4*h-m/30*(61+90*d-252*c*d+45*p+46*c-m/56*(1385+3633*d+4095*p+1574*p*d)))),r=qt(this.long0+f*(1-m/6*(1+2*d+c-m/20*(5+28*d+24*p+8*c*d+6*c-m/42*(61+662*d+1320*p+720*p*d))))/l)}else i=it*kt(a),r=0;else{var y=Math.exp(o/this.k0),g=.5*(y-1/y),v=this.lat0+a/this.k0,_=Math.cos(v);e=Math.sqrt((1-Math.pow(_,2))/(1+Math.pow(g,2))),i=Math.asin(e),a<0&&(i=-i),r=0===g&&0===_?0:qt(Math.atan2(g,_)+this.long0)}return t.x=r,t.y=i,t},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},ns=function(t){var e=Math.exp(t);return(e-1/e)/2},rs=function(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),i=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(i,2))},ls=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,n=e-1;return 0===n?t:t*Math.log(e)/n}(e*(1+e/(rs(1,e)+1))),t<0?-e:e},Ms=function(t,e){for(var n,i=2*Math.cos(2*e),r=t.length-1,o=t[r],a=0;--r>=0;)n=i*o-a+t[r],a=o,o=n;return e+n*Math.sin(2*e)},fs=function(t,e,n){for(var i,r,o=Math.sin(e),a=Math.cos(e),s=ns(n),l=function(t){var e=Math.exp(t);return(e+1/e)/2}(n),u=2*a*l,c=-2*o*s,h=t.length-1,d=t[h],p=0,f=0,m=0;--h>=0;)i=f,r=p,d=u*(f=d)-i-c*(p=m)+t[h],m=c*f-r+u*p;return[(u=o*l)*d-(c=a*s)*m,u*m+c*d]},ne={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),n*=e,this.cgb[1]=n*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n*=e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),n*=e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(e*(-24832/14175)-2.4)),n*=e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n*=e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(.25+n*(1/64+n/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),n*=e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n*=e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n*=e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n*=e,this.utg[5]=-.03233083094085698*n,this.gtu[5]=.6650675310896665*n;var i=Ms(this.cbg,this.lat0);this.Zb=-this.Qn*(i+function(t,e){for(var n,i=2*Math.cos(e),r=t.length-1,o=t[r],a=0;--r>=0;)n=i*o-a+t[r],a=o,o=n;return Math.sin(e)*n}(this.gtu,2*i))},forward:function(t){var e=qt(t.x-this.long0),n=t.y;n=Ms(this.cbg,n);var i=Math.sin(n),r=Math.cos(n),o=Math.sin(e),a=Math.cos(e);n=Math.atan2(i,a*r),e=Math.atan2(o*r,rs(i,r*a)),e=ls(Math.tan(e));var s,l,u=fs(this.gtu,2*n,2*e);return n+=u[0],e+=u[1],Math.abs(e)<=2.623395162778?(s=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*n+this.Zb)+this.y0):(s=1/0,l=1/0),t.x=s,t.y=l,t},inverse:function(t){var e,n,i=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(r=(r-this.Zb)/this.Qn,i/=this.Qn,Math.abs(i)<=2.623395162778){var o=fs(this.utg,2*r,2*i);r+=o[0],i+=o[1],i=Math.atan(ns(i));var a=Math.sin(r),s=Math.cos(r),l=Math.sin(i),u=Math.cos(i);r=Math.atan2(a*u,rs(l,u*s)),i=Math.atan2(l,u*s),e=qt(i+this.long0),n=Ms(this.cgb,r)}else e=1/0,n=1/0;return t.x=e,t.y=n,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},ie={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(qt(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*lt,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,ne.init.apply(this),this.forward=ne.forward,this.inverse=ne.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},ys=function(t,e){return Math.pow((1-t)/(1+t),e)},re={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ct)/(Math.pow(Math.tan(.5*this.lat0+ct),this.C)*ys(this.e*t,this.ratexp))},forward:function(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+ct),this.C)*ys(this.e*Math.sin(n),this.ratexp))-it,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,n=t.y,i=Math.pow(Math.tan(.5*n+ct)/this.K,1/this.C),r=20;r>0&&(n=2*Math.atan(i*ys(this.e*Math.sin(t.y),-.5*this.e))-it,!(Math.abs(n-t.y)<1e-14));--r)t.y=n;return r?(t.x=e,t.y=n,t):null},names:["gauss"]},oe={init:function(){re.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,n,i,r;return t.x=qt(t.x-this.long0),re.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),i=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*i),t.x=r*n*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*n*i),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,n,i,r,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Math.sqrt(t.x*t.x+t.y*t.y)){var a=2*Math.atan2(o,this.R2);e=Math.sin(a),n=Math.cos(a),r=Math.asin(n*this.sinc0+t.y*e*this.cosc0/o),i=Math.atan2(t.x*e,o*this.cosc0*n-t.y*this.sinc0*e)}else r=this.phic0,i=0;return t.x=i,t.y=r,re.inverse.apply(this,[t]),t.x=qt(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},ae={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&(this.k0=.5*(1+kt(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=st&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=st&&(this.k0=.5*this.cons*St(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/It(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=St(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-it,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,n,i,r,o,a,s=t.x,l=t.y,u=Math.sin(l),c=Math.cos(l),h=qt(s-this.long0);return Math.abs(Math.abs(s-this.long0)-Math.PI)<=st&&Math.abs(l+this.lat0)<=st?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*u+this.coslat0*c*Math.cos(h)),t.x=this.a*e*c*Math.sin(h)+this.x0,t.y=this.a*e*(this.coslat0*u-this.sinlat0*c*Math.cos(h))+this.y0,t):(n=2*Math.atan(this.ssfn_(l,u,this.e))-it,r=Math.cos(n),i=Math.sin(n),Math.abs(this.coslat0)<=st?(o=It(this.e,l*this.con,this.con*u),a=2*this.a*this.k0*o/this.cons,t.x=this.x0+a*Math.sin(s-this.long0),t.y=this.y0-this.con*a*Math.cos(s-this.long0),t):(Math.abs(this.sinlat0)<st?(e=2*this.a*this.k0/(1+r*Math.cos(h)),t.y=e*i):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*i+this.cosX0*r*Math.cos(h))),t.y=e*(this.cosX0*i-this.sinX0*r*Math.cos(h))+this.y0),t.x=e*r*Math.sin(h)+this.x0,t))},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i,r,o,a=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var s=2*Math.atan(a/(2*this.a*this.k0));return e=this.long0,n=this.lat0,a<=st?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(s)*this.sinlat0+t.y*Math.sin(s)*this.coslat0/a),e=qt(Math.abs(this.coslat0)<st?this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y):this.long0+Math.atan2(t.x*Math.sin(s),a*this.coslat0*Math.cos(s)-t.y*this.sinlat0*Math.sin(s))),t.x=e,t.y=n,t)}if(Math.abs(this.coslat0)<=st){if(a<=st)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,i=a*this.cons/(2*this.a*this.k0),n=this.con*Ot(this.e,i),e=this.con*qt(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,a<=st?o=this.X0:(o=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/a),e=qt(this.long0+Math.atan2(t.x*Math.sin(r),a*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),n=-1*Ot(this.e,Math.tan(.5*(it+o)));return t.x=e,t.y=n,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,n){return e*=n,Math.tan(.5*(it+t))*Math.pow((1-e)/(1+e),.5*n)}},se={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,i=1/this.rf,r=2*i-Math.pow(i,2),o=this.e=Math.sqrt(r);this.R=this.k0*n*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),s=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*s+this.alpha*o/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+n)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),a=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(o))),s=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*a+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,n=t.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),a=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),s=this.lambda0+a/this.alpha,l=0,u=o,c=-1e3,h=0;Math.abs(u-c)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),c=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=s,t.y=u,t},names:["somerc"]},le={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),n=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-n*n);var i,r,o=It(this.e,this.lat0,t),a=this.bl/e*Math.sqrt((1-this.es)/(1-n*n));if(a*a<1&&(a=1),isNaN(this.longc)){var s=It(this.e,this.lat1,Math.sin(this.lat1)),l=It(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(a+Math.sqrt(a*a-1))*Math.pow(o,this.bl):this.el=(a-Math.sqrt(a*a-1))*Math.pow(o,this.bl);var u=Math.pow(s,this.bl),c=Math.pow(l,this.bl);r=.5*((i=this.el/u)-1/i);var h=(this.el*this.el-c*u)/(this.el*this.el+c*u),d=(c-u)/(c+u),p=qt(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(h*Math.tan(.5*this.bl*p)/d)/this.bl,this.long0=qt(this.long0);var f=qt(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*f)/r),this.alpha=Math.asin(a*Math.sin(this.gamma0))}else i=this.lat0>=0?a+Math.sqrt(a*a-1):a-Math.sqrt(a*a-1),this.el=i*Math.pow(o,this.bl),r=.5*(i-1/i),this.gamma0=Math.asin(Math.sin(this.alpha)/a),this.long0=this.longc-Math.asin(r*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha))},forward:function(t){var e,n,i,r=t.x,o=t.y,a=qt(r-this.long0);if(Math.abs(Math.abs(o)-it)<=st)i=o>0?-1:1,n=this.al/this.bl*Math.log(Math.tan(ct+i*this.gamma0*.5)),e=-1*i*it*this.al/this.bl;else{var s=It(this.e,o,Math.sin(o)),l=this.el/Math.pow(s,this.bl),u=.5*(l-1/l),c=.5*(l+1/l),h=Math.sin(this.bl*a),d=(u*Math.sin(this.gamma0)-h*Math.cos(this.gamma0))/c;n=Math.abs(Math.abs(d)-1)<=st?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-d)/(1+d))/this.bl,e=Math.abs(Math.cos(this.bl*a))<=st?this.al*this.bl*a:this.al*Math.atan2(u*Math.cos(this.gamma0)+h*Math.sin(this.gamma0),Math.cos(this.bl*a))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+n):(e-=this.uc,t.x=this.x0+n*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-n*Math.sin(this.alpha)),t},inverse:function(t){var e,n;this.no_rot?(n=t.y-this.y0,e=t.x-this.x0):(n=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var i=Math.exp(-1*this.bl*n/this.al),r=.5*(i-1/i),o=.5*(i+1/i),a=Math.sin(this.bl*e/this.al),s=(a*Math.cos(this.gamma0)+r*Math.sin(this.gamma0))/o,l=Math.pow(this.el/Math.sqrt((1+s)/(1-s)),1/this.bl);return Math.abs(s-1)<st?(t.x=this.long0,t.y=it):Math.abs(s+1)<st?(t.x=this.long0,t.y=-1*it):(t.y=Ot(this.e,l),t.x=qt(this.long0-Math.atan2(r*Math.cos(this.gamma0)-a*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},ue={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<st)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),i=St(this.e,e,n),r=It(this.e,this.lat1,e),o=Math.sin(this.lat2),a=Math.cos(this.lat2),s=St(this.e,o,a),l=It(this.e,this.lat2,o),u=It(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>st?this.ns=Math.log(i/s)/Math.log(r/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=st&&(n=kt(n)*(it-2*st));var i,r,o=Math.abs(Math.abs(n)-it);if(o>st)i=It(this.e,n,Math.sin(n)),r=this.a*this.f0*Math.pow(i,this.ns);else{if((o=n*this.ns)<=0)return null;r=0}var a=this.ns*qt(e-this.long0);return t.x=this.k0*(r*Math.sin(a))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(a))+this.y0,t},inverse:function(t){var e,n,i,r,o,a=(t.x-this.x0)/this.k0,s=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+s*s),n=1):(e=-Math.sqrt(a*a+s*s),n=-1);var l=0;if(0!==e&&(l=Math.atan2(n*a,n*s)),0!==e||this.ns>0){if(n=1/this.ns,i=Math.pow(e/(this.a*this.f0),n),-9999===(r=Ot(this.e,i)))return null}else r=-it;return o=qt(l/this.ns+this.long0),t.x=o,t.y=r,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},ce={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,n,i,r,o,a,s,l=t.x,u=t.y,c=qt(l-this.long0);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),i=-c*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),o=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(r)),a=this.n*o,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=s*Math.cos(a)/1,t.x=s*Math.sin(a)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,n,i,r,o,a,s,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),n=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),t.x=this.long0-n/this.alfa,a=e,s=0;var u=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(s=1),a=t.y,u+=1}while(0===s&&u<15);return u>=15?null:t},names:["Krovak","krovak"]},Es=function(t,e,n,i,r){return t*r-e*Math.sin(2*r)+n*Math.sin(4*r)-i*Math.sin(6*r)},Ps=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},Ns=function(t){return.375*t*(1+.25*t*(1+.46875*t))},Ss=function(t){return.05859375*t*t*(1+.75*t)},ks=function(t){return t*t*t*(35/3072)},qs=function(t,e,n){var i=e*n;return t/Math.sqrt(1-i*i)},Is=function(t){return Math.abs(t)<it?t:t-kt(t)*Math.PI},Os=function(t,e,n,i,r){var o,a;o=t/e;for(var s=0;s<15;s++)if(o+=a=(t-(e*o-n*Math.sin(2*o)+i*Math.sin(4*o)-r*Math.sin(6*o)))/(e-2*n*Math.cos(2*o)+4*i*Math.cos(4*o)-6*r*Math.cos(6*o)),Math.abs(a)<=1e-10)return o;return NaN},he={init:function(){this.sphere||(this.e0=Ps(this.es),this.e1=Ns(this.es),this.e2=Ss(this.es),this.e3=ks(this.es),this.ml0=this.a*Es(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,n,i=t.x,r=t.y;if(i=qt(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),n=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var o=Math.sin(r),a=Math.cos(r),s=qs(this.a,this.e,o),l=Math.tan(r)*Math.tan(r),u=i*Math.cos(r),c=u*u,h=this.es*a*a/(1-this.es);e=s*u*(1-c*l*(1/6-(8-l+8*h)*c/120)),n=this.a*Es(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+s*o/a*c*(.5+(5-l+6*h)*c/24)}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i=t.x/this.a,r=t.y/this.a;if(this.sphere){var o=r+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(i)),n=Math.atan2(Math.tan(i),Math.cos(o))}else{var a=this.ml0/this.a+r,s=Os(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-it)<=st)return t.x=this.long0,t.y=it,r<0&&(t.y*=-1),t;var l=qs(this.a,this.e,Math.sin(s)),u=l*l*l/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(s),2),h=i*this.a/l,d=h*h;e=s-l*Math.tan(s)/u*h*h*(.5-(1+3*c)*h*h/24),n=h*(1-d*(c/3+(1+3*c)*c*d/15))/Math.cos(s)}return t.x=qt(n+this.long0),t.y=Is(e),t},names:["Cassini","Cassini_Soldner","cass"]},Gs=function(t,e){var n;return t>1e-7?(1-t*t)*(e/(1-(n=t*e)*n)-.5/t*Math.log((1-n)/(1+n))):2*e},de=.3333333333333333,pe=.17222222222222222,fe=.10257936507936508,me=.06388888888888888,ye=.0664021164021164,ge=.016415012942191543,ve={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-it)<st?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<st?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Gs(this.e,1),this.mmf=.5/(1-this.es),this.apa=function X(t){var e,n=[];return n[0]=t*de,e=t*t,n[0]+=e*pe,n[1]=e*me,e*=t,n[0]+=e*fe,n[1]+=e*ye,n[2]=e*ge,n}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Gs(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,n,i,r,o,a,s,l,u,c,h=t.x,d=t.y;if(h=qt(h-this.long0),this.sphere){if(o=Math.sin(d),c=Math.cos(d),i=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+c*i:1+this.sinph0*o+this.cosph0*c*i)<=st)return null;e=(n=Math.sqrt(2/n))*c*Math.sin(h),n*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*c*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(d+this.phi0)<st)return null;n=ct-.5*d,e=(n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)))*Math.sin(h),n*=i}}else{switch(s=0,l=0,u=0,i=Math.cos(h),r=Math.sin(h),o=Math.sin(d),a=Gs(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(s=a/this.qp,l=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:u=1+this.sinb1*s+this.cosb1*l*i;break;case this.EQUIT:u=1+l*i;break;case this.N_POLE:u=it+d,a=this.qp-a;break;case this.S_POLE:u=d-it,a=this.qp+a}if(Math.abs(u)<st)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),n=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*s-this.sinb1*l*i):(u=Math.sqrt(2/(1+l*i)))*s*this.ymf,e=this.xmf*u*l*r;break;case this.N_POLE:case this.S_POLE:a>=0?(e=(u=Math.sqrt(a))*r,n=i*(this.mode===this.S_POLE?u:-u)):e=n=0}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i,r,o,a,s,l=t.x/this.a,u=t.y/this.a;if(this.sphere){var c,h=0,d=0;if((n=.5*(c=Math.sqrt(l*l+u*u)))>1)return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(d=Math.sin(n),h=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(c)<=st?0:Math.asin(u*d/c),l*=d,u=h*c;break;case this.OBLIQ:n=Math.abs(c)<=st?this.phi0:Math.asin(h*this.sinph0+u*d*this.cosph0/c),l*=d*this.cosph0,u=(h-Math.sin(n)*this.sinph0)*c;break;case this.N_POLE:u=-u,n=it-n;break;case this.S_POLE:n-=it}e=0!==u||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,u):0}else{if(s=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,u*=this.dd,(a=Math.sqrt(l*l+u*u))<st)return t.x=0,t.y=this.phi0,t;r=2*Math.asin(.5*a/this.rq),i=Math.cos(r),l*=r=Math.sin(r),this.mode===this.OBLIQ?(s=i*this.sinb1+u*r*this.cosb1/a,o=this.qp*s,u=a*this.cosb1*i-u*this.sinb1*r):(s=u*r/a,o=this.qp*s,u=a*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(u=-u),!(o=l*l+u*u))return t.x=0,t.y=this.phi0,t;s=1-o/this.qp,this.mode===this.S_POLE&&(s=-s)}e=Math.atan2(l,u),n=function J(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}(Math.asin(s),this.apa)}return t.x=qt(this.long0+e),t.y=n,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Fs=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)},_e={init:function(){Math.abs(this.lat1+this.lat2)<st||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=St(this.e3,this.sin_po,this.cos_po),this.qs1=Gs(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=St(this.e3,this.sin_po,this.cos_po),this.qs2=Gs(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Gs(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>st?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var i=Gs(this.e3,this.sin_phi,this.cos_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,o=this.ns0*qt(e-this.long0),a=r*Math.sin(o)+this.x0,s=this.rh-r*Math.cos(o)+this.y0;return t.x=a,t.y=s,t},inverse:function(t){var e,n,i,r,o,a;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),r=0,0!==e&&(r=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-i*i)/(2*this.ns0)):(n=(this.c-i*i)/this.ns0,a=this.phi1z(this.e3,n)),o=qt(r/this.ns0+this.long0),t.x=o,t.y=a,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var n,i,r,o,a=Fs(.5*e);if(t<st)return a;for(var s=t*t,l=1;l<=25;l++)if(a+=o=.5*(r=1-(i=t*(n=Math.sin(a)))*i)*r/Math.cos(a)*(e/(1-s)-n/r+.5/t*Math.log((1-i)/(1+i))),Math.abs(o)<=1e-7)return a;return null}},be={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,n,i,r,o,a,s,l=t.x,u=t.y;return i=qt(l-this.long0),e=Math.sin(u),n=Math.cos(u),r=Math.cos(i),(o=this.sin_p14*e+this.cos_p14*n*r)>0||Math.abs(o)<=st?(a=this.x0+1*this.a*n*Math.sin(i)/o,s=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)/o):(a=this.x0+this.infinity_dist*n*Math.sin(i),s=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*r)),t.x=a,t.y=s,t},inverse:function(t){var e,n,i,r,o,a;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),n=Math.sin(r),i=Math.cos(r),a=Fs(i*this.sin_p14+t.y*n*this.cos_p14/e),o=Math.atan2(t.x*n,e*this.cos_p14*i-t.y*this.sin_p14*n),o=qt(this.long0+o)):(a=this.phic0,o=0),t.x=o,t.y=a,t},names:["gnom"]},Te={init:function(){this.sphere||(this.k0=St(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,n,i=t.x,r=t.y,o=qt(i-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var a=Gs(this.e,Math.sin(r));e=this.x0+this.a*this.k0*o,n=this.y0+this.a*a*.5/this.k0}return t.x=e,t.y=n,t},inverse:function(t){var e,n;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=qt(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*it:it;for(var i,r,o,a,s=Math.asin(.5*e),l=0;l<30;l++)if(r=Math.sin(s),o=Math.cos(s),a=t*r,s+=i=Math.pow(1-a*a,2)/(2*o)*(e/(1-t*t)-r/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),Math.abs(i)<=1e-10)return s;return NaN}(this.e,2*t.y*this.k0/this.a),e=qt(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t},names:["cea"]},we={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,n=t.y,i=qt(e-this.long0),r=Is(n-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*r,t},inverse:function(t){var e=t.x,n=t.y;return t.x=qt(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=Is(this.lat0+(n-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Ee={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ps(this.es),this.e1=Ns(this.es),this.e2=Ss(this.es),this.e3=ks(this.es),this.ml0=this.a*Es(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,n,i,r=t.x,o=t.y,a=qt(r-this.long0);if(i=a*Math.sin(o),this.sphere)Math.abs(o)<=st?(e=this.a*a,n=-1*this.a*this.lat0):(e=this.a*Math.sin(i)/Math.tan(o),n=this.a*(Is(o-this.lat0)+(1-Math.cos(i))/Math.tan(o)));else if(Math.abs(o)<=st)e=this.a*a,n=-1*this.ml0;else{var s=qs(this.a,this.e,Math.sin(o))/Math.tan(o);e=s*Math.sin(i),n=this.a*Es(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+s*(1-Math.cos(i))}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){var e,n,i,r,o,a,s,l,u;if(i=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=st)e=qt(i/this.a+this.long0),n=0;else{var c;for(a=this.lat0+r/this.a,s=i*i/this.a/this.a+a*a,l=a,o=20;o;--o)if(l+=u=-1*(a*(l*(c=Math.tan(l))+1)-l-.5*(l*l+s)*c)/((l-a)/c-1),Math.abs(u)<=st){n=l;break}e=qt(this.long0+Math.asin(i*Math.tan(l)/this.a)/Math.sin(n))}else if(Math.abs(r+this.ml0)<=st)n=0,e=qt(this.long0+i/this.a);else{var h,d,p,f,m;for(a=(this.ml0+r)/this.a,s=i*i/this.a/this.a+a*a,l=a,o=20;o;--o)if(m=this.e*Math.sin(l),h=Math.sqrt(1-m*m)*Math.tan(l),d=this.a*Es(this.e0,this.e1,this.e2,this.e3,l),p=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=u=(a*(h*(f=d/this.a)+1)-f-.5*h*(f*f+s))/(this.es*Math.sin(2*l)*(f*f+s-2*a*f)/(4*h)+(a-f)*(h*p-2/Math.sin(2*l))-p),Math.abs(u)<=st){n=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=qt(this.long0+Math.asin(i*h/this.a)/Math.sin(n))}return t.x=e,t.y=n,t},names:["Polyconic","poly"]},Se={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,n=t.x,i=t.y-this.lat0,r=n-this.long0,o=i/nt*1e-5,a=r,s=1,l=0;for(e=1;e<=10;e++)s*=o,l+=this.A[e]*s;var u,c=l,h=a,d=1,p=0,f=0,m=0;for(e=1;e<=6;e++)u=p*c+d*h,d=d*c-p*h,p=u,f=f+this.B_re[e]*d-this.B_im[e]*p,m=m+this.B_im[e]*d+this.B_re[e]*p;return t.x=m*this.a+this.x0,t.y=f*this.a+this.y0,t},inverse:function(t){var e,n,i=t.x,r=t.y,o=i-this.x0,a=(r-this.y0)/this.a,s=o/this.a,l=1,u=0,c=0,h=0;for(e=1;e<=6;e++)n=u*a+l*s,l=l*a-u*s,u=n,c=c+this.C_re[e]*l-this.C_im[e]*u,h=h+this.C_im[e]*l+this.C_re[e]*u;for(var d=0;d<this.iterations;d++){var p,f=c,m=h,y=a,g=s;for(e=2;e<=6;e++)p=m*c+f*h,f=f*c-m*h,m=p,y+=(e-1)*(this.B_re[e]*f-this.B_im[e]*m),g+=(e-1)*(this.B_im[e]*f+this.B_re[e]*m);f=1,m=0;var v=this.B_re[1],_=this.B_im[1];for(e=2;e<=6;e++)p=m*c+f*h,f=f*c-m*h,m=p,v+=e*(this.B_re[e]*f-this.B_im[e]*m),_+=e*(this.B_im[e]*f+this.B_re[e]*m);var b=v*v+_*_;c=(y*v+g*_)/b,h=(g*v-y*_)/b}var T=c,w=h,E=1,S=0;for(e=1;e<=9;e++)E*=T,S+=this.D[e]*E;var M=this.lat0+S*nt*1e5,O=this.long0+w;return t.x=O,t.y=M,t},names:["New_Zealand_Map_Grid","nzmg"]},Me={init:function(){},forward:function(t){var e=t.x,n=t.y,i=qt(e-this.long0),r=this.x0+this.a*i,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=r,t.y=o,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=qt(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t},names:["Miller_Cylindrical","mill"]},Oe={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=is(this.es)},forward:function(t){var e,n,i=t.x,r=t.y;if(i=qt(i-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(r),a=20;a;--a){var s=(this.m*r+Math.sin(r)-o)/(this.m+Math.cos(r));if(r-=s,Math.abs(s)<st)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*i*(this.m+Math.cos(r)),n=this.a*this.C_y*r}else{var l=Math.sin(r),u=Math.cos(r);n=this.a*as(r,l,u,this.en),e=this.a*i*u/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,i,r;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=Fs((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Fs(Math.sin(e)/this.n)),i=qt(i+this.long0),e=Is(e)):(e=hs(t.y/this.a,this.es,this.en),(r=Math.abs(e))<it?(r=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=qt(n)):r-st<it&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]},xe={init:function(){},forward:function(t){for(var e=t.x,n=t.y,i=qt(e-this.long0),r=n,o=Math.PI*Math.sin(n);;){var a=-(r+Math.sin(r)-o)/(1+Math.cos(r));if(r+=a,Math.abs(a)<st)break}r/=2,Math.PI/2-Math.abs(n)<st&&(i=0);var s=.900316316158*this.a*i*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=s,t.y=l,t},inverse:function(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var i=qt(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var r=Math.asin(n);return t.x=i,t.y=r,t},names:["Mollweide","moll"]},Pe={init:function(){Math.abs(this.lat1+this.lat2)<st||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ps(this.es),this.e1=Ns(this.es),this.e2=Ss(this.es),this.e3=ks(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=St(this.e,this.sinphi,this.cosphi),this.ml1=Es(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<st?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=St(this.e,this.sinphi,this.cosphi),this.ml2=Es(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Es(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,n=t.x,i=t.y;if(this.sphere)e=this.a*(this.g-i);else{var r=Es(this.e0,this.e1,this.e2,this.e3,i);e=this.a*(this.g-r)}var o=this.ns*qt(n-this.long0),a=this.x0+e*Math.sin(o),s=this.y0+this.rh-e*Math.cos(o);return t.x=a,t.y=s,t},inverse:function(t){var e,n,i,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(0!==n&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return r=qt(this.long0+o/this.ns),i=Is(this.g-n/this.a),t.x=r,t.y=i,t;var a=this.g-n/this.a;return i=Os(a,this.e0,this.e1,this.e2,this.e3),r=qt(this.long0+o/this.ns),t.x=r,t.y=i,t},names:["Equidistant_Conic","eqdc"]},Ce={init:function(){this.R=this.a},forward:function(t){var e,n,i=t.x,r=t.y,o=qt(i-this.long0);Math.abs(r)<=st&&(e=this.x0+this.R*o,n=this.y0);var a=Fs(2*Math.abs(r/Math.PI));(Math.abs(o)<=st||Math.abs(Math.abs(r)-it)<=st)&&(e=this.x0,n=r>=0?this.y0+Math.PI*this.R*Math.tan(.5*a):this.y0+Math.PI*this.R*-Math.tan(.5*a));var s=.5*Math.abs(Math.PI/o-o/Math.PI),l=s*s,u=Math.sin(a),c=Math.cos(a),h=c/(u+c-1),d=h*h,p=h*(2/u-1),f=p*p,m=Math.PI*this.R*(s*(h-f)+Math.sqrt(l*(h-f)*(h-f)-(f+l)*(d-f)))/(f+l);o<0&&(m=-m),e=this.x0+m;var y=l+h;return m=Math.PI*this.R*(p*y-s*Math.sqrt((f+l)*(l+1)-y*y))/(f+l),n=r>=0?this.y0+m:this.y0-m,t.x=e,t.y=n,t},inverse:function(t){var e,n,i,r,o,a,s,l,u,c,h,d;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,o=(i=t.x/h)*i+(r=t.y/h)*r,h=3*(r*r/(l=-2*(a=-Math.abs(r)*(1+o))+1+2*r*r+o*o)+(2*(s=a-2*r*r+i*i)*s*s/l/l/l-9*a*s/l/l)/27)/(u=(a-s*s/3/l)/l)/(c=2*Math.sqrt(-u/3)),Math.abs(h)>1&&(h=h>=0?1:-1),d=Math.acos(h)/3,n=t.y>=0?(-c*Math.cos(d+Math.PI/3)-s/3/l)*Math.PI:-(-c*Math.cos(d+Math.PI/3)-s/3/l)*Math.PI,e=Math.abs(i)<st?this.long0:qt(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(i*i-r*r)+o*o))/2/i),t.x=e,t.y=n,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},Ie={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,n,i,r,o,a,s,l,u,c,h,d,p,f,m,y,g,v,_,b,T,w,E=t.x,S=t.y,M=Math.sin(t.y),O=Math.cos(t.y),x=qt(E-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=st?(t.x=this.x0+this.a*(it-S)*Math.sin(x),t.y=this.y0-this.a*(it-S)*Math.cos(x),t):Math.abs(this.sin_p12+1)<=st?(t.x=this.x0+this.a*(it+S)*Math.sin(x),t.y=this.y0+this.a*(it+S)*Math.cos(x),t):(v=this.sin_p12*M+this.cos_p12*O*Math.cos(x),g=(y=Math.acos(v))/Math.sin(y),t.x=this.x0+this.a*g*O*Math.sin(x),t.y=this.y0+this.a*g*(this.cos_p12*M-this.sin_p12*O*Math.cos(x)),t):(e=Ps(this.es),n=Ns(this.es),i=Ss(this.es),r=ks(this.es),Math.abs(this.sin_p12-1)<=st?(o=this.a*Es(e,n,i,r,it),a=this.a*Es(e,n,i,r,S),t.x=this.x0+(o-a)*Math.sin(x),t.y=this.y0-(o-a)*Math.cos(x),t):Math.abs(this.sin_p12+1)<=st?(o=this.a*Es(e,n,i,r,it),a=this.a*Es(e,n,i,r,S),t.x=this.x0+(o+a)*Math.sin(x),t.y=this.y0+(o+a)*Math.cos(x),t):(s=M/O,l=qs(this.a,this.e,this.sin_p12),u=qs(this.a,this.e,M),c=Math.atan((1-this.es)*s+this.es*l*this.sin_p12/(u*O)),_=0===(h=Math.atan2(Math.sin(x),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(x)))?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(h)-Math.PI)<=st?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(x)*Math.cos(c)/Math.sin(h)),d=this.e*this.sin_p12/Math.sqrt(1-this.es),y=l*_*(1-(b=_*_)*(m=(p=this.e*this.cos_p12*Math.cos(h)/Math.sqrt(1-this.es))*p)*(1-m)/6+(T=b*_)/8*(f=d*p)*(1-2*m)+(w=T*_)/120*(m*(4-7*m)-3*d*d*(1-7*m))-w*_/48*f),t.x=this.x0+y*Math.sin(h),t.y=this.y0+y*Math.cos(h),t))},inverse:function(t){var e,n,i,r,o,a,s,l,u,c,h,d,p,f,m,y,g,v,_,b,T,w;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*it*this.a)return;return n=e/this.a,i=Math.sin(n),r=Math.cos(n),o=this.long0,Math.abs(e)<=st?a=this.lat0:(a=Fs(r*this.sin_p12+t.y*i*this.cos_p12/e),s=Math.abs(this.lat0)-it,o=qt(Math.abs(s)<=st?this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y):this.long0+Math.atan2(t.x*i,e*this.cos_p12*r-t.y*this.sin_p12*i))),t.x=o,t.y=a,t}return l=Ps(this.es),u=Ns(this.es),c=Ss(this.es),h=ks(this.es),Math.abs(this.sin_p12-1)<=st?(d=this.a*Es(l,u,c,h,it),e=Math.sqrt(t.x*t.x+t.y*t.y),a=Os((d-e)/this.a,l,u,c,h),o=qt(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=a,t):Math.abs(this.sin_p12+1)<=st?(d=this.a*Es(l,u,c,h,it),e=Math.sqrt(t.x*t.x+t.y*t.y),a=Os((e-d)/this.a,l,u,c,h),o=qt(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=a,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),m=Math.atan2(t.x,t.y),p=qs(this.a,this.e,this.sin_p12),y=Math.cos(m),v=-(g=this.e*this.cos_p12*y)*g/(1-this.es),_=3*this.es*(1-v)*this.sin_p12*this.cos_p12*y/(1-this.es),w=1-v*(T=(b=e/p)-v*(1+v)*Math.pow(b,3)/6-_*(1+3*v)*Math.pow(b,4)/24)*T/2-b*T*T*T/6,f=Math.asin(this.sin_p12*Math.cos(T)+this.cos_p12*Math.sin(T)*y),o=qt(this.long0+Math.asin(Math.sin(m)*Math.sin(T)/Math.cos(f))),a=Math.atan((1-this.es*w*this.sin_p12/Math.sin(f))*Math.tan(f)/(1-this.es)),t.x=o,t.y=a,t)},names:["Azimuthal_Equidistant","aeqd"]},Le={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,n,i,r,o,a,s,l=t.x,u=t.y;return i=qt(l-this.long0),e=Math.sin(u),n=Math.cos(u),r=Math.cos(i),((o=this.sin_p14*e+this.cos_p14*n*r)>0||Math.abs(o)<=st)&&(a=1*this.a*n*Math.sin(i),s=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)),t.x=a,t.y=s,t},inverse:function(t){var e,n,i,r,o,a,s;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=Fs(e/this.a),i=Math.sin(n),r=Math.cos(n),a=this.long0,Math.abs(e)<=st?(s=this.lat0,t.x=a,t.y=s,t):(s=Fs(r*this.sin_p14+t.y*i*this.cos_p14/e),o=Math.abs(this.lat0)-it,Math.abs(o)<=st?(a=qt(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)),t.x=a,t.y=s,t):(a=qt(this.long0+Math.atan2(t.x*i,e*this.cos_p14*r-t.y*this.sin_p14*i)),t.x=a,t.y=s,t))},names:["ortho"]},Re=1,ke=2,Ae=3,De=4,je=5,Ne=6,Fe={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4},Ue={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=it-ct/2?this.face=je:this.lat0<=-(it-ct/2)?this.face=Ne:Math.abs(this.long0)<=ct?this.face=Re:Math.abs(this.long0)<=it+ct?this.face=this.long0>0?ke:De:this.face=Ae,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,n,i,r,o,a,s={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,n=t.x,this.face===je)r=it-e,n>=ct&&n<=it+ct?(l.value=Fe.AREA_0,i=n-it):n>it+ct||n<=-(it+ct)?(l.value=Fe.AREA_1,i=n>0?n-dt:n+dt):n>-(it+ct)&&n<=-ct?(l.value=Fe.AREA_2,i=n+it):(l.value=Fe.AREA_3,i=n);else if(this.face===Ne)r=it+e,n>=ct&&n<=it+ct?(l.value=Fe.AREA_0,i=-n+it):n<ct&&n>=-ct?(l.value=Fe.AREA_1,i=-n):n<-ct&&n>=-(it+ct)?(l.value=Fe.AREA_2,i=-n-it):(l.value=Fe.AREA_3,i=n>0?-n+dt:-n-dt);else{var u,c,h,d,p,f;this.face===ke?n=Z(n,+it):this.face===Ae?n=Z(n,+dt):this.face===De&&(n=Z(n,-it)),d=Math.sin(e),p=Math.cos(e),f=Math.sin(n),u=p*Math.cos(n),c=p*f,h=d,this.face===Re?i=V(r=Math.acos(u),h,c,l):this.face===ke?i=V(r=Math.acos(c),h,-u,l):this.face===Ae?i=V(r=Math.acos(-u),h,-c,l):this.face===De?i=V(r=Math.acos(-c),h,u,l):(r=i=0,l.value=Fe.AREA_0)}return a=Math.atan(12/dt*(i+Math.acos(Math.sin(i)*Math.cos(ct))-it)),o=Math.sqrt((1-Math.cos(r))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Fe.AREA_1?a+=it:l.value===Fe.AREA_2?a+=dt:l.value===Fe.AREA_3&&(a+=1.5*dt),s.x=o*Math.cos(a),s.y=o*Math.sin(a),s.x=s.x*this.a+this.x0,s.y=s.y*this.a+this.y0,t.x=s.x,t.y=s.y,t},inverse:function(t){var e,n,i,r,o,a,s,l,u,c,h,d,p={lam:0,phi:0},f={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,n=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?f.value=Fe.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(f.value=Fe.AREA_1,e-=it):t.x<0&&-t.x>=Math.abs(t.y)?(f.value=Fe.AREA_2,e=e<0?e+dt:e-dt):(f.value=Fe.AREA_3,e+=it),u=dt/12*Math.tan(e),o=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),a=Math.atan(o),(s=1-(i=Math.cos(e))*i*(r=Math.tan(n))*r*(1-Math.cos(Math.atan(1/Math.cos(a)))))<-1?s=-1:s>1&&(s=1),this.face===je)l=Math.acos(s),p.phi=it-l,f.value===Fe.AREA_0?p.lam=a+it:f.value===Fe.AREA_1?p.lam=a<0?a+dt:a-dt:f.value===Fe.AREA_2?p.lam=a-it:p.lam=a;else if(this.face===Ne)l=Math.acos(s),p.phi=l-it,f.value===Fe.AREA_0?p.lam=-a+it:f.value===Fe.AREA_1?p.lam=-a:f.value===Fe.AREA_2?p.lam=-a-it:p.lam=a<0?-a-dt:-a+dt;else{var m,y,g;u=(m=s)*m,y=(u+=(g=u>=1?0:Math.sqrt(1-u)*Math.sin(a))*g)>=1?0:Math.sqrt(1-u),f.value===Fe.AREA_1?(u=y,y=-g,g=u):f.value===Fe.AREA_2?(y=-y,g=-g):f.value===Fe.AREA_3&&(u=y,y=g,g=-u),this.face===ke?(u=m,m=-y,y=u):this.face===Ae?(m=-m,y=-y):this.face===De&&(u=m,m=y,y=-u),p.phi=Math.acos(-g)-it,p.lam=Math.atan2(y,m),this.face===ke?p.lam=Z(p.lam,-it):this.face===Ae?p.lam=Z(p.lam,-dt):this.face===De&&(p.lam=Z(p.lam,+it))}return 0!==this.es&&(c=p.phi<0?1:0,h=Math.tan(p.phi),d=this.b/Math.sqrt(h*h+this.one_minus_f_squared),p.phi=Math.atan(Math.sqrt(this.a*this.a-d*d)/(this.one_minus_f*d)),c&&(p.phi=-p.phi)),p.lam+=this.long0,t.x=p.lam,t.y=p.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},Ve=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],ze=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Ge=ut/5,qe=1/Ge,di=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},We={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=qt(t.x-this.long0),n=Math.abs(t.y),i=Math.floor(n*Ge);i<0?i=0:i>=18&&(i=17);var r={x:di(Ve[i],n=ut*(n-qe*i))*e,y:di(ze[i],n)};return t.y<0&&(r.y=-r.y),r.x=r.x*this.a*.8487+this.x0,r.y=r.y*this.a*1.3523+this.y0,r},inverse:function(t){var e={x:(t.x-this.x0)/(.8487*this.a),y:Math.abs(t.y-this.y0)/(1.3523*this.a)};if(e.y>=1)e.x/=Ve[18][0],e.y=t.y<0?-it:it;else{var n=Math.floor(18*e.y);for(n<0?n=0:n>=18&&(n=17);;)if(ze[n][0]>e.y)--n;else{if(!(ze[n+1][0]<=e.y))break;++n}var i=ze[n],r=5*(e.y-i[0])/(ze[n+1][0]-i[0]);r=function Y(t,e,n,i){for(var r=e;i;--i){var o=t(r);if(r-=o,Math.abs(o)<n)break}return r}((function(t){return(di(i,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(i,t)}),r,st,100),e.x/=di(Ve[n],r),e.y=(5*n+r)*lt,t.y<0&&(e.y=-e.y)}return e.x=qt(e.x+this.long0),e},names:["Robinson","robin"]};return I.defaultDatum="WGS84",I.Proj=Projection,I.WGS84=new I.Proj("WGS84"),I.Point=Point,I.toPoint=Ft,I.defs=o,I.transform=S,I.mgrs=Jt,I.version="2.5.0",function(t){t.Proj.projections.add(ee),t.Proj.projections.add(ne),t.Proj.projections.add(ie),t.Proj.projections.add(oe),t.Proj.projections.add(ae),t.Proj.projections.add(se),t.Proj.projections.add(le),t.Proj.projections.add(ue),t.Proj.projections.add(ce),t.Proj.projections.add(he),t.Proj.projections.add(ve),t.Proj.projections.add(_e),t.Proj.projections.add(be),t.Proj.projections.add(Te),t.Proj.projections.add(we),t.Proj.projections.add(Ee),t.Proj.projections.add(Se),t.Proj.projections.add(Me),t.Proj.projections.add(Oe),t.Proj.projections.add(xe),t.Proj.projections.add(Pe),t.Proj.projections.add(Ce),t.Proj.projections.add(Ie),t.Proj.projections.add(Le),t.Proj.projections.add(Ue),t.Proj.projections.add(We)}(I),I}()})),N=createCommonjsModule((function(t){!function(t){var e,n=/^[a-z]+:/,i=/[-a-z0-9]+(\.[-a-z0-9])*:\d+/i,r=/\/\/(.*?)(?::(.*?))?@/,o=/^win/i,a=/:$/,s=/^\?/,l=/^#/,c=/(.*\/)/,d=/^\/{2,}/,p=/'/g,f=/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,m=/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,y=/%([0-7][0-9a-f])/gi,g=/\+/g,v=/^\w:$/,_=/[^/#?]/,b="undefined"==typeof window&&void 0!==D&&!0,T=b?t.require:null,w={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},E={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443};function x(){return b?(e||(e="file://"+(process.platform.match(o)?"/":"")+T("fs").realpathSync(".")),e):document.location.href}function u(t){return encodeURIComponent(t).replace(p,"%27")}function z(t){return(t=(t=(t=t.replace(g," ")).replace(f,(function(t,e,n,i){var r=parseInt(e,16)-224,o=parseInt(n,16)-128;if(0===r&&o<32)return t;var a=(r<<12)+(o<<6)+(parseInt(i,16)-128);return 65535<a?t:String.fromCharCode(a)}))).replace(m,(function(t,e,n){var i=parseInt(e,16)-192;if(i<2)return t;var r=parseInt(n,16)-128;return String.fromCharCode((i<<6)+r)}))).replace(y,(function(t,e){return String.fromCharCode(parseInt(e,16))}))}function F(t){for(var e=t.split("&"),n=0,i=e.length;n<i;n++){var r=e[n].split("="),o=decodeURIComponent(r[0].replace(g," "));if(o){var a=void 0!==r[1]?z(r[1]):null;void 0===this[o]?this[o]=a:(this[o]instanceof Array||(this[o]=[this[o]]),this[o].push(a))}}}function U(t,e){!function h(t,e,o){var u,h,p;e||(e=x()),b?u=T("url").parse(e):(u=document.createElement("a")).href=e;var f,m,y=(m={path:!0,query:!0,hash:!0},(f=e)&&n.test(f)&&(m.protocol=!0,m.host=!0,i.test(f)&&(m.port=!0),r.test(f)&&(m.user=!0,m.pass=!0)),m);for(h in p=e.match(r)||[],w)y[h]?t[h]=u[w[h]]||"":t[h]="";if(t.protocol=t.protocol.replace(a,""),t.query=t.query.replace(s,""),t.hash=z(t.hash.replace(l,"")),t.user=z(p[1]||""),t.pass=z(p[2]||""),t.port=E[t.protocol]==t.port||0==t.port?"":t.port,!y.protocol&&_.test(e.charAt(0))&&(t.path=e.split("?")[0].split("#")[0]),!y.protocol&&o){var g=new U(x().match(c)[0]),v=g.path.split("/"),S=t.path.split("/"),M=["protocol","user","pass","host","port"],O=M.length;for(v.pop(),h=0;h<O;h++)t[M[h]]=g[M[h]];for(;".."===S[0];)v.pop(),S.shift();t.path=("/"!==e.charAt(0)?v.join("/"):"")+"/"+S.join("/")}t.path=t.path.replace(d,"/"),t.paths(t.paths()),t.query=new F(t.query)}(this,t,!e)}F.prototype.toString=function(){var t,e,n="",i=u;for(t in this){var r=this[t];if(!(r instanceof Function||null===r))if(r instanceof Array){var o=r.length;if(o)for(e=0;e<o;e++){var a=r[e];n+=n?"&":"",n+=i(t)+(null==a?"":"="+i(a))}else n+=(n?"&":"")+i(t)+"="}else n+=n?"&":"",n+=i(t)+(void 0===r?"":"="+i(r))}return n},U.prototype.clearQuery=function(){for(var t in this.query)this.query[t]instanceof Function||delete this.query[t];return this},U.prototype.queryLength=function(){var t=0;for(var e in this.query)this.query[e]instanceof Function||t++;return t},U.prototype.isEmptyQuery=function(){return 0===this.queryLength()},U.prototype.paths=function(t){var e,n="",i=0;if(t&&t.length&&t+""!==t){for(this.isAbsolute()&&(n="/"),e=t.length;i<e;i++)t[i]=!i&&v.test(t[i])?t[i]:u(t[i]);this.path=n+t.join("/")}for(i=0,e=(t=("/"===this.path.charAt(0)?this.path.slice(1):this.path).split("/")).length;i<e;i++)t[i]=z(t[i]);return t},U.prototype.encode=u,U.prototype.decode=z,U.prototype.isAbsolute=function(){return this.protocol||"/"===this.path.charAt(0)},U.prototype.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&u(this.user)+(this.pass&&":"+u(this.pass))+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+u(this.hash))},t[t.exports?"exports":"Url"]=U}(t.exports?t:window)}));class LuxonError extends Error{}class InvalidDateTimeError extends LuxonError{constructor(t){super(`Invalid DateTime: ${t.toMessage()}`)}}class InvalidIntervalError extends LuxonError{constructor(t){super(`Invalid Interval: ${t.toMessage()}`)}}class InvalidDurationError extends LuxonError{constructor(t){super(`Invalid Duration: ${t.toMessage()}`)}}class ConflictingSpecificationError extends LuxonError{}class InvalidUnitError extends LuxonError{constructor(t){super(`Invalid unit ${t}`)}}class InvalidArgumentError extends LuxonError{}class ZoneIsAbstractError extends LuxonError{constructor(){super("Zone is an abstract class")}}const V="numeric",G="short",q="long",W={year:V,month:V,day:V},B={year:V,month:G,day:V},Z={year:V,month:q,day:V},K={year:V,month:q,day:V,weekday:q},Y={hour:V,minute:V},H={hour:V,minute:V,second:V},X={hour:V,minute:V,second:V,timeZoneName:G},$={hour:V,minute:V,second:V,timeZoneName:q},Q={hour:V,minute:V,hour12:!1},J={hour:V,minute:V,second:V,hour12:!1},tt={hour:V,minute:V,second:V,hour12:!1,timeZoneName:G},et={hour:V,minute:V,second:V,hour12:!1,timeZoneName:q},nt={year:V,month:V,day:V,hour:V,minute:V},it={year:V,month:V,day:V,hour:V,minute:V,second:V},rt={year:V,month:G,day:V,hour:V,minute:V},ot={year:V,month:G,day:V,hour:V,minute:V,second:V},at={year:V,month:G,day:V,weekday:G,hour:V,minute:V},st={year:V,month:q,day:V,hour:V,minute:V,timeZoneName:G},lt={year:V,month:q,day:V,hour:V,minute:V,second:V,timeZoneName:G},ut={year:V,month:q,day:V,weekday:q,hour:V,minute:V,timeZoneName:q},ct={year:V,month:q,day:V,weekday:q,hour:V,minute:V,second:V,timeZoneName:q};function isUndefined(t){return void 0===t}function isNumber(t){return"number"==typeof t}function isInteger(t){return"number"==typeof t&&t%1==0}function hasIntl(){try{return"undefined"!=typeof Intl&&Intl.DateTimeFormat}catch(t){return!1}}function hasFormatToParts(){return!isUndefined(Intl.DateTimeFormat.prototype.formatToParts)}function hasRelative(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(t){return!1}}function bestBy(t,e,n){if(0!==t.length)return t.reduce((t,i)=>{const r=[e(i),i];return t&&n(t[0],r[0])===t[0]?t:r},null)[1]}function pick(t,e){return e.reduce((e,n)=>(e[n]=t[n],e),{})}function hasOwnProperty(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function integerBetween(t,e,n){return isInteger(t)&&t>=e&&t<=n}function padStart(t,e=2){return t.toString().length<e?("0".repeat(e)+t).slice(-e):t.toString()}function parseInteger(t){return isUndefined(t)||null===t||""===t?void 0:parseInt(t,10)}function parseMillis(t){if(!isUndefined(t)&&null!==t&&""!==t){const e=1e3*parseFloat("0."+t);return Math.floor(e)}}function roundTo(t,e,n=!1){const i=10**e;return(n?Math.trunc:Math.round)(t*i)/i}function isLeapYear(t){return t%4==0&&(t%100!=0||t%400==0)}function daysInYear(t){return isLeapYear(t)?366:365}function daysInMonth(t,e){const n=function floorMod(t,e){return t-e*Math.floor(t/e)}(e-1,12)+1;return 2===n?isLeapYear(t+(e-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function objToLocalTS(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e)).setUTCFullYear(e.getUTCFullYear()-1900),+e}function weeksInWeekYear(t){const e=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7,n=t-1,i=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7;return 4===e||3===i?53:52}function untruncateYear(t){return t>99?t:t>60?1900+t:2e3+t}function parseZoneInfo(t,e,n,i=null){const r=new Date(t),o={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(o.timeZone=i);const a=Object.assign({timeZoneName:e},o),s=hasIntl();if(s&&hasFormatToParts()){const t=new Intl.DateTimeFormat(n,a).formatToParts(r).find(t=>"timezonename"===t.type.toLowerCase());return t?t.value:null}if(s){const t=new Intl.DateTimeFormat(n,o).format(r);return new Intl.DateTimeFormat(n,a).format(r).substring(t.length).replace(/^[, \u200e]+/,"")}return null}function signedOffset(t,e){let n=parseInt(t,10);Number.isNaN(n)&&(n=0);const i=parseInt(e,10)||0;return 60*n+(n<0||Object.is(n,-0)?-i:i)}function asNumber(t){const e=Number(t);if("boolean"==typeof t||""===t||Number.isNaN(e))throw new InvalidArgumentError(`Invalid unit value ${t}`);return e}function normalizeObject(t,e,n){const i={};for(const r in t)if(hasOwnProperty(t,r)){if(n.indexOf(r)>=0)continue;const o=t[r];if(null==o)continue;i[e(r)]=asNumber(o)}return i}function formatOffset(t,e){const n=Math.trunc(t/60),i=Math.abs(t%60),r=n>=0&&!Object.is(n,-0)?"+":"-",o=`${r}${Math.abs(n)}`;switch(e){case"short":return`${r}${padStart(Math.abs(n),2)}:${padStart(i,2)}`;case"narrow":return i>0?`${o}:${i}`:o;case"techie":return`${r}${padStart(Math.abs(n),2)}${padStart(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function timeObject(t){return pick(t,["hour","minute","second","millisecond"])}const ht=/[A-Za-z_+-]{1,256}(:?\/[A-Za-z_+-]{1,256}(\/[A-Za-z_+-]{1,256})?)?/;function stringify(t){return JSON.stringify(t,Object.keys(t).sort())}const dt=["January","February","March","April","May","June","July","August","September","October","November","December"],pt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ft=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(t){switch(t){case"narrow":return ft;case"short":return pt;case"long":return dt;case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const mt=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],yt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],gt=["M","T","W","T","F","S","S"];function weekdays(t){switch(t){case"narrow":return gt;case"short":return yt;case"long":return mt;case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const vt=["AM","PM"],_t=["Before Christ","Anno Domini"],bt=["BC","AD"],Tt=["B","A"];function eras(t){switch(t){case"narrow":return Tt;case"short":return bt;case"long":return _t;default:return null}}function stringifyTokens(t,e){let n="";for(const i of t)i.literal?n+=i.val:n+=e(i.val);return n}const wt={D:W,DD:B,DDD:Z,DDDD:K,t:Y,tt:H,ttt:X,tttt:$,T:Q,TT:J,TTT:tt,TTTT:et,f:nt,ff:rt,fff:st,ffff:ut,F:it,FF:ot,FFF:lt,FFFF:ct};class Formatter{static create(t,e={}){return new Formatter(t,e)}static parseFormat(t){let e=null,n="",i=!1;const r=[];for(let o=0;o<t.length;o++){const a=t.charAt(o);"'"===a?(n.length>0&&r.push({literal:i,val:n}),e=null,n="",i=!i):i?n+=a:a===e?n+=a:(n.length>0&&r.push({literal:!1,val:n}),n=a,e=a)}return n.length>0&&r.push({literal:i,val:n}),r}static macroTokenToFormatOpts(t){return wt[t]}constructor(t,e){this.opts=e,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,e){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,Object.assign({},this.opts,e)).format()}formatDateTime(t,e={}){return this.loc.dtFormatter(t,Object.assign({},this.opts,e)).format()}formatDateTimeParts(t,e={}){return this.loc.dtFormatter(t,Object.assign({},this.opts,e)).formatToParts()}resolvedOptions(t,e={}){return this.loc.dtFormatter(t,Object.assign({},this.opts,e)).resolvedOptions()}num(t,e=0){if(this.opts.forceSimple)return padStart(t,e);const n=Object.assign({},this.opts);return e>0&&(n.padTo=e),this.loc.numberFormatter(n).format(t)}formatDateTimeFromString(t,e){const n="en"===this.loc.listingMode(),i=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar&&hasFormatToParts(),string=(e,n)=>this.loc.extract(t,e,n),formatOffset=e=>t.isOffsetFixed&&0===t.offset&&e.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,e.format):"",meridiem=()=>n?function meridiemForDateTime(t){return vt[t.hour<12?0:1]}(t):string({hour:"numeric",hour12:!0},"dayperiod"),month=(e,i)=>n?function monthForDateTime(t,e){return months(e)[t.month-1]}(t,e):string(i?{month:e}:{month:e,day:"numeric"},"month"),weekday=(e,i)=>n?function weekdayForDateTime(t,e){return weekdays(e)[t.weekday-1]}(t,e):string(i?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday"),maybeMacro=e=>{const n=Formatter.macroTokenToFormatOpts(e);return n?this.formatWithSystemDefault(t,n):e},era=e=>n?function eraForDateTime(t,e){return eras(e)[t.year<0?0:1]}(t,e):string({era:e},"era");return stringifyTokens(Formatter.parseFormat(e),e=>{switch(e){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12==0?12:t.hour%12);case"hh":return this.num(t.hour%12==0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return formatOffset({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return formatOffset({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return formatOffset({format:"techie",allowZ:!1});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return meridiem();case"d":return i?string({day:"numeric"},"day"):this.num(t.day);case"dd":return i?string({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return weekday("short",!0);case"cccc":return weekday("long",!0);case"ccccc":return weekday("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return weekday("short",!1);case"EEEE":return weekday("long",!1);case"EEEEE":return weekday("narrow",!1);case"L":return i?string({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return i?string({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return month("short",!0);case"LLLL":return month("long",!0);case"LLLLL":return month("narrow",!0);case"M":return i?string({month:"numeric"},"month"):this.num(t.month);case"MM":return i?string({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return month("short",!1);case"MMMM":return month("long",!1);case"MMMMM":return month("narrow",!1);case"y":return i?string({year:"numeric"},"year"):this.num(t.year);case"yy":return i?string({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return i?string({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return i?string({year:"numeric"},"year"):this.num(t.year,6);case"G":return era("short");case"GG":return era("long");case"GGGGG":return era("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return maybeMacro(e)}})}formatDurationFromString(t,e){const tokenToField=t=>{switch(t[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"M":return"month";case"y":return"year";default:return null}},n=Formatter.parseFormat(e),i=n.reduce((t,{literal:e,val:n})=>e?t:t.concat(n),[]);return stringifyTokens(n,(t=>e=>{const n=tokenToField(e);return n?this.num(t.get(n),e.length):e})(t.shiftTo(...i.map(tokenToField).filter(t=>t))))}}class Invalid{constructor(t,e){this.reason=t,this.explanation=e}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}class Zone{get type(){throw new ZoneIsAbstractError}get name(){throw new ZoneIsAbstractError}get universal(){throw new ZoneIsAbstractError}offsetName(t,e){throw new ZoneIsAbstractError}formatOffset(t,e){throw new ZoneIsAbstractError}offset(t){throw new ZoneIsAbstractError}equals(t){throw new ZoneIsAbstractError}get isValid(){throw new ZoneIsAbstractError}}let Et=null;class LocalZone extends Zone{static get instance(){return null===Et&&(Et=new LocalZone),Et}get type(){return"local"}get name(){return hasIntl()?(new Intl.DateTimeFormat).resolvedOptions().timeZone:"local"}get universal(){return!1}offsetName(t,{format:e,locale:n}){return parseZoneInfo(t,e,n)}formatOffset(t,e){return formatOffset(this.offset(t),e)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return"local"===t.type}get isValid(){return!0}}const St=RegExp(`^${ht.source}$`);let Mt={};const Ot={year:0,month:1,day:2,hour:3,minute:4,second:5};let xt={};class IANAZone extends Zone{static create(t){return xt[t]||(xt[t]=new IANAZone(t)),xt[t]}static resetCache(){xt={},Mt={}}static isValidSpecifier(t){return!(!t||!t.match(St))}static isValidZone(t){try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch(t){return!1}}static parseGMTOffset(t){if(t){const e=t.match(/^Etc\/GMT([+-]\d{1,2})$/i);if(e)return-60*parseInt(e[1])}return null}constructor(t){super(),this.zoneName=t,this.valid=IANAZone.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get universal(){return!1}offsetName(t,{format:e,locale:n}){return parseZoneInfo(t,e,n,this.name)}formatOffset(t,e){return formatOffset(this.offset(t),e)}offset(t){const e=new Date(t),n=function makeDTF(t){return Mt[t]||(Mt[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),Mt[t]}(this.name),[i,r,o,a,s,l]=n.formatToParts?function partsOffset(t,e){const n=t.formatToParts(e),i=[];for(let t=0;t<n.length;t++){const{type:e,value:r}=n[t],o=Ot[e];isUndefined(o)||(i[o]=parseInt(r,10))}return i}(n,e):function hackyOffset(t,e){const n=t.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n),[,r,o,a,s,l,u]=i;return[a,r,o,s,l,u]}(n,e),u=objToLocalTS({year:i,month:r,day:o,hour:a,minute:s,second:l,millisecond:0});let c=e.valueOf();return(u-(c-=c%1e3))/6e4}equals(t){return"iana"===t.type&&t.name===this.name}get isValid(){return this.valid}}let Pt=null;class FixedOffsetZone extends Zone{static get utcInstance(){return null===Pt&&(Pt=new FixedOffsetZone(0)),Pt}static instance(t){return 0===t?FixedOffsetZone.utcInstance:new FixedOffsetZone(t)}static parseSpecifier(t){if(t){const e=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(e)return new FixedOffsetZone(signedOffset(e[1],e[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${formatOffset(this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,e){return formatOffset(this.fixed,e)}get universal(){return!0}offset(){return this.fixed}equals(t){return"fixed"===t.type&&t.fixed===this.fixed}get isValid(){return!0}}class InvalidZone extends Zone{constructor(t){super(),this.zoneName=t}get type(){return"invalid"}get name(){return this.zoneName}get universal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function normalizeZone(t,e){let n;if(isUndefined(t)||null===t)return e;if(t instanceof Zone)return t;if(function isString(t){return"string"==typeof t}(t)){const i=t.toLowerCase();return"local"===i?e:"utc"===i||"gmt"===i?FixedOffsetZone.utcInstance:null!=(n=IANAZone.parseGMTOffset(t))?FixedOffsetZone.instance(n):IANAZone.isValidSpecifier(i)?IANAZone.create(t):FixedOffsetZone.parseSpecifier(i)||new InvalidZone(t)}return isNumber(t)?FixedOffsetZone.instance(t):"object"==typeof t&&t.offset&&"number"==typeof t.offset?t:new InvalidZone(t)}let now=()=>Date.now(),Ct=null,It=null,Lt=null,Rt=null,kt=!1;class Settings{static get now(){return now}static set now(t){now=t}static get defaultZoneName(){return Settings.defaultZone.name}static set defaultZoneName(t){Ct=t?normalizeZone(t):null}static get defaultZone(){return Ct||LocalZone.instance}static get defaultLocale(){return It}static set defaultLocale(t){It=t}static get defaultNumberingSystem(){return Lt}static set defaultNumberingSystem(t){Lt=t}static get defaultOutputCalendar(){return Rt}static set defaultOutputCalendar(t){Rt=t}static get throwOnInvalid(){return kt}static set throwOnInvalid(t){kt=t}static resetCaches(){Locale.resetCache(),IANAZone.resetCache()}}let At={};function getCachedDTF(t,e={}){const n=JSON.stringify([t,e]);let i=At[n];return i||(i=new Intl.DateTimeFormat(t,e),At[n]=i),i}let Dt={};let jt={};let Nt=null;function listStuff(t,e,n,i,r){const o=t.listingMode(n);return"error"===o?null:"en"===o?i(e):r(e)}class PolyNumberFormatter{constructor(t,e,n){if(this.padTo=n.padTo||0,this.floor=n.floor||!1,!e&&hasIntl()){const e={useGrouping:!1};n.padTo>0&&(e.minimumIntegerDigits=n.padTo),this.inf=function getCachedINF(t,e={}){const n=JSON.stringify([t,e]);let i=Dt[n];return i||(i=new Intl.NumberFormat(t,e),Dt[n]=i),i}(t,e)}}format(t){if(this.inf){const e=this.floor?Math.floor(t):t;return this.inf.format(e)}return padStart(this.floor?Math.floor(t):roundTo(t,3),this.padTo)}}class PolyDateFormatter{constructor(t,e,n){let i;if(this.opts=n,this.hasIntl=hasIntl(),t.zone.universal&&this.hasIntl?(i="UTC",n.timeZoneName?this.dt=t:this.dt=0===t.offset?t:DateTime.fromMillis(t.ts+60*t.offset*1e3)):"local"===t.zone.type?this.dt=t:(this.dt=t,i=t.zone.name),this.hasIntl){const t=Object.assign({},this.opts);i&&(t.timeZone=i),this.dtf=getCachedDTF(e,t)}}format(){if(this.hasIntl)return this.dtf.format(this.dt.toJSDate());{const t=function formatString(t){switch(stringify(pick(t,["weekday","era","year","month","day","hour","minute","second","timeZoneName","hour12"]))){case stringify(W):return"M/d/yyyy";case stringify(B):return"LLL d, yyyy";case stringify(Z):return"LLLL d, yyyy";case stringify(K):return"EEEE, LLLL d, yyyy";case stringify(Y):return"h:mm a";case stringify(H):return"h:mm:ss a";case stringify(X):case stringify($):return"h:mm a";case stringify(Q):return"HH:mm";case stringify(J):return"HH:mm:ss";case stringify(tt):case stringify(et):return"HH:mm";case stringify(nt):return"M/d/yyyy, h:mm a";case stringify(rt):return"LLL d, yyyy, h:mm a";case stringify(st):return"LLLL d, yyyy, h:mm a";case stringify(ut):return"EEEE, LLLL d, yyyy, h:mm a";case stringify(it):return"M/d/yyyy, h:mm:ss a";case stringify(ot):return"LLL d, yyyy, h:mm:ss a";case stringify(at):return"EEE, d LLL yyyy, h:mm a";case stringify(lt):return"LLLL d, yyyy, h:mm:ss a";case stringify(ct):return"EEEE, LLLL d, yyyy, h:mm:ss a";default:return"EEEE, LLLL d, yyyy, h:mm a"}}(this.opts),e=Locale.create("en-US");return Formatter.create(e).formatDateTimeFromString(this.dt,t)}}formatToParts(){return this.hasIntl&&hasFormatToParts()?this.dtf.formatToParts(this.dt.toJSDate()):[]}resolvedOptions(){return this.hasIntl?this.dtf.resolvedOptions():{locale:"en-US",numberingSystem:"latn",outputCalendar:"gregory"}}}class PolyRelFormatter{constructor(t,e,n){this.opts=Object.assign({style:"long"},n),!e&&hasRelative()&&(this.rtf=function getCachedRTF(t,e={}){const n=JSON.stringify([t,e]);let i=jt[n];return i||(i=new Intl.RelativeTimeFormat(t,e),jt[n]=i),i}(t,n))}format(t,e){return this.rtf?this.rtf.format(t,e):function formatRelativeTime(t,e,n="always",i=!1){const r={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=-1===["hours","minutes","seconds"].indexOf(t);if("auto"===n&&o){const n="days"===t;switch(e){case 1:return n?"tomorrow":`next ${r[t][0]}`;case-1:return n?"yesterday":`last ${r[t][0]}`;case 0:return n?"today":`this ${r[t][0]}`}}const a=Object.is(e,-0)||e<0,s=Math.abs(e),l=1===s,u=r[t],c=i?l?u[1]:u[2]||u[1]:l?r[t][0]:t;return a?`${s} ${c} ago`:`in ${s} ${c}`}(e,t,this.opts.numeric,"long"!==this.opts.style)}formatToParts(t,e){return this.rtf?this.rtf.formatToParts(t,e):[]}}class Locale{static fromOpts(t){return Locale.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)}static create(t,e,n,i=!1){const r=t||Settings.defaultLocale,o=r||(i?"en-US":function systemLocale(){if(Nt)return Nt;if(hasIntl()){const t=(new Intl.DateTimeFormat).resolvedOptions().locale;return Nt=t&&"und"!==t?t:"en-US"}return Nt="en-US"}()),a=e||Settings.defaultNumberingSystem,s=n||Settings.defaultOutputCalendar;return new Locale(o,a,s,r)}static resetCache(){Nt=null,At={},Dt={},jt={}}static fromObject({locale:t,numberingSystem:e,outputCalendar:n}={}){return Locale.create(t,e,n)}constructor(t,e,n,i){const[r,o,a]=function parseLocaleString(t){const e=t.indexOf("-u-");if(-1===e)return[t];{let n;const i=t.substring(0,e);try{n=getCachedDTF(t).resolvedOptions()}catch(t){n=getCachedDTF(i).resolvedOptions()}const{numberingSystem:r,calendar:o}=n;return[i,r,o]}}(t);this.locale=r,this.numberingSystem=e||o||null,this.outputCalendar=n||a||null,this.intl=function intlConfigString(t,e,n){return hasIntl()?n||e?(t+="-u",n&&(t+=`-ca-${n}`),e&&(t+=`-nu-${e}`),t):t:[]}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=i,this.fastNumbersCached=null}get fastNumbers(){return null==this.fastNumbersCached&&(this.fastNumbersCached=function supportsFastNumbers(t){return(!t.numberingSystem||"latn"===t.numberingSystem)&&("latn"===t.numberingSystem||!t.locale||t.locale.startsWith("en")||hasIntl()&&"latn"===new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem)}(this)),this.fastNumbersCached}listingMode(t=!0){const e=hasIntl()&&hasFormatToParts(),n=this.isEnglish(),i=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e||n&&i||t?!e||n&&i?"en":"intl":"error"}clone(t){return t&&0!==Object.getOwnPropertyNames(t).length?Locale.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1):this}redefaultToEN(t={}){return this.clone(Object.assign({},t,{defaultToEN:!0}))}redefaultToSystem(t={}){return this.clone(Object.assign({},t,{defaultToEN:!1}))}months(t,e=!1,n=!0){return listStuff(this,t,n,months,()=>{const n=e?{month:t,day:"numeric"}:{month:t},i=e?"format":"standalone";return this.monthsCache[i][t]||(this.monthsCache[i][t]=function mapMonths(t){const e=[];for(let n=1;n<=12;n++){const i=DateTime.utc(2016,n,1);e.push(t(i))}return e}(t=>this.extract(t,n,"month"))),this.monthsCache[i][t]})}weekdays(t,e=!1,n=!0){return listStuff(this,t,n,weekdays,()=>{const n=e?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},i=e?"format":"standalone";return this.weekdaysCache[i][t]||(this.weekdaysCache[i][t]=function mapWeekdays(t){const e=[];for(let n=1;n<=7;n++){const i=DateTime.utc(2016,11,13+n);e.push(t(i))}return e}(t=>this.extract(t,n,"weekday"))),this.weekdaysCache[i][t]})}meridiems(t=!0){return listStuff(this,void 0,t,()=>vt,()=>{if(!this.meridiemCache){const t={hour:"numeric",hour12:!0};this.meridiemCache=[DateTime.utc(2016,11,13,9),DateTime.utc(2016,11,13,19)].map(e=>this.extract(e,t,"dayperiod"))}return this.meridiemCache})}eras(t,e=!0){return listStuff(this,t,e,eras,()=>{const e={era:t};return this.eraCache[t]||(this.eraCache[t]=[DateTime.utc(-40,1,1),DateTime.utc(2017,1,1)].map(t=>this.extract(t,e,"era"))),this.eraCache[t]})}extract(t,e,n){const i=this.dtFormatter(t,e).formatToParts().find(t=>t.type.toLowerCase()===n);return i?i.value:null}numberFormatter(t={}){return new PolyNumberFormatter(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,e={}){return new PolyDateFormatter(t,this.intl,e)}relFormatter(t={}){return new PolyRelFormatter(this.intl,this.isEnglish(),t)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||hasIntl()&&new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}}function combineRegexes(...t){const e=t.reduce((t,e)=>t+e.source,"");return RegExp(`^${e}$`)}function combineExtractors(...t){return e=>t.reduce(([t,n,i],r)=>{const[o,a,s]=r(e,i);return[Object.assign(t,o),n||a,s]},[{},null,1]).slice(0,2)}function parse(t,...e){if(null==t)return[null,null];for(const[n,i]of e){const e=n.exec(t);if(e)return i(e)}return[null,null]}function simpleParse(...t){return(e,n)=>{const i={};let r;for(r=0;r<t.length;r++)i[t[r]]=parseInteger(e[n+r]);return[i,null,n+r]}}const Ft=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Ut=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,9}))?)?)?/,Vt=RegExp(`${Ut.source}${Ft.source}?`),zt=RegExp(`(?:T${Vt.source})?`),Gt=simpleParse("weekYear","weekNumber","weekDay"),qt=simpleParse("year","ordinal"),Wt=RegExp(`${Ut.source} ?(?:${Ft.source}|(${ht.source}))?`),Bt=RegExp(`(?: ${Wt.source})?`);function int(t,e,n){const i=t[e];return isUndefined(i)?n:parseInteger(i)}function extractISOYmd(t,e){return[{year:int(t,e),month:int(t,e+1,1),day:int(t,e+2,1)},null,e+3]}function extractISOTime(t,e){return[{hour:int(t,e,0),minute:int(t,e+1,0),second:int(t,e+2,0),millisecond:parseMillis(t[e+3])},null,e+4]}function extractISOOffset(t,e){const n=!t[e]&&!t[e+1],i=signedOffset(t[e+1],t[e+2]);return[{},n?null:FixedOffsetZone.instance(i),e+3]}function extractIANAZone(t,e){return[{},t[e]?IANAZone.create(t[e]):null,e+1]}const Zt=/^P(?:(?:(-?\d{1,9})Y)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})W)?(?:(-?\d{1,9})D)?(?:T(?:(-?\d{1,9})H)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})(?:[.,](-?\d{1,9}))?S)?)?)$/;function extractISODuration(t){const[,e,n,i,r,o,a,s,l]=t;return[{years:parseInteger(e),months:parseInteger(n),weeks:parseInteger(i),days:parseInteger(r),hours:parseInteger(o),minutes:parseInteger(a),seconds:parseInteger(s),milliseconds:parseMillis(l)}]}const Kt={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function fromStrings(t,e,n,i,r,o,a){const s={year:2===e.length?untruncateYear(parseInteger(e)):parseInteger(e),month:pt.indexOf(n)+1,day:parseInteger(i),hour:parseInteger(r),minute:parseInteger(o)};return a&&(s.second=parseInteger(a)),t&&(s.weekday=t.length>3?mt.indexOf(t)+1:yt.indexOf(t)+1),s}const Yt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(t){const[,e,n,i,r,o,a,s,l,u,c,h]=t,d=fromStrings(e,r,i,n,o,a,s);let p;return p=l?Kt[l]:u?0:signedOffset(c,h),[d,new FixedOffsetZone(p)]}const Ht=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Xt=/^(Monday|Tuesday|Wedsday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,$t=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(t){const[,e,n,i,r,o,a,s]=t;return[fromStrings(e,r,i,n,o,a,s),FixedOffsetZone.utcInstance]}function extractASCII(t){const[,e,n,i,r,o,a,s]=t;return[fromStrings(e,s,n,i,r,o,a),FixedOffsetZone.utcInstance]}const Qt=combineRegexes(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,zt),Jt=combineRegexes(/(\d{4})-?W(\d\d)(?:-?(\d))?/,zt),te=combineRegexes(/(\d{4})-?(\d{3})/,zt),ee=combineRegexes(Vt),ne=combineExtractors(extractISOYmd,extractISOTime,extractISOOffset),ie=combineExtractors(Gt,extractISOTime,extractISOOffset),re=combineExtractors(qt,extractISOTime),oe=combineExtractors(extractISOTime,extractISOOffset);const ae=combineRegexes(/(\d{4})-(\d\d)-(\d\d)/,Bt),se=combineRegexes(Wt),le=combineExtractors(extractISOYmd,extractISOTime,extractISOOffset,extractIANAZone),ue=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);const ce="Invalid Duration",he={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},de=Object.assign({years:{months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},he),pe=Object.assign({years:{months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},he),fe=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],me=fe.slice(0).reverse();function clone$1(t,e,n=!1){const i={values:n?e.values:Object.assign({},t.values,e.values||{}),loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy};return new Duration(i)}function convert(t,e,n,i,r){const o=t[r][n],a=e[n]/o,s=!(Math.sign(a)===Math.sign(i[r]))&&0!==i[r]&&Math.abs(a)<=1?function antiTrunc(t){return t<0?Math.floor(t):Math.ceil(t)}(a):Math.trunc(a);i[r]+=s,e[n]-=s*o}function normalizeValues(t,e){me.reduce((n,i)=>isUndefined(e[i])?n:(n&&convert(t,e,n,e,i),i),null)}class Duration{constructor(t){const e="longterm"===t.conversionAccuracy||!1;this.values=t.values,this.loc=t.loc||Locale.create(),this.conversionAccuracy=e?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=e?pe:de,this.isLuxonDuration=!0}static fromMillis(t,e){return Duration.fromObject(Object.assign({milliseconds:t},e))}static fromObject(t){if(null==t||"object"!=typeof t)throw new InvalidArgumentError(`Duration.fromObject: argument expected to be an object, got ${null===t?"null":typeof t}`);return new Duration({values:normalizeObject(t,Duration.normalizeUnit,["locale","numberingSystem","conversionAccuracy","zone"]),loc:Locale.fromObject(t),conversionAccuracy:t.conversionAccuracy})}static fromISO(t,e){const[n]=function parseISODuration(t){return parse(t,[Zt,extractISODuration])}(t);if(n){const t=Object.assign(n,e);return Duration.fromObject(t)}return Duration.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,e=null){if(!t)throw new InvalidArgumentError("need to specify a reason the Duration is invalid");const n=t instanceof Invalid?t:new Invalid(t,e);if(Settings.throwOnInvalid)throw new InvalidDurationError(n);return new Duration({invalid:n})}static normalizeUnit(t){const e={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t?t.toLowerCase():t];if(!e)throw new InvalidUnitError(t);return e}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,e={}){const n=Object.assign({},e,{floor:!1!==e.round&&!1!==e.floor});return this.isValid?Formatter.create(this.loc,n).formatDurationFromString(this,t):ce}toObject(t={}){if(!this.isValid)return{};const e=Object.assign({},this.values);return t.includeConfig&&(e.conversionAccuracy=this.conversionAccuracy,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e}toISO(){if(!this.isValid)return null;let t="P";return 0!==this.years&&(t+=this.years+"Y"),0===this.months&&0===this.quarters||(t+=this.months+3*this.quarters+"M"),0!==this.weeks&&(t+=this.weeks+"W"),0!==this.days&&(t+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(t+="T"),0!==this.hours&&(t+=this.hours+"H"),0!==this.minutes&&(t+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(t+=roundTo(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===t&&(t+="T0S"),t}toJSON(){return this.toISO()}toString(){return this.toISO()}valueOf(){return this.as("milliseconds")}plus(t){if(!this.isValid)return this;const e=friendlyDuration(t),n={};for(const t of fe)(hasOwnProperty(e.values,t)||hasOwnProperty(this.values,t))&&(n[t]=e.get(t)+this.get(t));return clone$1(this,{values:n},!0)}minus(t){if(!this.isValid)return this;const e=friendlyDuration(t);return this.plus(e.negate())}mapUnits(t){if(!this.isValid)return this;const e={};for(const n of Object.keys(this.values))e[n]=asNumber(t(this.values[n],n));return clone$1(this,{values:e},!0)}get(t){return this[Duration.normalizeUnit(t)]}set(t){if(!this.isValid)return this;return clone$1(this,{values:Object.assign(this.values,normalizeObject(t,Duration.normalizeUnit,[]))})}reconfigure({locale:t,numberingSystem:e,conversionAccuracy:n}={}){const i={loc:this.loc.clone({locale:t,numberingSystem:e})};return n&&(i.conversionAccuracy=n),clone$1(this,i)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;const t=this.toObject();return normalizeValues(this.matrix,t),clone$1(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(0===t.length)return this;t=t.map(t=>Duration.normalizeUnit(t));const e={},n={},i=this.toObject();let r;normalizeValues(this.matrix,i);for(const o of fe)if(t.indexOf(o)>=0){r=o;let t=0;for(const e in n)t+=this.matrix[e][o]*n[e],n[e]=0;isNumber(i[o])&&(t+=i[o]);const a=Math.trunc(t);e[o]=a,n[o]=t-a;for(const t in i)fe.indexOf(t)>fe.indexOf(o)&&convert(this.matrix,i,t,e,o)}else isNumber(i[o])&&(n[o]=i[o]);for(const t in n)0!==n[t]&&(e[r]+=t===r?n[t]:n[t]/this.matrix[r][t]);return clone$1(this,{values:e},!0).normalize()}negate(){if(!this.isValid)return this;const t={};for(const e of Object.keys(this.values))t[e]=-this.values[e];return clone$1(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid)return!1;if(!this.loc.equals(t.loc))return!1;for(const e of fe)if(this.values[e]!==t.values[e])return!1;return!0}}function friendlyDuration(t){if(isNumber(t))return Duration.fromMillis(t);if(Duration.isDuration(t))return t;if("object"==typeof t)return Duration.fromObject(t);throw new InvalidArgumentError(`Unknown duration argument ${t} of type ${typeof t}`)}const ye="Invalid Interval";class Interval{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,e=null){if(!t)throw new InvalidArgumentError("need to specify a reason the Interval is invalid");const n=t instanceof Invalid?t:new Invalid(t,e);if(Settings.throwOnInvalid)throw new InvalidIntervalError(n);return new Interval({invalid:n})}static fromDateTimes(t,e){const n=friendlyDateTime(t),i=friendlyDateTime(e),r=function validateStartEnd(t,e){return t&&t.isValid?e&&e.isValid?e<t?Interval.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null:Interval.invalid("missing or invalid end"):Interval.invalid("missing or invalid start")}(n,i);return null==r?new Interval({start:n,end:i}):r}static after(t,e){const n=friendlyDuration(e),i=friendlyDateTime(t);return Interval.fromDateTimes(i,i.plus(n))}static before(t,e){const n=friendlyDuration(e),i=friendlyDateTime(t);return Interval.fromDateTimes(i.minus(n),i)}static fromISO(t,e){const[n,i]=(t||"").split("/",2);if(n&&i){const t=DateTime.fromISO(n,e),r=DateTime.fromISO(i,e);if(t.isValid&&r.isValid)return Interval.fromDateTimes(t,r);if(t.isValid){const n=Duration.fromISO(i,e);if(n.isValid)return Interval.after(t,n)}else if(r.isValid){const t=Duration.fromISO(n,e);if(t.isValid)return Interval.before(r,t)}}return Interval.invalid("unparsable",`the input "${t}" can't be parsed asISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds"){if(!this.isValid)return NaN;const e=this.start.startOf(t),n=this.end.startOf(t);return Math.floor(n.diff(e,t).get(t))+1}hasSame(t){return!!this.isValid&&this.e.minus(1).hasSame(this.s,t)}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return!!this.isValid&&this.s>t}isBefore(t){return!!this.isValid&&this.e<=t}contains(t){return!!this.isValid&&(this.s<=t&&this.e>t)}set({start:t,end:e}={}){return this.isValid?Interval.fromDateTimes(t||this.s,e||this.e):this}splitAt(...t){if(!this.isValid)return[];const e=t.map(friendlyDateTime).filter(t=>this.contains(t)).sort(),n=[];let{s:i}=this,r=0;for(;i<this.e;){const t=e[r]||this.e,o=+t>+this.e?this.e:t;n.push(Interval.fromDateTimes(i,o)),i=o,r+=1}return n}splitBy(t){const e=friendlyDuration(t);if(!this.isValid||!e.isValid||0===e.as("milliseconds"))return[];let n,i,{s:r}=this;const o=[];for(;r<this.e;)i=+(n=r.plus(e))>+this.e?this.e:n,o.push(Interval.fromDateTimes(r,i)),r=i;return o}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return!!this.isValid&&+this.e==+t.s}abutsEnd(t){return!!this.isValid&&+t.e==+this.s}engulfs(t){return!!this.isValid&&(this.s<=t.s&&this.e>=t.e)}equals(t){return!(!this.isValid||!t.isValid)&&(this.s.equals(t.s)&&this.e.equals(t.e))}intersection(t){if(!this.isValid)return this;const e=this.s>t.s?this.s:t.s,n=this.e<t.e?this.e:t.e;return e>n?null:Interval.fromDateTimes(e,n)}union(t){if(!this.isValid)return this;const e=this.s<t.s?this.s:t.s,n=this.e>t.e?this.e:t.e;return Interval.fromDateTimes(e,n)}static merge(t){const[e,n]=t.sort((t,e)=>t.s-e.s).reduce(([t,e],n)=>e?e.overlaps(n)||e.abutsStart(n)?[t,e.union(n)]:[t.concat([e]),n]:[t,n],[[],null]);return n&&e.push(n),e}static xor(t){let e=null,n=0;const i=[],r=t.map(t=>[{time:t.s,type:"s"},{time:t.e,type:"e"}]),o=Array.prototype.concat(...r).sort((t,e)=>t.time-e.time);for(const t of o)1===(n+="s"===t.type?1:-1)?e=t.time:(e&&+e!=+t.time&&i.push(Interval.fromDateTimes(e,t.time)),e=null);return Interval.merge(i)}difference(...t){return Interval.xor([this].concat(t)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:ye}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:ye}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:ye}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:ye}toFormat(t,{separator:e=" – "}={}){return this.isValid?`${this.s.toFormat(t)}${e}${this.e.toFormat(t)}`:ye}toDuration(t,e){return this.isValid?this.e.diff(this.s,t,e):Duration.invalid(this.invalidReason)}mapEndpoints(t){return Interval.fromDateTimes(t(this.s),t(this.e))}}class Info{static hasDST(t=Settings.defaultZone){const e=DateTime.local().setZone(t).set({month:12});return!t.universal&&e.offset!==e.set({month:6}).offset}static isValidIANAZone(t){return IANAZone.isValidSpecifier(t)&&IANAZone.isValidZone(t)}static normalizeZone(t){return normalizeZone(t,Settings.defaultZone)}static months(t="long",{locale:e=null,numberingSystem:n=null,outputCalendar:i="gregory"}={}){return Locale.create(e,n,i).months(t)}static monthsFormat(t="long",{locale:e=null,numberingSystem:n=null,outputCalendar:i="gregory"}={}){return Locale.create(e,n,i).months(t,!0)}static weekdays(t="long",{locale:e=null,numberingSystem:n=null}={}){return Locale.create(e,n,null).weekdays(t)}static weekdaysFormat(t="long",{locale:e=null,numberingSystem:n=null}={}){return Locale.create(e,n,null).weekdays(t,!0)}static meridiems({locale:t=null}={}){return Locale.create(t).meridiems()}static eras(t="short",{locale:e=null}={}){return Locale.create(e,null,"gregory").eras(t)}static features(){let t=!1,e=!1,n=!1,i=!1;if(hasIntl()){t=!0,e=hasFormatToParts(),i=hasRelative();try{n="America/New_York"===new Intl.DateTimeFormat("en",{timeZone:"America/New_York"}).resolvedOptions().timeZone}catch(t){n=!1}}return{intl:t,intlTokens:e,zones:n,relative:i}}}function dayDiff(t,e){const utcDayStart=t=>t.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),n=utcDayStart(e)-utcDayStart(t);return Math.floor(Duration.fromMillis(n).as("days"))}function diff(t,e,n,i){let[r,o,a,s]=function highOrderDiffs(t,e,n){const i=[["years",(t,e)=>e.year-t.year],["months",(t,e)=>e.month-t.month+12*(e.year-t.year)],["weeks",(t,e)=>{const n=dayDiff(t,e);return(n-n%7)/7}],["days",dayDiff]],r={};let o,a;for(const[s,l]of i)if(n.indexOf(s)>=0){o=s;let n=l(t,e);(a=t.plus({[s]:n}))>e?(t=t.plus({[s]:n-1}),n-=1):t=a,r[s]=n}return[t,r,a,o]}(t,e,n);const l=e-r,u=n.filter(t=>["hours","minutes","seconds","milliseconds"].indexOf(t)>=0);0===u.length&&(a<e&&(a=r.plus({[s]:1})),a!==r&&(o[s]=(o[s]||0)+l/(a-r)));const c=Duration.fromObject(Object.assign(o,i));return u.length>0?Duration.fromMillis(l,i).shiftTo(...u).plus(c):c}const ge={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},ve={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},_e=ge.hanidec.replace(/[\[|\]]/g,"").split("");function digitRegex({numberingSystem:t},e=""){return new RegExp(`${ge[t||"latn"]}${e}`)}const be="missing Intl.DateTimeFormat.formatToParts support";function intUnit(t,e=(t=>t)){return{regex:t,deser:([t])=>e(function parseDigits(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);if(-1!==t[n].search(ge.hanidec))e+=_e.indexOf(t[n]);else for(const t in ve){const[n,r]=ve[t];i>=n&&i<=r&&(e+=i-n)}}return parseInt(e,10)}return e}(t))}}function fixListRegex(t){return t.replace(/\./,"\\.?")}function stripInsensitivities(t){return t.replace(/\./,"").toLowerCase()}function oneOf(t,e){return null===t?null:{regex:RegExp(t.map(fixListRegex).join("|")),deser:([n])=>t.findIndex(t=>stripInsensitivities(n)===stripInsensitivities(t))+e}}function offset(t,e){return{regex:t,deser:([,t,e])=>signedOffset(t,e),groups:e}}function simple(t){return{regex:t,deser:([t])=>t}}function escapeToken(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}const Te={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}};let we=null;function maybeExpandMacroToken(t,e){if(t.literal)return t;const n=Formatter.macroTokenToFormatOpts(t.val);if(!n)return t;const i=Formatter.create(e,n).formatDateTimeParts(function getDummyDateTime(){return we||(we=DateTime.fromMillis(1555555555555)),we}()).map(t=>(function tokenForPart(t,e,n){const{type:i,value:r}=t;if("literal"===i)return{literal:!0,val:r};const o=n[i];let a=Te[i];return"object"==typeof a&&(a=a[o]),a?{literal:!1,val:a}:void 0})(t,0,n));return i.includes(void 0)?t:i}function explainFromTokens(t,e,n){const i=function expandMacroTokens(t,e){return Array.prototype.concat(...t.map(t=>maybeExpandMacroToken(t,e)))}(Formatter.parseFormat(n),t),r=i.map(e=>(function unitForToken(t,e){const n=digitRegex(e),i=digitRegex(e,"{2}"),r=digitRegex(e,"{3}"),o=digitRegex(e,"{4}"),a=digitRegex(e,"{6}"),s=digitRegex(e,"{1,2}"),l=digitRegex(e,"{1,3}"),u=digitRegex(e,"{1,6}"),c=digitRegex(e,"{1,9}"),h=digitRegex(e,"{2,4}"),d=digitRegex(e,"{4,6}"),literal=t=>({regex:RegExp(escapeToken(t.val)),deser:([t])=>t,literal:!0}),p=(p=>{if(t.literal)return literal(p);switch(p.val){case"G":return oneOf(e.eras("short",!1),0);case"GG":return oneOf(e.eras("long",!1),0);case"y":return intUnit(u);case"yy":return intUnit(h,untruncateYear);case"yyyy":return intUnit(o);case"yyyyy":return intUnit(d);case"yyyyyy":return intUnit(a);case"M":return intUnit(s);case"MM":return intUnit(i);case"MMM":return oneOf(e.months("short",!0,!1),1);case"MMMM":return oneOf(e.months("long",!0,!1),1);case"L":return intUnit(s);case"LL":return intUnit(i);case"LLL":return oneOf(e.months("short",!1,!1),1);case"LLLL":return oneOf(e.months("long",!1,!1),1);case"d":return intUnit(s);case"dd":return intUnit(i);case"o":return intUnit(l);case"ooo":return intUnit(r);case"HH":return intUnit(i);case"H":return intUnit(s);case"hh":return intUnit(i);case"h":return intUnit(s);case"mm":return intUnit(i);case"m":case"q":return intUnit(s);case"qq":return intUnit(i);case"s":return intUnit(s);case"ss":return intUnit(i);case"S":return intUnit(l);case"SSS":return intUnit(r);case"u":return simple(c);case"a":return oneOf(e.meridiems(),0);case"kkkk":return intUnit(o);case"kk":return intUnit(h,untruncateYear);case"W":return intUnit(s);case"WW":return intUnit(i);case"E":case"c":return intUnit(n);case"EEE":return oneOf(e.weekdays("short",!1,!1),1);case"EEEE":return oneOf(e.weekdays("long",!1,!1),1);case"ccc":return oneOf(e.weekdays("short",!0,!1),1);case"cccc":return oneOf(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return offset(new RegExp(`([+-]${s.source})(?::(${i.source}))?`),2);case"ZZZ":return offset(new RegExp(`([+-]${s.source})(${i.source})?`),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);default:return literal(p)}})(t)||{invalidReason:be};return p.token=t,p})(e,t)),o=r.find(t=>t.invalidReason);if(o)return{input:e,tokens:i,invalidReason:o.invalidReason};{const[t,n]=function buildRegex(t){return[`^${t.map(t=>t.regex).reduce((t,e)=>`${t}(${e.source})`,"")}$`,t]}(r),o=RegExp(t,"i"),[a,s]=function match(t,e,n){const i=t.match(e);if(i){const t={};let e=1;for(const r in n)if(hasOwnProperty(n,r)){const o=n[r],a=o.groups?o.groups+1:1;!o.literal&&o.token&&(t[o.token.val[0]]=o.deser(i.slice(e,e+a))),e+=a}return[i,t]}return[i,{}]}(e,o,n),[l,u]=s?function dateTimeFromMatches(t){let e;return e=isUndefined(t.Z)?isUndefined(t.z)?null:IANAZone.create(t.z):new FixedOffsetZone(t.Z),isUndefined(t.q)||(t.M=3*(t.q-1)+1),isUndefined(t.h)||(t.h<12&&1===t.a?t.h+=12:12===t.h&&0===t.a&&(t.h=0)),0===t.G&&t.y&&(t.y=-t.y),isUndefined(t.u)||(t.S=parseMillis(t.u)),[Object.keys(t).reduce((e,n)=>{const i=(t=>{switch(t){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})(n);return i&&(e[i]=t[n]),e},{}),e]}(s):[null,null];return{input:e,tokens:i,regex:o,rawMatches:a,matches:s,result:l,zone:u}}}const Ee=[0,31,59,90,120,151,181,212,243,273,304,334],Se=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(t,e){return new Invalid("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function dayOfWeek(t,e,n){const i=new Date(Date.UTC(t,e-1,n)).getUTCDay();return 0===i?7:i}function computeOrdinal(t,e,n){return n+(isLeapYear(t)?Se:Ee)[e-1]}function uncomputeOrdinal(t,e){const n=isLeapYear(t)?Se:Ee,i=n.findIndex(t=>t<e);return{month:i+1,day:e-n[i]}}function gregorianToWeek(t){const{year:e,month:n,day:i}=t,r=computeOrdinal(e,n,i),o=dayOfWeek(e,n,i);let a,s=Math.floor((r-o+10)/7);return s<1?s=weeksInWeekYear(a=e-1):s>weeksInWeekYear(e)?(a=e+1,s=1):a=e,Object.assign({weekYear:a,weekNumber:s,weekday:o},timeObject(t))}function weekToGregorian(t){const{weekYear:e,weekNumber:n,weekday:i}=t,r=dayOfWeek(e,1,4),o=daysInYear(e);let a,s=7*n+i-r-3;s<1?s+=daysInYear(a=e-1):s>o?(a=e+1,s-=daysInYear(e)):a=e;const{month:l,day:u}=uncomputeOrdinal(a,s);return Object.assign({year:a,month:l,day:u},timeObject(t))}function gregorianToOrdinal(t){const{year:e,month:n,day:i}=t,r=computeOrdinal(e,n,i);return Object.assign({year:e,ordinal:r},timeObject(t))}function ordinalToGregorian(t){const{year:e,ordinal:n}=t,{month:i,day:r}=uncomputeOrdinal(e,n);return Object.assign({year:e,month:i,day:r},timeObject(t))}function hasInvalidGregorianData(t){const e=isInteger(t.year),n=integerBetween(t.month,1,12),i=integerBetween(t.day,1,daysInMonth(t.year,t.month));return e?n?!i&&unitOutOfRange("day",t.day):unitOutOfRange("month",t.month):unitOutOfRange("year",t.year)}function hasInvalidTimeData(t){const{hour:e,minute:n,second:i,millisecond:r}=t,o=integerBetween(e,0,23)||24===e&&0===n&&0===i&&0===r,a=integerBetween(n,0,59),s=integerBetween(i,0,59),l=integerBetween(r,0,999);return o?a?s?!l&&unitOutOfRange("millisecond",r):unitOutOfRange("second",i):unitOutOfRange("minute",n):unitOutOfRange("hour",e)}const Me="Invalid DateTime",Oe=864e13;function unsupportedZone(t){return new Invalid("unsupported zone",`the zone "${t.name}" is not supported`)}function possiblyCachedWeekData(t){return null===t.weekData&&(t.weekData=gregorianToWeek(t.c)),t.weekData}function clone$2(t,e){const n={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new DateTime(Object.assign({},n,e,{old:n}))}function fixOffset(t,e,n){let i=t-60*e*1e3;const r=n.offset(i);if(e===r)return[i,e];i-=60*(r-e)*1e3;const o=n.offset(i);return r===o?[i,r]:[t-60*Math.min(r,o)*1e3,Math.max(r,o)]}function tsToObj(t,e){const n=new Date(t+=60*e*1e3);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function objToTS(t,e,n){return fixOffset(objToLocalTS(t),e,n)}function adjustTime(t,e){const n=Object.keys(e.values);-1===n.indexOf("milliseconds")&&n.push("milliseconds"),e=e.shiftTo(...n);const i=t.o,r=t.c.year+e.years,o=t.c.month+e.months+3*e.quarters,a=Object.assign({},t.c,{year:r,month:o,day:Math.min(t.c.day,daysInMonth(r,o))+e.days+7*e.weeks}),s=Duration.fromObject({hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),l=objToLocalTS(a);let[u,c]=fixOffset(l,i,t.zone);return 0!==s&&(u+=s,c=t.zone.offset(u)),{ts:u,o:c}}function parseDataToDateTime(t,e,n,i,r){const{setZone:o,zone:a}=n;if(t&&0!==Object.keys(t).length){const i=e||a,r=DateTime.fromObject(Object.assign(t,n,{zone:i,setZone:void 0}));return o?r:r.setZone(a)}return DateTime.invalid(new Invalid("unparsable",`the input "${r}" can't be parsed as ${i}`))}function toTechFormat(t,e){return t.isValid?Formatter.create(Locale.create("en-US"),{allowZ:!0,forceSimple:!0}).formatDateTimeFromString(t,e):null}function toTechTimeFormat(t,{suppressSeconds:e=!1,suppressMilliseconds:n=!1,includeOffset:i,includeZone:r=!1,spaceZone:o=!1}){let a="HH:mm";return e&&0===t.second&&0===t.millisecond||(a+=":ss",n&&0===t.millisecond||(a+=".SSS")),(r||i)&&o&&(a+=" "),r?a+="z":i&&(a+="ZZ"),toTechFormat(t,a)}const xe={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Pe={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Ce={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Ie=["year","month","day","hour","minute","second","millisecond"],Le=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Re=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnit(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new InvalidUnitError(t);return e}function quickDT(t,e){for(const e of Ie)isUndefined(t[e])&&(t[e]=xe[e]);const n=hasInvalidGregorianData(t)||hasInvalidTimeData(t);if(n)return DateTime.invalid(n);const i=Settings.now(),r=e.offset(i),[o,a]=objToTS(t,r,e);return new DateTime({ts:o,zone:e,o:a})}function diffRelative(t,e,n){const i=!!isUndefined(n.round)||n.round,format=(t,r)=>{return t=roundTo(t,i||n.calendary?0:2,!0),e.loc.clone(n).relFormatter(n).format(t,r)},differ=i=>n.calendary?e.hasSame(t,i)?0:e.startOf(i).diff(t.startOf(i),i).get(i):e.diff(t,i).get(i);if(n.unit)return format(differ(n.unit),n.unit);for(const t of n.units){const e=differ(t);if(Math.abs(e)>=1)return format(e,t)}return format(0,n.units[n.units.length-1])}class DateTime{constructor(t){const e=t.zone||Settings.defaultZone;let n=t.invalid||(Number.isNaN(t.ts)?new Invalid("invalid input"):null)||(e.isValid?null:unsupportedZone(e));this.ts=isUndefined(t.ts)?Settings.now():t.ts;let i=null,r=null;if(!n){t.old&&t.old.ts===this.ts&&t.old.zone.equals(e)?[i,r]=[t.old.c,t.old.o]:(i=tsToObj(this.ts,e.offset(this.ts)),i=(n=Number.isNaN(i.year)?new Invalid("invalid input"):null)?null:i,r=n?null:e.offset(this.ts))}this._zone=e,this.loc=t.loc||Locale.create(),this.invalid=n,this.weekData=null,this.c=i,this.o=r,this.isLuxonDateTime=!0}static local(t,e,n,i,r,o,a){return isUndefined(t)?new DateTime({ts:Settings.now()}):quickDT({year:t,month:e,day:n,hour:i,minute:r,second:o,millisecond:a},Settings.defaultZone)}static utc(t,e,n,i,r,o,a){return isUndefined(t)?new DateTime({ts:Settings.now(),zone:FixedOffsetZone.utcInstance}):quickDT({year:t,month:e,day:n,hour:i,minute:r,second:o,millisecond:a},FixedOffsetZone.utcInstance)}static fromJSDate(t,e={}){const n=function isDate(t){return"[object Date]"===Object.prototype.toString.call(t)}(t)?t.valueOf():NaN;if(Number.isNaN(n))return DateTime.invalid("invalid input");const i=normalizeZone(e.zone,Settings.defaultZone);return i.isValid?new DateTime({ts:n,zone:i,loc:Locale.fromObject(e)}):DateTime.invalid(unsupportedZone(i))}static fromMillis(t,e={}){if(isNumber(t))return t<-Oe||t>Oe?DateTime.invalid("Timestamp out of range"):new DateTime({ts:t,zone:normalizeZone(e.zone,Settings.defaultZone),loc:Locale.fromObject(e)});throw new InvalidArgumentError("fromMillis requires a numerical input")}static fromSeconds(t,e={}){if(isNumber(t))return new DateTime({ts:1e3*t,zone:normalizeZone(e.zone,Settings.defaultZone),loc:Locale.fromObject(e)});throw new InvalidArgumentError("fromSeconds requires a numerical input")}static fromObject(t){const e=normalizeZone(t.zone,Settings.defaultZone);if(!e.isValid)return DateTime.invalid(unsupportedZone(e));const n=Settings.now(),i=e.offset(n),r=normalizeObject(t,normalizeUnit,["zone","locale","outputCalendar","numberingSystem"]),o=!isUndefined(r.ordinal),a=!isUndefined(r.year),s=!isUndefined(r.month)||!isUndefined(r.day),l=a||s,u=r.weekYear||r.weekNumber,c=Locale.fromObject(t);if((l||o)&&u)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(s&&o)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");const h=u||r.weekday&&!l;let d,p,f=tsToObj(n,i);h?(d=Le,p=Pe,f=gregorianToWeek(f)):o?(d=Re,p=Ce,f=gregorianToOrdinal(f)):(d=Ie,p=xe);let m=!1;for(const t of d){isUndefined(r[t])?r[t]=m?p[t]:f[t]:m=!0}const y=(h?function hasInvalidWeekData(t){const e=isInteger(t.weekYear),n=integerBetween(t.weekNumber,1,weeksInWeekYear(t.weekYear)),i=integerBetween(t.weekday,1,7);return e?n?!i&&unitOutOfRange("weekday",t.weekday):unitOutOfRange("week",t.week):unitOutOfRange("weekYear",t.weekYear)}(r):o?function hasInvalidOrdinalData(t){const e=isInteger(t.year),n=integerBetween(t.ordinal,1,daysInYear(t.year));return e?!n&&unitOutOfRange("ordinal",t.ordinal):unitOutOfRange("year",t.year)}(r):hasInvalidGregorianData(r))||hasInvalidTimeData(r);if(y)return DateTime.invalid(y);const g=h?weekToGregorian(r):o?ordinalToGregorian(r):r,[v,_]=objToTS(g,i,e),b=new DateTime({ts:v,zone:e,o:_,loc:c});return r.weekday&&l&&t.weekday!==b.weekday?DateTime.invalid("mismatched weekday",`you can't specify both a weekday of ${r.weekday} and a date of ${b.toISO()}`):b}static fromISO(t,e={}){const[n,i]=function parseISODate(t){return parse(t,[Qt,ne],[Jt,ie],[te,re],[ee,oe])}(t);return parseDataToDateTime(n,i,e,"ISO 8601",t)}static fromRFC2822(t,e={}){const[n,i]=function parseRFC2822Date(t){return parse(function preprocessRFC2822(t){return t.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(t),[Yt,extractRFC2822])}(t);return parseDataToDateTime(n,i,e,"RFC 2822",t)}static fromHTTP(t,e={}){const[n,i]=function parseHTTPDate(t){return parse(t,[Ht,extractRFC1123Or850],[Xt,extractRFC1123Or850],[$t,extractASCII])}(t);return parseDataToDateTime(n,i,e,"HTTP",e)}static fromFormat(t,e,n={}){if(isUndefined(t)||isUndefined(e))throw new InvalidArgumentError("fromFormat requires an input string and a format");const{locale:i=null,numberingSystem:r=null}=n,o=Locale.fromOpts({locale:i,numberingSystem:r,defaultToEN:!0}),[a,s,l]=function parseFromTokens(t,e,n){const{result:i,zone:r,invalidReason:o}=explainFromTokens(t,e,n);return[i,r,o]}(o,t,e);return l?DateTime.invalid(l):parseDataToDateTime(a,s,n,`format ${e}`,t)}static fromString(t,e,n={}){return DateTime.fromFormat(t,e,n)}static fromSQL(t,e={}){const[n,i]=function parseSQL(t){return parse(t,[ae,le],[se,ue])}(t);return parseDataToDateTime(n,i,e,"SQL",t)}static invalid(t,e=null){if(!t)throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");const n=t instanceof Invalid?t:new Invalid(t,e);if(Settings.throwOnInvalid)throw new InvalidDateTimeError(n);return new DateTime({invalid:n})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}get(t){return this[t]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN}get weekNumber(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN}get weekday(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN}get ordinal(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN}get monthShort(){return this.isValid?Info.months("short",{locale:this.locale})[this.month-1]:null}get monthLong(){return this.isValid?Info.months("long",{locale:this.locale})[this.month-1]:null}get weekdayShort(){return this.isValid?Info.weekdays("short",{locale:this.locale})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Info.weekdays("long",{locale:this.locale})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.universal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1}).offset||this.offset>this.set({month:5}).offset)}get isInLeapYear(){return isLeapYear(this.year)}get daysInMonth(){return daysInMonth(this.year,this.month)}get daysInYear(){return this.isValid?daysInYear(this.year):NaN}get weeksInWeekYear(){return this.isValid?weeksInWeekYear(this.weekYear):NaN}resolvedLocaleOpts(t={}){const{locale:e,numberingSystem:n,calendar:i}=Formatter.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:e,numberingSystem:n,outputCalendar:i}}toUTC(t=0,e={}){return this.setZone(FixedOffsetZone.instance(t),e)}toLocal(){return this.setZone(Settings.defaultZone)}setZone(t,{keepLocalTime:e=!1,keepCalendarTime:n=!1}={}){if((t=normalizeZone(t,Settings.defaultZone)).equals(this.zone))return this;if(t.isValid){let i=this.ts;if(e||n){const e=this.o-t.offset(this.ts),n=this.toObject();[i]=objToTS(n,e,t)}return clone$2(this,{ts:i,zone:t})}return DateTime.invalid(unsupportedZone(t))}reconfigure({locale:t,numberingSystem:e,outputCalendar:n}={}){return clone$2(this,{loc:this.loc.clone({locale:t,numberingSystem:e,outputCalendar:n})})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;const e=normalizeObject(t,normalizeUnit,[]);let n;!isUndefined(e.weekYear)||!isUndefined(e.weekNumber)||!isUndefined(e.weekday)?n=weekToGregorian(Object.assign(gregorianToWeek(this.c),e)):isUndefined(e.ordinal)?(n=Object.assign(this.toObject(),e),isUndefined(e.day)&&(n.day=Math.min(daysInMonth(n.year,n.month),n.day))):n=ordinalToGregorian(Object.assign(gregorianToOrdinal(this.c),e));const[i,r]=objToTS(n,this.o,this.zone);return clone$2(this,{ts:i,o:r})}plus(t){if(!this.isValid)return this;return clone$2(this,adjustTime(this,friendlyDuration(t)))}minus(t){if(!this.isValid)return this;return clone$2(this,adjustTime(this,friendlyDuration(t).negate()))}startOf(t){if(!this.isValid)return this;const e={},n=Duration.normalizeUnit(t);switch(n){case"years":e.month=1;case"quarters":case"months":e.day=1;case"weeks":case"days":e.hour=0;case"hours":e.minute=0;case"minutes":e.second=0;case"seconds":e.millisecond=0}if("weeks"===n&&(e.weekday=1),"quarters"===n){const t=Math.ceil(this.month/3);e.month=3*(t-1)+1}return this.set(e)}endOf(t){return this.isValid?this.plus({[t]:1}).startOf(t).minus(1):this}toFormat(t,e={}){return this.isValid?Formatter.create(this.loc.redefaultToEN(e)).formatDateTimeFromString(this,t):Me}toLocaleString(t=W){return this.isValid?Formatter.create(this.loc.clone(t),t).formatDateTime(this):Me}toLocaleParts(t={}){return this.isValid?Formatter.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO(t={}){return this.isValid?`${this.toISODate()}T${this.toISOTime(t)}`:null}toISODate(){let t="yyyy-MM-dd";return this.year>9999&&(t="+"+t),toTechFormat(this,t)}toISOWeekDate(){return toTechFormat(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:e=!1,includeOffset:n=!0}={}){return toTechTimeFormat(this,{suppressSeconds:e,suppressMilliseconds:t,includeOffset:n})}toRFC2822(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ")}toHTTP(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return toTechFormat(this,"yyyy-MM-dd")}toSQLTime({includeOffset:t=!0,includeZone:e=!1}={}){return toTechTimeFormat(this,{includeOffset:t,includeZone:e,spaceZone:!0})}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():Me}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};const e=Object.assign({},this.c);return t.includeConfig&&(e.outputCalendar=this.outputCalendar,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,e="milliseconds",n={}){if(!this.isValid||!t.isValid)return Duration.invalid(this.invalid||t.invalid,"created by diffing an invalid DateTime");const i=Object.assign({locale:this.locale,numberingSystem:this.numberingSystem},n),r=function maybeArray(t){return Array.isArray(t)?t:[t]}(e).map(Duration.normalizeUnit),o=t.valueOf()>this.valueOf(),a=diff(o?this:t,o?t:this,r,i);return o?a.negate():a}diffNow(t="milliseconds",e={}){return this.diff(DateTime.local(),t,e)}until(t){return this.isValid?Interval.fromDateTimes(this,t):this}hasSame(t,e){if(!this.isValid)return!1;if("millisecond"===e)return this.valueOf()===t.valueOf();{const n=t.valueOf();return this.startOf(e)<=n&&n<=this.endOf(e)}}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;const e=t.base||DateTime.fromObject({zone:this.zone}),n=t.padding?this<e?-t.padding:t.padding:0;return diffRelative(e,this.plus(n),Object.assign(t,{numeric:"always",units:["years","months","days","hours","minutes","seconds"]}))}toRelativeCalendar(t={}){return this.isValid?diffRelative(t.base||DateTime.fromObject({zone:this.zone}),this,Object.assign(t,{numeric:"auto",units:["years","months","days"],calendary:!0})):null}static min(...t){if(!t.every(DateTime.isDateTime))throw new InvalidArgumentError("min requires all arguments be DateTimes");return bestBy(t,t=>t.valueOf(),Math.min)}static max(...t){if(!t.every(DateTime.isDateTime))throw new InvalidArgumentError("max requires all arguments be DateTimes");return bestBy(t,t=>t.valueOf(),Math.max)}static fromFormatExplain(t,e,n={}){const{locale:i=null,numberingSystem:r=null}=n;return explainFromTokens(Locale.fromOpts({locale:i,numberingSystem:r,defaultToEN:!0}),t,e)}static fromStringExplain(t,e,n={}){return DateTime.fromFormatExplain(t,e,n)}static get DATE_SHORT(){return W}static get DATE_MED(){return B}static get DATE_FULL(){return Z}static get DATE_HUGE(){return K}static get TIME_SIMPLE(){return Y}static get TIME_WITH_SECONDS(){return H}static get TIME_WITH_SHORT_OFFSET(){return X}static get TIME_WITH_LONG_OFFSET(){return $}static get TIME_24_SIMPLE(){return Q}static get TIME_24_WITH_SECONDS(){return J}static get TIME_24_WITH_SHORT_OFFSET(){return tt}static get TIME_24_WITH_LONG_OFFSET(){return et}static get DATETIME_SHORT(){return nt}static get DATETIME_SHORT_WITH_SECONDS(){return it}static get DATETIME_MED(){return rt}static get DATETIME_MED_WITH_SECONDS(){return ot}static get DATETIME_MED_WITH_WEEKDAY(){return at}static get DATETIME_FULL(){return st}static get DATETIME_FULL_WITH_SECONDS(){return lt}static get DATETIME_HUGE(){return ut}static get DATETIME_HUGE_WITH_SECONDS(){return ct}}function friendlyDateTime(t){if(DateTime.isDateTime(t))return t;if(t&&t.valueOf&&isNumber(t.valueOf()))return DateTime.fromJSDate(t);if(t&&"object"==typeof t)return DateTime.fromObject(t);throw new InvalidArgumentError(`Unknown datetime argument: ${t}, of type ${typeof t}`)}var ke=Object.freeze({__proto__:null,DateTime:DateTime,Duration:Duration,Interval:Interval,Info:Info,Zone:Zone,FixedOffsetZone:FixedOffsetZone,IANAZone:IANAZone,InvalidZone:InvalidZone,LocalZone:LocalZone,Settings:Settings}),Ae=function unwrapExports(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(createCommonjsModule((function(t,e){!function webpackUniversalModuleDefinition(e,n){t.exports=n(ke)}("undefined"!=typeof self&&self,(function(t){return function(t){var e={};function __webpack_require__(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,__webpack_require__),i.l=!0,i.exports}return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.d=function(t,e,n){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.t=function(t,e){if(1&e&&(t=__webpack_require__(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)__webpack_require__.d(n,i,function(e){return t[e]}.bind(null,i));return n},__webpack_require__.n=function(t){var e=t&&t.__esModule?function getDefault(){return t.default}:function getModuleExports(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1)}([function(t,e,n){n.d(e,"f",(function(){return isPresent})),n.d(e,"e",(function(){return isNumber})),n.d(e,"d",(function(){return i})),n.d(e,"j",(function(){return range})),n.d(e,"k",(function(){return repeat})),n.d(e,"m",(function(){return toArray})),n.d(e,"h",(function(){return padStart})),n.d(e,"l",(function(){return split})),n.d(e,"i",(function(){return pymod})),n.d(e,"a",(function(){return divmod})),n.d(e,"b",(function(){return empty})),n.d(e,"g",(function(){return notEmpty})),n.d(e,"c",(function(){return includes}));var isPresent=function(t){return null!=t},isNumber=function(t){return"number"==typeof t},i=Array.isArray,range=function(t,e){void 0===e&&(e=t),1===arguments.length&&(e=t,t=0);for(var n=[],i=t;i<e;i++)n.push(i);return n},repeat=function(t,e){var n=0,r=[];if(i(t))for(;n<e;n++)r[n]=[].concat(t);else for(;n<e;n++)r[n]=t;return r},toArray=function(t){return i(t)?t:[t]};function padStart(t,e,n){void 0===n&&(n=" ");var i=String(t);return e>>=0,i.length>e?String(i):((e-=i.length)>n.length&&(n+=repeat(n,e/n.length)),n.slice(0,e)+String(i))}var split=function(t,e,n){var i=t.split(e);return n?i.slice(0,n).concat([i.slice(n).join(e)]):i},pymod=function(t,e){var n=t%e;return n*e<0?n+e:n},divmod=function(t,e){return{div:Math.floor(t/e),mod:pymod(t,e)}},empty=function(t){return!isPresent(t)||0===t.length},notEmpty=function(t){return!empty(t)},includes=function(t,e){return notEmpty(t)&&-1!==t.indexOf(e)}},function(t,e,n){n.r(e);var i,r,o=n(0);(r=i||(i={})).MONTH_DAYS=[31,28,31,30,31,30,31,31,30,31,30,31],r.ONE_DAY=864e5,r.MAXYEAR=9999,r.ORDINAL_BASE=new Date(Date.UTC(1970,0,1)),r.PY_WEEKDAYS=[6,0,1,2,3,4,5],r.getYearDay=function(t){var e=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate());return Math.ceil((e.valueOf()-new Date(t.getUTCFullYear(),0,1).valueOf())/r.ONE_DAY)+1},r.isLeapYear=function(t){return t%4==0&&t%100!=0||t%400==0},r.isDate=function(t){return t instanceof Date},r.isValidDate=function(t){return r.isDate(t)&&!isNaN(t.getTime())},r.tzOffset=function(t){return 60*t.getTimezoneOffset()*1e3},r.daysBetween=function(t,e){var n=t.getTime()-r.tzOffset(t)-(e.getTime()-r.tzOffset(e));return Math.round(n/r.ONE_DAY)},r.toOrdinal=function(t){return r.daysBetween(t,r.ORDINAL_BASE)},r.fromOrdinal=function(t){return new Date(r.ORDINAL_BASE.getTime()+t*r.ONE_DAY)},r.getMonthDays=function(t){var e=t.getUTCMonth();return 1===e&&r.isLeapYear(t.getUTCFullYear())?29:r.MONTH_DAYS[e]},r.getWeekday=function(t){return r.PY_WEEKDAYS[t.getUTCDay()]},r.monthRange=function(t,e){var n=new Date(Date.UTC(t,e,1));return[r.getWeekday(n),r.getMonthDays(n)]},r.combine=function(t,e){return e=e||t,new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))},r.clone=function(t){return new Date(t.getTime())},r.cloneDates=function(t){for(var e=[],n=0;n<t.length;n++)e.push(r.clone(t[n]));return e},r.sort=function(t){t.sort((function(t,e){return t.getTime()-e.getTime()}))},r.timeToUntilString=function(t,e){void 0===e&&(e=!0);var n=new Date(t);return[Object(o.h)(n.getUTCFullYear().toString(),4,"0"),Object(o.h)(n.getUTCMonth()+1,2,"0"),Object(o.h)(n.getUTCDate(),2,"0"),"T",Object(o.h)(n.getUTCHours(),2,"0"),Object(o.h)(n.getUTCMinutes(),2,"0"),Object(o.h)(n.getUTCSeconds(),2,"0"),e?"Z":""].join("")},r.untilStringToDate=function(t){var e=/^(\d{4})(\d{2})(\d{2})(T(\d{2})(\d{2})(\d{2})Z?)?$/.exec(t);if(!e)throw new Error("Invalid UNTIL value: "+t);return new Date(Date.UTC(parseInt(e[1],10),parseInt(e[2],10)-1,parseInt(e[3],10),parseInt(e[5],10)||0,parseInt(e[6],10)||0,parseInt(e[7],10)||0))};var a=i,s=function(){function IterResult(t,e){this.minDate=null,this.maxDate=null,this._result=[],this.total=0,this.method=t,this.args=e,"between"===t?(this.maxDate=e.inc?e.before:new Date(e.before.getTime()-1),this.minDate=e.inc?e.after:new Date(e.after.getTime()+1)):"before"===t?this.maxDate=e.inc?e.dt:new Date(e.dt.getTime()-1):"after"===t&&(this.minDate=e.inc?e.dt:new Date(e.dt.getTime()+1))}return IterResult.prototype.accept=function(t){++this.total;var e=this.minDate&&t<this.minDate,n=this.maxDate&&t>this.maxDate;if("between"===this.method){if(e)return!0;if(n)return!1}else if("before"===this.method){if(n)return!1}else if("after"===this.method)return!!e||(this.add(t),!1);return this.add(t)},IterResult.prototype.add=function(t){return this._result.push(t),!0},IterResult.prototype.getValue=function(){var t=this._result;switch(this.method){case"all":case"between":return t;case"before":case"after":default:return t.length?t[t.length-1]:null}},IterResult.prototype.clone=function(){return new IterResult(this.method,this.args)},IterResult}(),extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function __extends(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}var l,__assign=function(){return(__assign=Object.assign||function __assign(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},u=function(t){function CallbackIterResult(e,n,i){var r=t.call(this,e,n)||this;return r.iterator=i,r}return __extends(CallbackIterResult,t),CallbackIterResult.prototype.add=function(t){return!!this.iterator(t,this._result.length)&&(this._result.push(t),!0)},CallbackIterResult}(s);function freqIsDailyOrGreater(t){return t<l.HOURLY}!function(t){t[t.YEARLY=0]="YEARLY",t[t.MONTHLY=1]="MONTHLY",t[t.WEEKLY=2]="WEEKLY",t[t.DAILY=3]="DAILY",t[t.HOURLY=4]="HOURLY",t[t.MINUTELY=5]="MINUTELY",t[t.SECONDLY=6]="SECONDLY"}(l||(l={}));var c=["MO","TU","WE","TH","FR","SA","SU"],h=function(){function Weekday(t,e){if(0===e)throw new Error("Can't create weekday with n == 0");this.weekday=t,this.n=e}return Weekday.prototype.nth=function(t){return this.n===t?this:new Weekday(this.weekday,t)},Weekday.prototype.equals=function(t){return this.weekday===t.weekday&&this.n===t.n},Weekday.prototype.toString=function(){var t=c[this.weekday];return this.n&&(t=(this.n>0?"+":"")+String(this.n)+t),t},Weekday.prototype.getJsWeekday=function(){return 6===this.weekday?0:this.weekday+1},Weekday}(),d=function(){function Time(t,e,n,i){this.hour=t,this.minute=e,this.second=n,this.millisecond=i||0}return Time.prototype.getHours=function(){return this.hour},Time.prototype.getMinutes=function(){return this.minute},Time.prototype.getSeconds=function(){return this.second},Time.prototype.getMilliseconds=function(){return this.millisecond},Time.prototype.getTime=function(){return 1e3*(60*this.hour*60+60*this.minute+this.second)+this.millisecond},Time}(),p=function(t){function DateTime(e,n,i,r,o,a,s){var l=t.call(this,r,o,a,s)||this;return l.year=e,l.month=n,l.day=i,l}return __extends(DateTime,t),DateTime.fromDate=function(t){return new this(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.valueOf()%1e3)},DateTime.prototype.getWeekday=function(){return i.getWeekday(new Date(this.getTime()))},DateTime.prototype.getTime=function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond)).getTime()},DateTime.prototype.getDay=function(){return this.day},DateTime.prototype.getMonth=function(){return this.month},DateTime.prototype.getYear=function(){return this.year},DateTime.prototype.addYears=function(t){this.year+=t},DateTime.prototype.addMonths=function(t){if(this.month+=t,this.month>12){var e=Math.floor(this.month/12),n=Object(o.i)(this.month,12);this.month=n,this.year+=e,0===this.month&&(this.month=12,--this.year)}},DateTime.prototype.addWeekly=function(t,e){e>this.getWeekday()?this.day+=-(this.getWeekday()+1+(6-e))+7*t:this.day+=-(this.getWeekday()-e)+7*t,this.fixDay()},DateTime.prototype.addDaily=function(t){this.day+=t,this.fixDay()},DateTime.prototype.addHours=function(t,e,n){for(e&&(this.hour+=Math.floor((23-this.hour)/t)*t);;){this.hour+=t;var i=Object(o.a)(this.hour,24),r=i.div,a=i.mod;if(r&&(this.hour=a,this.addDaily(r)),Object(o.b)(n)||Object(o.c)(n,this.hour))break}},DateTime.prototype.addMinutes=function(t,e,n,i){for(e&&(this.minute+=Math.floor((1439-(60*this.hour+this.minute))/t)*t);;){this.minute+=t;var r=Object(o.a)(this.minute,60),a=r.div,s=r.mod;if(a&&(this.minute=s,this.addHours(a,!1,n)),(Object(o.b)(n)||Object(o.c)(n,this.hour))&&(Object(o.b)(i)||Object(o.c)(i,this.minute)))break}},DateTime.prototype.addSeconds=function(t,e,n,i,r){for(e&&(this.second+=Math.floor((86399-(3600*this.hour+60*this.minute+this.second))/t)*t);;){this.second+=t;var a=Object(o.a)(this.second,60),s=a.div,l=a.mod;if(s&&(this.second=l,this.addMinutes(s,!1,n,i)),(Object(o.b)(n)||Object(o.c)(n,this.hour))&&(Object(o.b)(i)||Object(o.c)(i,this.minute))&&(Object(o.b)(r)||Object(o.c)(r,this.second)))break}},DateTime.prototype.fixDay=function(){if(!(this.day<=28)){var t=i.monthRange(this.year,this.month-1)[1];if(!(this.day<=t))for(;this.day>t;){if(this.day-=t,++this.month,13===this.month&&(this.month=1,++this.year,this.year>i.MAXYEAR))return;t=i.monthRange(this.year,this.month-1)[1]}}},DateTime.prototype.add=function(t,e){var n=t.freq,i=t.interval,r=t.wkst,o=t.byhour,a=t.byminute,s=t.bysecond;switch(n){case l.YEARLY:return this.addYears(i);case l.MONTHLY:return this.addMonths(i);case l.WEEKLY:return this.addWeekly(i,r);case l.DAILY:return this.addDaily(i);case l.HOURLY:return this.addHours(i,e,o);case l.MINUTELY:return this.addMinutes(i,e,o,a);case l.SECONDLY:return this.addSeconds(i,e,o,a,s)}},DateTime}(d);function initializeOptions(t){var e=[],n=Object.keys(t),i={};if(n.forEach((function(n){var r=t[n];i[n]=r,Object(o.c)(N,n)||e.push(n),a.isDate(r)&&!a.isValidDate(r)&&e.push(n)})),e.length)throw new Error("Invalid options: "+e.join(", "));return i}function parseString(t){var e=t.split("\n").map(parseLine).filter((function(t){return null!==t}));return __assign({},e[0],e[1])}function parseDtstart(t){var e={},n=/DTSTART(?:;TZID=([^:=]+?))?(?::|=)([^;\s]+)/i.exec(t);if(!n)return e;n[0];var i=n[1],r=n[2];return i&&(e.tzid=i),e.dtstart=a.untilStringToDate(r),e}function parseLine(t){if(!(t=t.replace(/^\s+|\s+$/,"")).length)return null;var e=/^([A-Z]+?)[:;]/.exec(t.toUpperCase());if(!e)return parseRrule(t);e[0];var n=e[1];switch(n.toUpperCase()){case"RRULE":case"EXRULE":return parseRrule(t);case"DTSTART":return parseDtstart(t);default:throw new Error("Unsupported RFC prop "+n+" in "+t)}}function parseRrule(t){var e=parseDtstart(t.replace(/^RRULE:/i,""));return t.replace(/^(?:RRULE|EXRULE):/i,"").split(";").forEach((function(n){var i=n.split("="),r=i[0],o=i[1];switch(r.toUpperCase()){case"FREQ":e.freq=l[o.toUpperCase()];break;case"WKST":e.wkst=D[o.toUpperCase()];break;case"COUNT":case"INTERVAL":case"BYSETPOS":case"BYMONTH":case"BYMONTHDAY":case"BYYEARDAY":case"BYWEEKNO":case"BYHOUR":case"BYMINUTE":case"BYSECOND":var s=function parseNumber(t){if(-1!==t.indexOf(",")){return t.split(",").map(parseIndividualNumber)}return parseIndividualNumber(t)}(o),u=r.toLowerCase();e[u]=s;break;case"BYWEEKDAY":case"BYDAY":e.byweekday=function parseWeekday(t){return t.split(",").map((function(t){if(2===t.length)return D[t];var e=t.match(/^([+-]?\d{1,2})([A-Z]{2})$/),n=Number(e[1]),i=e[2],r=D[i].weekday;return new h(r,n)}))}(o);break;case"DTSTART":case"TZID":var c=parseDtstart(t);e.tzid=c.tzid,e.dtstart=c.dtstart;break;case"UNTIL":e.until=a.untilStringToDate(o);break;case"BYEASTER":e.byeaster=Number(o);break;default:throw new Error("Unknown RRULE property '"+r+"'")}})),e}function parseIndividualNumber(t){return/^[+-]?\d+$/.test(t)?Number(t):t}var f=n(2),m=function(){function DateWithZone(t,e){this.date=t,this.tzid=e}return Object.defineProperty(DateWithZone.prototype,"isUTC",{get:function(){return!this.tzid||"UTC"===this.tzid.toUpperCase()},enumerable:!0,configurable:!0}),DateWithZone.prototype.toString=function(){var t=a.timeToUntilString(this.date.getTime(),this.isUTC);return this.isUTC?":"+t:";TZID="+this.tzid+":"+t},DateWithZone.prototype.getTime=function(){return this.date.getTime()},DateWithZone.prototype.rezonedDate=function(){if(this.isUTC)return this.date;try{return f.DateTime.fromJSDate(this.date).setZone(this.tzid,{keepLocalTime:!0}).toJSDate()}catch(t){return t instanceof TypeError&&console.error("Using TZID without Luxon available is unsupported. Returned times are in UTC, not the requested time zone"),this.date}},DateWithZone}();function optionsToString(t){for(var e=[],n="",i=Object.keys(t),r=Object.keys(j),s=0;s<i.length;s++)if("tzid"!==i[s]&&Object(o.c)(r,i[s])){var l=i[s].toUpperCase(),u=t[i[s]],c="";if(Object(o.f)(u)&&(!Object(o.d)(u)||u.length)){switch(l){case"FREQ":c=F.FREQUENCIES[t.freq];break;case"WKST":c=Object(o.e)(u)?new h(u).toString():u.toString();break;case"BYWEEKDAY":l="BYDAY",c=Object(o.m)(u).map((function(t){return t instanceof h?t:Object(o.d)(t)?new h(t[0],t[1]):new h(t)})).toString();break;case"DTSTART":n=buildDtstart(u,t.tzid);break;case"UNTIL":c=a.timeToUntilString(u,!t.tzid);break;default:if(Object(o.d)(u)){for(var d=[],p=0;p<u.length;p++)d[p]=String(u[p]);c=d.toString()}else c=String(u)}c&&e.push([l,c])}}var f=e.map((function(t){return t[0]+"="+t[1].toString()})).join(";"),m="";return""!==f&&(m="RRULE:"+f),[n,m].filter((function(t){return!!t})).join("\n")}function buildDtstart(t,e){return t?"DTSTART"+new m(new Date(t),e).toString():""}var y=function(){function Cache(){this.all=!1,this.before=[],this.after=[],this.between=[]}return Cache.prototype._cacheAdd=function(t,e,n){e&&(e=e instanceof Date?a.clone(e):a.cloneDates(e)),"all"===t?this.all=e:(n._value=e,this[t].push(n))},Cache.prototype._cacheGet=function(t,e){var n=!1,i=e?Object.keys(e):[],findCacheDiff=function(t){for(var n=0;n<i.length;n++){var r=i[n];if(String(e[r])!==String(t[r]))return!0}return!1},r=this[t];if("all"===t)n=this.all;else if(Object(o.d)(r))for(var l=0;l<r.length;l++){var u=r[l];if(!i.length||!findCacheDiff(u)){n=u._value;break}}if(!n&&this.all){var c=new s(t,e);for(l=0;l<this.all.length&&c.accept(this.all[l]);l++);n=c.getValue(),this._cacheAdd(t,n,e)}return Object(o.d)(n)?a.cloneDates(n):n instanceof Date?a.clone(n):n},Cache}(),g=Object(o.k)(1,31).concat(Object(o.k)(2,28),Object(o.k)(3,31),Object(o.k)(4,30),Object(o.k)(5,31),Object(o.k)(6,30),Object(o.k)(7,31),Object(o.k)(8,31),Object(o.k)(9,30),Object(o.k)(10,31),Object(o.k)(11,30),Object(o.k)(12,31),Object(o.k)(1,7)),v=Object(o.k)(1,31).concat(Object(o.k)(2,29),Object(o.k)(3,31),Object(o.k)(4,30),Object(o.k)(5,31),Object(o.k)(6,30),Object(o.k)(7,31),Object(o.k)(8,31),Object(o.k)(9,30),Object(o.k)(10,31),Object(o.k)(11,30),Object(o.k)(12,31),Object(o.k)(1,7)),_=Object(o.j)(1,29),b=Object(o.j)(1,30),T=Object(o.j)(1,31),w=Object(o.j)(1,32),E=w.concat(b,w,T,w,T,w,w,T,w,T,w,w.slice(0,7)),S=w.concat(_,w,T,w,T,w,w,T,w,T,w,w.slice(0,7)),M=Object(o.j)(-28,0),O=Object(o.j)(-29,0),x=Object(o.j)(-30,0),P=Object(o.j)(-31,0),C=P.concat(O,P,x,P,x,P,P,x,P,x,P,P.slice(0,7)),I=P.concat(M,P,x,P,x,P,P,x,P,x,P,P.slice(0,7)),L=[0,31,60,91,121,152,182,213,244,274,305,335,366],R=[0,31,59,90,120,151,181,212,243,273,304,334,365],k=function(){for(var t=[],e=0;e<55;e++)t=t.concat(Object(o.j)(7));return t}();function rebuildYear(t,e){var n,i,r=new Date(Date.UTC(t,0,1)),s=a.isLeapYear(t)?366:365,l=a.isLeapYear(t+1)?366:365,u=a.toOrdinal(r),c=a.getWeekday(r),h=__assign({yearlen:s,nextyearlen:l,yearordinal:u,yearweekday:c},function baseYearMasks(t){var e=a.isLeapYear(t)?366:365,n=new Date(Date.UTC(t,0,1)),i=a.getWeekday(n);if(365===e)return{mmask:g,mdaymask:S,nmdaymask:I,wdaymask:k.slice(i),mrange:R};return{mmask:v,mdaymask:E,nmdaymask:C,wdaymask:k.slice(i),mrange:L}}(t),{wnomask:null});if(Object(o.b)(e.byweekno))return h;h.wnomask=Object(o.k)(0,s+7);var d=n=Object(o.i)(7-c+e.wkst,7);d>=4?(d=0,i=h.yearlen+Object(o.i)(c-e.wkst,7)):i=s-d;for(var p=Math.floor(i/7),f=Object(o.i)(i,7),m=Math.floor(p+f/4),y=0;y<e.byweekno.length;y++){var _=e.byweekno[y];if(_<0&&(_+=m+1),_>0&&_<=m){var b=void 0;_>1?(b=d+7*(_-1),d!==n&&(b-=7-n)):b=d;for(var T=0;T<7&&(h.wnomask[b]=1,b++,h.wdaymask[b]!==e.wkst);T++);}}if(Object(o.c)(e.byweekno,1)){b=d+7*m;if(d!==n&&(b-=7-n),b<s)for(y=0;y<7&&(h.wnomask[b]=1,b+=1,h.wdaymask[b]!==e.wkst);y++);}if(d){var w=void 0;if(Object(o.c)(e.byweekno,-1))w=-1;else{var M=a.getWeekday(new Date(Date.UTC(t-1,0,1))),O=Object(o.i)(7-M.valueOf()+e.wkst,7),x=a.isLeapYear(t-1)?366:365,P=void 0;O>=4?(O=0,P=x+Object(o.i)(M-e.wkst,7)):P=s-d,w=Math.floor(52+Object(o.i)(P,7)/4)}if(Object(o.c)(e.byweekno,w))for(b=0;b<d;b++)h.wnomask[b]=1}return h}var A=function(){function Iterinfo(t){this.options=t}return Iterinfo.prototype.rebuild=function(t,e){var n=this.options;if(t!==this.lastyear&&(this.yearinfo=rebuildYear(t,n)),Object(o.g)(n.bynweekday)&&(e!==this.lastmonth||t!==this.lastyear)){var i=this.yearinfo,r=i.yearlen,a=i.mrange,s=i.wdaymask;this.monthinfo=function rebuildMonth(t,e,n,i,r,a){var s={lastyear:t,lastmonth:e,nwdaymask:[]},l=[];if(a.freq===F.YEARLY)if(Object(o.b)(a.bymonth))l=[[0,n]];else for(var u=0;u<a.bymonth.length;u++)e=a.bymonth[u],l.push(i.slice(e-1,e+1));else a.freq===F.MONTHLY&&(l=[i.slice(e-1,e+1)]);if(Object(o.b)(l))return s;for(s.nwdaymask=Object(o.k)(0,n),u=0;u<l.length;u++)for(var c=l[u],h=c[0],d=c[1]-1,p=0;p<a.bynweekday.length;p++){var f=void 0,m=a.bynweekday[p],y=m[0],g=m[1];g<0?(f=d+7*(g+1),f-=Object(o.i)(r[f]-y,7)):(f=h+7*(g-1),f+=Object(o.i)(7-r[f]+y,7)),h<=f&&f<=d&&(s.nwdaymask[f]=1)}return s}(t,e,r,a,s,n)}Object(o.f)(n.byeaster)&&(this.eastermask=function easter(t,e){void 0===e&&(e=0);var n=t%19,i=Math.floor(t/100),r=t%100,o=Math.floor(i/4),a=i%4,s=Math.floor((i+8)/25),l=Math.floor((i-s+1)/3),u=Math.floor(19*n+i-o-l+15)%30,c=Math.floor(r/4),h=r%4,d=Math.floor(32+2*a+2*c-u-h)%7,p=Math.floor((n+11*u+22*d)/451),f=Math.floor((u+d-7*p+114)/31),m=(u+d-7*p+114)%31+1,y=Date.UTC(t,f-1,m+e),g=Date.UTC(t,0,1);return[Math.ceil((y-g)/864e5)]}(t,n.byeaster))},Object.defineProperty(Iterinfo.prototype,"lastyear",{get:function(){return this.monthinfo?this.monthinfo.lastyear:null},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"lastmonth",{get:function(){return this.monthinfo?this.monthinfo.lastmonth:null},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"yearlen",{get:function(){return this.yearinfo.yearlen},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"yearordinal",{get:function(){return this.yearinfo.yearordinal},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"mrange",{get:function(){return this.yearinfo.mrange},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"wdaymask",{get:function(){return this.yearinfo.wdaymask},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"mmask",{get:function(){return this.yearinfo.mmask},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"wnomask",{get:function(){return this.yearinfo.wnomask},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"nwdaymask",{get:function(){return this.monthinfo?this.monthinfo.nwdaymask:[]},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"nextyearlen",{get:function(){return this.yearinfo.nextyearlen},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"mdaymask",{get:function(){return this.yearinfo.mdaymask},enumerable:!0,configurable:!0}),Object.defineProperty(Iterinfo.prototype,"nmdaymask",{get:function(){return this.yearinfo.nmdaymask},enumerable:!0,configurable:!0}),Iterinfo.prototype.ydayset=function(){return[Object(o.j)(this.yearlen),0,this.yearlen]},Iterinfo.prototype.mdayset=function(t,e,n){for(var i=this.mrange[e-1],r=this.mrange[e],a=Object(o.k)(null,this.yearlen),s=i;s<r;s++)a[s]=s;return[a,i,r]},Iterinfo.prototype.wdayset=function(t,e,n){for(var i=Object(o.k)(null,this.yearlen+7),r=a.toOrdinal(new Date(Date.UTC(t,e-1,n)))-this.yearordinal,s=r,l=0;l<7&&(i[r]=r,++r,this.wdaymask[r]!==this.options.wkst);l++);return[i,s,r]},Iterinfo.prototype.ddayset=function(t,e,n){var i=Object(o.k)(null,this.yearlen),r=a.toOrdinal(new Date(Date.UTC(t,e-1,n)))-this.yearordinal;return i[r]=r,[i,r,r+1]},Iterinfo.prototype.htimeset=function(t,e,n,i){var r=this,o=[];return this.options.byminute.forEach((function(e){o=o.concat(r.mtimeset(t,e,n,i))})),a.sort(o),o},Iterinfo.prototype.mtimeset=function(t,e,n,i){var r=this.options.bysecond.map((function(n){return new d(t,e,n,i)}));return a.sort(r),r},Iterinfo.prototype.stimeset=function(t,e,n,i){return[new d(t,e,n,i)]},Iterinfo.prototype.getdayset=function(t){switch(t){case l.YEARLY:return this.ydayset.bind(this);case l.MONTHLY:return this.mdayset.bind(this);case l.WEEKLY:return this.wdayset.bind(this);case l.DAILY:default:return this.ddayset.bind(this)}},Iterinfo.prototype.gettimeset=function(t){switch(t){case l.HOURLY:return this.htimeset.bind(this);case l.MINUTELY:return this.mtimeset.bind(this);case l.SECONDLY:return this.stimeset.bind(this)}},Iterinfo}();function buildPoslist(t,e,n,i,r,s){for(var l=[],u=0;u<t.length;u++){var c=void 0,h=void 0,d=t[u];d<0?(c=Math.floor(d/e.length),h=Object(o.i)(d,e.length)):(c=Math.floor((d-1)/e.length),h=Object(o.i)(d-1,e.length));for(var p=[],f=n;f<i;f++){var m=s[f];Object(o.f)(m)&&p.push(m)}var y=void 0;y=c<0?p.slice(c)[0]:p[c];var g=e[h],v=a.fromOrdinal(r.yearordinal+y),_=a.combine(v,g);Object(o.c)(l,_)||l.push(_)}return a.sort(l),l}function iter(t,e){var n=e.dtstart,i=e.freq,r=e.interval,s=e.until,l=e.bysetpos,u=e.count;if(0===u||0===r)return emitResult(t);var c=p.fromDate(n),h=new A(e);h.rebuild(c.year,c.month);for(var f=function makeTimeset(t,e,n){var i=n.freq,r=n.byhour,a=n.byminute,s=n.bysecond;if(freqIsDailyOrGreater(i))return function buildTimeset(t){var e=t.dtstart.getTime()%1e3;if(!freqIsDailyOrGreater(t.freq))return[];var n=[];return t.byhour.forEach((function(i){t.byminute.forEach((function(r){t.bysecond.forEach((function(t){n.push(new d(i,r,t,e))}))}))})),n}(n);if(i>=F.HOURLY&&Object(o.g)(r)&&!Object(o.c)(r,e.hour)||i>=F.MINUTELY&&Object(o.g)(a)&&!Object(o.c)(a,e.minute)||i>=F.SECONDLY&&Object(o.g)(s)&&!Object(o.c)(s,e.second))return[];return t.gettimeset(i)(e.hour,e.minute,e.second,e.millisecond)}(h,c,e);;){var m=h.getdayset(i)(c.year,c.month,c.day),y=m[0],g=m[1],v=m[2],_=removeFilteredDays(y,g,v,h,e);if(Object(o.g)(l))for(var b=buildPoslist(l,f,g,v,h,y),T=0;T<b.length;T++){var w=b[T];if(s&&w>s)return emitResult(t);if(w>=n){var E=rezoneIfNeeded(w,e);if(!t.accept(E))return emitResult(t);if(u&&!--u)return emitResult(t)}}else for(T=g;T<v;T++){var S=y[T];if(Object(o.f)(S))for(var M=a.fromOrdinal(h.yearordinal+S),O=0;O<f.length;O++){var x=f[O];w=a.combine(M,x);if(s&&w>s)return emitResult(t);if(w>=n){E=rezoneIfNeeded(w,e);if(!t.accept(E))return emitResult(t);if(u&&!--u)return emitResult(t)}}}if(0===e.interval)return emitResult(t);if(c.add(e,_),c.year>a.MAXYEAR)return emitResult(t);freqIsDailyOrGreater(i)||(f=h.gettimeset(i)(c.hour,c.minute,c.second,0)),h.rebuild(c.year,c.month)}}function isFiltered(t,e,n){var i=n.bymonth,r=n.byweekno,a=n.byweekday,s=n.byeaster,l=n.bymonthday,u=n.bynmonthday,c=n.byyearday;return Object(o.g)(i)&&!Object(o.c)(i,t.mmask[e])||Object(o.g)(r)&&!t.wnomask[e]||Object(o.g)(a)&&!Object(o.c)(a,t.wdaymask[e])||Object(o.g)(t.nwdaymask)&&!t.nwdaymask[e]||null!==s&&!Object(o.c)(t.eastermask,e)||(Object(o.g)(l)||Object(o.g)(u))&&!Object(o.c)(l,t.mdaymask[e])&&!Object(o.c)(u,t.nmdaymask[e])||Object(o.g)(c)&&(e<t.yearlen&&!Object(o.c)(c,e+1)&&!Object(o.c)(c,-t.yearlen+e)||e>=t.yearlen&&!Object(o.c)(c,e+1-t.yearlen)&&!Object(o.c)(c,-t.nextyearlen+e-t.yearlen))}function rezoneIfNeeded(t,e){return new m(t,e.tzid).rezonedDate()}function emitResult(t){return t.getValue()}function removeFilteredDays(t,e,n,i,r){for(var o=!1,a=e;a<n;a++){var s=t[a];(o=isFiltered(i,s,r))&&(t[s]=null)}return o}var getnlp=function(){return getnlp._nlp||(getnlp._nlp=n(3)),getnlp._nlp},D={MO:new h(0),TU:new h(1),WE:new h(2),TH:new h(3),FR:new h(4),SA:new h(5),SU:new h(6)},j={freq:l.YEARLY,dtstart:null,interval:1,wkst:D.MO,count:null,until:null,tzid:null,bysetpos:null,bymonth:null,bymonthday:null,bynmonthday:null,byyearday:null,byweekno:null,byweekday:null,bynweekday:null,byhour:null,byminute:null,bysecond:null,byeaster:null},N=Object.keys(j),F=function(){function RRule(t,e){void 0===t&&(t={}),void 0===e&&(e=!1),this._cache=e?null:new y,this.origOptions=initializeOptions(t);var n=function parseOptions(t){var e=initializeOptions(t),n=Object.keys(t);if(N.forEach((function(t){Object(o.c)(n,t)&&Object(o.f)(e[t])||(e[t]=j[t])})),Object(o.f)(e.byeaster)&&(e.freq=F.YEARLY),!Object(o.f)(e.freq)||!F.FREQUENCIES[e.freq])throw new Error("Invalid frequency: "+e.freq+" "+t.freq);if(e.dtstart||(e.dtstart=new Date((new Date).setMilliseconds(0))),Object(o.f)(e.wkst)?Object(o.e)(e.wkst)||(e.wkst=e.wkst.weekday):e.wkst=F.MO.weekday,Object(o.f)(e.bysetpos)){Object(o.e)(e.bysetpos)&&(e.bysetpos=[e.bysetpos]);for(var i=0;i<e.bysetpos.length;i++){if(0===(l=e.bysetpos[i])||!(l>=-366&&l<=366))throw new Error("bysetpos must be between 1 and 366, or between -366 and -1")}}if(!(Boolean(e.byweekno)||Object(o.g)(e.byweekno)||Object(o.g)(e.byyearday)||Boolean(e.bymonthday)||Object(o.g)(e.bymonthday)||Object(o.f)(e.byweekday)||Object(o.f)(e.byeaster)))switch(e.freq){case F.YEARLY:e.bymonth||(e.bymonth=e.dtstart.getUTCMonth()+1),e.bymonthday=e.dtstart.getUTCDate();break;case F.MONTHLY:e.bymonthday=e.dtstart.getUTCDate();break;case F.WEEKLY:e.byweekday=[a.getWeekday(e.dtstart)]}if(Object(o.f)(e.bymonth)&&!Object(o.d)(e.bymonth)&&(e.bymonth=[e.bymonth]),Object(o.f)(e.byyearday)&&!Object(o.d)(e.byyearday)&&Object(o.e)(e.byyearday)&&(e.byyearday=[e.byyearday]),Object(o.f)(e.bymonthday))if(Object(o.d)(e.bymonthday)){var r=[],s=[];for(i=0;i<e.bymonthday.length;i++){var l;(l=e.bymonthday[i])>0?r.push(l):l<0&&s.push(l)}e.bymonthday=r,e.bynmonthday=s}else e.bymonthday<0?(e.bynmonthday=[e.bymonthday],e.bymonthday=[]):(e.bynmonthday=[],e.bymonthday=[e.bymonthday]);else e.bymonthday=[],e.bynmonthday=[];if(Object(o.f)(e.byweekno)&&!Object(o.d)(e.byweekno)&&(e.byweekno=[e.byweekno]),Object(o.f)(e.byweekday))if(Object(o.e)(e.byweekday))e.byweekday=[e.byweekday],e.bynweekday=null;else if(e.byweekday instanceof h)!e.byweekday.n||e.freq>F.MONTHLY?(e.byweekday=[e.byweekday.weekday],e.bynweekday=null):(e.bynweekday=[[e.byweekday.weekday,e.byweekday.n]],e.byweekday=null);else{var u=[],c=[];for(i=0;i<e.byweekday.length;i++){var d=e.byweekday[i];if(Object(o.e)(d))u.push(d);else{var p=d;!p.n||e.freq>F.MONTHLY?u.push(p.weekday):c.push([p.weekday,p.n])}}e.byweekday=Object(o.g)(u)?u:null,e.bynweekday=Object(o.g)(c)?c:null}else e.bynweekday=null;return Object(o.f)(e.byhour)?Object(o.e)(e.byhour)&&(e.byhour=[e.byhour]):e.byhour=e.freq<F.HOURLY?[e.dtstart.getUTCHours()]:null,Object(o.f)(e.byminute)?Object(o.e)(e.byminute)&&(e.byminute=[e.byminute]):e.byminute=e.freq<F.MINUTELY?[e.dtstart.getUTCMinutes()]:null,Object(o.f)(e.bysecond)?Object(o.e)(e.bysecond)&&(e.bysecond=[e.bysecond]):e.bysecond=e.freq<F.SECONDLY?[e.dtstart.getUTCSeconds()]:null,{parsedOptions:e}}(t).parsedOptions;this.options=n}return RRule.parseText=function(t,e){return getnlp().parseText(t,e)},RRule.fromText=function(t,e){return getnlp().fromText(t,e)},RRule.fromString=function(t){return new RRule(RRule.parseString(t)||void 0)},RRule.prototype._iter=function(t){return iter(t,this.options)},RRule.prototype._cacheGet=function(t,e){return!!this._cache&&this._cache._cacheGet(t,e)},RRule.prototype._cacheAdd=function(t,e,n){if(this._cache)return this._cache._cacheAdd(t,e,n)},RRule.prototype.all=function(t){if(t)return this._iter(new u("all",{},t));var e=this._cacheGet("all");return!1===e&&(e=this._iter(new s("all",{})),this._cacheAdd("all",e)),e},RRule.prototype.between=function(t,e,n,i){if(void 0===n&&(n=!1),!a.isValidDate(t)||!a.isValidDate(e))throw new Error("Invalid date passed in to RRule.between");var r={before:e,after:t,inc:n};if(i)return this._iter(new u("between",r,i));var o=this._cacheGet("between",r);return!1===o&&(o=this._iter(new s("between",r)),this._cacheAdd("between",o,r)),o},RRule.prototype.before=function(t,e){if(void 0===e&&(e=!1),!a.isValidDate(t))throw new Error("Invalid date passed in to RRule.before");var n={dt:t,inc:e},i=this._cacheGet("before",n);return!1===i&&(i=this._iter(new s("before",n)),this._cacheAdd("before",i,n)),i},RRule.prototype.after=function(t,e){if(void 0===e&&(e=!1),!a.isValidDate(t))throw new Error("Invalid date passed in to RRule.after");var n={dt:t,inc:e},i=this._cacheGet("after",n);return!1===i&&(i=this._iter(new s("after",n)),this._cacheAdd("after",i,n)),i},RRule.prototype.count=function(){return this.all().length},RRule.prototype.toString=function(){return optionsToString(this.origOptions)},RRule.prototype.toText=function(t,e,n){return getnlp().toText(this,t,e,n)},RRule.prototype.isFullyConvertibleToText=function(){return getnlp().isFullyConvertible(this)},RRule.prototype.clone=function(){return new RRule(this.origOptions)},RRule.FREQUENCIES=["YEARLY","MONTHLY","WEEKLY","DAILY","HOURLY","MINUTELY","SECONDLY"],RRule.YEARLY=l.YEARLY,RRule.MONTHLY=l.MONTHLY,RRule.WEEKLY=l.WEEKLY,RRule.DAILY=l.DAILY,RRule.HOURLY=l.HOURLY,RRule.MINUTELY=l.MINUTELY,RRule.SECONDLY=l.SECONDLY,RRule.MO=D.MO,RRule.TU=D.TU,RRule.WE=D.WE,RRule.TH=D.TH,RRule.FR=D.FR,RRule.SA=D.SA,RRule.SU=D.SU,RRule.parseString=parseString,RRule.optionsToString=optionsToString,RRule}();var U={dtstart:null,cache:!1,unfold:!1,forceset:!1,compatible:!1,tzid:null};function parseInput(t,e){var n=[],i=[],r=[],a=[],s=parseDtstart(t),l=s.dtstart,u=s.tzid;return function splitIntoLines(t,e){void 0===e&&(e=!1);if(!(t=t&&t.trim()))throw new Error("Invalid empty string");if(!e)return t.split(/\s/);var n=t.split("\n"),i=0;for(;i<n.length;){var r=n[i]=n[i].replace(/\s+$/g,"");r?i>0&&" "===r[0]?(n[i-1]+=r.slice(1),n.splice(i,1)):i+=1:n.splice(i,1)}return n}(t,e.unfold).forEach((function(t){if(t){var e=function breakDownLine(t){var e=function extractName(t){if(-1===t.indexOf(":"))return{name:"RRULE",value:t};var e=Object(o.l)(t,":",1),n=e[0],i=e[1];return{name:n,value:i}}(t),n=e.name,i=e.value,r=n.split(";");if(!r)throw new Error("empty property name");return{name:r[0].toUpperCase(),parms:r.slice(1),value:i}}(t),s=e.name,l=e.parms,c=e.value;switch(s.toUpperCase()){case"RRULE":if(l.length)throw new Error("unsupported RRULE parm: "+l.join(","));n.push(parseString(t));break;case"RDATE":var h=/RDATE(?:;TZID=([^:=]+))?/i.exec(t),d=(h[0],h[1]);d&&!u&&(u=d),i=i.concat(parseRDate(c,l));break;case"EXRULE":if(l.length)throw new Error("unsupported EXRULE parm: "+l.join(","));r.push(parseString(c));break;case"EXDATE":a=a.concat(parseRDate(c,l));break;case"DTSTART":break;default:throw new Error("unsupported property: "+s)}}})),{dtstart:l,tzid:u,rrulevals:n,rdatevals:i,exrulevals:r,exdatevals:a}}function rrulestr(t,e){return void 0===e&&(e={}),function buildRule(t,e){var n=parseInput(t,e),i=n.rrulevals,r=n.rdatevals,o=n.exrulevals,a=n.exdatevals,s=n.dtstart,l=n.tzid,u=!1===e.cache;if(e.compatible&&(e.forceset=!0,e.unfold=!0),e.forceset||i.length>1||r.length||o.length||a.length){var c=new V(u);return c.dtstart(s),c.tzid(l||void 0),i.forEach((function(t){c.rrule(new F(groomRruleOptions(t,s,l),u))})),r.forEach((function(t){c.rdate(t)})),o.forEach((function(t){c.exrule(new F(groomRruleOptions(t,s,l),u))})),a.forEach((function(t){c.exdate(t)})),e.compatible&&e.dtstart&&c.rdate(s),c}var h=i[0]||{};return new F(groomRruleOptions(h,h.dtstart||e.dtstart||s,h.tzid||e.tzid||l),u)}(t,function rrulestr_initializeOptions(t){var e=[],n=Object.keys(t),i=Object.keys(U);if(n.forEach((function(t){Object(o.c)(i,t)||e.push(t)})),e.length)throw new Error("Invalid options: "+e.join(", "));var r=__assign({},t);return i.forEach((function(t){Object(o.c)(n,t)||(r[t]=U[t])})),r}(e))}function groomRruleOptions(t,e,n){return __assign({},t,{dtstart:e,tzid:n})}function parseRDate(t,e){return function validateDateParm(t){t.forEach((function(t){if(!/(VALUE=DATE(-TIME)?)|(TZID=)/.test(t))throw new Error("unsupported RDATE/EXDATE parm: "+t)}))}(e),t.split(",").map((function(t){return a.untilStringToDate(t)}))}function createGetterSetter(t){var e=this;return function(n){if(void 0!==n&&(e["_"+t]=n),void 0!==e["_"+t])return e["_"+t];for(var i=0;i<e._rrule.length;i++){var r=e._rrule[i].origOptions[t];if(r)return r}}}var V=function(t){function RRuleSet(e){void 0===e&&(e=!1);var n=t.call(this,{},e)||this;return n.dtstart=createGetterSetter.apply(n,["dtstart"]),n.tzid=createGetterSetter.apply(n,["tzid"]),n._rrule=[],n._rdate=[],n._exrule=[],n._exdate=[],n}return __extends(RRuleSet,t),RRuleSet.prototype._iter=function(t){return function iterSet(t,e,n,i,r,o){var s={},l=t.accept;function evalExdate(t,e){n.forEach((function(n){n.between(t,e,!0).forEach((function(t){s[Number(t)]=!0}))}))}r.forEach((function(t){var e=new m(t,o).rezonedDate();s[Number(e)]=!0})),t.accept=function(t){var e=Number(t);return!(!s[e]&&(evalExdate(new Date(e-1),new Date(e+1)),!s[e]))||(s[e]=!0,l.call(this,t))},"between"===t.method&&(evalExdate(t.args.after,t.args.before),t.accept=function(t){var e=Number(t);return!!s[e]||(s[e]=!0,l.call(this,t))});for(var u=0;u<i.length;u++){var c=new m(i[u],o).rezonedDate();if(!t.accept(new Date(c.getTime())))break}e.forEach((function(e){iter(t,e.options)}));var h=t._result;switch(a.sort(h),t.method){case"all":case"between":return h;case"before":return h.length&&h[h.length-1]||null;case"after":default:return h.length&&h[0]||null}}(t,this._rrule,this._exrule,this._rdate,this._exdate,this.tzid())},RRuleSet.prototype.rrule=function(t){_addRule(t,this._rrule)},RRuleSet.prototype.exrule=function(t){_addRule(t,this._exrule)},RRuleSet.prototype.rdate=function(t){_addDate(t,this._rdate)},RRuleSet.prototype.exdate=function(t){_addDate(t,this._exdate)},RRuleSet.prototype.rrules=function(){return this._rrule.map((function(t){return rrulestr(t.toString())}))},RRuleSet.prototype.exrules=function(){return this._exrule.map((function(t){return rrulestr(t.toString())}))},RRuleSet.prototype.rdates=function(){return this._rdate.map((function(t){return new Date(t.getTime())}))},RRuleSet.prototype.exdates=function(){return this._exdate.map((function(t){return new Date(t.getTime())}))},RRuleSet.prototype.valueOf=function(){var t=[];return!this._rrule.length&&this._dtstart&&(t=t.concat(optionsToString({dtstart:this._dtstart}))),this._rrule.forEach((function(e){t=t.concat(e.toString().split("\n"))})),this._exrule.forEach((function(e){t=t.concat(e.toString().split("\n").map((function(t){return t.replace(/^RRULE:/,"EXRULE:")})).filter((function(t){return!/^DTSTART/.test(t)})))})),this._rdate.length&&t.push(rdatesToString("RDATE",this._rdate,this.tzid())),this._exdate.length&&t.push(rdatesToString("EXDATE",this._exdate,this.tzid())),t},RRuleSet.prototype.toString=function(){return this.valueOf().join("\n")},RRuleSet.prototype.clone=function(){var t=new RRuleSet(!!this._cache);return this._rrule.forEach((function(e){return t.rrule(e.clone())})),this._exrule.forEach((function(e){return t.exrule(e.clone())})),this._rdate.forEach((function(e){return t.rdate(new Date(e.getTime()))})),this._exdate.forEach((function(e){return t.exdate(new Date(e.getTime()))})),t},RRuleSet}(F);function _addRule(t,e){if(!(t instanceof F))throw new TypeError(String(t)+" is not RRule instance");Object(o.c)(e.map(String),String(t))||e.push(t)}function _addDate(t,e){if(!(t instanceof Date))throw new TypeError(String(t)+" is not Date instance");Object(o.c)(e.map(Number),Number(t))||(e.push(t),a.sort(e))}function rdatesToString(t,e,n){var i=!n||"UTC"===n.toUpperCase();return""+(i?t+":":t+";TZID="+n+":")+e.map((function(t){return a.timeToUntilString(t.valueOf(),i)})).join(",")}n.d(e,"Frequency",(function(){return l})),n.d(e,"Weekday",(function(){return h})),n.d(e,"RRule",(function(){return F})),n.d(e,"RRuleSet",(function(){return V})),n.d(e,"rrulestr",(function(){return rrulestr}));
/*!
     * rrule.js - Library for working with recurrence rules for calendar dates.
     * https://github.com/jakubroztocil/rrule
     *
     * Copyright 2010, Jakub Roztocil and Lars Schoning
     * Licenced under the BSD licence.
     * https://github.com/jakubroztocil/rrule/blob/master/LICENCE
     *
     * Based on:
     * python-dateutil - Extensions to the standard Python datetime module.
     * Copyright (c) 2003-2011 - Gustavo Niemeyer <gustavo@niemeyer.net>
     * Copyright (c) 2012 - Tomi Pieviläinen <tomi.pievilainen@iki.fi>
     * https://github.com/jakubroztocil/rrule/blob/master/LICENCE
     *
     */e.default=F},function(e,n){e.exports=t},function(t,e,n){n.r(e);var i={dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],tokens:{SKIP:/^[ \r\n\t]+|^\.$/,number:/^[1-9][0-9]*/,numberAsText:/^(one|two|three)/i,every:/^every/i,"day(s)":/^days?/i,"weekday(s)":/^weekdays?/i,"week(s)":/^weeks?/i,"hour(s)":/^hours?/i,"minute(s)":/^minutes?/i,"month(s)":/^months?/i,"year(s)":/^years?/i,on:/^(on|in)/i,at:/^(at)/i,the:/^the/i,first:/^first/i,second:/^second/i,third:/^third/i,nth:/^([1-9][0-9]*)(\.|th|nd|rd|st)/i,last:/^last/i,for:/^for/i,"time(s)":/^times?/i,until:/^(un)?til/i,monday:/^mo(n(day)?)?/i,tuesday:/^tu(e(s(day)?)?)?/i,wednesday:/^we(d(n(esday)?)?)?/i,thursday:/^th(u(r(sday)?)?)?/i,friday:/^fr(i(day)?)?/i,saturday:/^sa(t(urday)?)?/i,sunday:/^su(n(day)?)?/i,january:/^jan(uary)?/i,february:/^feb(ruary)?/i,march:/^mar(ch)?/i,april:/^apr(il)?/i,may:/^may/i,june:/^june?/i,july:/^july?/i,august:/^aug(ust)?/i,september:/^sep(t(ember)?)?/i,october:/^oct(ober)?/i,november:/^nov(ember)?/i,december:/^dec(ember)?/i,comma:/^(,\s*|(and|or)\s*)+/i}},r=n(1),o=n(0),contains=function(t,e){return-1!==t.indexOf(e)},defaultGetText=function(t){return t.toString()},defaultDateFormatter=function(t,e,n){return e+" "+n+", "+t},a=function(){function ToText(t,e,n,r){if(void 0===e&&(e=defaultGetText),void 0===n&&(n=i),void 0===r&&(r=defaultDateFormatter),this.text=[],this.language=n||i,this.gettext=e,this.dateFormatter=r,this.rrule=t,this.options=t.options,this.origOptions=t.origOptions,this.origOptions.bymonthday){var a=[].concat(this.options.bymonthday),s=[].concat(this.options.bynmonthday);a.sort((function(t,e){return t-e})),s.sort((function(t,e){return e-t})),this.bymonthday=a.concat(s),this.bymonthday.length||(this.bymonthday=null)}if(Object(o.f)(this.origOptions.byweekday)){var l=Object(o.d)(this.origOptions.byweekday)?this.origOptions.byweekday:[this.origOptions.byweekday],u=String(l);this.byweekday={allWeeks:l.filter((function(t){return!t.n})),someWeeks:l.filter((function(t){return Boolean(t.n)})),isWeekdays:-1!==u.indexOf("MO")&&-1!==u.indexOf("TU")&&-1!==u.indexOf("WE")&&-1!==u.indexOf("TH")&&-1!==u.indexOf("FR")&&-1===u.indexOf("SA")&&-1===u.indexOf("SU"),isEveryDay:-1!==u.indexOf("MO")&&-1!==u.indexOf("TU")&&-1!==u.indexOf("WE")&&-1!==u.indexOf("TH")&&-1!==u.indexOf("FR")&&-1!==u.indexOf("SA")&&-1!==u.indexOf("SU")};var sortWeekDays=function(t,e){return t.weekday-e.weekday};this.byweekday.allWeeks.sort(sortWeekDays),this.byweekday.someWeeks.sort(sortWeekDays),this.byweekday.allWeeks.length||(this.byweekday.allWeeks=null),this.byweekday.someWeeks.length||(this.byweekday.someWeeks=null)}else this.byweekday=null}return ToText.isFullyConvertible=function(t){if(!(t.options.freq in ToText.IMPLEMENTED))return!1;if(t.origOptions.until&&t.origOptions.count)return!1;for(var e in t.origOptions){if(contains(["dtstart","wkst","freq"],e))return!0;if(!contains(ToText.IMPLEMENTED[t.options.freq],e))return!1}return!0},ToText.prototype.isFullyConvertible=function(){return ToText.isFullyConvertible(this.rrule)},ToText.prototype.toString=function(){var t=this.gettext;if(!(this.options.freq in ToText.IMPLEMENTED))return t("RRule error: Unable to fully convert this rrule to text");if(this.text=[t("every")],this[r.default.FREQUENCIES[this.options.freq]](),this.options.until){this.add(t("until"));var e=this.options.until;this.add(this.dateFormatter(e.getUTCFullYear(),this.language.monthNames[e.getUTCMonth()],e.getUTCDate()))}else this.options.count&&this.add(t("for")).add(this.options.count.toString()).add(this.plural(this.options.count)?t("times"):t("time"));return this.isFullyConvertible()||this.add(t("(~ approximate)")),this.text.join("")},ToText.prototype.HOURLY=function(){var t=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("hours"):t("hour"))},ToText.prototype.MINUTELY=function(){var t=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()),this.add((this.plural(this.options.interval),t("minutes")))},ToText.prototype.DAILY=function(){var t=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()),this.byweekday&&this.byweekday.isWeekdays?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(this.plural(this.options.interval)?t("days"):t("day")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday?this._byweekday():this.origOptions.byhour&&this._byhour()},ToText.prototype.WEEKLY=function(){var t=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()).add(this.plural(this.options.interval)?t("weeks"):t("week")),this.byweekday&&this.byweekday.isWeekdays?1===this.options.interval?this.add(this.plural(this.options.interval)?t("weekdays"):t("weekday")):this.add(t("on")).add(t("weekdays")):this.byweekday&&this.byweekday.isEveryDay?this.add(this.plural(this.options.interval)?t("days"):t("day")):(1===this.options.interval&&this.add(t("week")),this.origOptions.bymonth&&(this.add(t("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday())},ToText.prototype.MONTHLY=function(){var t=this.gettext;this.origOptions.bymonth?(1!==this.options.interval&&(this.add(this.options.interval.toString()).add(t("months")),this.plural(this.options.interval)&&this.add(t("in"))),this._bymonth()):(1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("months"):t("month"))),this.bymonthday?this._bymonthday():this.byweekday&&this.byweekday.isWeekdays?this.add(t("on")).add(t("weekdays")):this.byweekday&&this._byweekday()},ToText.prototype.YEARLY=function(){var t=this.gettext;this.origOptions.bymonth?(1!==this.options.interval&&(this.add(this.options.interval.toString()),this.add(t("years"))),this._bymonth()):(1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?t("years"):t("year"))),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.options.byyearday&&this.add(t("on the")).add(this.list(this.options.byyearday,this.nth,t("and"))).add(t("day")),this.options.byweekno&&this.add(t("in")).add(this.plural(this.options.byweekno.length)?t("weeks"):t("week")).add(this.list(this.options.byweekno,void 0,t("and")))},ToText.prototype._bymonthday=function(){var t=this.gettext;this.byweekday&&this.byweekday.allWeeks?this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext,t("or"))).add(t("the")).add(this.list(this.bymonthday,this.nth,t("or"))):this.add(t("on the")).add(this.list(this.bymonthday,this.nth,t("and")))},ToText.prototype._byweekday=function(){var t=this.gettext;this.byweekday.allWeeks&&!this.byweekday.isWeekdays&&this.add(t("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext)),this.byweekday.someWeeks&&(this.byweekday.allWeeks&&this.add(t("and")),this.add(t("on the")).add(this.list(this.byweekday.someWeeks,this.weekdaytext,t("and"))))},ToText.prototype._byhour=function(){var t=this.gettext;this.add(t("at")).add(this.list(this.origOptions.byhour,void 0,t("and")))},ToText.prototype._bymonth=function(){this.add(this.list(this.options.bymonth,this.monthtext,this.gettext("and")))},ToText.prototype.nth=function(t){var e,n;t=parseInt(t.toString(),10);var i=this.gettext;if(-1===t)return i("last");switch(n=Math.abs(t)){case 1:case 21:case 31:e=n+i("st");break;case 2:case 22:e=n+i("nd");break;case 3:case 23:e=n+i("rd");break;default:e=n+i("th")}return t<0?e+" "+i("last"):e},ToText.prototype.monthtext=function(t){return this.language.monthNames[t-1]},ToText.prototype.weekdaytext=function(t){var e=Object(o.e)(t)?(t+1)%7:t.getJsWeekday();return(t.n?this.nth(t.n)+" ":"")+this.language.dayNames[e]},ToText.prototype.plural=function(t){return t%100!=1},ToText.prototype.add=function(t){return this.text.push(" "),this.text.push(t),this},ToText.prototype.list=function(t,e,n,i){void 0===i&&(i=","),Object(o.d)(t)||(t=[t]);e=e||function(t){return t.toString()};var r=this,realCallback=function(t){return e&&e.call(r,t)};return n?function(t,e,n){for(var i="",r=0;r<t.length;r++)0!==r&&(r===t.length-1?i+=" "+n+" ":i+=e+" "),i+=t[r];return i}(t.map(realCallback),i,n):t.map(realCallback).join(i+" ")},ToText}(),s=function(){function Parser(t){this.done=!0,this.rules=t}return Parser.prototype.start=function(t){return this.text=t,this.done=!1,this.nextSymbol()},Parser.prototype.isDone=function(){return this.done&&null===this.symbol},Parser.prototype.nextSymbol=function(){var t,e;this.symbol=null,this.value=null;do{if(this.done)return!1;for(var n in t=null,this.rules){var i=this.rules[n].exec(this.text);i&&(null===t||i[0].length>t[0].length)&&(t=i,e=n)}if(null!=t&&(this.text=this.text.substr(t[0].length),""===this.text&&(this.done=!0)),null==t)return this.done=!0,this.symbol=null,void(this.value=null)}while("SKIP"===e);return this.symbol=e,this.value=t,!0},Parser.prototype.accept=function(t){if(this.symbol===t){if(this.value){var e=this.value;return this.nextSymbol(),e}return this.nextSymbol(),!0}return!1},Parser.prototype.acceptNumber=function(){return this.accept("number")},Parser.prototype.expect=function(t){if(this.accept(t))return!0;throw new Error("expected "+t+" but found "+this.symbol)},Parser}();function parseText(t,e){void 0===e&&(e=i);var n={},o=new s(e.tokens);return o.start(t)?(function S(){o.expect("every");var t=o.acceptNumber();t&&(n.interval=parseInt(t[0],10));if(o.isDone())throw new Error("Unexpected end");switch(o.symbol){case"day(s)":n.freq=r.default.DAILY,o.nextSymbol()&&(!function AT(){if(!o.accept("at"))return;do{var t=o.acceptNumber();if(!t)throw new Error("Unexpected symbol "+o.symbol+", expected hour");for(n.byhour=[parseInt(t[0],10)];o.accept("comma");){if(!(t=o.acceptNumber()))throw new Error("Unexpected symbol "+o.symbol+"; expected hour");n.byhour.push(parseInt(t[0],10))}}while(o.accept("comma")||o.accept("at"))}(),F());break;case"weekday(s)":n.freq=r.default.WEEKLY,n.byweekday=[r.default.MO,r.default.TU,r.default.WE,r.default.TH,r.default.FR],o.nextSymbol(),F();break;case"week(s)":n.freq=r.default.WEEKLY,o.nextSymbol()&&(ON(),F());break;case"hour(s)":n.freq=r.default.HOURLY,o.nextSymbol()&&(ON(),F());break;case"minute(s)":n.freq=r.default.MINUTELY,o.nextSymbol()&&(ON(),F());break;case"month(s)":n.freq=r.default.MONTHLY,o.nextSymbol()&&(ON(),F());break;case"year(s)":n.freq=r.default.YEARLY,o.nextSymbol()&&(ON(),F());break;case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":n.freq=r.default.WEEKLY;var e=o.symbol.substr(0,2).toUpperCase();if(n.byweekday=[r.default[e]],!o.nextSymbol())return;for(;o.accept("comma");){if(o.isDone())throw new Error("Unexpected end");var i=decodeWKD();if(!i)throw new Error("Unexpected symbol "+o.symbol+", expected weekday");n.byweekday.push(r.default[i]),o.nextSymbol()}!function MDAYs(){o.accept("on"),o.accept("the");var t=decodeNTH();if(!t)return;n.bymonthday=[t],o.nextSymbol();for(;o.accept("comma");){if(!(t=decodeNTH()))throw new Error("Unexpected symbol "+o.symbol+"; expected monthday");n.bymonthday.push(t),o.nextSymbol()}}(),F();break;case"january":case"february":case"march":case"april":case"may":case"june":case"july":case"august":case"september":case"october":case"november":case"december":if(n.freq=r.default.YEARLY,n.bymonth=[decodeM()],!o.nextSymbol())return;for(;o.accept("comma");){if(o.isDone())throw new Error("Unexpected end");var a=decodeM();if(!a)throw new Error("Unexpected symbol "+o.symbol+", expected month");n.bymonth.push(a),o.nextSymbol()}ON(),F();break;default:throw new Error("Unknown symbol")}}(),n):null;function ON(){var t=o.accept("on"),e=o.accept("the");if(t||e)do{var i=decodeNTH(),a=decodeWKD(),s=decodeM();if(i)a?(o.nextSymbol(),n.byweekday||(n.byweekday=[]),n.byweekday.push(r.default[a].nth(i))):(n.bymonthday||(n.bymonthday=[]),n.bymonthday.push(i),o.accept("day(s)"));else if(a)o.nextSymbol(),n.byweekday||(n.byweekday=[]),n.byweekday.push(r.default[a]);else if("weekday(s)"===o.symbol)o.nextSymbol(),n.byweekday||(n.byweekday=[r.default.MO,r.default.TU,r.default.WE,r.default.TH,r.default.FR]);else if("week(s)"===o.symbol){o.nextSymbol();var l=o.acceptNumber();if(!l)throw new Error("Unexpected symbol "+o.symbol+", expected week number");for(n.byweekno=[parseInt(l[0],10)];o.accept("comma");){if(!(l=o.acceptNumber()))throw new Error("Unexpected symbol "+o.symbol+"; expected monthday");n.byweekno.push(parseInt(l[0],10))}}else{if(!s)return;o.nextSymbol(),n.bymonth||(n.bymonth=[]),n.bymonth.push(s)}}while(o.accept("comma")||o.accept("the")||o.accept("on"))}function decodeM(){switch(o.symbol){case"january":return 1;case"february":return 2;case"march":return 3;case"april":return 4;case"may":return 5;case"june":return 6;case"july":return 7;case"august":return 8;case"september":return 9;case"october":return 10;case"november":return 11;case"december":return 12;default:return!1}}function decodeWKD(){switch(o.symbol){case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":return o.symbol.substr(0,2).toUpperCase();default:return!1}}function decodeNTH(){switch(o.symbol){case"last":return o.nextSymbol(),-1;case"first":return o.nextSymbol(),1;case"second":return o.nextSymbol(),o.accept("last")?-2:2;case"third":return o.nextSymbol(),o.accept("last")?-3:3;case"nth":var t=parseInt(o.value[1],10);if(t<-366||t>366)throw new Error("Nth out of range: "+t);return o.nextSymbol(),o.accept("last")?-t:t;default:return!1}}function F(){if("until"===o.symbol){var t=Date.parse(o.text);if(!t)throw new Error("Cannot parse until date:"+o.text);n.until=new Date(t)}else o.accept("for")&&(n.count=parseInt(o.value[0],10),o.expect("number"))}}n.d(e,"fromText",(function(){return fromText})),n.d(e,"isFullyConvertible",(function(){return u})),n.d(e,"toText",(function(){return toText})),n.d(e,"parseText",(function(){return parseText}));
/*!
    * rrule.js - Library for working with recurrence rules for calendar dates.
    * https://github.com/jakubroztocil/rrule
    *
    * Copyright 2010, Jakub Roztocil and Lars Schoning
    * Licenced under the BSD licence.
    * https://github.com/jakubroztocil/rrule/blob/master/LICENCE
    *
    */
var fromText=function(t,e){return void 0===e&&(e=i),new r.default(parseText(t,e)||void 0)},l=["count","until","interval","byweekday","bymonthday","bymonth"];a.IMPLEMENTED=[],a.IMPLEMENTED[r.default.HOURLY]=l,a.IMPLEMENTED[r.default.MINUTELY]=l,a.IMPLEMENTED[r.default.DAILY]=["byhour"].concat(l),a.IMPLEMENTED[r.default.WEEKLY]=l,a.IMPLEMENTED[r.default.MONTHLY]=l,a.IMPLEMENTED[r.default.YEARLY]=["byweekno","byyearday"].concat(l);var toText=function(t,e,n,i){return new a(t,e,n,i).toString()},u=a.isFullyConvertible}])}))})));
/**
     * @fileoverview Constant definitions for the animator.
     * @author Finnish Meteorological Institute
     * @license MIT
     */
const De="noselect",je=36e5,Ne=2147483647,Fe="history",Ue="future",Ve="working",ze="success",Ge=1e3,qe="playing",We="fmi-metoclient-timeslider-clickable-container",Be="fmi-metoclient-timeslider-pre-margin",Ze="fmi-metoclient-timeslider-pre-tools",Ke="fmi-metoclient-timeslider-frames-container",Ye="fmi-metoclient-timeslider-play-button",He="fmi-metoclient-timeslider-post-tools",Xe="fmi-metoclient-timeslider-step-button",$e="fmi-metoclient-timeslider-post-margin",Qe="fmi-metoclient-timeslider-timezone",Je="fmi-metoclient-timeslider-frame-tick",tn="fmi-metoclient-timeslider-frame-text-wrapper",en="fmi-metoclient-timeslider-frame-text",nn="fmi-metoclient-timeslider-drag-listener",rn="fmi-metoclient-timeslider-interactions",on="fmi-metoclient-timeslider-pointer",an="fmi-metoclient-timeslider-pointer-wrapper",sn="fmi-metoclient-timeslider-pointer-text",ln="fmi-metoclient-timeslider-handle",un="fmi-metoclient-timeslider-pointer-infotip",cn="fmi-metoclient-timeslider-indicator",hn="fmi-metoclient-timeslider-hidden",dn="dragging",pn="working",fn=-1,mn=1,yn="fmi-metoclient-timeslider-keyboard-accessible",gn=100,vn=9e5,_n=500,bn=500,Tn=300,wn="request=GetCapabilities",En={sources:{},time:null,timeZone:"Europe/Helsinki",timeZoneLabel:"",container:"map",resolutions:[2048,1024,512,256,128,64],metadata:{refreshInterval:"map"},delay:Ge,periodDelay:2*Ge,texts:{"Zoom In":"Zoom In","Zoom Out":"Zoom Out",Legend:"Legend"}},Sn=1024,Mn="metoclient:time",On="present",xn="metoclient:defaultLegend",Pn="fmi-metoclient-layer-switcher-container",Cn="fmi-metoclient-legend-chooser-container",In="fmi-metoclient-legend-chooser-label",Ln="fmi-metoclient-legend-chooser-select",Rn="fmi-metoclient-legend-container";function parseTimes(t,e,n=null){const i=Date.now();let r=[];if(null==t)r=[];else if(Array.isArray(t))r=t.map(t=>new Date(t).getTime());else if("object"==typeof t){new Ae(t).all().map(t=>DateTime.fromJSDate(t).toUTC().valueOf()).forEach(t=>{r.includes(t)||r.push(t)})}else if(t.includes(",")){const e=t.split(",");r=e.map(t=>new Date(t).getTime())}else if(t.includes("/")){const e=t.split("/").map(t=>{if(t.toLowerCase()===On)return{value:Date.now(),type:"date"};const e=new Date(t);if(function isValidDate(t){return t instanceof Date&&!isNaN(t)}(e))return{value:e.getTime(),type:"date"};try{return{value:Duration.fromISO(t).toObject(),type:"period"}}catch(t){return{value:null,type:null}}});if(2===e.length);else if(3===e.length&&"date"===e[0].type&&"date"===e[1].type&&"period"===e[2].type){const t=Duration.fromObject(e[2].value).as("milliseconds");let n=0,i=e[0].value;for(;i<=e[1].value;)r.push(i),n++,i=e[0].value+n*t}}else{t.toLowerCase().split(" and ").map(t=>t.trim()).forEach(t=>{let o,a=t.startsWith("data");a&&(t=t.replace("data","every"));const s=t.split(" ");if(s.length>=2){const t=Number(s[0]);if(!isNaN(t)&&"times"===s[1].trim())return void(r=r.concat(Array(t).fill(s.length>=3&&"history"===s[2]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY)))}const l=t.includes(" history");t=t.replace(" history",""),a&&(t+=" for 2 times");try{o=Ae.fromText(t)}catch(t){return[]}if(a||(o.options.freq===Ae.HOURLY?(o.options.byhour=Array.from(Array(24).keys()).filter(t=>t%o.options.interval==0),o.options.byminute=[0],o.options.bysecond=[0],o.options.interval=1):o.options.freq===Ae.MINUTELY&&(o.options.byminute=Array.from(Array(60).keys()).filter(t=>t%o.options.interval==0),o.options.bysecond=[0],o.options.interval=1)),null!=e){let t=DateTime.fromJSDate(o.options.dtstart);if(null!=t){let n=Duration.fromISO(e);null!=n&&null!=(t=t.plus(n))&&(o.options.dtstart=t.toJSDate())}}let u,c=o.all().map(t=>DateTime.fromJSDate(t).toUTC().valueOf());if(l){let t=c.length-1;if(0===t){let t={...o.options};t.count=2;let e=new Ae(t).all();u=e[1]-e[0]}else u=(t+1)*(c[t]-c[0])/t;c=c.map(t=>t-u)}a?n.forEach(t=>{(l&&t>=c[1]&&t<=i||!l&&t<=c[1]&&t>=i)&&r.push(t)}):c.forEach(t=>{r.includes(t)||r.push(t)})})}return r.sort(),r}function getBaseUrl(t){return t.split(/[?#]/)[0]}var kn,An,Dn=0,jn=0,Nn=0,Fn=1e3,Un=0,Vn=0,zn=0,Gn="object"==typeof performance&&performance.now?performance:Date,qn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function now$1(){return Vn||(qn(clearNow),Vn=Gn.now()+zn)}function clearNow(){Vn=0}function Timer(){this._call=this._time=this._next=null}function wake(){Vn=(Un=Gn.now())+zn,Dn=jn=0;try{!function timerFlush(){now$1(),++Dn;for(var t,e=kn;e;)(t=Vn-e._time)>=0&&e._call.call(null,t),e=e._next;--Dn}()}finally{Dn=0,function nap(){var t,e,n=kn,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:kn=e);An=t,sleep(i)}(),Vn=0}}function poke(){var t=Gn.now(),e=t-Un;e>Fn&&(zn-=e,Un=t)}function sleep(t){Dn||(jn&&(jn=clearTimeout(jn)),t-Vn>24?(t<1/0&&(jn=setTimeout(wake,t-Gn.now()-zn)),Nn&&(Nn=clearInterval(Nn))):(Nn||(Un=Gn.now(),Nn=setInterval(poke,Fn)),Dn=1,qn(wake)))}function timeout$1(t,e,n){var i=new Timer;return e=null==e?0:+e,i.restart((function(n){i.stop(),t(n+e)}),e,n),i}Timer.prototype=function timer(t,e,n){var i=new Timer;return i.restart(t,e,n),i}.prototype={constructor:Timer,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?now$1():+n)+(null==e?0:+e),this._next||An===this||(An?An._next=this:kn=this,An=this),this._call=t,this._time=n,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var Wn="propertychange";function listen(t,e,n,i,r){if(i&&i!==t&&(n=n.bind(i)),r){var o=n;n=function(){t.removeEventListener(e,n),o.apply(this,arguments)}}var a={target:t,type:e,listener:n};return t.addEventListener(e,n),a}function listenOnce(t,e,n,i){return listen(t,e,n,i,!0)}function unlistenByKey(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),clear(t))}var Bn=function(){function Disposable(){this.disposed_=!1}return Disposable.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},Disposable.prototype.disposeInternal=function(){},Disposable}();function numberSafeCompareFunction(t,e){return t>e?1:t<e?-1:0}function includes(t,e){return t.indexOf(e)>=0}function linearFindNearest(t,e,n){var i=t.length;if(t[0]<=e)return 0;if(e<=t[i-1])return i-1;var r=void 0;if(n>0){for(r=1;r<i;++r)if(t[r]<e)return r-1}else if(n<0){for(r=1;r<i;++r)if(t[r]<=e)return r}else for(r=1;r<i;++r){if(t[r]==e)return r;if(t[r]<e)return t[r-1]-e<e-t[r]?r-1:r}return i-1}function find(t,e){for(var n,i=t.length>>>0,r=0;r<i;r++)if(e(n=t[r],r,t))return n;return null}function equals$1(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function findIndex(t,e){var n;return!t.every((function(i,r){return n=r,!e(i,r,t)}))?n:-1}function TRUE(){return!0}function FALSE(){return!1}function VOID(){}var Zn=function(){function BaseEvent(t){this.propagationStopped,this.type=t,this.target=null}return BaseEvent.prototype.preventDefault=function(){this.propagationStopped=!0},BaseEvent.prototype.stopPropagation=function(){this.propagationStopped=!0},BaseEvent}(),Kn=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Yn=function(t){function Target(e){var n=t.call(this)||this;return n.eventTarget_=e,n.pendingRemovals_={},n.dispatching_={},n.listeners_={},n}return Kn(Target,t),Target.prototype.addEventListener=function(t,e){if(t&&e){var n=this.listeners_[t];n||(n=[],this.listeners_[t]=n),-1===n.indexOf(e)&&n.push(e)}},Target.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Zn(t):t,n=e.type;e.target||(e.target=this.eventTarget_||this);var i,r=this.listeners_[n];if(r){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var o=0,a=r.length;o<a;++o)if(!1===r[o].call(this,e)||e.propagationStopped){i=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var s=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];s--;)this.removeEventListener(n,VOID);delete this.dispatching_[n]}return i}},Target.prototype.disposeInternal=function(){clear(this.listeners_)},Target.prototype.getListeners=function(t){return this.listeners_[t]},Target.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},Target.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var i=n.indexOf(e);-1!==i&&(t in this.pendingRemovals_?(n[i]=VOID,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}},Target}(Bn),Hn={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",WHEEL:"wheel"},Xn=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),$n=function(t){function Observable(){var e=t.call(this)||this;return e.revision_=0,e}return Xn(Observable,t),Observable.prototype.changed=function(){++this.revision_,this.dispatchEvent(Hn.CHANGE)},Observable.prototype.getRevision=function(){return this.revision_},Observable.prototype.on=function(t,e){if(Array.isArray(t)){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=listen(this,t[r],e);return i}return listen(this,t,e)},Observable.prototype.once=function(t,e){if(Array.isArray(t)){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=listenOnce(this,t[r],e);return i}return listenOnce(this,t,e)},Observable.prototype.un=function(t,e){if(Array.isArray(t))for(var n=0,i=t.length;n<i;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)},Observable}(Yn);function unByKey(t){if(Array.isArray(t))for(var e=0,n=t.length;e<n;++e)unlistenByKey(t[e]);else unlistenByKey(t)}var Qn=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Jn=function(t){function ObjectEvent(e,n,i){var r=t.call(this,e)||this;return r.key=n,r.oldValue=i,r}return Qn(ObjectEvent,t),ObjectEvent}(Zn),ti=function(e){function BaseObject(t){var n=e.call(this)||this;return getUid(n),n.values_={},void 0!==t&&n.setProperties(t),n}return Qn(BaseObject,e),BaseObject.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},BaseObject.prototype.getKeys=function(){return Object.keys(this.values_)},BaseObject.prototype.getProperties=function(){return t({},this.values_)},BaseObject.prototype.notify=function(t,e){var n;n=getChangeEventType(t),this.dispatchEvent(new Jn(n,t,e)),n=Wn,this.dispatchEvent(new Jn(n,t,e))},BaseObject.prototype.set=function(t,e,n){if(n)this.values_[t]=e;else{var i=this.values_[t];this.values_[t]=e,i!==e&&this.notify(t,i)}},BaseObject.prototype.setProperties=function(t,e){for(var n in t)this.set(n,t[n],e)},BaseObject.prototype.unset=function(t,e){if(t in this.values_){var n=this.values_[t];delete this.values_[t],e||this.notify(t,n)}},BaseObject}($n),ei={};function getChangeEventType(t){return ei.hasOwnProperty(t)?ei[t]:ei[t]="change:"+t}var ni=function emptyElement(t){if(!(t instanceof HTMLElement))throw new TypeError("Expected an element");for(var e;e=t.lastChild;)t.removeChild(e);return t},ii=createCommonjsModule((function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var n=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}})),ri=(ii.node,ii.nodeList,ii.string,ii.fn,9);if("undefined"!=typeof Element&&!Element.prototype.matches){var oi=Element.prototype;oi.matches=oi.matchesSelector||oi.mozMatchesSelector||oi.msMatchesSelector||oi.oMatchesSelector||oi.webkitMatchesSelector}var ai=function closest(t,e){for(;t&&t.nodeType!==ri;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}};function _delegate(t,e,n,i,r){var o=listener.apply(this,arguments);return t.addEventListener(n,o,r),{destroy:function(){t.removeEventListener(n,o,r)}}}function listener(t,e,n,i){return function(n){n.delegateTarget=ai(n.target,e),n.delegateTarget&&i.call(t,n)}}var si=function delegate(t,e,n,i,r){return"function"==typeof t.addEventListener?_delegate.apply(null,arguments):"function"==typeof n?_delegate.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return _delegate(t,e,n,i,r)})))};var li=function listen$1(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!ii.string(e))throw new TypeError("Second argument must be a String");if(!ii.fn(n))throw new TypeError("Third argument must be a Function");if(ii.node(t))return function listenNode(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}(t,e,n);if(ii.nodeList(t))return function listenNodeList(t,e,n){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,n)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,n)}))}}}(t,e,n);if(ii.string(t))return function listenSelector(t,e,n){return si(document.body,t,e,n)}(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")},ui=createCommonjsModule((function(t){(t.exports={}).forEach=function(t,e){for(var n=0;n<t.length;n++){var i=e(t[n]);if(i)return i}}})),ci=createCommonjsModule((function(t){var e=t.exports={};e.isIE=function(t){return!!function isAnyIeVersion(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("msie")||-1!==t.indexOf("trident")||-1!==t.indexOf(" edge/")}()&&(!t||t===function(){var t=3,e=document.createElement("div"),n=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(n[0]);return t>4?t:void 0}())},e.isLegacyOpera=function(){return!!window.opera}})),hi=createCommonjsModule((function(t){(t.exports={}).getOption=function getOption(t,e,n){var i=t[e];if(null==i&&void 0!==n)return n;return i}})),di=function batchProcessorMaker(t){var e=(t=t||{}).reporter,n=hi.getOption(t,"async",!0),i=hi.getOption(t,"auto",!0);i&&!n&&(e&&e.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),n=!0);var r,o=Batch(),a=!1;function processBatch(){for(a=!0;o.size();){var t=o;o=Batch(),t.process()}a=!1}function processBatchAsync(){r=function requestFrame(t){return e=t,setTimeout(e,0);var e}(processBatch)}return{add:function addFunction(t,e){!a&&i&&n&&0===o.size()&&processBatchAsync(),o.add(t,e)},force:function forceProcessBatch(t){a||(void 0===t&&(t=n),r&&(!function cancelFrame(t){return clearTimeout(t)}(r),r=null),t?processBatchAsync():processBatch())}}};function Batch(){var t={},e=0,n=0,i=0;return{add:function add(r,o){o||(o=r,r=0),r>n?n=r:r<i&&(i=r),t[r]||(t[r]=[]),t[r].push(o),e++},process:function process(){for(var e=i;e<=n;e++)for(var r=t[e],o=0;o<r.length;o++){(0,r[o])()}},size:function getSize(){return e}}}var pi="_erd";function getState(t){return t[pi]}var fi={initState:function initState(t){return t[pi]={},getState(t)},getState:getState,cleanState:function cleanState(t){delete t[pi]}},mi=ui.forEach,scroll=function(t){var e=(t=t||{}).reporter,n=t.batchProcessor,i=t.stateHandler.getState,r=(t.stateHandler.hasState,t.idHandler);if(!n)throw new Error("Missing required dependency: batchProcessor");if(!e)throw new Error("Missing required dependency: reporter.");var o=function getScrollbarSizes(){var t=document.createElement("div");t.style.cssText="position: absolute; width: 1000px; height: 1000px; visibility: hidden; margin: 0; padding: 0;";var e=document.createElement("div");e.style.cssText="position: absolute; width: 500px; height: 500px; overflow: scroll; visibility: none; top: -1500px; left: -1500px; visibility: hidden; margin: 0; padding: 0;",e.appendChild(t),document.body.insertBefore(e,document.body.firstChild);var n=500-e.clientWidth,i=500-e.clientHeight;return document.body.removeChild(e),{width:n,height:i}}(),a="erd_scroll_detection_container";function addEvent(t,n,i){if(t.addEventListener)t.addEventListener(n,i);else{if(!t.attachEvent)return e.error("[scroll] Don't know how to add event listeners.");t.attachEvent("on"+n,i)}}function removeEvent(t,n,i){if(t.removeEventListener)t.removeEventListener(n,i);else{if(!t.detachEvent)return e.error("[scroll] Don't know how to remove event listeners.");t.detachEvent("on"+n,i)}}function getExpandElement(t){return i(t).container.childNodes[0].childNodes[0].childNodes[0]}function getShrinkElement(t){return i(t).container.childNodes[0].childNodes[0].childNodes[1]}return function injectScrollStyle(t,e){if(!document.getElementById(t)){var n=e+"_animation",i="/* Created by the element-resize-detector library. */\n";i+="."+e+" > div::-webkit-scrollbar { display: none; }\n\n",i+="."+(e+"_animation_active")+" { -webkit-animation-duration: 0.1s; animation-duration: 0.1s; -webkit-animation-name: "+n+"; animation-name: "+n+"; }\n",i+="@-webkit-keyframes "+n+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",function injectStyle(e,n){n=n||function(t){document.head.appendChild(t)};var i=document.createElement("style");return i.innerHTML=e,i.id=t,n(i),i}(i+="@keyframes "+n+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}("erd_scroll_detection_scrollbar_style",a),{makeDetectable:function makeDetectable(t,s,l){function debug(){if(t.debug){var n=Array.prototype.slice.call(arguments);if(n.unshift(r.get(s),"Scroll: "),e.log.apply)e.log.apply(null,n);else for(var i=0;i<n.length;i++)e.log(n[i])}}function isUnrendered(t){var e=i(t).container.childNodes[0],n=window.getComputedStyle(e);return!n.width||-1===n.width.indexOf("px")}function getStyle(){var t=window.getComputedStyle(s),e={};return e.position=t.position,e.width=s.offsetWidth,e.height=s.offsetHeight,e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left,e.widthCSS=t.width,e.heightCSS=t.height,e}function storeStyle(){if(debug("storeStyle invoked."),i(s)){var t=getStyle();i(s).style=t}else debug("Aborting because element has been uninstalled")}function storeCurrentSize(t,e,n){i(t).lastWidth=e,i(t).lastHeight=n}function getWidthOffset(){return 2*o.width+1}function getHeightOffset(){return 2*o.height+1}function getExpandWidth(t){return t+10+getWidthOffset()}function getExpandHeight(t){return t+10+getHeightOffset()}function positionScrollbars(t,e,n){var i=getExpandElement(t),r=getShrinkElement(t),o=getExpandWidth(e),a=getExpandHeight(n),s=function getShrinkWidth(t){return 2*t+getWidthOffset()}(e),l=function getShrinkHeight(t){return 2*t+getHeightOffset()}(n);i.scrollLeft=o,i.scrollTop=a,r.scrollLeft=s,r.scrollTop=l}function injectContainerElement(){var t=i(s).container;if(!t){(t=document.createElement("div")).className=a,t.style.cssText="visibility: hidden; display: inline; width: 0px; height: 0px; z-index: -1; overflow: hidden; margin: 0; padding: 0;",i(s).container=t,function addAnimationClass(t){t.className+=" "+a+"_animation_active"}(t),s.appendChild(t);var onAnimationStart=function(){i(s).onRendered&&i(s).onRendered()};addEvent(t,"animationstart",onAnimationStart),i(s).onAnimationStart=onAnimationStart}return t}function injectScrollElements(){if(debug("Injecting elements"),i(s)){!function alterPositionStyles(){var t=i(s).style;if("static"===t.position){s.style.position="relative";var removeRelativeStyles=function(t,e,n,i){var r=n[i];"auto"!==r&&"0"!==function getNumericalValue(t){return t.replace(/[^-\d\.]/g,"")}(r)&&(t.warn("An element that is positioned static has style."+i+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+i+" will be set to 0. Element: ",e),e.style[i]=0)};removeRelativeStyles(e,s,t,"top"),removeRelativeStyles(e,s,t,"right"),removeRelativeStyles(e,s,t,"bottom"),removeRelativeStyles(e,s,t,"left")}}();var t=i(s).container;t||(t=injectContainerElement());var n=o.width,r=o.height,l="position: absolute; flex: none; overflow: hidden; z-index: -1; visibility: hidden; "+function getLeftTopBottomRightCssText(t,e,n,i){return"left: "+(t=t?t+"px":"0")+"; top: "+(e=e?e+"px":"0")+"; right: "+(i=i?i+"px":"0")+"; bottom: "+(n=n?n+"px":"0")+";"}(-(1+n),-(1+r),-r,-n),u=document.createElement("div"),c=document.createElement("div"),h=document.createElement("div"),d=document.createElement("div"),p=document.createElement("div"),f=document.createElement("div");u.dir="ltr",u.style.cssText="position: absolute; flex: none; overflow: hidden; z-index: -1; visibility: hidden; width: 100%; height: 100%; left: 0px; top: 0px;",u.className=a,c.className=a,c.style.cssText=l,h.style.cssText="position: absolute; flex: none; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;",d.style.cssText="position: absolute; left: 0; top: 0;",p.style.cssText="position: absolute; flex: none; overflow: scroll; z-index: -1; visibility: hidden; width: 100%; height: 100%;",f.style.cssText="position: absolute; width: 200%; height: 200%;",h.appendChild(d),p.appendChild(f),c.appendChild(h),c.appendChild(p),u.appendChild(c),t.appendChild(u),addEvent(h,"scroll",onExpandScroll),addEvent(p,"scroll",onShrinkScroll),i(s).onExpandScroll=onExpandScroll,i(s).onShrinkScroll=onShrinkScroll}else debug("Aborting because element has been uninstalled");function onExpandScroll(){i(s).onExpand&&i(s).onExpand()}function onShrinkScroll(){i(s).onShrink&&i(s).onShrink()}}function registerListenersAndPositionElements(){function updateChildSizes(t,e,n){var i=function getExpandChildElement(t){return getExpandElement(t).childNodes[0]}(t),r=getExpandWidth(e),o=getExpandHeight(n);i.style.width=r+"px",i.style.height=o+"px"}function updateDetectorElements(o){var a=s.offsetWidth,l=s.offsetHeight;debug("Storing current size",a,l),storeCurrentSize(s,a,l),n.add(0,(function performUpdateChildSizes(){if(i(s))if(areElementsInjected()){if(t.debug){var n=s.offsetWidth,o=s.offsetHeight;n===a&&o===l||e.warn(r.get(s),"Scroll: Size changed before updating detector elements.")}updateChildSizes(s,a,l)}else debug("Aborting because element container has not been initialized");else debug("Aborting because element has been uninstalled")})),n.add(1,(function updateScrollbars(){i(s)?areElementsInjected()?positionScrollbars(s,a,l):debug("Aborting because element container has not been initialized"):debug("Aborting because element has been uninstalled")})),o&&n.add(2,(function(){i(s)?areElementsInjected()?o():debug("Aborting because element container has not been initialized"):debug("Aborting because element has been uninstalled")}))}function areElementsInjected(){return!!i(s).container}function notifyListenersIfNeeded(){debug("notifyListenersIfNeeded invoked");var t=i(s);return function isFirstNotify(){return void 0===i(s).lastNotifiedWidth}()&&t.lastWidth===t.startSize.width&&t.lastHeight===t.startSize.height?debug("Not notifying: Size is the same as the start size, and there has been no notification yet."):t.lastWidth===t.lastNotifiedWidth&&t.lastHeight===t.lastNotifiedHeight?debug("Not notifying: Size already notified"):(debug("Current size not notified, notifying..."),t.lastNotifiedWidth=t.lastWidth,t.lastNotifiedHeight=t.lastHeight,void mi(i(s).listeners,(function(t){t(s)})))}function handleScroll(){if(debug("Scroll detected."),isUnrendered(s))debug("Scroll event fired while unrendered. Ignoring...");else{var t=s.offsetWidth,e=s.offsetHeight;t!==i(s).lastWidth||e!==i(s).lastHeight?(debug("Element size changed."),updateDetectorElements(notifyListenersIfNeeded)):debug("Element size has not changed ("+t+"x"+e+").")}}if(debug("registerListenersAndPositionElements invoked."),i(s)){i(s).onRendered=function handleRender(){if(debug("startanimation triggered."),isUnrendered(s))debug("Ignoring since element is still unrendered...");else{debug("Element rendered.");var t=getExpandElement(s),e=getShrinkElement(s);0!==t.scrollLeft&&0!==t.scrollTop&&0!==e.scrollLeft&&0!==e.scrollTop||(debug("Scrollbars out of sync. Updating detector elements..."),updateDetectorElements(notifyListenersIfNeeded))}},i(s).onExpand=handleScroll,i(s).onShrink=handleScroll;var o=i(s).style;updateChildSizes(s,o.width,o.height)}else debug("Aborting because element has been uninstalled")}function finalizeDomMutation(){if(debug("finalizeDomMutation invoked."),i(s)){var t=i(s).style;storeCurrentSize(s,t.width,t.height),positionScrollbars(s,t.width,t.height)}else debug("Aborting because element has been uninstalled")}function ready(){l(s)}function install(){debug("Installing..."),function initListeners(){i(s).listeners=[]}(),function storeStartSize(){var t=getStyle();i(s).startSize={width:t.width,height:t.height},debug("Element start size",i(s).startSize)}(),n.add(0,storeStyle),n.add(1,injectScrollElements),n.add(2,registerListenersAndPositionElements),n.add(3,finalizeDomMutation),n.add(4,ready)}l||(l=s,s=t,t=null),t=t||{},debug("Making detectable..."),!function isDetached(t){return!function isInDocument(t){return t===t.ownerDocument.body||t.ownerDocument.body.contains(t)}(t)||null===window.getComputedStyle(t)}(s)?install():(debug("Element is detached"),injectContainerElement(),debug("Waiting until element is attached..."),i(s).onRendered=function(){debug("Element is now attached"),install()})},addListener:function addListener(t,e){if(!i(t).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");i(t).listeners.push(e)},uninstall:function uninstall(t){var e=i(t);e&&(e.onExpandScroll&&removeEvent(getExpandElement(t),"scroll",e.onExpandScroll),e.onShrinkScroll&&removeEvent(getShrinkElement(t),"scroll",e.onShrinkScroll),e.onAnimationStart&&removeEvent(e.container,"animationstart",e.onAnimationStart),e.container&&t.removeChild(e.container))}}},yi=ui.forEach;function isCollection(t){return Array.isArray(t)||void 0!==t.length}function toArray(t){if(Array.isArray(t))return t;var e=[];return yi(t,(function(t){e.push(t)})),e}function isElement(t){return t&&1===t.nodeType}var elementResizeDetector=function(t){var e,n;if((t=t||{}).idHandler)e={get:function(e){return t.idHandler.get(e,!0)},set:t.idHandler.set};else{var i=function(t){var e=t.idGenerator,n=t.stateHandler.getState;return{get:function getId(t){var e=n(t);return e&&void 0!==e.id?e.id:null},set:function setId(t){var i=n(t);if(!i)throw new Error("setId required the element to have a resize detection state.");var r=e.generate();return i.id=r,r}}}({idGenerator:(n=1,{generate:function generate(){return n++}}),stateHandler:fi});e=i}var r=t.reporter;r||(r=function(t){function noop(){}var e={log:noop,warn:noop,error:noop};if(!t&&window.console){var attachFunction=function(t,e){t[e]=function reporterProxy(){var t=console[e];if(t.apply)t.apply(console,arguments);else for(var n=0;n<arguments.length;n++)t(arguments[n])}};attachFunction(e,"log"),attachFunction(e,"warn"),attachFunction(e,"error")}return e}(!1===r));var o=getOption(t,"batchProcessor",di({reporter:r})),a={};a.callOnAdd=!!getOption(t,"callOnAdd",!0),a.debug=!!getOption(t,"debug",!1);var s,l=function(t){var e={};function getListeners(n){var i=t.get(n);return void 0===i?[]:e[i]||[]}return{get:getListeners,add:function addListener(n,i){var r=t.get(n);e[r]||(e[r]=[]),e[r].push(i)},removeListener:function removeListener(t,e){for(var n=getListeners(t),i=0,r=n.length;i<r;++i)if(n[i]===e){n.splice(i,1);break}},removeAllListeners:function removeAllListeners(t){var e=getListeners(t);e&&(e.length=0)}}}(e),u=function(t){var e=t.stateHandler.getState;return{isDetectable:function isDetectable(t){var n=e(t);return n&&!!n.isDetectable},markAsDetectable:function markAsDetectable(t){e(t).isDetectable=!0},isBusy:function isBusy(t){return!!e(t).busy},markBusy:function markBusy(t,n){e(t).busy=!!n}}}({stateHandler:fi}),c=getOption(t,"strategy","object"),h={reporter:r,batchProcessor:o,stateHandler:fi,idHandler:e};if("scroll"===c&&(ci.isLegacyOpera()?(r.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),c="object"):ci.isIE(9)&&(r.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),c="object")),"scroll"===c)s=scroll(h);else{if("object"!==c)throw new Error("Invalid strategy name: "+c);s=function(t){var e=(t=t||{}).reporter,n=t.batchProcessor,i=t.stateHandler.getState;if(!e)throw new Error("Missing required dependency: reporter.");function getObject(t){return i(t).object}return{makeDetectable:function makeDetectable(t,r,o){o||(o=r,r=t,t=null),(t=t||{}).debug,ci.isIE(8)?o(r):function injectObject(t,r){var o="display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; padding: 0; margin: 0; opacity: 0; z-index: -1000; pointer-events: none;",a=!1,s=window.getComputedStyle(t),l=t.offsetWidth,u=t.offsetHeight;function mutateDom(){function alterPositionStyles(){if("static"===s.position){t.style.position="relative";var removeRelativeStyles=function(t,e,n,i){var r=n[i];"auto"!==r&&"0"!==function getNumericalValue(t){return t.replace(/[^-\d\.]/g,"")}(r)&&(t.warn("An element that is positioned static has style."+i+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+i+" will be set to 0. Element: ",e),e.style[i]=0)};removeRelativeStyles(e,t,s,"top"),removeRelativeStyles(e,t,s,"right"),removeRelativeStyles(e,t,s,"bottom"),removeRelativeStyles(e,t,s,"left")}}""!==s.position&&(alterPositionStyles(),a=!0);var n=document.createElement("object");n.style.cssText=o,n.tabIndex=-1,n.type="text/html",n.setAttribute("aria-hidden","true"),n.onload=function onObjectLoad(){a||alterPositionStyles(),function getDocument(t,e){t.contentDocument?e(t.contentDocument):setTimeout((function checkForObjectDocument(){getDocument(t,e)}),100)}(this,(function onObjectDocumentReady(e){r(t)}))},ci.isIE()||(n.data="about:blank"),t.appendChild(n),i(t).object=n,ci.isIE()&&(n.data="about:blank")}i(t).startSize={width:l,height:u},n?n.add(mutateDom):mutateDom()}(r,o)},addListener:function addListener(t,e){if(!getObject(t))throw new Error("Element is not detectable by this strategy.");function listenerProxy(){e(t)}ci.isIE(8)?(i(t).object={proxy:listenerProxy},t.attachEvent("onresize",listenerProxy)):getObject(t).contentDocument.defaultView.addEventListener("resize",listenerProxy)},uninstall:function uninstall(t){ci.isIE(8)?t.detachEvent("onresize",i(t).object.proxy):t.removeChild(getObject(t)),delete i(t).object}}}(h)}var d={};return{listenTo:function listenTo(t,n,i){function onResizeCallback(t){var e=l.get(t);yi(e,(function callListenerProxy(e){e(t)}))}function addListener(t,e,n){l.add(e,n),t&&n(e)}if(i||(i=n,n=t,t={}),!n)throw new Error("At least one element required.");if(!i)throw new Error("Listener required.");if(isElement(n))n=[n];else{if(!isCollection(n))return r.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");n=toArray(n)}var o=0,c=getOption(t,"callOnAdd",a.callOnAdd),h=getOption(t,"onReady",(function noop(){})),p=getOption(t,"debug",a.debug);yi(n,(function attachListenerToElement(t){fi.getState(t)||(fi.initState(t),e.set(t));var a=e.get(t);if(p&&r.log("Attaching listener to element",a,t),!u.isDetectable(t))return p&&r.log(a,"Not detectable."),u.isBusy(t)?(p&&r.log(a,"System busy making it detectable"),addListener(c,t,i),d[a]=d[a]||[],void d[a].push((function onReady(){++o===n.length&&h()}))):(p&&r.log(a,"Making detectable..."),u.markBusy(t,!0),s.makeDetectable({debug:p},t,(function onElementDetectable(t){if(p&&r.log(a,"onElementDetectable"),fi.getState(t)){u.markAsDetectable(t),u.markBusy(t,!1),s.addListener(t,onResizeCallback),addListener(c,t,i);var e=fi.getState(t);if(e&&e.startSize){var l=t.offsetWidth,f=t.offsetHeight;e.startSize.width===l&&e.startSize.height===f||onResizeCallback(t)}d[a]&&yi(d[a],(function(t){t()}))}else p&&r.log(a,"Element uninstalled before being detectable.");delete d[a],++o===n.length&&h()})));p&&r.log(a,"Already detecable, adding listener."),addListener(c,t,i),o++})),o===n.length&&h()},removeListener:l.removeListener,removeAllListeners:l.removeAllListeners,uninstall:function uninstall(t){if(!t)return r.error("At least one element is required.");if(isElement(t))t=[t];else{if(!isCollection(t))return r.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");t=toArray(t)}yi(t,(function(t){l.removeAllListeners(t),s.uninstall(t),fi.cleanState(t)}))}}};function getOption(t,e,n){var i=t[e];return null==i&&void 0!==n?n:i}class TimeFrame{constructor(t){this.beginTime=t.beginTime,this.endTime=t.endTime,this.useDateFormat=!1,this.element=document.createElement("div"),this.element.style["flex-grow"]=t.weight,this.element.classList.add("fmi-metoclient-timeslider-frame"),this.element.classList.add(t.type),this.element.dataset.time=this.endTime,this.dragListenerElement=document.createElement("div"),this.dragListenerElement.classList.add("fmi-metoclient-timeslider-drag-listener"),this.dragListenerElement.style.pointerEvents="none",this.element.appendChild(this.dragListenerElement),this.keyboardAccessibleElement=document.createElement("button"),this.keyboardAccessibleElement.classList.add("fmi-metoclient-timeslider-keyboard-accessible"),this.keyboardAccessibleElement.style.pointerEvents="none",this.element.appendChild(this.keyboardAccessibleElement)}}const gi=6e4,vi=60*gi,_i=24*vi;var bi="postrender",Ti="movestart",wi="moveend";function createCanvasContext2D(t,e){var n=document.createElement("canvas");return t&&(n.width=t),e&&(n.height=e),n.getContext("2d")}function replaceNode(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)}function removeNode(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var Ei=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Si=function(t){function Control(e){var n=t.call(this)||this;return n.element=e.element?e.element:null,n.target_=null,n.map_=null,n.listenerKeys=[],n.render=e.render?e.render:VOID,e.target&&n.setTarget(e.target),n}return Ei(Control,t),Control.prototype.disposeInternal=function(){removeNode(this.element),t.prototype.disposeInternal.call(this)},Control.prototype.getMap=function(){return this.map_},Control.prototype.setMap=function(t){this.map_&&removeNode(this.element);for(var e=0,n=this.listenerKeys.length;e<n;++e)unlistenByKey(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==VOID&&this.listenerKeys.push(listen(t,bi,this.render,this)),t.render())},Control.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},Control}(ti);class TimeSlider extends Si{constructor(t){const e=t||{},n=document.createElement("div");n.className="ol-unselectable ol-control fmi-metoclient-timeslider",super({element:n,target:e.target}),this.container_=n,this.config_=e,this.callbacks_=e.callbacks,this.interactions_=null,this.playButton_=null,this.animationPlay_=!1,this.frames_=[],this.locale_=e.locale,this.timeZone_=e.timeZone,this.timeZoneLabel_=e.timeZoneLabel,this.previousTickTextTop_=Number.POSITIVE_INFINITY,this.previousTickTextRight_=Number.NEGATIVE_INFINITY,this.previousTickTextBottom_=Number.NEGATIVE_INFINITY,this.previousTickTextLeft_=Number.POSITIVE_INFINITY,this.previousTickIndex_=-1,this.mouseListeners_=[],this.dragging_=!1,this.resizeDetector=elementResizeDetector(),this.timeListener=null,this.playingListener=null}createTimeSlider(t){this.clear(),this.createContainers(t),this.createFrames(t),this.createIndicators(),this.createTicks(),this.createInteractions(),null!=this.getMap().get("time")&&this.updatePointer(this.getMap().get("time")),null!=this.callbacks_&&"function"==typeof this.callbacks_.timeSliderCreated&&this.callbacks_.timeSliderCreated(t),this.timeListener=this.getMap().on("change:time",t=>{this.setAnimationTime(t.target.get("time"))}),this.playingListener=this.getMap().on("change:playing",t=>{this.setAnimationPlay(t.target.get("playing"))})}step(t){const e=this.getMap();t>0?e.dispatchEvent("next"):t<0&&e.dispatchEvent("previous")}createContainers(t){const e=this,n=document.createElement("div");n.classList.add(We),t.length>0&&(n.appendChild(this.createPreMargin()),n.appendChild(this.createPreTools()));const i=document.createElement("div");i.classList.add(Ke),n.appendChild(i),n.appendChild(this.createPostTools(t));const r=document.createElement("div");r.classList.add($e),this.mouseListeners_.push(li(r,"click",t=>{e.step(mn)})),n.appendChild(r),n.appendChild(this.createTimeZoneLabel()),this.container_.appendChild(n),this.container_.classList.add("noselect"),this.mouseListeners_.push(li(this.container_,"mouseup",t=>{e.setDragging(!1),document.activeElement.blur()})),this.mouseListeners_.push(li(this.container_,"touchend",t=>{e.setDragging(!1),document.activeElement.blur()})),this.resizeDetector.listenTo(this.container_.getElementsByClassName(Ke)[0],t=>{e.createTicks()})}createPreMargin(){const t=this,e=document.createElement("div");return e.classList.add(Be),this.mouseListeners_.push(li(e,"click",()=>{t.step(fn)})),e}createPreTools(){let t=document.createElement("div");t.classList.add(Ze);let e=document.createElement("button");return e.classList.add(Ye),e.tabIndex=gn,this.animationPlay_&&e.classList.add(qe),this.mouseListeners_.push(li(e,"click",()=>{event.preventDefault();let t=this.getMap();t.set("playing",!t.get("playing"))})),this.playButton_=e,t.appendChild(e),t}createPostTools(t){const e=this,n=document.createElement("div");n.classList.add(He);const i=document.createElement("button");return i.classList.add(Xe),i.tabIndex=gn+10+t.length,n.appendChild(i),this.mouseListeners_.push(li(i,"click",()=>{this.config_.showTimeSliderMenu||null!=e.callbacks_&&"function"==typeof e.callbacks_.toolClicked&&this.callbacks_.toolClicked("timeslider-right-button")})),this.config_.showTimeSliderMenu,n}createTimeZoneLabel(){const t=document.createElement("div");return t.innerHTML=this.timeZoneLabel_,t.classList.add(Qe),t}createFrames(t){let e;const n=t.length,i=Date.now();let r,o,a,s,l;const u=this.container_.getElementsByClassName(Ke)[0];if(ni(u),n<2)return;const c=t[n-1]-t[0];for(e=0;e<n;e++)r=0===e?2*t[0]-t[1]:t[e-1],o=t[e],a=t[e]<=i?Fe:Ue,s=100*(o-r)/c,(l=this.createFrame(r,o,a,s)).element.getElementsByClassName(yn)[0].tabIndex=gn+e,u.appendChild(l.element),this.frames_.push(l)}createFrame(t,e,n,i){const r=this,o=new TimeFrame({beginTime:t,endTime:e,type:n,weight:i});let a,s,l=0,u=0;return this.mouseListeners_.push(li(o.element,"mousedown",()=>{a=setTimeout(()=>{clearTimeout(u),a=null,this.getMap().set("time",o.endTime)},_n)})),this.mouseListeners_.push(li(o.element,"mouseup",()=>{null==a||r.dragging_||(clearTimeout(a),1===++l?u=setTimeout(()=>{clearTimeout(a),l=0,o.endTime===this.getMap().get("time")?this.getMap().set("time",o.beginTime):r.step(o.endTime-this.getMap().get("time"))},Tn):2===l&&(clearTimeout(u),l=0,this.getMap().set("time",o.endTime)))})),this.mouseListeners_.push(li(o.element,"mouseout",()=>{null!=a&&clearTimeout(a)})),this.mouseListeners_.push(li(o.element,"touchstart",()=>{s=setTimeout(()=>{s=null,this.getMap().set("time",o.endTime)},bn)})),this.mouseListeners_.push(li(o.element,"touchend",()=>{null!=s&&clearTimeout(s)})),this.mouseListeners_.push(li(o.element,"touchcancel",()=>{null!=s&&clearTimeout(s)})),this.mouseListeners_.push(li(o.dragListenerElement,"mousemove",t=>{r.dragging_&&(document.activeElement.blur(),this.getMap().set("time",o.endTime))})),this.mouseListeners_.push(li(o.element,"touchmove",t=>{if(!r.dragging_||void 0===t.changedTouches[0])return;let e;const n=t.changedTouches[0].clientX,i=this.frames_.length;let o;for(let t=0;t<i;t++)if((o=this.frames_[t].element.getBoundingClientRect()).left<=n&&n<=o.right){e=this.frames_[t];break}document.activeElement.blur(),this.getMap().set("time",e.endTime)})),o}createIndicators(){this.frames_.forEach((t,e,n)=>{const i=document.createElement("div");i.classList.add(cn),0===e?i.classList.add("first"):e===n.length-1&&i.classList.add("last"),t.element.appendChild(i)})}createTicks(){let t,e;const n=[gi,2*gi,5*gi,10*gi,15*gi,20*gi,30*gi,vi,2*vi,3*vi,4*vi,6*vi,8*vi,12*vi,_i],i=n.length;let r,o,a=0,s=0;let l=!0;do{if(s>10){this.configureTicks();break}if(r=a,l=this.configureTicks(r),t=0,e=-1,a=s>0?r:Number.POSITIVE_INFINITY,this.frames_.forEach((n,i,r)=>{n.element.getElementsByClassName(Je).length>0&&(e>=0&&(t=n.endTime-r[e].endTime,(0===s&&t<a||0!==s&&t>a)&&(a=t)),e=i)}),a!==r&&(a<vi&&vi%a!=0||a>vi&&a%vi!=0||a<_i&&_i%a!=0))for(o=0;o<i;o++)if(a<n[o]){a=n[o];break}s++}while(l&&a!==r);this.showTicks()}configureTicks(t=0){const e=this;let n,i,r,o,a=0,s=!1,l=!1,u=!1,c=!1;this.previousTickTextTop_=null,this.previousTickTextRight_=Number.NEGATIVE_INFINITY,this.previousTickTextBottom_=null,this.previousTickTextLeft_=null,this.previousTickValue_=null,this.previousTickIndex_=null;const clearFrame=t=>{const removeChildrenByClass=e=>{Array.from(t.element.getElementsByClassName(e)).forEach(t=>{t.parentElement.removeChild(t)})};removeChildrenByClass(tn),removeChildrenByClass(Je)};this.frames_.forEach((t,e,n)=>{clearFrame(t);const i=document.createElement("div");i.classList.add(tn);const r=document.createElement("span");r.classList.add(en),r.classList.add(De);const o=this.getTickText(t.endTime);r.textContent=o.content,t.useDateFormat=o.useDateFormat,i.appendChild(r),t.element.appendChild(i),t.element.style.display="none"}),this.frames_.forEach((t,n,i)=>{let o;const h=n+1;if(t.element.style.display="",DateTime.fromMillis(t.endTime).setZone(e.timeZone_).startOf("day").valueOf()===t.endTime&&(l=!0),h===i.length)return;const d=t.element.querySelector("span."+en).getBoundingClientRect();a<d.width&&(a=d.width),o=i[h].endTime-t.endTime,DateTime.fromMillis(t.endTime).setZone(e.timeZone_).isInDST&&o<_i?u=!0:c=!0,null==r?(s=!0,r=o):s&&o!==r&&(s=!1)}),u&&c&&(s=!1),s&&(r*=2),i=Math.round(a)+"px",Array.from(this.container_.getElementsByClassName(tn)).forEach(t=>{t.style.width=i});const createTick=(t,i,r,o)=>{e.previousTickTextTop_=r.top,e.previousTickTextRight_=r.right,e.previousTickTextBottom_=r.bottom,e.previousTickTextLeft_=r.left,e.previousTickValue_=o,e.previousTickIndex_=i,(n=document.createElement("div")).classList.add(Je),n.classList.add(hn),t.element.appendChild(n)};return(o=Array.from(this.container_.getElementsByClassName(Ke))).length>0&&(o=o[0].getBoundingClientRect()),this.frames_.forEach((n,i,a)=>{let u,c;const h=Array.from(n.element.getElementsByClassName(tn));0!==h.length&&(c=(u=h.shift()).getBoundingClientRect(),0===o.length||o.left<=c.left&&o.right>=c.right&&o.top<=c.top&&o.bottom>=c.bottom?(e.previousTickTextRight_<c.left||e.previousTickTextLeft_>c.right||e.previousTickTextBottom_<c.top||e.previousTickTextTop_>c.bottom)&&(null==e.previousTickIndex_||n.endTime-a[e.previousTickIndex_].endTime>=t)?createTick(n,i,c,n.endTime):i>0&&e.previousTickIndex_>=0&&null!=a[e.previousTickIndex_]&&(0===t&&(n.endTime%vi==0&&a[e.previousTickIndex_].endTime%vi!=0||s&&n.endTime%vi%r==0&&a[e.previousTickIndex_].endTime%je%r!=0||n.endTime%je==0&&a[e.previousTickIndex_].endTime%je==0&&DateTime.fromMillis(n.endTime).setZone(e.timeZone_).hour%2==0&&DateTime.fromMillis(a[e.previousTickIndex_].endTime).setZone(e.timeZone_).hour%2!=0)&&!a[e.previousTickIndex_].useDateFormat||n.useDateFormat||t>0&&(t>=je&&a[e.previousTickIndex_].endTime%vi!=0||a[e.previousTickIndex_].endTime%vi%t!=0||l&&DateTime.fromMillis(a[e.previousTickIndex_].endTime).setZone(e.timeZone_).hour%(t/vi)!=0))?(clearFrame(a[e.previousTickIndex_]),createTick(n,i,c,n.endTime)):n.element.removeChild(u):n.element.removeChild(u))}),s}showTicks(){Array.from(this.container_.getElementsByClassName(Je)).forEach(t=>{t.classList.remove(hn)})}createInteractions(){const t=this,e=document.createElement("div");e.classList.add(rn);const n=document.createElement("div");n.classList.add(on);const i=document.createElement("div");i.classList.add(an);const r=document.createElement("span");r.classList.add(sn),r.classList.add("noselect"),r.innerHTML="",i.appendChild(r),n.appendChild(i);let o=document.createElement("div");o.classList.add(un),o.style.display="none",n.appendChild(o),e.append(n);const a=document.createElement("div");a.classList.add(ln),e.appendChild(a),this.mouseListeners_.push(li(e,"mousedown",e=>{t.setDragging(!0)})),this.mouseListeners_.push(li(e,"touchstart",e=>{t.setDragging(!0)})),this.interactions_=e}setAnimationTime(t){if(t===this.getMap().get("time"))return void this.updatePointer(t);const e=this.frames_.length;let n,i,r,o=!0;if(this.animationPlay_){for(n=0;n<e;n++)if(this.getMap().get("time")<=this.frames_[n].endTime){i=n;break}null==i&&(i=e-1),r=(i+1)%e,Array.from(this.frames_[i].element.getElementsByClassName(cn)).forEach(t=>{t.getAttribute("data-status")===pn&&(o=!1)}),o&&Array.from(this.frames_[r].element.getElementsByClassName(cn)).forEach(t=>{t.getAttribute("data-status")===pn&&(o=!1)})}o&&(this.getMap().set("time",t),this.updatePointer(t))}updatePointer(t){if(null==this.interactions_)return;const e=this.frames_.length;let n,i,r,o;for(n=0;n<e;n++)if(t<=this.frames_[n].endTime){i=n;break}null!=i&&(null==this.interactions_.parentElement?r=!0:Number.parseInt(this.interactions_.parentElement.dataset.time)!==t&&(this.interactions_.parentElement.removeChild(this.interactions_),r=!0),r&&(this.frames_[i].element.appendChild(this.interactions_),o=this.getTickText(this.frames_[i].endTime,!1).content,Array.from(this.interactions_.getElementsByClassName(sn)).forEach(t=>{t.innerHTML=o}),Array.from(this.container_.getElementsByClassName(un)).forEach(t=>{t.innerHTML=o})))}updateTimeLoaderVis(t){let e=t.reduce((t,e)=>(e.active&&t.push(e),t),[]);if(!this.config_.showTimeSlider)return;const n=e.length;let i,r=n!==this.frames_.length,o=[];if(!r)for(i=0;i<n;i++)if(e[i].endTime!==this.frames_[i].endTime){r=!0;break}if(r){for(i=0;i<n;i++)o.push(e[i].endTime);this.createTimeSlider(o)}this.frames_.forEach((t,n)=>{Array.from(t.element.getElementsByClassName(cn)).forEach(t=>{let n,i,r,o,a;if(null!=t.parentElement&&null!=t.parentElement.dataset&&(o=t.parentElement.dataset.time),null!=o&&null!=(r=parseInt(o)))for(n=e.length,i=0;i<n;i++)if(null!=(a=e[i].endTime)&&a===r){t.setAttribute("data-status",e[i].status);break}})})}setDragging(t){this.dragging_=t;const e=t?"auto":"none";Array.from(this.container_.getElementsByClassName(nn)).forEach(t=>{t.style.pointerEvents=e}),Array.from(this.container_.getElementsByClassName(on)).forEach(e=>{t?e.classList.add(dn):e.classList.remove(dn)});let n=t?"block":"none";Array.from(this.container_.getElementsByClassName(un)).forEach(t=>{t.style.display=n})}setAnimationPlay(t){this.animationPlay_=t,this.animationPlay_?this.playButton_.classList.add(qe):this.playButton_.classList.remove(qe)}setTimeZone(t){const e=this;this.timeZone_=t,this.frames_.forEach(t=>{const n=e.getTickText(t.endTime),i=t.element.getElementsByClassName(en);i.length>0&&(i[0].textContent=n.content)})}setTimeZoneLabel(t){const e=this;this.timeZoneLabel_=t,Array.from(this.container_.getElementsByClassName(Qe)).forEach(t=>{t.innerHTML=e.timeZoneLabel_})}setCallbacks(t){this.callbacks_=t}getTickText(t,e=!0){let n,i,r,o,a,s,l;let u=!1;const c=this.frames_.length>0?this.frames_[0].endTime:Number.NEGATIVE_INFINITY;if(null==c)return"";t<c&&(t=c);const h=(n=DateTime.fromMillis(t).setZone(this.timeZone_).setLocale(this.locale_)).ordinal,d=n.year;if(e){for(i=this.frames_.length,r=0;r<i&&!((o=this.frames_[r].endTime)>=t);r++)Array.from(this.frames_[r].element.getElementsByClassName(tn)).length>0&&(a=o);l=DateTime.local().setZone(this.timeZone_),null!=a?h===(s=DateTime.fromMillis(a).setZone(this.timeZone_)).ordinal&&d===s.year||(u=!0):t!==c||h===l.ordinal&&d===l.year||(u=!0)}return{content:u?n.weekdayShort+n.toFormat(" d.M."):n.toFormat("HH:mm"),useDateFormat:u}}clear(){null!=this.timeListener&&unByKey(this.timeListener),null!=this.playingListener&&unByKey(this.playingListener),this.mouseListeners_.forEach(t=>{t.destroy()}),this.resizeDetector.removeAllListeners(this.container_),ni(this.container_),this.frames_=[]}destroy(){this.clear()}}var Mi={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"},Oi=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),xi=function(e){function BaseLayer(n){var i=e.call(this)||this,r=t({},n);return r[Mi.OPACITY]=void 0!==n.opacity?n.opacity:1,assert("number"==typeof r[Mi.OPACITY],64),r[Mi.VISIBLE]=void 0===n.visible||n.visible,r[Mi.Z_INDEX]=n.zIndex,r[Mi.MAX_RESOLUTION]=void 0!==n.maxResolution?n.maxResolution:1/0,r[Mi.MIN_RESOLUTION]=void 0!==n.minResolution?n.minResolution:0,r[Mi.MIN_ZOOM]=void 0!==n.minZoom?n.minZoom:-1/0,r[Mi.MAX_ZOOM]=void 0!==n.maxZoom?n.maxZoom:1/0,i.className_=void 0!==r.className?n.className:"ol-layer",delete r.className,i.setProperties(r),i.state_=null,i}return Oi(BaseLayer,e),BaseLayer.prototype.getClassName=function(){return this.className_},BaseLayer.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=clamp(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n?n:!1===e.managed?1/0:0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},BaseLayer.prototype.getLayersArray=function(t){return abstract()},BaseLayer.prototype.getLayerStatesArray=function(t){return abstract()},BaseLayer.prototype.getExtent=function(){return this.get(Mi.EXTENT)},BaseLayer.prototype.getMaxResolution=function(){return this.get(Mi.MAX_RESOLUTION)},BaseLayer.prototype.getMinResolution=function(){return this.get(Mi.MIN_RESOLUTION)},BaseLayer.prototype.getMinZoom=function(){return this.get(Mi.MIN_ZOOM)},BaseLayer.prototype.getMaxZoom=function(){return this.get(Mi.MAX_ZOOM)},BaseLayer.prototype.getOpacity=function(){return this.get(Mi.OPACITY)},BaseLayer.prototype.getSourceState=function(){return abstract()},BaseLayer.prototype.getVisible=function(){return this.get(Mi.VISIBLE)},BaseLayer.prototype.getZIndex=function(){return this.get(Mi.Z_INDEX)},BaseLayer.prototype.setExtent=function(t){this.set(Mi.EXTENT,t)},BaseLayer.prototype.setMaxResolution=function(t){this.set(Mi.MAX_RESOLUTION,t)},BaseLayer.prototype.setMinResolution=function(t){this.set(Mi.MIN_RESOLUTION,t)},BaseLayer.prototype.setMaxZoom=function(t){this.set(Mi.MAX_ZOOM,t)},BaseLayer.prototype.setMinZoom=function(t){this.set(Mi.MIN_ZOOM,t)},BaseLayer.prototype.setOpacity=function(t){assert("number"==typeof t,64),this.set(Mi.OPACITY,t)},BaseLayer.prototype.setVisible=function(t){this.set(Mi.VISIBLE,t)},BaseLayer.prototype.setZIndex=function(t){this.set(Mi.Z_INDEX,t)},BaseLayer.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),e.prototype.disposeInternal.call(this)},BaseLayer}(ti),Pi="prerender",Ci="postrender",Ii="precompose",Li="postcompose",Ri="rendercomplete",ki={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},Ai=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Di=function(e){function Layer(n){var i=this,r=t({},n);delete r.source,(i=e.call(this,r)||this).mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,n.render&&(i.render=n.render),n.map&&i.setMap(n.map),i.addEventListener(getChangeEventType(Mi.SOURCE),i.handleSourcePropertyChange_);var o=n.source?n.source:null;return i.setSource(o),i}return Ai(Layer,e),Layer.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},Layer.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},Layer.prototype.getSource=function(){return this.get(Mi.SOURCE)||null},Layer.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():ki.UNDEFINED},Layer.prototype.handleSourceChange_=function(){this.changed()},Layer.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=listen(t,Hn.CHANGE,this.handleSourceChange_,this)),this.changed()},Layer.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)},Layer.prototype.render=function(t,e){var n=this.getRenderer();if(n.prepareFrame(t))return n.renderFrame(t,e)},Layer.prototype.setMap=function(t){this.mapPrecomposeKey_&&(unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=listen(t,Ii,(function(t){t.frameState.layerStatesArray.push(this.getLayerState(!1))}),this),this.mapRenderKey_=listen(this,Hn.CHANGE,t.render,t),this.changed())},Layer.prototype.setSource=function(t){this.set(Mi.SOURCE,t)},Layer.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},Layer.prototype.hasRenderer=function(){return!!this.renderer_},Layer.prototype.createRenderer=function(){return null},Layer.prototype.disposeInternal=function(){this.setSource(null),e.prototype.disposeInternal.call(this)},Layer}(xi);function inView(t,e){if(!t.visible)return!1;var n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;var i=e.zoom;return i>t.minZoom&&i<=t.maxZoom}var ji="preload",Ni="useInterimTilesOnError",Fi=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Ui=function(e){function BaseTileLayer(n){var i=this,r=n||{},o=t({},r);return delete o.preload,delete o.useInterimTilesOnError,(i=e.call(this,o)||this).setPreload(void 0!==r.preload?r.preload:0),i.setUseInterimTilesOnError(void 0===r.useInterimTilesOnError||r.useInterimTilesOnError),i}return Fi(BaseTileLayer,e),BaseTileLayer.prototype.getPreload=function(){return this.get(ji)},BaseTileLayer.prototype.setPreload=function(t){this.set(ji,t)},BaseTileLayer.prototype.getUseInterimTilesOnError=function(){return this.get(Ni)},BaseTileLayer.prototype.setUseInterimTilesOnError=function(t){this.set(Ni,t)},BaseTileLayer}(Di),Vi=function(){function TileRange(t,e,n,i){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i}return TileRange.prototype.contains=function(t){return this.containsXY(t[1],t[2])},TileRange.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},TileRange.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},TileRange.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},TileRange.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},TileRange.prototype.getHeight=function(){return this.maxY-this.minY+1},TileRange.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},TileRange.prototype.getWidth=function(){return this.maxX-this.minX+1},TileRange.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},TileRange}();function createOrUpdate$1(t,e,n,i,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=n,r.maxY=i,r):new Vi(t,e,n,i)}var zi={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5},Gi=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),qi=function(t){function RenderEvent(e,n,i,r){var o=t.call(this,e)||this;return o.inversePixelTransform=n,o.frameState=i,o.context=r,o}return Gi(RenderEvent,t),RenderEvent}(Zn),Wi="ol-hidden",Bi="ol-unselectable",Zi="ol-control",Ki="ol-collapsed";new Array(6);function apply(t,e){var n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function compose(t,e,n,i,r,o,a,s){var l=Math.sin(o),u=Math.cos(o);return t[0]=i*u,t[1]=r*l,t[2]=-i*l,t[3]=r*u,t[4]=a*i*u-s*i*l+e,t[5]=a*r*l+s*r*u+n,t}function makeInverse(t,e){var n=function determinant(t){return t[0]*t[3]-t[1]*t[2]}(e);assert(0!==n,32);var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5];return t[0]=a/n,t[1]=-r/n,t[2]=-o/n,t[3]=i/n,t[4]=(o*l-a*s)/n,t[5]=-(i*l-r*s)/n,t}var Yi=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Hi=function(t){function LRUCache(e){var n=t.call(this)||this;return n.highWaterMark=void 0!==e?e:2048,n.count_=0,n.entries_={},n.oldest_=null,n.newest_=null,n}return Yi(LRUCache,t),LRUCache.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},LRUCache.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(Hn.CLEAR)},LRUCache.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},LRUCache.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},LRUCache.prototype.get=function(t,e){var n=this.entries_[t];return assert(void 0!==n,15),n===this.newest_?n.value_:(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n,n.value_)},LRUCache.prototype.remove=function(t){var e=this.entries_[t];return assert(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},LRUCache.prototype.getCount=function(){return this.count_},LRUCache.prototype.getKeys=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.key_;return e},LRUCache.prototype.getValues=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.value_;return e},LRUCache.prototype.peekLast=function(){return this.oldest_.value_},LRUCache.prototype.peekLastKey=function(){return this.oldest_.key_},LRUCache.prototype.peekFirstKey=function(){return this.newest_.key_},LRUCache.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},LRUCache.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},LRUCache.prototype.set=function(t,e){assert(!(t in this.entries_),16);var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_},LRUCache.prototype.setSize=function(t){this.highWaterMark=t},LRUCache}(Yn),Xi=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),$i=new(function(t){function LabelCache(e){var n=t.call(this,e)||this;return n.consumers={},n}return Xi(LabelCache,t),LabelCache.prototype.clear=function(){this.consumers={},t.prototype.clear.call(this)},LabelCache.prototype.get=function(e,n){var i=t.prototype.get.call(this,e),r=getUid(n);return r in this.consumers||(this.consumers[r]={}),this.consumers[r][e]=!0,i},LabelCache.prototype.prune=function(){t:for(;this.canExpireCache();){var t=this.peekLastKey();for(var e in this.consumers)if(t in this.consumers[e])break t;var n=this.pop();for(var e in n.width=0,n.height=0,this.consumers)delete this.consumers[e][t]}},LabelCache.prototype.release=function(t){delete this.consumers[getUid(t)]},LabelCache}(Hi));function rotateAtOffset(t,e,n,i){0!==e&&(t.translate(n,i),t.rotate(e),t.translate(-n,-i))}var Qi={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},Ji=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),tr=function(t){function LayerRenderer(e){var n=t.call(this)||this;return n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=e,n}return Ji(LayerRenderer,t),LayerRenderer.prototype.getFeatures=function(t){return abstract()},LayerRenderer.prototype.prepareFrame=function(t){return abstract()},LayerRenderer.prototype.renderFrame=function(t,e){return abstract()},LayerRenderer.prototype.loadedTileCallback=function(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n},LayerRenderer.prototype.createLoadedTileFinder=function(t,e,n){return function(i,r){var o=this.loadedTileCallback.bind(this,n,i);return t.forEachLoadedTile(e,i,r,o)}.bind(this)},LayerRenderer.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r){},LayerRenderer.prototype.getDataAtPixel=function(t,e,n){return abstract()},LayerRenderer.prototype.getLayer=function(){return this.layer_},LayerRenderer.prototype.handleFontsChanged=function(){},LayerRenderer.prototype.handleImageChange_=function(t){t.target.getState()===Qi.LOADED&&this.renderIfReadyAndVisible()},LayerRenderer.prototype.loadImage=function(t){var e=t.getState();return e!=Qi.LOADED&&e!=Qi.ERROR&&t.addEventListener(Hn.CHANGE,this.boundHandleImageChange_),e==Qi.IDLE&&(t.load(),e=t.getState()),e==Qi.LOADED},LayerRenderer.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==ki.READY&&t.changed()},LayerRenderer}($n),er=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),nr=function(t){function CanvasLayerRenderer(e){var n=t.call(this,e)||this;return n.container=null,n.renderedResolution,n.tempTransform_=[1,0,0,1,0,0],n.pixelTransform=[1,0,0,1,0,0],n.inversePixelTransform=[1,0,0,1,0,0],n.context=null,n.containerReused=!1,n.createTransformStringCanvas_=createCanvasContext2D(1,1).canvas,n}return er(CanvasLayerRenderer,t),CanvasLayerRenderer.prototype.useContainer=function(t,e,n){var i,r,o=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===o&&((s=t.firstElementChild)instanceof HTMLCanvasElement&&(r=s.getContext("2d")));if(r&&r.canvas.style.transform===e?(this.container=t,this.context=r,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(i=document.createElement("div")).className=o;var a=i.style;a.position="absolute",a.width="100%",a.height="100%";var s=(r=createCanvasContext2D()).canvas;i.appendChild(s),(a=s.style).position="absolute",a.left="0",a.transformOrigin="top left",this.container=i,this.context=r}},CanvasLayerRenderer.prototype.clip=function(t,e,n){var i=e.pixelRatio,r=e.size[0]*i/2,o=e.size[1]*i/2,a=e.viewState.rotation,s=getTopLeft(n),l=getTopRight(n),u=getBottomRight(n),c=getBottomLeft(n);apply(e.coordinateToPixelTransform,s),apply(e.coordinateToPixelTransform,l),apply(e.coordinateToPixelTransform,u),apply(e.coordinateToPixelTransform,c),t.save(),rotateAtOffset(t,-a,r,o),t.beginPath(),t.moveTo(s[0]*i,s[1]*i),t.lineTo(l[0]*i,l[1]*i),t.lineTo(u[0]*i,u[1]*i),t.lineTo(c[0]*i,c[1]*i),t.clip(),rotateAtOffset(t,a,r,o)},CanvasLayerRenderer.prototype.clipUnrotated=function(t,e,n){var i=getTopLeft(n),r=getTopRight(n),o=getBottomRight(n),a=getBottomLeft(n);apply(e.coordinateToPixelTransform,i),apply(e.coordinateToPixelTransform,r),apply(e.coordinateToPixelTransform,o),apply(e.coordinateToPixelTransform,a);var s=this.inversePixelTransform;apply(s,i),apply(s,r),apply(s,o),apply(s,a),t.save(),t.beginPath(),t.moveTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()},CanvasLayerRenderer.prototype.dispatchRenderEvent_=function(t,e,n){var i=this.getLayer();if(i.hasListener(t)){var r=new qi(t,this.inversePixelTransform,n,e);i.dispatchEvent(r)}},CanvasLayerRenderer.prototype.preRender=function(t,e){this.dispatchRenderEvent_(Pi,t,e)},CanvasLayerRenderer.prototype.postRender=function(t,e){this.dispatchRenderEvent_(Ci,t,e)},CanvasLayerRenderer.prototype.getRenderTransform=function(t,e,n,i,r,o,a){var s=r/2,l=o/2,u=i/e,c=-u,h=-t[0]+a,d=-t[1];return compose(this.tempTransform_,s,l,u,c,-n,h,d)},CanvasLayerRenderer.prototype.getDataAtPixel=function(t,e,n){var i,r=apply(this.inversePixelTransform,t.slice()),o=this.context;try{i=o.getImageData(Math.round(r[0]),Math.round(r[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:i}return 0===i[3]?null:i},CanvasLayerRenderer.prototype.createTransformString=function(t){return this.createTransformStringCanvas_.style.transform=function toString(t){return"matrix("+t.join(", ")+")"}(t),this.createTransformStringCanvas_.style.transform},CanvasLayerRenderer}(tr),ir=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),rr=function(t){function CanvasTileLayerRenderer(e){var n=t.call(this,e)||this;return n.extentChanged=!0,n.renderedExtent_=null,n.renderedPixelRatio,n.renderedProjection=null,n.renderedRevision,n.renderedTiles=[],n.newTiles_=!1,n.tmpExtent=[1/0,1/0,-1/0,-1/0],n.tmpTileRange_=new Vi(0,0,0,0),n}return ir(CanvasTileLayerRenderer,t),CanvasTileLayerRenderer.prototype.isDrawableTile=function(t){var e=this.getLayer(),n=t.getState(),i=e.getUseInterimTilesOnError();return n==zi.LOADED||n==zi.EMPTY||n==zi.ERROR&&!i},CanvasTileLayerRenderer.prototype.getTile=function(t,e,n,i){var r=i.pixelRatio,o=i.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(t,e,n,r,o);return s.getState()==zi.ERROR&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):s.setState(zi.LOADED)),this.isDrawableTile(s)||(s=s.getInterimTile()),s},CanvasTileLayerRenderer.prototype.loadedTileCallback=function(e,n,i){return!!this.isDrawableTile(i)&&t.prototype.loadedTileCallback.call(this,e,n,i)},CanvasTileLayerRenderer.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},CanvasTileLayerRenderer.prototype.renderFrame=function(t,e){var n=t.layerStatesArray[t.layerIndex],i=t.viewState,r=i.projection,o=i.resolution,a=i.center,s=i.rotation,l=t.pixelRatio,u=this.getLayer(),c=u.getSource(),h=c.getRevision(),d=c.getTileGridForProjection(r),p=d.getZForResolution(o,c.zDirection),f=d.getResolution(p),m=t.extent,y=n.extent&&fromUserExtent(n.extent,r);y&&(m=getIntersection(m,fromUserExtent(n.extent,r)));var g=c.getTilePixelRatio(l),v=Math.round(t.size[0]*g),_=Math.round(t.size[1]*g);if(s){var b=Math.round(Math.sqrt(v*v+_*_));v=b,_=b}var T=f*v/2/g,w=f*_/2/g,E=[a[0]-T,a[1]-w,a[0]+T,a[1]+w],S=d.getTileRangeForExtentAndZ(m,p),M={};M[p]={};var O=this.createLoadedTileFinder(c,r,M),x=this.tmpExtent,P=this.tmpTileRange_;this.newTiles_=!1;for(var C=S.minX;C<=S.maxX;++C)for(var I=S.minY;I<=S.maxY;++I){var L=this.getTile(p,C,I,t);if(this.isDrawableTile(L)){var R=getUid(this);if(L.getState()==zi.LOADED){M[p][L.tileCoord.toString()]=L;var k=L.inTransition(R);this.newTiles_||!k&&-1!==this.renderedTiles.indexOf(L)||(this.newTiles_=!0)}if(1===L.getAlpha(R,t.time))continue}var A=d.getTileCoordChildTileRange(L.tileCoord,P,x),D=!1;A&&(D=O(p+1,A)),D||d.forEachTileCoordParentTileRange(L.tileCoord,O,P,x)}var j=f/o;compose(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/g,1/g,s,-v/2,-_/2);var N=this.createTransformString(this.pixelTransform);this.useContainer(e,N,n.opacity);var F=this.context,U=F.canvas;makeInverse(this.inversePixelTransform,this.pixelTransform),compose(this.tempTransform_,v/2,_/2,j,j,0,-v/2,-_/2),U.width!=v||U.height!=_?(U.width=v,U.height=_):this.containerReused||F.clearRect(0,0,v,_),y&&this.clipUnrotated(F,t,y),this.preRender(F,t),this.renderedTiles.length=0;var V,z,G,q=Object.keys(M).map(Number);q.sort(numberSafeCompareFunction),1!==n.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(V=[],z=[]):q=q.reverse();for(var W=q.length-1;W>=0;--W){var B=q[W],Z=c.getTilePixelSize(B,l,r),K=d.getResolution(B)/f,Y=Z[0]*K*j,H=Z[1]*K*j,X=d.getTileCoordForCoordAndZ(getTopLeft(E),B),$=d.getTileCoordExtent(X),Q=apply(this.tempTransform_,[g*($[0]-E[0])/f,g*(E[3]-$[3])/f]),J=g*c.getGutterForProjection(r),tt=M[B];for(var et in tt){var nt=(L=tt[et]).tileCoord,it=Q[0]-(X[1]-nt[1])*Y,rt=Math.round(it+Y),ot=Q[1]-(X[2]-nt[2])*H,at=Math.round(ot+H),st=rt-(C=Math.round(it)),lt=at-(I=Math.round(ot)),ut=p===B;if(!(k=ut&&1!==L.getAlpha(getUid(this),t.time)))if(V){F.save(),G=[C,I,C+st,I,C+st,I+lt,C,I+lt];for(var ct=0,ht=V.length;ct<ht;++ct)if(p!==B&&B<z[ct]){var dt=V[ct];F.beginPath(),F.moveTo(G[0],G[1]),F.lineTo(G[2],G[3]),F.lineTo(G[4],G[5]),F.lineTo(G[6],G[7]),F.moveTo(dt[6],dt[7]),F.lineTo(dt[4],dt[5]),F.lineTo(dt[2],dt[3]),F.lineTo(dt[0],dt[1]),F.clip()}V.push(G),z.push(B)}else F.clearRect(C,I,st,lt);this.drawTileImage(L,t,C,I,st,lt,J,ut,n.opacity),V&&!k&&F.restore(),this.renderedTiles.push(L),this.updateUsedTiles(t.usedTiles,c,L)}}return this.renderedRevision=h,this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!equals(this.renderedExtent_,E),this.renderedExtent_=E,this.renderedPixelRatio=l,this.renderedProjection=r,this.manageTilePyramid(t,c,d,l,r,m,p,u.getPreload()),this.updateCacheSize_(t,c),this.scheduleExpireCache(t,c),this.postRender(F,t),n.extent&&F.restore(),N!==U.style.transform&&(U.style.transform=N),this.container},CanvasTileLayerRenderer.prototype.drawTileImage=function(t,e,n,i,r,o,a,s,l){var u=this.getTileImage(t);if(u){var c=getUid(this),h=s?t.getAlpha(c,e.time):1,d=l*h,p=d!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(u,a,a,u.width-2*a,u.height-2*a,n,i,r,o),p&&this.context.restore(),1!==h?e.animate=!0:s&&t.endTransition(c)}},CanvasTileLayerRenderer.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},CanvasTileLayerRenderer.prototype.getTileImage=function(t){return t.getImage()},CanvasTileLayerRenderer.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var n=function(t,e,n){var i=getUid(t);i in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[i])}.bind(null,e);t.postRenderFunctions.push(n)}},CanvasTileLayerRenderer.prototype.updateUsedTiles=function(t,e,n){var i=getUid(e);i in t||(t[i]={}),t[i][n.getKey()]=!0},CanvasTileLayerRenderer.prototype.updateCacheSize_=function(t,e){var n=getUid(e),i=0;n in t.usedTiles&&(i+=Object.keys(t.usedTiles[n]).length),n in t.wantedTiles&&(i+=Object.keys(t.wantedTiles[n]).length);var r=e.tileCache;r.highWaterMark<i&&(r.highWaterMark=i)},CanvasTileLayerRenderer.prototype.manageTilePyramid=function(t,e,n,i,r,o,a,s,l){var u=getUid(e);u in t.wantedTiles||(t.wantedTiles[u]={});var c,h,d,p,f,m,y=t.wantedTiles[u],g=t.tileQueue;for(m=n.getMinZoom();m<=a;++m)for(h=n.getTileRangeForExtentAndZ(o,m,h),d=n.getResolution(m),p=h.minX;p<=h.maxX;++p)for(f=h.minY;f<=h.maxY;++f)a-m<=s?((c=e.getTile(m,p,f,i,r)).getState()==zi.IDLE&&(y[c.getKey()]=!0,g.isKeyQueued(c.getKey())||g.enqueue([c,u,n.getTileCoordCenter(c.tileCoord),d])),void 0!==l&&l(c)):e.useTile(m,p,f,r)},CanvasTileLayerRenderer}(nr);rr.prototype.getLayer;var or=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),ar=function(t){function TileLayer(e){return t.call(this,e)||this}return or(TileLayer,t),TileLayer.prototype.createRenderer=function(){return new rr(this)},TileLayer}(Ui),sr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),lr=function(t){function BaseImageLayer(e){var n=e||{};return t.call(this,n)||this}return sr(BaseImageLayer,t),BaseImageLayer}(Di),ur=.5,cr=0,hr=1,dr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),pr=function(t){function CanvasImageLayerRenderer(e){var n=t.call(this,e)||this;return n.image_=null,n}return dr(CanvasImageLayerRenderer,t),CanvasImageLayerRenderer.prototype.getImage=function(){return this.image_?this.image_.getImage():null},CanvasImageLayerRenderer.prototype.prepareFrame=function(t){var e=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,i=t.viewState,r=i.resolution,o=this.getLayer().getSource(),a=t.viewHints,s=t.extent;if(void 0!==e.extent&&(s=getIntersection(s,fromUserExtent(e.extent,i.projection))),!a[cr]&&!a[hr]&&!isEmpty(s)){var l=i.projection,u=o.getImage(s,r,n,l);u&&this.loadImage(u)&&(this.image_=u)}return!!this.image_},CanvasImageLayerRenderer.prototype.renderFrame=function(t,e){var n=this.image_,i=n.getExtent(),r=n.getResolution(),o=n.getPixelRatio(),a=t.layerStatesArray[t.layerIndex],s=t.pixelRatio,l=t.viewState,u=l.center,c=l.resolution,h=t.size,d=s*r/(c*o),p=Math.round(h[0]*s),f=Math.round(h[1]*s),m=l.rotation;if(m){var y=Math.round(Math.sqrt(p*p+f*f));p=y,f=y}compose(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/s,1/s,m,-p/2,-f/2),makeInverse(this.inversePixelTransform,this.pixelTransform);var g=this.createTransformString(this.pixelTransform);this.useContainer(e,g,a.opacity);var v=this.context,_=v.canvas;_.width!=p||_.height!=f?(_.width=p,_.height=f):this.containerReused||v.clearRect(0,0,p,f);var b=!1;if(a.extent){var T=fromUserExtent(a.extent,l.projection);(b=!containsExtent(T,t.extent)&&intersects(T,t.extent))&&this.clipUnrotated(v,t,T)}var w=n.getImage(),E=compose(this.tempTransform_,p/2,f/2,d,d,0,o*(i[0]-u[0])/r,o*(u[1]-i[3])/r);this.renderedResolution=r*s/o;var S=E[4],M=E[5],O=w.width*E[0],x=w.height*E[3];if(this.preRender(v,t),O>=.5&&x>=.5){var P=a.opacity,C=void 0;1!==P&&(C=this.context.globalAlpha,this.context.globalAlpha=P),this.context.drawImage(w,0,0,+w.width,+w.height,Math.round(S),Math.round(M),Math.round(O),Math.round(x)),1!==P&&(this.context.globalAlpha=C)}return this.postRender(v,t),b&&v.restore(),g!==_.style.transform&&(_.style.transform=g),this.container},CanvasImageLayerRenderer}(nr),fr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),mr=function(t){function ImageLayer(e){return t.call(this,e)||this}return fr(ImageLayer,t),ImageLayer.prototype.createRenderer=function(){return new pr(this)},ImageLayer}(lr),yr="1.3.0",gr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),vr=function(t){function ImageBase(e,n,i,r){var o=t.call(this)||this;return o.extent=e,o.pixelRatio_=i,o.resolution=n,o.state=r,o}return gr(ImageBase,t),ImageBase.prototype.changed=function(){this.dispatchEvent(Hn.CHANGE)},ImageBase.prototype.getExtent=function(){return this.extent},ImageBase.prototype.getImage=function(){return abstract()},ImageBase.prototype.getPixelRatio=function(){return this.pixelRatio_},ImageBase.prototype.getResolution=function(){return this.resolution},ImageBase.prototype.getState=function(){return this.state},ImageBase.prototype.load=function(){abstract()},ImageBase}(Yn),_r="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",br=-1!==_r.indexOf("firefox"),Tr=(-1!==_r.indexOf("safari")&&_r.indexOf("chrom"),-1!==_r.indexOf("webkit")&&-1==_r.indexOf("edge")),wr=-1!==_r.indexOf("macintosh"),Er=window.devicePixelRatio||1,Sr="undefined"!=typeof Image&&Image.prototype.decode,Mr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Or=function(t){function ImageWrapper(e,n,i,r,o,a){var s=t.call(this,e,n,i,Qi.IDLE)||this;return s.src_=r,s.image_=new Image,null!==o&&(s.image_.crossOrigin=o),s.unlisten_=null,s.state=Qi.IDLE,s.imageLoadFunction_=a,s}return Mr(ImageWrapper,t),ImageWrapper.prototype.getImage=function(){return this.image_},ImageWrapper.prototype.handleImageError_=function(){this.state=Qi.ERROR,this.unlistenImage_(),this.changed()},ImageWrapper.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=getHeight(this.extent)/this.image_.height),this.state=Qi.LOADED,this.unlistenImage_(),this.changed()},ImageWrapper.prototype.load=function(){this.state!=Qi.IDLE&&this.state!=Qi.ERROR||(this.state=Qi.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=listenImage(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},ImageWrapper.prototype.setImage=function(t){this.image_=t},ImageWrapper.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},ImageWrapper}(vr);function listenImage(t,e,n){var i=t;if(i.src&&Sr){var r=i.decode(),o=!0;return r.then((function(){o&&e()})).catch((function(t){o&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():n())})),function(){o=!1}}var a=[listenOnce(i,Hn.LOAD,e),listenOnce(i,Hn.ERROR,n)];return function unlisten(){a.forEach(unlistenByKey)}}function calculateSourceResolution(t,e,n,i){var r=transform(n,e,t),o=getPointResolution(e,i,n),a=e.getMetersPerUnit();void 0!==a&&(o*=a);var s=t.getMetersPerUnit();void 0!==s&&(o/=s);var l=t.getExtent();if(!l||containsCoordinate(l,r)){var u=getPointResolution(t,o,r)/o;isFinite(u)&&u>0&&(o/=u)}return o}function enlargeClipPoint(t,e,n,i){var r=n-t,o=i-e,a=Math.sqrt(r*r+o*o);return[Math.round(n+r/a),Math.round(i+o/a)]}function render(t,e,n,i,r,o,a,s,l,u,c){var h=createCanvasContext2D(Math.round(n*t),Math.round(n*e));if(0===l.length)return h.canvas;h.scale(n,n);var d=[1/0,1/0,-1/0,-1/0];l.forEach((function(t,e,n){!function extend(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}(d,t.extent)}));var p=getWidth(d),f=getHeight(d),m=createCanvasContext2D(Math.round(n*p/i),Math.round(n*f/i)),y=n/i;l.forEach((function(t,e,n){var i=t.extent[0]-d[0],r=-(t.extent[3]-d[3]),o=getWidth(t.extent),a=getHeight(t.extent);m.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,i*y,r*y,o*y,a*y)}));var g=getTopLeft(a);return s.getTriangles().forEach((function(t,e,r){var a=t.source,s=t.target,l=a[0][0],u=a[0][1],c=a[1][0],p=a[1][1],f=a[2][0],y=a[2][1],v=(s[0][0]-g[0])/o,_=-(s[0][1]-g[1])/o,b=(s[1][0]-g[0])/o,T=-(s[1][1]-g[1])/o,w=(s[2][0]-g[0])/o,E=-(s[2][1]-g[1])/o,S=l,M=u;l=0,u=0;var O=function solveLinearSystem(t){for(var e=t.length,n=0;n<e;n++){for(var i=n,r=Math.abs(t[n][n]),o=n+1;o<e;o++){var a=Math.abs(t[o][n]);a>r&&(r=a,i=o)}if(0===r)return null;var s=t[i];t[i]=t[n],t[n]=s;for(var l=n+1;l<e;l++)for(var u=-t[l][n]/t[n][n],c=n;c<e+1;c++)n==c?t[l][c]=0:t[l][c]+=u*t[n][c]}for(var h=new Array(e),d=e-1;d>=0;d--){h[d]=t[d][e]/t[d][d];for(var p=d-1;p>=0;p--)t[p][e]-=t[p][d]*h[d]}return h}([[c-=S,p-=M,0,0,b-v],[f-=S,y-=M,0,0,w-v],[0,0,c,p,T-_],[0,0,f,y,E-_]]);if(O){h.save(),h.beginPath();var x=(v+b+w)/3,P=(_+T+E)/3,C=enlargeClipPoint(x,P,v,_),I=enlargeClipPoint(x,P,b,T),L=enlargeClipPoint(x,P,w,E);h.moveTo(I[0],I[1]),h.lineTo(C[0],C[1]),h.lineTo(L[0],L[1]),h.clip(),h.transform(O[0],O[2],O[1],O[3],v,_),h.translate(d[0]-S,d[3]-M),h.scale(i/n,-i/n),h.drawImage(m.canvas,0,0),h.restore()}})),c&&(h.save(),h.strokeStyle="black",h.lineWidth=1,s.getTriangles().forEach((function(t,e,n){var i=t.target,r=(i[0][0]-g[0])/o,a=-(i[0][1]-g[1])/o,s=(i[1][0]-g[0])/o,l=-(i[1][1]-g[1])/o,u=(i[2][0]-g[0])/o,c=-(i[2][1]-g[1])/o;h.beginPath(),h.moveTo(s,l),h.lineTo(r,a),h.lineTo(u,c),h.closePath(),h.stroke()})),h.restore()),h.canvas}var xr=10,Pr=function(){function Triangulation(t,e,n,i,r){this.sourceProj_=t,this.targetProj_=e;var o={},a=getTransform(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=i,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&getWidth(i)==getWidth(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?getWidth(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?getWidth(this.targetProj_.getExtent()):null;var s=getTopLeft(n),l=getTopRight(n),u=getBottomRight(n),c=getBottomLeft(n),h=this.transformInv_(s),d=this.transformInv_(l),p=this.transformInv_(u),f=this.transformInv_(c);if(this.addQuad_(s,l,u,c,h,d,p,f,xr),this.wrapsXInSource_){var m=1/0;this.triangles_.forEach((function(t,e,n){m=Math.min(m,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-m>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-m>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-m>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-m>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var n=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-n<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}o={}}return Triangulation.prototype.addTriangle_=function(t,e,n,i,r,o){this.triangles_.push({source:[i,r,o],target:[t,e,n]})},Triangulation.prototype.addQuad_=function(t,e,n,i,r,o,a,s,l){var u=boundingExtent([r,o,a,s]),c=this.sourceWorldWidth_?getWidth(u)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&c>.5&&c<1,p=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)p=getWidth(boundingExtent([t,e,n,i]))/this.targetWorldWidth_>.25||p;!d&&this.sourceProj_.isGlobal()&&c&&(p=c>.25||p)}if(p||!this.maxSourceExtent_||intersects(u,this.maxSourceExtent_)){if(!(p||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(s[0])&&isFinite(s[1]))){if(!(l>0))return;p=!0}if(l>0){if(!p){var f=[(t[0]+n[0])/2,(t[1]+n[1])/2],m=this.transformInv_(f),y=void 0;if(d)y=(modulo(r[0],h)+modulo(a[0],h))/2-modulo(m[0],h);else y=(r[0]+a[0])/2-m[0];var g=(r[1]+a[1])/2-m[1];p=y*y+g*g>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var v=[(e[0]+n[0])/2,(e[1]+n[1])/2],_=this.transformInv_(v),b=[(i[0]+t[0])/2,(i[1]+t[1])/2],T=this.transformInv_(b);this.addQuad_(t,e,v,b,r,o,_,T,l-1),this.addQuad_(b,v,n,i,T,_,a,s,l-1)}else{var w=[(t[0]+e[0])/2,(t[1]+e[1])/2],E=this.transformInv_(w),S=[(n[0]+i[0])/2,(n[1]+i[1])/2],M=this.transformInv_(S);this.addQuad_(t,w,S,i,r,E,M,s,l-1),this.addQuad_(w,e,n,S,E,o,a,M,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,n,i,r,a,s),this.addTriangle_(t,e,n,r,o,a)}},Triangulation.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,n,i){var r=e.source;extendCoordinate(t,r[0]),extendCoordinate(t,r[1]),extendCoordinate(t,r[2])})),t},Triangulation.prototype.getTriangles=function(){return this.triangles_},Triangulation}(),Cr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Ir=function(t){function ReprojImage(e,n,i,r,o,a){var s=this,l=e.getExtent(),u=n.getExtent(),c=u?getIntersection(i,u):i,h=calculateSourceResolution(e,n,getCenter(c),r),d=new Pr(e,n,c,l,h*ur),p=a(d.calculateSourceExtent(),h,o),f=p?Qi.IDLE:Qi.EMPTY,m=p?p.getPixelRatio():1;return(s=t.call(this,i,r,m,f)||this).targetProj_=n,s.maxSourceExtent_=l,s.triangulation_=d,s.targetResolution_=r,s.targetExtent_=i,s.sourceImage_=p,s.sourcePixelRatio_=m,s.canvas_=null,s.sourceListenerKey_=null,s}return Cr(ReprojImage,t),ReprojImage.prototype.disposeInternal=function(){this.state==Qi.LOADING&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},ReprojImage.prototype.getImage=function(){return this.canvas_},ReprojImage.prototype.getProjection=function(){return this.targetProj_},ReprojImage.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==Qi.LOADED){var e=getWidth(this.targetExtent_)/this.targetResolution_,n=getHeight(this.targetExtent_)/this.targetResolution_;this.canvas_=render(e,n,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},ReprojImage.prototype.load=function(){if(this.state==Qi.IDLE){this.state=Qi.LOADING,this.changed();var t=this.sourceImage_.getState();t==Qi.LOADED||t==Qi.ERROR?this.reproject_():(this.sourceListenerKey_=listen(this.sourceImage_,Hn.CHANGE,(function(t){var e=this.sourceImage_.getState();e!=Qi.LOADED&&e!=Qi.ERROR||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}},ReprojImage.prototype.unlistenSource_=function(){unlistenByKey(this.sourceListenerKey_),this.sourceListenerKey_=null},ReprojImage}(vr),Lr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Rr=function(t){function Source(e){var n=t.call(this)||this;return n.projection_=get$3(e.projection),n.attributions_=adaptAttributions(e.attributions),n.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,n.loading=!1,n.state_=void 0!==e.state?e.state:ki.READY,n.wrapX_=void 0!==e.wrapX&&e.wrapX,n}return Lr(Source,t),Source.prototype.getAttributions=function(){return this.attributions_},Source.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},Source.prototype.getProjection=function(){return this.projection_},Source.prototype.getResolutions=function(){return abstract()},Source.prototype.getState=function(){return this.state_},Source.prototype.getWrapX=function(){return this.wrapX_},Source.prototype.refresh=function(){this.changed()},Source.prototype.setAttributions=function(t){this.attributions_=adaptAttributions(t),this.changed()},Source.prototype.setState=function(t){this.state_=t,this.changed()},Source}(ti);function adaptAttributions(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var kr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Ar="imageloadstart",Dr="imageloadend",jr="imageloaderror",Nr=function(t){function ImageSourceEvent(e,n){var i=t.call(this,e)||this;return i.image=n,i}return kr(ImageSourceEvent,t),ImageSourceEvent}(Zn),Fr=function(t){function ImageSource(e){var n=t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state})||this;return n.resolutions_=void 0!==e.resolutions?e.resolutions:null,n.reprojectedImage_=null,n.reprojectedRevision_=0,n}return kr(ImageSource,t),ImageSource.prototype.getResolutions=function(){return this.resolutions_},ImageSource.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=linearFindNearest(this.resolutions_,t,0);t=this.resolutions_[e]}return t},ImageSource.prototype.getImage=function(t,e,n,i){var r=this.getProjection();if(r&&i&&!equivalent(r,i)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&equivalent(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==e&&equals(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new Ir(r,i,t,e,n,function(t,e,n){return this.getImageInternal(t,e,n,r)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return r&&(i=r),this.getImageInternal(t,e,n,i)},ImageSource.prototype.getImageInternal=function(t,e,n,i){return abstract()},ImageSource.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case Qi.LOADING:this.loading=!0,this.dispatchEvent(new Nr(Ar,e));break;case Qi.LOADED:this.loading=!1,this.dispatchEvent(new Nr(Dr,e));break;case Qi.ERROR:this.loading=!1,this.dispatchEvent(new Nr(jr,e))}},ImageSource}(Rr);function defaultImageLoadFunction(t,e){t.getImage().src=e}var Ur="carmentaserver",Vr="geoserver",zr="mapserver",Gr="qgis";function compareVersions(t,e){for(var n=(""+t).split("."),i=(""+e).split("."),r=0;r<Math.max(n.length,i.length);r++){var o=parseInt(n[r]||"0",10),a=parseInt(i[r]||"0",10);if(o>a)return 1;if(a>o)return-1}return 0}function appendParams(t,e){var n=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&n.push(t+"="+encodeURIComponent(e[t]))}));var i=n.join("&");return(t=-1===(t=t.replace(/[?&]$/,"")).indexOf("?")?t+"?":t+"&")+i}var qr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Wr=[101,101],Br=function(e){function ImageWMS(t){var n=this,i=t||{};return(n=e.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions})||this).crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null,n.url_=i.url,n.imageLoadFunction_=void 0!==i.imageLoadFunction?i.imageLoadFunction:defaultImageLoadFunction,n.params_=i.params||{},n.v13_=!0,n.updateV13_(),n.serverType_=i.serverType,n.hidpi_=void 0===i.hidpi||i.hidpi,n.image_=null,n.imageSize_=[0,0],n.renderedRevision_=0,n.ratio_=void 0!==i.ratio?i.ratio:1.5,n}return qr(ImageWMS,e),ImageWMS.prototype.getFeatureInfoUrl=function(e,n,i,r){if(void 0!==this.url_){var o=get$3(i),a=this.getProjection();a&&a!==o&&(n=calculateSourceResolution(a,o,e,n),e=transform(e,o,a));var s=getForViewAndSize(e,n,0,Wr),l={SERVICE:"WMS",VERSION:yr,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};t(l,this.params_,r);var u=Math.floor((e[0]-s[0])/n),c=Math.floor((s[3]-e[1])/n);return l[this.v13_?"I":"X"]=u,l[this.v13_?"J":"Y"]=c,this.getRequestUrl_(s,Wr,1,a||o,l)}},ImageWMS.prototype.getLegendUrl=function(e,n){if(void 0!==this.url_){var i={SERVICE:"WMS",VERSION:yr,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===n||void 0===n.LAYER){var r=this.params_.LAYERS;if(!(!Array.isArray(r)||1===r.length))return;i.LAYER=r}if(void 0!==e){var o=this.getProjection()?this.getProjection().getMetersPerUnit():1;i.SCALE=e*o*39.37*(25.4/.28)}return t(i,n),appendParams(this.url_,i)}},ImageWMS.prototype.getParams=function(){return this.params_},ImageWMS.prototype.getImageInternal=function(e,n,i,r){if(void 0===this.url_)return null;n=this.findNearestResolution(n),1==i||this.hidpi_&&void 0!==this.serverType_||(i=1);var o=n/i,a=getCenter(e),s=getForViewAndSize(a,o,0,[Math.ceil(getWidth(e)/o),Math.ceil(getHeight(e)/o)]),l=getForViewAndSize(a,o,0,[Math.ceil(this.ratio_*getWidth(e)/o),Math.ceil(this.ratio_*getHeight(e)/o)]),u=this.image_;if(u&&this.renderedRevision_==this.getRevision()&&u.getResolution()==n&&u.getPixelRatio()==i&&containsExtent(u.getExtent(),s))return u;var c={SERVICE:"WMS",VERSION:yr,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};t(c,this.params_),this.imageSize_[0]=Math.round(getWidth(l)/o),this.imageSize_[1]=Math.round(getHeight(l)/o);var h=this.getRequestUrl_(l,this.imageSize_,i,r,c);return this.image_=new Or(l,n,i,h,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(Hn.CHANGE,this.handleImageChange.bind(this)),this.image_},ImageWMS.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},ImageWMS.prototype.getRequestUrl_=function(t,e,n,i,r){if(assert(void 0!==this.url_,9),r[this.v13_?"CRS":"SRS"]=i.getCode(),"STYLES"in this.params_||(r.STYLES=""),1!=n)switch(this.serverType_){case Vr:var o=90*n+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+o:r.FORMAT_OPTIONS="dpi:"+o;break;case zr:r.MAP_RESOLUTION=90*n;break;case Ur:case Gr:r.DPI=90*n;break;default:assert(!1,8)}r.WIDTH=e[0],r.HEIGHT=e[1];var a,s=i.getAxisOrientation();return a=this.v13_&&"ne"==s.substr(0,2)?[t[1],t[0],t[3],t[2]]:t,r.BBOX=a.join(","),appendParams(this.url_,r)},ImageWMS.prototype.getUrl=function(){return this.url_},ImageWMS.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},ImageWMS.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},ImageWMS.prototype.updateParams=function(e){t(this.params_,e),this.updateV13_(),this.image_=null,this.changed()},ImageWMS.prototype.updateV13_=function(){var t=this.params_.VERSION||yr;this.v13_=compareVersions(t,"1.3")>=0},ImageWMS}(Fr);function createOrUpdate$2(t,e,n,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function getKeyZXY(t,e,n){return t+"/"+e+"/"+n}function getKey(t){return getKeyZXY(t[0],t[1],t[2])}function hash(t){return(t[1]<<t[0])+t[2]}function createFromTemplate(t,e){var n=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(a,s,l){return a?t.replace(n,a[0].toString()).replace(i,a[1].toString()).replace(r,a[2].toString()).replace(o,(function(){var t=a[0],n=e.getFullTileRange(t);return assert(n,55),(n.getHeight()-a[2]-1).toString()})):void 0}}function createFromTileUrlFunctions(t){return 1===t.length?t[0]:function(e,n,i){if(e){var r=modulo(hash(e),t.length);return t[r](e,n,i)}}}function nullTileUrlFunction(t,e,n){}function expandUrl(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var i=n[1].charCodeAt(0),r=n[2].charCodeAt(0),o=void 0;for(o=i;o<=r;++o)e.push(t.replace(n[0],String.fromCharCode(o)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t)){for(var a=parseInt(n[2],10),s=parseInt(n[1],10);s<=a;s++)e.push(t.replace(n[0],s.toString()));return e}return e.push(t),e}function easeIn(t){return Math.pow(t,3)}function easeOut(t){return 1-easeIn(1-t)}function inAndOut(t){return 3*t*t-2*t*t*t}function linear(t){return t}var Zr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Kr=function(t){function Tile(e,n,i){var r=t.call(this)||this,o=i||{};return r.tileCoord=e,r.state=n,r.interimTile=null,r.hifi=!0,r.key="",r.transition_=void 0===o.transition?250:o.transition,r.transitionStarts_={},r}return Zr(Tile,t),Tile.prototype.changed=function(){this.dispatchEvent(Hn.CHANGE)},Tile.prototype.disposeInternal=function(){this.setState(zi.ABORT)},Tile.prototype.getKey=function(){return this.key+"/"+this.tileCoord},Tile.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==zi.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},Tile.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==zi.LOADED){t.interimTile=null;break}t.getState()==zi.LOADING?e=t:t.getState()==zi.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},Tile.prototype.getTileCoord=function(){return this.tileCoord},Tile.prototype.getState=function(){return this.state},Tile.prototype.setState=function(t){if(this.state!==zi.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},Tile.prototype.load=function(){abstract()},Tile.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;var i=e-n+1e3/60;return i>=this.transition_?1:easeIn(i/this.transition_)},Tile.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},Tile.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},Tile}(Yn),Yr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Hr=function(t){function ImageTile(e,n,i,r,o,a){var s=t.call(this,e,n,a)||this;return s.crossOrigin_=r,s.src_=i,s.image_=new Image,null!==r&&(s.image_.crossOrigin=r),s.unlisten_=null,s.tileLoadFunction_=o,s}return Yr(ImageTile,t),ImageTile.prototype.disposeInternal=function(){this.state==zi.LOADING&&(this.unlistenImage_(),this.image_=getBlankImage()),this.interimTile&&this.interimTile.dispose(),t.prototype.disposeInternal.call(this)},ImageTile.prototype.getImage=function(){return this.image_},ImageTile.prototype.getKey=function(){return this.src_},ImageTile.prototype.handleImageError_=function(){this.state=zi.ERROR,this.unlistenImage_(),this.image_=getBlankImage(),this.changed()},ImageTile.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=zi.LOADED:this.state=zi.EMPTY,this.unlistenImage_(),this.changed()},ImageTile.prototype.load=function(){this.state==zi.ERROR&&(this.state=zi.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==zi.IDLE&&(this.state=zi.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=listenImage(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},ImageTile.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},ImageTile}(Kr);function getBlankImage(){var t=createCanvasContext2D(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}var Xr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),$r=function(t){function TileCache(e){return t.call(this,e)||this}return Xr(TileCache,t),TileCache.prototype.expireCache=function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().dispose()}},TileCache.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function fromKey(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(getKey(e.tileCoord)),e.dispose())}.bind(this))}},TileCache}(Hi),Qr=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Jr=function(t){function ReprojTile(e,n,i,r,o,a,s,l,u,c,h){var d=t.call(this,o,zi.IDLE)||this;d.renderEdges_=void 0!==h&&h,d.pixelRatio_=s,d.gutter_=l,d.canvas_=null,d.sourceTileGrid_=n,d.targetTileGrid_=r,d.wrappedTileCoord_=a||o,d.sourceTiles_=[],d.sourcesListenerKeys_=null,d.sourceZ_=0;var p=r.getTileCoordExtent(d.wrappedTileCoord_),f=d.targetTileGrid_.getExtent(),m=d.sourceTileGrid_.getExtent(),y=f?getIntersection(p,f):p;if(0===getArea(y))return d.state=zi.EMPTY,d;var g=e.getExtent();g&&(m=m?getIntersection(m,g):g);var v=r.getResolution(d.wrappedTileCoord_[0]),_=calculateSourceResolution(e,i,getCenter(y),v);if(!isFinite(_)||_<=0)return d.state=zi.EMPTY,d;var b=void 0!==c?c:ur;if(d.triangulation_=new Pr(e,i,y,m,_*b),0===d.triangulation_.getTriangles().length)return d.state=zi.EMPTY,d;d.sourceZ_=n.getZForResolution(_);var T=d.triangulation_.calculateSourceExtent();if(m&&(e.canWrapX()?(T[1]=clamp(T[1],m[1],m[3]),T[3]=clamp(T[3],m[1],m[3])):T=getIntersection(T,m)),getArea(T)){for(var w=n.getTileRangeForExtentAndZ(T,d.sourceZ_),E=w.minX;E<=w.maxX;E++)for(var S=w.minY;S<=w.maxY;S++){var M=u(d.sourceZ_,E,S,s);M&&d.sourceTiles_.push(M)}0===d.sourceTiles_.length&&(d.state=zi.EMPTY)}else d.state=zi.EMPTY;return d}return Qr(ReprojTile,t),ReprojTile.prototype.disposeInternal=function(){this.state==zi.LOADING&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},ReprojTile.prototype.getImage=function(){return this.canvas_},ReprojTile.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,n,i){e&&e.getState()==zi.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=zi.ERROR;else{var e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),i="number"==typeof n?n:n[0],r="number"==typeof n?n:n[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=render(i,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,s,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=zi.LOADED}this.changed()},ReprojTile.prototype.load=function(){if(this.state==zi.IDLE){this.state=zi.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,n,i){var r=e.getState();if(r==zi.IDLE||r==zi.LOADING){t++;var o=listen(e,Hn.CHANGE,(function(n){var i=e.getState();i!=zi.LOADED&&i!=zi.ERROR&&i!=zi.EMPTY||(unlistenByKey(o),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(o)}}.bind(this)),this.sourceTiles_.forEach((function(t,e,n){t.getState()==zi.IDLE&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},ReprojTile.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(unlistenByKey),this.sourcesListenerKeys_=null},ReprojTile}(Kr);function buffer$1(t,e,n){return void 0===n&&(n=[0,0]),n[0]=t[0]+2*e,n[1]=t[1]+2*e,n}function scale(t,e,n){return void 0===n&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function toSize(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}var to=42,eo=256,no=[0,0,0],io=function(){function TileGrid(t){var e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,assert(function isSorted(t,e,n){var i=e||numberSafeCompareFunction;return t.every((function(e,r){if(0===r)return!0;var o=i(t[r-1],e);return!(o>0||n&&0===o)}))}(this.resolutions_,(function(t,e){return e-t}),!0),17),!t.origins)for(var n=0,i=this.resolutions_.length-1;n<i;++n)if(e){if(this.resolutions_[n]/this.resolutions_[n+1]!==e){e=void 0;break}}else e=this.resolutions_[n]/this.resolutions_[n+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,assert(this.origins_.length==this.resolutions_.length,20));var r=t.extent;void 0===r||this.origin_||this.origins_||(this.origin_=getTopLeft(r)),assert(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,assert(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:eo,assert(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==r?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){return new Vi(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):r&&this.calculateTileRanges_(r)}return TileGrid.prototype.forEachTileCoord=function(t,e,n){for(var i=this.getTileRangeForExtentAndZ(t,e),r=i.minX,o=i.maxX;r<=o;++r)for(var a=i.minY,s=i.maxY;a<=s;++a)n([e,r,a])},TileGrid.prototype.forEachTileCoordParentTileRange=function(t,e,n,i){var r,o,a=null,s=t[0]-1;for(2===this.zoomFactor_?(r=t[1],o=t[2]):a=this.getTileCoordExtent(t,i);s>=this.minZoom;){if(e(s,2===this.zoomFactor_?createOrUpdate$1(r=Math.floor(r/2),r,o=Math.floor(o/2),o,n):this.getTileRangeForExtentAndZ(a,s,n)))return!0;--s}return!1},TileGrid.prototype.getExtent=function(){return this.extent_},TileGrid.prototype.getMaxZoom=function(){return this.maxZoom},TileGrid.prototype.getMinZoom=function(){return this.minZoom},TileGrid.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},TileGrid.prototype.getResolution=function(t){return this.resolutions_[t]},TileGrid.prototype.getResolutions=function(){return this.resolutions_},TileGrid.prototype.getTileCoordChildTileRange=function(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var i=2*t[1],r=2*t[2];return createOrUpdate$1(i,i+1,r,r+1,e)}var o=this.getTileCoordExtent(t,n);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},TileGrid.prototype.getTileRangeExtent=function(t,e,n){var i=this.getOrigin(t),r=this.getResolution(t),o=toSize(this.getTileSize(t),this.tmpSize_),a=i[0]+e.minX*o[0]*r,s=i[0]+(e.maxX+1)*o[0]*r;return createOrUpdate(a,i[1]+e.minY*o[1]*r,s,i[1]+(e.maxY+1)*o[1]*r,n)},TileGrid.prototype.getTileRangeForExtentAndZ=function(t,e,n){var i=no;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,i);var r=i[1],o=i[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,i),createOrUpdate$1(r,i[1],o,i[2],n)},TileGrid.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=toSize(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]-(t[2]+.5)*i[1]*n]},TileGrid.prototype.getTileCoordExtent=function(t,e){var n=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=toSize(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*r[0]*i,a=n[1]-(t[2]+1)*r[1]*i;return createOrUpdate(o,a,o+r[0]*i,a+r[1]*i,e)},TileGrid.prototype.getTileCoordForCoordAndResolution=function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)},TileGrid.prototype.getTileCoordForXYAndResolution_=function(t,e,n,i,r){var o=this.getZForResolution(n),a=n/this.getResolution(o),s=this.getOrigin(o),l=toSize(this.getTileSize(o),this.tmpSize_),u=i?.5:0,c=i?.5:0,h=Math.floor((t-s[0])/n+u),d=Math.floor((s[1]-e)/n+c),p=a*h/l[0],f=a*d/l[1];return i?(p=Math.ceil(p)-1,f=Math.ceil(f)-1):(p=Math.floor(p),f=Math.floor(f)),createOrUpdate$2(o,p,f,r)},TileGrid.prototype.getTileCoordForXYAndZ_=function(t,e,n,i,r){var o=this.getOrigin(n),a=this.getResolution(n),s=toSize(this.getTileSize(n),this.tmpSize_),l=i?.5:0,u=i?.5:0,c=Math.floor((t-o[0])/a+l),h=Math.floor((o[1]-e)/a+u),d=c/s[0],p=h/s[1];return i?(d=Math.ceil(d)-1,p=Math.ceil(p)-1):(d=Math.floor(d),p=Math.floor(p)),createOrUpdate$2(n,d,p,r)},TileGrid.prototype.getTileCoordForCoordAndZ=function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)},TileGrid.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},TileGrid.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},TileGrid.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},TileGrid.prototype.getZForResolution=function(t,e){return clamp(linearFindNearest(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},TileGrid.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,n=new Array(e),i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n},TileGrid}();function getForProjection(t){var e=t.getDefaultTileGrid();return e||(e=function createForProjection(t,e,n,i){return function createForExtent(t,e,n,i){var r=void 0!==i?i:f.TOP_LEFT,o=resolutionsFromExtent(t,e,n);return new io({extent:t,origin:getCorner(t,r),resolutions:o,tileSize:n})}(extentFromProjection(t),e,n,i)}(t),t.setDefaultTileGrid(e)),e}function resolutionsFromExtent(t,e,n){for(var i=void 0!==e?e:to,r=getHeight(t),o=getWidth(t),a=toSize(void 0!==n?n:eo),s=Math.max(o/a[0],r/a[1]),l=i+1,u=new Array(l),c=0;c<l;++c)u[c]=s/Math.pow(2,c);return u}function extentFromProjection(t){var e=(t=get$3(t)).getExtent();if(!e){var n=180*g[y.DEGREES]/t.getMetersPerUnit();e=createOrUpdate(-n,-n,n,n)}return e}var ro=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),oo=function(t){function TileSource(e){var n=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX})||this;n.opaque_=void 0!==e.opaque&&e.opaque,n.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,n.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;var i=e.cacheSize;if(void 0===i){var r=[256,256],o=e.tileGrid;o&&toSize(o.getTileSize(o.getMinZoom()),r);var a="undefined"!=typeof screen,s=a?screen.availWidth||screen.width:1920,l=a?screen.availHeight||screen.height:1080;i=4*Math.ceil(s/r[0])*Math.ceil(l/r[1])}return n.tileCache=new $r(i),n.tmpSize=[0,0],n.key_=e.key||"",n.tileOptions={transition:e.transition},n.zDirection=e.zDirection?e.zDirection:0,n}return ro(TileSource,t),TileSource.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},TileSource.prototype.expireCache=function(t,e){var n=this.getTileCacheForProjection(t);n&&n.expireCache(e)},TileSource.prototype.forEachLoadedTile=function(t,e,n,i){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var o,a,s,l=!0,u=n.minX;u<=n.maxX;++u)for(var c=n.minY;c<=n.maxY;++c)a=getKeyZXY(e,u,c),s=!1,r.containsKey(a)&&(s=(o=r.get(a)).getState()===zi.LOADED)&&(s=!1!==i(o)),s||(l=!1);return l},TileSource.prototype.getGutterForProjection=function(t){return 0},TileSource.prototype.getKey=function(){return this.key_},TileSource.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},TileSource.prototype.getOpaque=function(t){return this.opaque_},TileSource.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},TileSource.prototype.getTile=function(t,e,n,i,r){return abstract()},TileSource.prototype.getTileGrid=function(){return this.tileGrid},TileSource.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:getForProjection(t)},TileSource.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!equivalent(e,t)?null:this.tileCache},TileSource.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},TileSource.prototype.getTilePixelSize=function(t,e,n){var i=this.getTileGridForProjection(n),r=this.getTilePixelRatio(e),o=toSize(i.getTileSize(t),this.tmpSize);return 1==r?o:scale(o,r,this.tmpSize)},TileSource.prototype.getTileCoordForTileUrlFunction=function(t,e){var n=void 0!==e?e:this.getProjection(),i=this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=function wrapX(t,e,n){var i=e[0],r=t.getTileCoordCenter(e),o=extentFromProjection(n);if(containsCoordinate(o,r))return e;var a=getWidth(o),s=Math.ceil((o[0]-r[0])/a);return r[0]+=a*s,t.getTileCoordForCoordAndZ(r,i)}(i,t,n)),function withinExtentAndZ(t,e){var n=t[0],i=t[1],r=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;var o,a=e.getExtent();return!(o=a?e.getTileRangeForExtentAndZ(a,n):e.getFullTileRange(n))||o.containsXY(i,r)}(t,i)?t:null},TileSource.prototype.clear=function(){this.tileCache.clear()},TileSource.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},TileSource.prototype.useTile=function(t,e,n,i){},TileSource}(Rr),ao=function(t){function TileSourceEvent(e,n){var i=t.call(this,e)||this;return i.tile=n,i}return ro(TileSourceEvent,t),TileSourceEvent}(Zn),so="tileloadstart",lo="tileloadend",uo="tileloaderror",co=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),ho=function(t){function UrlTile(e){var n=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return n.generateTileUrlFunction_=!e.tileUrlFunction,n.tileLoadFunction=e.tileLoadFunction,n.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(n):nullTileUrlFunction,n.urls=null,e.urls?n.setUrls(e.urls):e.url&&n.setUrl(e.url),n.tileLoadingKeys_={},n}return co(UrlTile,t),UrlTile.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},UrlTile.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},UrlTile.prototype.getUrls=function(){return this.urls},UrlTile.prototype.handleTileChange=function(t){var e,n=t.target,i=getUid(n),r=n.getState();r==zi.LOADING?(this.tileLoadingKeys_[i]=!0,e=so):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],e=r==zi.ERROR?uo:r==zi.LOADED||r==zi.ABORT?lo:void 0),null!=e&&this.dispatchEvent(new ao(e,n))},UrlTile.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},UrlTile.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},UrlTile.prototype.setUrl=function(t){var e=expandUrl(t);this.urls=e,this.setUrls(e)},UrlTile.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function createFromTemplates(t,e){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=createFromTemplate(t[r],e);return createFromTileUrlFunctions(i)}(t,this.tileGrid),e):this.setKey(e)},UrlTile.prototype.useTile=function(t,e,n){var i=getKeyZXY(t,e,n);this.tileCache.containsKey(i)&&this.tileCache.get(i)},UrlTile}(oo),po=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),fo=function(t){function TileImage(e){var n=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:defaultTileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return n.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,n.tileClass=void 0!==e.tileClass?e.tileClass:Hr,n.tileCacheForProjection={},n.tileGridForProjection={},n.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,n.renderReprojectionEdges_=!1,n}return po(TileImage,t),TileImage.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},TileImage.prototype.expireCache=function(t,e){var n=this.getTileCacheForProjection(t);for(var i in this.tileCache.expireCache(this.tileCache==n?e:{}),this.tileCacheForProjection){var r=this.tileCacheForProjection[i];r.expireCache(r==n?e:{})}},TileImage.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!equivalent(this.getProjection(),t)?0:this.getGutter()},TileImage.prototype.getGutter=function(){return 0},TileImage.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!equivalent(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},TileImage.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!equivalent(e,t)){var n=getUid(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=getForProjection(t)),this.tileGridForProjection[n]}return this.tileGrid},TileImage.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||equivalent(e,t))return this.tileCache;var n=getUid(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new $r(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]},TileImage.prototype.createTile_=function(t,e,n,i,r,o){var a=[t,e,n],s=this.getTileCoordForTileUrlFunction(a,r),l=s?this.tileUrlFunction(s,i,r):void 0,u=new this.tileClass(a,void 0!==l?zi.IDLE:zi.EMPTY,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(Hn.CHANGE,this.handleTileChange.bind(this)),u},TileImage.prototype.getTile=function(t,e,n,i,r){var o=this.getProjection();if(o&&r&&!equivalent(o,r)){var a=this.getTileCacheForProjection(r),s=[t,e,n],l=void 0,u=getKey(s);a.containsKey(u)&&(l=a.get(u));var c=this.getKey();if(l&&l.key==c)return l;var h=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),p=this.getTileCoordForTileUrlFunction(s,r),f=new Jr(o,h,r,d,s,p,this.getTilePixelRatio(i),this.getGutter(),function(t,e,n,i){return this.getTileInternal(t,e,n,i,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return f.key=c,l?(f.interimTile=l,f.refreshInterimChain(),a.replace(u,f)):a.set(u,f),f}return this.getTileInternal(t,e,n,i,o||r)},TileImage.prototype.getTileInternal=function(t,e,n,i,r){var o=null,a=getKeyZXY(t,e,n),s=this.getKey();if(this.tileCache.containsKey(a)){if((o=this.tileCache.get(a)).key!=s){var l=o;o=this.createTile_(t,e,n,i,r,s),l.getState()==zi.IDLE?o.interimTile=l.interimTile:o.interimTile=l,o.refreshInterimChain(),this.tileCache.replace(a,o)}}else o=this.createTile_(t,e,n,i,r,s),this.tileCache.set(a,o);return o},TileImage.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},TileImage.prototype.setTileGridForProjection=function(t,e){var n=get$3(t);if(n){var i=getUid(n);i in this.tileGridForProjection||(this.tileGridForProjection[i]=e)}},TileImage}(ho);function defaultTileLoadFunction(t,e){t.getImage().src=e}var mo=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),yo=function(t){function XYZ(e){var n=e||{},i=void 0!==n.projection?n.projection:"EPSG:3857",r=void 0!==n.tileGrid?n.tileGrid:function createXYZ(t){var e=t||{},n=e.extent||get$3("EPSG:3857").getExtent(),i={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:resolutionsFromExtent(n,e.maxZoom,e.tileSize)};return new io(i)}({extent:extentFromProjection(i),maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize});return t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,opaque:n.opaque,projection:i,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this}return mo(XYZ,t),XYZ}(fo);function equals$2(t,e){for(var n=!0,i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}function rotate(t,e){var n=Math.cos(e),i=Math.sin(e),r=t[0]*n-t[1]*i,o=t[1]*n+t[0]*i;return t[0]=r,t[1]=o,t}var go=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),vo=[1,0,0,1,0,0],_o=function(t){function Geometry(){var e=t.call(this)||this;return e.extent_=[1/0,1/0,-1/0,-1/0],e.extentRevision_=-1,e.simplifiedGeometryMaxMinSquaredTolerance=0,e.simplifiedGeometryRevision=0,e.simplifyTransformedInternal=function memoizeOne(t){var e,n,i,r=!1;return function(){var o=Array.prototype.slice.call(arguments);return r&&this===i&&equals$1(o,n)||(r=!0,i=this,n=o,e=t.apply(this,arguments)),e}}((function(t,e,n){if(!n)return this.getSimplifiedGeometry(e);var i=this.clone();return i.applyTransform(n),i.getSimplifiedGeometry(e)})),e}return go(Geometry,t),Geometry.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},Geometry.prototype.clone=function(){return abstract()},Geometry.prototype.closestPointXY=function(t,e,n,i){return abstract()},Geometry.prototype.containsXY=function(t,e){var n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e},Geometry.prototype.getClosestPoint=function(t,e){var n=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],n,1/0),n},Geometry.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},Geometry.prototype.computeExtent=function(t){return abstract()},Geometry.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function returnOrUpdate(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},Geometry.prototype.rotate=function(t,e){abstract()},Geometry.prototype.scale=function(t,e,n){abstract()},Geometry.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},Geometry.prototype.getSimplifiedGeometry=function(t){return abstract()},Geometry.prototype.getType=function(){return abstract()},Geometry.prototype.applyTransform=function(t){abstract()},Geometry.prototype.intersectsExtent=function(t){return abstract()},Geometry.prototype.translate=function(t,e){abstract()},Geometry.prototype.transform=function(t,e){var n=get$3(t),i=n.getUnits()==y.TILE_PIXELS?function(t,i,r){var o=n.getExtent(),a=n.getWorldExtent(),s=getHeight(a)/getHeight(o);return compose(vo,a[0],a[3],s,-s,0,0,0),function transform2D(t,e,n,i,r,o){for(var a=o||[],s=0,l=e;l<n;l+=i){var u=t[l],c=t[l+1];a[s++]=r[0]*u+r[2]*c+r[4],a[s++]=r[1]*u+r[3]*c+r[5]}return o&&a.length!=s&&(a.length=s),a}(t,0,t.length,r,vo,i),getTransform(n,e)(t,i,r)}:getTransform(n,e);return this.applyTransform(i),this},Geometry}(ti),bo={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"},To=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),wo=function(t){function SimpleGeometry(){var e=t.call(this)||this;return e.layout=bo.XY,e.stride=2,e.flatCoordinates=null,e}return To(SimpleGeometry,t),SimpleGeometry.prototype.computeExtent=function(t){return function createOrUpdateFromFlatCoordinates(t,e,n,i,r){return extendFlatCoordinates(createOrUpdateEmpty(r),t,e,n,i)}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},SimpleGeometry.prototype.getCoordinates=function(){return abstract()},SimpleGeometry.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},SimpleGeometry.prototype.getFlatCoordinates=function(){return this.flatCoordinates},SimpleGeometry.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},SimpleGeometry.prototype.getLayout=function(){return this.layout},SimpleGeometry.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},SimpleGeometry.prototype.getSimplifiedGeometryInternal=function(t){return this},SimpleGeometry.prototype.getStride=function(){return this.stride},SimpleGeometry.prototype.setFlatCoordinates=function(t,e){this.stride=getStrideForLayout(t),this.layout=t,this.flatCoordinates=e},SimpleGeometry.prototype.setCoordinates=function(t,e){abstract()},SimpleGeometry.prototype.setLayout=function(t,e,n){var i;if(t)i=getStrideForLayout(t);else{for(var r=0;r<n;++r){if(0===e.length)return this.layout=bo.XY,void(this.stride=2);e=e[0]}t=function getLayoutForStride(t){var e;2==t?e=bo.XY:3==t?e=bo.XYZ:4==t&&(e=bo.XYZM);return(e)}(i=e.length)}this.layout=t,this.stride=i},SimpleGeometry.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},SimpleGeometry.prototype.rotate=function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();!function rotate$1(t,e,n,i,r,o,a){for(var s=a||[],l=Math.cos(r),u=Math.sin(r),c=o[0],h=o[1],d=0,p=e;p<n;p+=i){var f=t[p]-c,m=t[p+1]-h;s[d++]=c+f*l-m*u,s[d++]=h+f*u+m*l;for(var y=p+2;y<p+i;++y)s[d++]=t[y]}return a&&s.length!=d&&(s.length=d),s}(n,0,n.length,i,t,e,n),this.changed()}},SimpleGeometry.prototype.scale=function(t,e,n){var i=e;void 0===i&&(i=t);var r=n;r||(r=getCenter(this.getExtent()));var o=this.getFlatCoordinates();if(o){var a=this.getStride();!function scale$2(t,e,n,i,r,o,a,s){for(var l=s||[],u=a[0],c=a[1],h=0,d=e;d<n;d+=i){var p=t[d]-u,f=t[d+1]-c;l[h++]=u+r*p,l[h++]=c+o*f;for(var m=d+2;m<d+i;++m)l[h++]=t[m]}return s&&l.length!=h&&(l.length=h),l}(o,0,o.length,a,t,i,r,o),this.changed()}},SimpleGeometry.prototype.translate=function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();!function translate(t,e,n,i,r,o,a){for(var s=a||[],l=0,u=e;u<n;u+=i){s[l++]=t[u]+r,s[l++]=t[u+1]+o;for(var c=u+2;c<u+i;++c)s[l++]=t[c]}return a&&s.length!=l&&(s.length=l),s}(n,0,n.length,i,t,e,n),this.changed()}},SimpleGeometry}(_o);function getStrideForLayout(t){var e;return t==bo.XY?e=2:t==bo.XYZ||t==bo.XYM?e=3:t==bo.XYZM&&(e=4),e}function deflateCoordinates(t,e,n,i){for(var r=0,o=n.length;r<o;++r)for(var a=n[r],s=0;s<i;++s)t[e++]=a[s];return e}var Eo=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),So=function(t){function Point(e,n){var i=t.call(this)||this;return i.setCoordinates(e,n),i}return Eo(Point,t),Point.prototype.clone=function(){return new Point(this.flatCoordinates.slice(),this.layout)},Point.prototype.closestPointXY=function(t,e,n,i){var r=this.flatCoordinates,o=squaredDistance(t,e,r[0],r[1]);if(o<i){for(var a=this.stride,s=0;s<a;++s)n[s]=r[s];return n.length=a,o}return i},Point.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},Point.prototype.computeExtent=function(t){return function createOrUpdateFromCoordinate(t,e){var n=t[0],i=t[1];return createOrUpdate(n,i,n,i,e)}(this.flatCoordinates,t)},Point.prototype.getType=function(){return i},Point.prototype.intersectsExtent=function(t){return containsXY(t,this.flatCoordinates[0],this.flatCoordinates[1])},Point.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function deflateCoordinate(t,e,n,i){for(var r=0,o=n.length;r<o;++r)t[e++]=n[r];return e}(this.flatCoordinates,0,t,this.stride),this.changed()},Point}(wo),Mo={ADD:"add",REMOVE:"remove"},Oo=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),xo="length",Po=function(t){function CollectionEvent(e,n,i){var r=t.call(this,e)||this;return r.element=n,r.index=i,r}return Oo(CollectionEvent,t),CollectionEvent}(Zn),Co=function(t){function Collection(e,n){var i=t.call(this)||this,r=n||{};if(i.unique_=!!r.unique,i.array_=e||[],i.unique_)for(var o=0,a=i.array_.length;o<a;++o)i.assertUnique_(i.array_[o],o);return i.updateLength_(),i}return Oo(Collection,t),Collection.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},Collection.prototype.extend=function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this},Collection.prototype.forEach=function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)t(e[n],n,e)},Collection.prototype.getArray=function(){return this.array_},Collection.prototype.item=function(t){return this.array_[t]},Collection.prototype.getLength=function(){return this.get(xo)},Collection.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Po(Mo.ADD,e,t))},Collection.prototype.pop=function(){return this.removeAt(this.getLength()-1)},Collection.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},Collection.prototype.remove=function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)},Collection.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Po(Mo.REMOVE,e,t)),e},Collection.prototype.setAt=function(t,e){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(e,t);var i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Po(Mo.REMOVE,i,t)),this.dispatchEvent(new Po(Mo.ADD,e,t))}else{for(var r=n;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},Collection.prototype.updateLength_=function(){this.set(xo,this.array_.length)},Collection.prototype.assertUnique_=function(t,e){for(var n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new p(58)},Collection}(ti),Io=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Lo='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',Ro=function(t){function OSM(e){var n,i=e||{};n=void 0!==i.attributions?i.attributions:[Lo];var r=void 0!==i.crossOrigin?i.crossOrigin:"anonymous",o=void 0!==i.url?i.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return t.call(this,{attributions:n,cacheSize:i.cacheSize,crossOrigin:r,opaque:void 0===i.opaque||i.opaque,maxZoom:void 0!==i.maxZoom?i.maxZoom:19,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileLoadFunction:i.tileLoadFunction,url:o,wrapX:i.wrapX,attributionsCollapsible:!1})||this}return Io(OSM,t),OSM}(yo),ko=function(){function PriorityQueue(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return PriorityQueue.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,clear(this.queuedElements_)},PriorityQueue.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var i=this.keyFunction_(n);return delete this.queuedElements_[i],n},PriorityQueue.prototype.enqueue=function(t){assert(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},PriorityQueue.prototype.getCount=function(){return this.elements_.length},PriorityQueue.prototype.getLeftChildIndex_=function(t){return 2*t+1},PriorityQueue.prototype.getRightChildIndex_=function(t){return 2*t+2},PriorityQueue.prototype.getParentIndex_=function(t){return t-1>>1},PriorityQueue.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},PriorityQueue.prototype.isEmpty=function(){return 0===this.elements_.length},PriorityQueue.prototype.isKeyQueued=function(t){return t in this.queuedElements_},PriorityQueue.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},PriorityQueue.prototype.siftUp_=function(t){for(var e=this.elements_,n=this.priorities_,i=e.length,r=e[t],o=n[t],a=t;t<i>>1;){var s=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),u=l<i&&n[l]<n[s]?l:s;e[t]=e[u],n[t]=n[u],t=u}e[t]=r,n[t]=o,this.siftDown_(a,t)},PriorityQueue.prototype.siftDown_=function(t,e){for(var n=this.elements_,i=this.priorities_,r=n[e],o=i[e];e>t;){var a=this.getParentIndex_(e);if(!(i[a]>o))break;n[e]=n[a],i[e]=i[a],e=a}n[e]=r,i[e]=o},PriorityQueue.prototype.reprioritize=function(){var t,e,n,i=this.priorityFunction_,r=this.elements_,o=this.priorities_,a=0,s=r.length;for(e=0;e<s;++e)(n=i(t=r[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(o[a]=n,r[a++]=t);r.length=a,o.length=a,this.heapify_()},PriorityQueue}(),Ao=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Do=function(t){function TileQueue(e,n){var i=t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()}))||this;return i.boundHandleTileChange_=i.handleTileChange.bind(i),i.tileChangeCallback_=n,i.tilesLoading_=0,i.tilesLoadingKeys_={},i}return Ao(TileQueue,t),TileQueue.prototype.enqueue=function(e){var n=t.prototype.enqueue.call(this,e);n&&e[0].addEventListener(Hn.CHANGE,this.boundHandleTileChange_);return n},TileQueue.prototype.getTilesLoading=function(){return this.tilesLoading_},TileQueue.prototype.handleTileChange=function(t){var e=t.target,n=e.getState();if(e.hifi&&n===zi.LOADED||n===zi.ERROR||n===zi.EMPTY||n===zi.ABORT){e.removeEventListener(Hn.CHANGE,this.boundHandleTileChange_);var i=e.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}},TileQueue.prototype.loadMoreTiles=function(t,e){for(var n,i,r,o=0,a=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)r=(i=this.dequeue()[0]).getKey(),(n=i.getState())===zi.ABORT?a=!0:n!==zi.IDLE||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,i.load());0===o&&a&&this.tileChangeCallback_()},TileQueue}(ko),jo=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),No=function(e){function TileWMS(t){var n=this,i=t||{},r=i.params||{},o=!("TRANSPARENT"in r)||r.TRANSPARENT;return(n=e.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:!o,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:i.tileClass,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction,tileUrlFunction:tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})||this).gutter_=void 0!==i.gutter?i.gutter:0,n.params_=r,n.v13_=!0,n.serverType_=i.serverType,n.hidpi_=void 0===i.hidpi||i.hidpi,n.tmpExtent_=[1/0,1/0,-1/0,-1/0],n.updateV13_(),n.setKey(n.getKeyForParams_()),n}return jo(TileWMS,e),TileWMS.prototype.getFeatureInfoUrl=function(e,n,i,r){var o=get$3(i),a=this.getProjection(),s=this.getTileGrid();s||(s=this.getTileGridForProjection(o));var l=s.getZForResolution(n,this.zDirection),u=s.getTileCoordForCoordAndZ(e,l);if(!(s.getResolutions().length<=u[0])){var c=s.getResolution(u[0]),h=s.getTileCoordExtent(u,this.tmpExtent_),d=toSize(s.getTileSize(u[0]),this.tmpSize),p=this.gutter_;0!==p&&(d=buffer$1(d,p,this.tmpSize),h=buffer(h,c*p,h)),a&&a!==o&&(c=calculateSourceResolution(a,o,e,c),h=transformExtent(h,o,a),e=transform(e,o,a));var f={SERVICE:"WMS",VERSION:yr,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};t(f,this.params_,r);var m=Math.floor((e[0]-h[0])/c),y=Math.floor((h[3]-e[1])/c);return f[this.v13_?"I":"X"]=m,f[this.v13_?"J":"Y"]=y,this.getRequestUrl_(u,d,h,1,a||o,f)}},TileWMS.prototype.getLegendUrl=function(e,n){if(void 0!==this.urls[0]){var i={SERVICE:"WMS",VERSION:yr,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===n||void 0===n.LAYER){var r=this.params_.LAYERS;if(!(!Array.isArray(r)||1===r.length))return;i.LAYER=r}if(void 0!==e){var o=this.getProjection()?this.getProjection().getMetersPerUnit():1;i.SCALE=e*o*39.37*(25.4/.28)}return t(i,n),appendParams(this.urls[0],i)}},TileWMS.prototype.getGutter=function(){return this.gutter_},TileWMS.prototype.getParams=function(){return this.params_},TileWMS.prototype.getRequestUrl_=function(t,e,n,i,r,o){var a=this.urls;if(a){if(o.WIDTH=e[0],o.HEIGHT=e[1],o[this.v13_?"CRS":"SRS"]=r.getCode(),"STYLES"in this.params_||(o.STYLES=""),1!=i)switch(this.serverType_){case Vr:var s=90*i+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+s:o.FORMAT_OPTIONS="dpi:"+s;break;case zr:o.MAP_RESOLUTION=90*i;break;case Ur:case Gr:o.DPI=90*i;break;default:assert(!1,52)}var l,u=r.getAxisOrientation(),c=n;if(this.v13_&&"ne"==u.substr(0,2)){var h=void 0;h=n[0],c[0]=n[1],c[1]=h,h=n[2],c[2]=n[3],c[3]=h}if(o.BBOX=c.join(","),1==a.length)l=a[0];else l=a[modulo(hash(t),a.length)];return appendParams(l,o)}},TileWMS.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},TileWMS.prototype.getKeyForParams_=function(){var t=0,e=[];for(var n in this.params_)e[t++]=n+"-"+this.params_[n];return e.join("/")},TileWMS.prototype.updateParams=function(e){t(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())},TileWMS.prototype.updateV13_=function(){var t=this.params_.VERSION||yr;this.v13_=compareVersions(t,"1.3")>=0},TileWMS}(fo);function tileUrlFunction(e,n,i){var r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),!(r.getResolutions().length<=e[0])){1==n||this.hidpi_&&void 0!==this.serverType_||(n=1);var o=r.getResolution(e[0]),a=r.getTileCoordExtent(e,this.tmpExtent_),s=toSize(r.getTileSize(e[0]),this.tmpSize),l=this.gutter_;0!==l&&(s=buffer$1(s,l,this.tmpSize),a=buffer(a,o*l,a)),1!=n&&(s=scale(s,n,this.tmpSize));var u={SERVICE:"WMS",VERSION:yr,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return t(u,this.params_),this.getRequestUrl_(e,s,a,n,i,u)}}var Fo={KVP:"KVP",REST:"REST"},Uo=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Vo=function(t){function WMTSTileGrid(e){var n=t.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes})||this;return n.matrixIds_=e.matrixIds,n}return Uo(WMTSTileGrid,t),WMTSTileGrid.prototype.getMatrixId=function(t){return this.matrixIds_[t]},WMTSTileGrid.prototype.getMatrixIds=function(){return this.matrixIds_},WMTSTileGrid}(io);var zo=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Go=function(e){function WMTS(t){var n=this,i=void 0!==t.requestEncoding?t.requestEncoding:Fo.KVP,r=t.tileGrid,o=t.urls;return void 0===o&&void 0!==t.url&&(o=expandUrl(t.url)),(n=e.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:r,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:nullTileUrlFunction,urls:o,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition})||this).version_=void 0!==t.version?t.version:"1.0.0",n.format_=void 0!==t.format?t.format:"image/jpeg",n.dimensions_=void 0!==t.dimensions?t.dimensions:{},n.layer_=t.layer,n.matrixSet_=t.matrixSet,n.style_=t.style,n.requestEncoding_=i,n.setKey(n.getKeyForDimensions_()),o&&o.length>0&&(n.tileUrlFunction=createFromTileUrlFunctions(o.map(createFromWMTSTemplate.bind(n)))),n}return zo(WMTS,e),WMTS.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(createFromTileUrlFunctions(t.map(createFromWMTSTemplate.bind(this))),e)},WMTS.prototype.getDimensions=function(){return this.dimensions_},WMTS.prototype.getFormat=function(){return this.format_},WMTS.prototype.getLayer=function(){return this.layer_},WMTS.prototype.getMatrixSet=function(){return this.matrixSet_},WMTS.prototype.getRequestEncoding=function(){return this.requestEncoding_},WMTS.prototype.getStyle=function(){return this.style_},WMTS.prototype.getVersion=function(){return this.version_},WMTS.prototype.getKeyForDimensions_=function(){var t=0,e=[];for(var n in this.dimensions_)e[t++]=n+"-"+this.dimensions_[n];return e.join("/")},WMTS.prototype.updateDimensions=function(e){t(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())},WMTS}(fo);function optionsFromCapabilities(t,e){var n=find(t.Contents.Layer,(function(t,n,i){return t.Identifier==e.layer}));if(null===n)return null;var i,r=t.Contents.TileMatrixSet;(i=n.TileMatrixSetLink.length>1?findIndex(n.TileMatrixSetLink,"projection"in e?function(t,n,i){var o=find(r,(function(e){return e.Identifier==t.TileMatrixSet})).SupportedCRS,a=get$3(o.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||get$3(o),s=get$3(e.projection);return a&&s?equivalent(a,s):o==e.projection}:function(t,n,i){return t.TileMatrixSet==e.matrixSet}):0)<0&&(i=0);var o=n.TileMatrixSetLink[i].TileMatrixSet,a=n.TileMatrixSetLink[i].TileMatrixSetLimits,s=n.Format[0];"format"in e&&(s=e.format),(i=findIndex(n.Style,(function(t,n,i){return"style"in e?t.Title==e.style:t.isDefault})))<0&&(i=0);var l=n.Style[i].Identifier,u={};"Dimension"in n&&n.Dimension.forEach((function(t,e,n){var i=t.Identifier,r=t.Default;void 0===r&&(r=t.Value[0]),u[i]=r}));var c,h=find(t.Contents.TileMatrixSet,(function(t,e,n){return t.Identifier==o})),d=h.SupportedCRS;if(d&&(c=get$3(d.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||get$3(d)),"projection"in e){var p=get$3(e.projection);p&&(c&&!equivalent(p,c)||(c=p))}var f,m,y=n.WGS84BoundingBox;if(void 0!==y){var g=get$3("EPSG:4326").getExtent();m=y[0]==g[0]&&y[2]==g[2],f=transformExtent(y,"EPSG:4326",c);var v=c.getExtent();v&&(containsExtent(v,f)||(f=void 0))}var _=function createFromCapabilitiesMatrixSet(t,e,n){var i=[],r=[],o=[],a=[],s=[],l=void 0!==n?n:[],u=t.SupportedCRS,c=get$3(u.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||get$3(u),h=c.getMetersPerUnit(),d="ne"==c.getAxisOrientation().substr(0,2);return t.TileMatrix.sort((function(t,e){return e.ScaleDenominator-t.ScaleDenominator})),t.TileMatrix.forEach((function(e){if(!(l.length>0)||find(l,(function(n){return e.Identifier==n.TileMatrix||-1===e.Identifier.indexOf(":")&&t.Identifier+":"+e.Identifier===n.TileMatrix}))){r.push(e.Identifier);var n=28e-5*e.ScaleDenominator/h,u=e.TileWidth,c=e.TileHeight;d?o.push([e.TopLeftCorner[1],e.TopLeftCorner[0]]):o.push(e.TopLeftCorner),i.push(n),a.push(u==c?u:[u,c]),s.push([e.MatrixWidth,e.MatrixHeight])}})),new Vo({extent:e,origins:o,resolutions:i,matrixIds:r,tileSizes:a,sizes:s})}(h,f,a),b=[],T=e.requestEncoding;if(T=void 0!==T?T:"","OperationsMetadata"in t&&"GetTile"in t.OperationsMetadata)for(var w=t.OperationsMetadata.GetTile.DCP.HTTP.Get,E=0,S=w.length;E<S;++E)if(w[E].Constraint){var M=find(w[E].Constraint,(function(t){return"GetEncoding"==t.name})).AllowedValues.Value;if(""===T&&(T=M[0]),T!==Fo.KVP)break;includes(M,Fo.KVP)&&b.push(w[E].href)}else w[E].href&&(T=Fo.KVP,b.push(w[E].href));return 0===b.length&&(T=Fo.REST,n.ResourceURL.forEach((function(t){"tile"===t.resourceType&&(s=t.format,b.push(t.template))}))),{urls:b,layer:e.layer,matrixSet:o,format:s,projection:c,requestEncoding:T,tileGrid:_,style:l,dimensions:u,wrapX:m,crossOrigin:e.crossOrigin}}function createFromWMTSTemplate(e){var n=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};n==Fo.KVP&&t(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e=n==Fo.KVP?appendParams(e,i):e.replace(/\{(\w+?)\}/g,(function(t,e){return e.toLowerCase()in i?i[e.toLowerCase()]:t}));var r=this.tileGrid,o=this.dimensions_;return function(i,a,s){if(i){var l={TileMatrix:r.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};t(l,o);var u=e;return u=n==Fo.KVP?appendParams(u,l):u.replace(/\{(\w+?)\}/g,(function(t,e){return l[e]}))}}}class SourceCreator{static wms(t,e){const n=e.sources[t.source];if(null==n)return null;const i=n.tiles[0],r=new N(i);let o=Object.keys(r.query).reduce((t,e)=>(t["string"==typeof e?e.toUpperCase():e]=r.query[e],t),{});Object.keys(t.url).forEach(e=>{o[e.toUpperCase()]=t.url[e].toString()});const a=null!=t.time&&t.time.data.includes(e.time);a&&(o.TIME=new Date(e.time).toISOString());let s=new No({url:getBaseUrl(i),params:o,tileGrid:new io({extent:null!=n.bounds?n.bounds:get(e.projection).getExtent(),resolutions:e.resolutions,tileSize:null!=n.tileSize?n.tileSize:Sn}),transition:0});return a&&s.set("metoclient:time",e.time),s}static wmts(t,e,n){if(null==e.sources[t.source]||"wmts"!==n.type)return null;let i=optionsFromCapabilities(n.data,{layer:t.url.layer,matrixSet:t.url.tilematrixset});if(null==i)return null;const r=null!=t.time&&t.time.data.includes(e.time);r&&(i.tileLoadFunction=function(t,n){t.getImage().src=n+"&Time="+new Date(e.time).toISOString()}),i.transition=0;let o=new Go(i);return null!=r&&o.set("metoclient:time",e.time),o}}class LayerCreator{static tiled(t,e,n){const i=e.sources[t.source];if(null==i)return null;if("OSM"===i.type)return new ar({source:new Ro,type:t.metadata&&t.metadata.type?t.metadata.type:"",title:t.metadata&&t.metadata.title?t.metadata.title:"",id:t.id});const r=t.url.service.toLowerCase();if("function"==typeof SourceCreator[r]){let i=SourceCreator[r](t,e,n);return null!=i?new ar({source:i,preload:0,opacity:0,type:t.metadata&&t.metadata.type?t.metadata.type:"",title:t.metadata&&t.metadata.title?t.metadata.title:"",previous:null!=t.previous?t.previous:e.layers.find(t=>t.next===t.id),next:null!=t.next?t.next:e.layers.find(t=>t.previous===t.id),legendTitle:t.legendTitle,id:t.id}):null}}static image(t,e,n){const i=e.sources[t.source];if(null==i||null==i.tiles[0]||0===i.tiles[0].length)return null;const r=getBaseUrl(i.tiles[0]),o=null!=t.time&&t.time.data.includes(e.time);if(o){let n=new Date(e.time).toISOString();t.url.TIME=n}let a=new Br({url:r,params:t.url});return null==a?null:(o&&a.set("metoclient:time",e.time),new mr({source:a,preload:0,opacity:0,type:t.metadata&&t.metadata.type?t.metadata.type:"",title:t.metadata&&t.metadata.title?t.metadata.title:"",previous:null!=t.previous?t.previous:e.layers.find(t=>t.next===t.id),next:null!=t.next?t.next:e.layers.find(t=>t.previous===t.id),legendTitle:t.legendTitle,id:t.id}))}}class SourceUpdater{static TileWMS(t,e){if(null==e)return;let n=new Date(e).toISOString();t.set("metoclient:time",e),t.updateParams({TIME:n}),t.refresh()}static WMTS(t,e){if(null==e)return;let n=new Date(e).toISOString();t.set("metoclient:time",e),t.setTileLoadFunction((function(t,e){t.getImage().src=e+"&Time="+n}))}}var qo="http://www.w3.org/1999/xlink";function readHref(t){return t.getAttributeNS(qo,"href")}document.implementation.createDocument("","",null);function getAllTextContent(t,e){return function getAllTextContent_(t,e,n){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)e?n.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):n.push(t.nodeValue);else{var i=void 0;for(i=t.firstChild;i;i=i.nextSibling)getAllTextContent_(i,e,n)}return n}(t,e,[]).join("")}function makeArrayPusher(t,e){return function(n,i){var r=t.call(void 0!==e?e:this,n,i);void 0!==r&&i[i.length-1].push(r)}}function makeObjectPropertyPusher(t,e,n){return function(i,r){var o=t.call(void 0!==n?n:this,i,r);if(void 0!==o){var a=r[r.length-1],s=void 0!==e?e:i.localName,l=void 0;s in a?l=a[s]:(l=[],a[s]=l),l.push(o)}}}function makeObjectPropertySetter(t,e,n){return function(i,r){var o=t.call(void 0!==n?n:this,i,r);void 0!==o&&(r[r.length-1][void 0!==e?e:i.localName]=o)}}function makeStructureNS(t,e,n){var i,r,o=void 0!==n?n:{};for(i=0,r=t.length;i<r;++i)o[t[i]]=e;return o}function pushParseAndPop(t,e,n,i,r){return i.push(t),function parseNode(t,e,n,i){var r;for(r=e.firstElementChild;r;r=r.nextElementSibling){var o=t[r.namespaceURI];if(void 0!==o){var a=o[r.localName];void 0!==a&&a.call(i,r,n)}}}(e,n,i,r),i.pop()}var Wo=function(){function XML(){}return XML.prototype.read=function(t){if(t){if("string"==typeof t){var e=function parse$1(t){return(new DOMParser).parseFromString(t,"application/xml")}(t);return this.readFromDocument(e)}return function isDocument(t){return"documentElement"in t}(t)?this.readFromDocument(t):this.readFromNode(t)}return null},XML.prototype.readFromDocument=function(t){},XML.prototype.readFromNode=function(t){},XML}();function readBooleanString(t){var e=/^\s*(true|1)|(false|0)\s*$/.exec(t);return e?void 0!==e[1]||!1:void 0}function readDecimal(t){return readDecimalString(getAllTextContent(t,!1))}function readDecimalString(t){var e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);return e?parseFloat(e[1]):void 0}function readNonNegativeInteger(t){return readNonNegativeIntegerString(getAllTextContent(t,!1))}function readNonNegativeIntegerString(t){var e=/^\s*(\d+)\s*$/.exec(t);return e?parseInt(e[1],10):void 0}function readString(t){return getAllTextContent(t,!1).trim()}var Bo=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Zo=[null,"http://www.opengis.net/wms"],Ko=makeStructureNS(Zo,{Service:makeObjectPropertySetter((function readService(t,e){return pushParseAndPop({},Xo,t,e)})),Capability:makeObjectPropertySetter((function readCapability(t,e){return pushParseAndPop({},Yo,t,e)}))}),Yo=makeStructureNS(Zo,{Request:makeObjectPropertySetter((function readRequest(t,e){return pushParseAndPop({},ra,t,e)})),Exception:makeObjectPropertySetter((function readException(t,e){return pushParseAndPop([],ta,t,e)})),Layer:makeObjectPropertySetter((function readCapabilityLayer(t,e){return pushParseAndPop({},ea,t,e)}))}),Ho=function(t){function WMSCapabilities(){var e=t.call(this)||this;return e.version=void 0,e}return Bo(WMSCapabilities,t),WMSCapabilities.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},WMSCapabilities.prototype.readFromNode=function(t){this.version=t.getAttribute("version").trim();var e=pushParseAndPop({version:this.version},Ko,t,[]);return e||null},WMSCapabilities}(Wo),Xo=makeStructureNS(Zo,{Name:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),KeywordList:makeObjectPropertySetter(readKeywordList),OnlineResource:makeObjectPropertySetter(readHref),ContactInformation:makeObjectPropertySetter((function readContactInformation(t,e){return pushParseAndPop({},$o,t,e)})),Fees:makeObjectPropertySetter(readString),AccessConstraints:makeObjectPropertySetter(readString),LayerLimit:makeObjectPropertySetter(readNonNegativeInteger),MaxWidth:makeObjectPropertySetter(readNonNegativeInteger),MaxHeight:makeObjectPropertySetter(readNonNegativeInteger)}),$o=makeStructureNS(Zo,{ContactPersonPrimary:makeObjectPropertySetter((function readContactPersonPrimary(t,e){return pushParseAndPop({},Qo,t,e)})),ContactPosition:makeObjectPropertySetter(readString),ContactAddress:makeObjectPropertySetter((function readContactAddress(t,e){return pushParseAndPop({},Jo,t,e)})),ContactVoiceTelephone:makeObjectPropertySetter(readString),ContactFacsimileTelephone:makeObjectPropertySetter(readString),ContactElectronicMailAddress:makeObjectPropertySetter(readString)}),Qo=makeStructureNS(Zo,{ContactPerson:makeObjectPropertySetter(readString),ContactOrganization:makeObjectPropertySetter(readString)}),Jo=makeStructureNS(Zo,{AddressType:makeObjectPropertySetter(readString),Address:makeObjectPropertySetter(readString),City:makeObjectPropertySetter(readString),StateOrProvince:makeObjectPropertySetter(readString),PostCode:makeObjectPropertySetter(readString),Country:makeObjectPropertySetter(readString)}),ta=makeStructureNS(Zo,{Format:makeArrayPusher(readString)}),ea=makeStructureNS(Zo,{Name:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),KeywordList:makeObjectPropertySetter(readKeywordList),CRS:makeObjectPropertyPusher(readString),EX_GeographicBoundingBox:makeObjectPropertySetter((function readEXGeographicBoundingBox(t,e){var n=pushParseAndPop({},ia,t,e);if(!n)return;var i=n.westBoundLongitude,r=n.southBoundLatitude,o=n.eastBoundLongitude,a=n.northBoundLatitude;if(void 0===i||void 0===r||void 0===o||void 0===a)return;return[i,r,o,a]})),BoundingBox:makeObjectPropertyPusher((function readBoundingBox(t,e){var n=[readDecimalString(t.getAttribute("minx")),readDecimalString(t.getAttribute("miny")),readDecimalString(t.getAttribute("maxx")),readDecimalString(t.getAttribute("maxy"))],i=[readDecimalString(t.getAttribute("resx")),readDecimalString(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS"),extent:n,res:i}})),Dimension:makeObjectPropertyPusher((function readDimension(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:readBooleanString(t.getAttribute("multipleValues")),nearestValue:readBooleanString(t.getAttribute("nearestValue")),current:readBooleanString(t.getAttribute("current")),values:readString(t)}})),Attribution:makeObjectPropertySetter((function readAttribution(t,e){return pushParseAndPop({},na,t,e)})),AuthorityURL:makeObjectPropertyPusher((function readAuthorityURL(t,e){var n=readFormatOnlineresource(t,e);if(n)return n.name=t.getAttribute("name"),n;return})),Identifier:makeObjectPropertyPusher(readString),MetadataURL:makeObjectPropertyPusher((function readMetadataURL(t,e){var n=readFormatOnlineresource(t,e);if(n)return n.type=t.getAttribute("type"),n;return})),DataURL:makeObjectPropertyPusher(readFormatOnlineresource),FeatureListURL:makeObjectPropertyPusher(readFormatOnlineresource),Style:makeObjectPropertyPusher((function readStyle(t,e){return pushParseAndPop({},la,t,e)})),MinScaleDenominator:makeObjectPropertySetter(readDecimal),MaxScaleDenominator:makeObjectPropertySetter(readDecimal),Layer:makeObjectPropertyPusher((function readLayer(t,e){var n=e[e.length-1],i=pushParseAndPop({},ea,t,e);if(!i)return;var r=readBooleanString(t.getAttribute("queryable"));void 0===r&&(r=n.queryable);i.queryable=void 0!==r&&r;var o=readNonNegativeIntegerString(t.getAttribute("cascaded"));void 0===o&&(o=n.cascaded);i.cascaded=o;var a=readBooleanString(t.getAttribute("opaque"));void 0===a&&(a=n.opaque);i.opaque=void 0!==a&&a;var s=readBooleanString(t.getAttribute("noSubsets"));void 0===s&&(s=n.noSubsets);i.noSubsets=void 0!==s&&s;var l=readDecimalString(t.getAttribute("fixedWidth"));l||(l=n.fixedWidth);i.fixedWidth=l;var u=readDecimalString(t.getAttribute("fixedHeight"));u||(u=n.fixedHeight);i.fixedHeight=u,["Style","CRS","AuthorityURL"].forEach((function(t){if(t in n){var e=i[t]||[];i[t]=e.concat(n[t])}}));return["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach((function(t){if(!(t in i)){var e=n[t];i[t]=e}})),i}))}),na=makeStructureNS(Zo,{Title:makeObjectPropertySetter(readString),OnlineResource:makeObjectPropertySetter(readHref),LogoURL:makeObjectPropertySetter(readSizedFormatOnlineresource)}),ia=makeStructureNS(Zo,{westBoundLongitude:makeObjectPropertySetter(readDecimal),eastBoundLongitude:makeObjectPropertySetter(readDecimal),southBoundLatitude:makeObjectPropertySetter(readDecimal),northBoundLatitude:makeObjectPropertySetter(readDecimal)}),ra=makeStructureNS(Zo,{GetCapabilities:makeObjectPropertySetter(readOperationType),GetMap:makeObjectPropertySetter(readOperationType),GetFeatureInfo:makeObjectPropertySetter(readOperationType)}),oa=makeStructureNS(Zo,{Format:makeObjectPropertyPusher(readString),DCPType:makeObjectPropertyPusher((function readDCPType(t,e){return pushParseAndPop({},aa,t,e)}))}),aa=makeStructureNS(Zo,{HTTP:makeObjectPropertySetter((function readHTTP(t,e){return pushParseAndPop({},sa,t,e)}))}),sa=makeStructureNS(Zo,{Get:makeObjectPropertySetter(readFormatOnlineresource),Post:makeObjectPropertySetter(readFormatOnlineresource)}),la=makeStructureNS(Zo,{Name:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),LegendURL:makeObjectPropertyPusher(readSizedFormatOnlineresource),StyleSheetURL:makeObjectPropertySetter(readFormatOnlineresource),StyleURL:makeObjectPropertySetter(readFormatOnlineresource)}),ua=makeStructureNS(Zo,{Format:makeObjectPropertySetter(readString),OnlineResource:makeObjectPropertySetter(readHref)}),ca=makeStructureNS(Zo,{Keyword:makeArrayPusher(readString)});function readFormatOnlineresource(t,e){return pushParseAndPop({},ua,t,e)}function readOperationType(t,e){return pushParseAndPop({},oa,t,e)}function readSizedFormatOnlineresource(t,e){var n=readFormatOnlineresource(t,e);if(n){var i=[readNonNegativeIntegerString(t.getAttribute("width")),readNonNegativeIntegerString(t.getAttribute("height"))];return n.size=i,n}}function readKeywordList(t,e){return pushParseAndPop([],ca,t,e)}var ha=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),da=[null,"http://www.opengis.net/ows/1.1"],pa=makeStructureNS(da,{ServiceIdentification:makeObjectPropertySetter((function readServiceIdentification(t,e){return pushParseAndPop({},Oa,t,e)})),ServiceProvider:makeObjectPropertySetter((function readServiceProvider(t,e){return pushParseAndPop({},xa,t,e)})),OperationsMetadata:makeObjectPropertySetter((function readOperationsMetadata(t,e){return pushParseAndPop({},wa,t,e)}))}),fa=function(t){function OWS(){return t.call(this)||this}return ha(OWS,t),OWS.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},OWS.prototype.readFromNode=function(t){var e=pushParseAndPop({},pa,t,[]);return e||null},OWS}(Wo),ma=makeStructureNS(da,{DeliveryPoint:makeObjectPropertySetter(readString),City:makeObjectPropertySetter(readString),AdministrativeArea:makeObjectPropertySetter(readString),PostalCode:makeObjectPropertySetter(readString),Country:makeObjectPropertySetter(readString),ElectronicMailAddress:makeObjectPropertySetter(readString)}),ya=makeStructureNS(da,{Value:makeObjectPropertyPusher((function readValue(t,e){return readString(t)}))}),ga=makeStructureNS(da,{AllowedValues:makeObjectPropertySetter((function readAllowedValues(t,e){return pushParseAndPop({},ya,t,e)}))}),va=makeStructureNS(da,{Phone:makeObjectPropertySetter((function readPhone(t,e){return pushParseAndPop({},Ea,t,e)})),Address:makeObjectPropertySetter((function readAddress(t,e){return pushParseAndPop({},ma,t,e)}))}),_a=makeStructureNS(da,{HTTP:makeObjectPropertySetter((function readHttp(t,e){return pushParseAndPop({},ba,t,e)}))}),ba=makeStructureNS(da,{Get:makeObjectPropertyPusher((function readGet(t,e){var n=readHref(t);if(!n)return;return pushParseAndPop({href:n},Sa,t,e)})),Post:void 0}),Ta=makeStructureNS(da,{DCP:makeObjectPropertySetter((function readDcp(t,e){return pushParseAndPop({},_a,t,e)}))}),wa=makeStructureNS(da,{Operation:function readOperation(t,e){var n=t.getAttribute("name"),i=pushParseAndPop({},Ta,t,e);if(!i)return;e[e.length-1][n]=i}}),Ea=makeStructureNS(da,{Voice:makeObjectPropertySetter(readString),Facsimile:makeObjectPropertySetter(readString)}),Sa=makeStructureNS(da,{Constraint:makeObjectPropertyPusher((function readConstraint(t,e){var n=t.getAttribute("name");if(!n)return;return pushParseAndPop({name:n},ga,t,e)}))}),Ma=makeStructureNS(da,{IndividualName:makeObjectPropertySetter(readString),PositionName:makeObjectPropertySetter(readString),ContactInfo:makeObjectPropertySetter((function readContactInfo(t,e){return pushParseAndPop({},va,t,e)}))}),Oa=makeStructureNS(da,{Abstract:makeObjectPropertySetter(readString),AccessConstraints:makeObjectPropertySetter(readString),Fees:makeObjectPropertySetter(readString),Title:makeObjectPropertySetter(readString),ServiceTypeVersion:makeObjectPropertySetter(readString),ServiceType:makeObjectPropertySetter(readString)}),xa=makeStructureNS(da,{ProviderName:makeObjectPropertySetter(readString),ProviderSite:makeObjectPropertySetter(readHref),ServiceContact:makeObjectPropertySetter((function readServiceContact(t,e){return pushParseAndPop({},Ma,t,e)}))});var Pa=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Ca=[null,"http://www.opengis.net/wmts/1.0"],Ia=[null,"http://www.opengis.net/ows/1.1"],La=makeStructureNS(Ca,{Contents:makeObjectPropertySetter((function readContents(t,e){return pushParseAndPop({},ka,t,e)}))}),Ra=function(t){function WMTSCapabilities(){var e=t.call(this)||this;return e.owsParser_=new fa,e}return Pa(WMTSCapabilities,t),WMTSCapabilities.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},WMTSCapabilities.prototype.readFromNode=function(t){var e=t.getAttribute("version").trim(),n=this.owsParser_.readFromNode(t);return n?(n.version=e,(n=pushParseAndPop(n,La,t,[]))||null):null},WMTSCapabilities}(Wo),ka=makeStructureNS(Ca,{Layer:makeObjectPropertyPusher((function readLayer$1(t,e){return pushParseAndPop({},Aa,t,e)})),TileMatrixSet:makeObjectPropertyPusher((function readTileMatrixSet(t,e){return pushParseAndPop({},za,t,e)}))}),Aa=makeStructureNS(Ca,{Style:makeObjectPropertyPusher((function readStyle$1(t,e){var n=pushParseAndPop({},Da,t,e);if(!n)return;var i="true"===t.getAttribute("isDefault");return n.isDefault=i,n})),Format:makeObjectPropertyPusher(readString),TileMatrixSetLink:makeObjectPropertyPusher((function readTileMatrixSetLink(t,e){return pushParseAndPop({},ja,t,e)})),Dimension:makeObjectPropertyPusher((function readDimensions(t,e){return pushParseAndPop({},Ua,t,e)})),ResourceURL:makeObjectPropertyPusher((function readResourceUrl(t,e){var n=t.getAttribute("format"),i=t.getAttribute("template"),r=t.getAttribute("resourceType"),o={};n&&(o.format=n);i&&(o.template=i);r&&(o.resourceType=r);return o}))},makeStructureNS(Ia,{Title:makeObjectPropertySetter(readString),Abstract:makeObjectPropertySetter(readString),WGS84BoundingBox:makeObjectPropertySetter((function readWgs84BoundingBox(t,e){var n=pushParseAndPop([],Va,t,e);if(2!=n.length)return;return boundingExtent(n)})),Identifier:makeObjectPropertySetter(readString)})),Da=makeStructureNS(Ca,{LegendURL:makeObjectPropertyPusher((function readLegendUrl(t,e){var n={};return n.format=t.getAttribute("format"),n.href=readHref(t),n}))},makeStructureNS(Ia,{Title:makeObjectPropertySetter(readString),Identifier:makeObjectPropertySetter(readString)})),ja=makeStructureNS(Ca,{TileMatrixSet:makeObjectPropertySetter(readString),TileMatrixSetLimits:makeObjectPropertySetter((function readTileMatrixLimitsList(t,e){return pushParseAndPop([],Na,t,e)}))}),Na=makeStructureNS(Ca,{TileMatrixLimits:makeArrayPusher((function readTileMatrixLimits(t,e){return pushParseAndPop({},Fa,t,e)}))}),Fa=makeStructureNS(Ca,{TileMatrix:makeObjectPropertySetter(readString),MinTileRow:makeObjectPropertySetter(readNonNegativeInteger),MaxTileRow:makeObjectPropertySetter(readNonNegativeInteger),MinTileCol:makeObjectPropertySetter(readNonNegativeInteger),MaxTileCol:makeObjectPropertySetter(readNonNegativeInteger)}),Ua=makeStructureNS(Ca,{Default:makeObjectPropertySetter(readString),Value:makeObjectPropertyPusher(readString)},makeStructureNS(Ia,{Identifier:makeObjectPropertySetter(readString)})),Va=makeStructureNS(Ia,{LowerCorner:makeArrayPusher(readCoordinates),UpperCorner:makeArrayPusher(readCoordinates)}),za=makeStructureNS(Ca,{WellKnownScaleSet:makeObjectPropertySetter(readString),TileMatrix:makeObjectPropertyPusher((function readTileMatrix(t,e){return pushParseAndPop({},Ga,t,e)}))},makeStructureNS(Ia,{SupportedCRS:makeObjectPropertySetter(readString),Identifier:makeObjectPropertySetter(readString)})),Ga=makeStructureNS(Ca,{TopLeftCorner:makeObjectPropertySetter(readCoordinates),ScaleDenominator:makeObjectPropertySetter(readDecimal),TileWidth:makeObjectPropertySetter(readNonNegativeInteger),TileHeight:makeObjectPropertySetter(readNonNegativeInteger),MatrixWidth:makeObjectPropertySetter(readNonNegativeInteger),MatrixHeight:makeObjectPropertySetter(readNonNegativeInteger)},makeStructureNS(Ia,{Identifier:makeObjectPropertySetter(readString)}));function readCoordinates(t,e){var n=readString(t).split(/\s+/);if(n&&2==n.length){var i=+n[0],r=+n[1];if(!isNaN(i)&&!isNaN(r))return[i,r]}}class CapabilitiesReader{static wms(t){return(new Ho).read(t)}static wmts(t){return(new Ra).read(t)}}var qa,Wa={};if("undefined"!=typeof Symbol&&"function"==typeof Symbol.for&&"symbol"==typeof Symbol("a symbol for testing symbols"))qa=Symbol;else{var Ba=0,Za={},Ka={};(qa=function CanSymbolPolyfill(t){var e="@@symbol"+Ba+++t,n={};return Object.defineProperties(n,{toString:{value:function(){return e}}}),n}).for=function(t){var e=Za[t];return e||(e=Za[t]=qa(t),Ka[e]=t),e},qa.keyFor=function(t){return Ka[t]},["hasInstance","isConcatSpreadable","iterator","match","prototype","replace","search","species","split","toPrimitive","toStringTag","unscopables"].forEach((function(t){qa[t]=qa("Symbol."+t)}))}["isMapLike","isListLike","isValueLike","isFunctionLike","getOwnKeys","getOwnKeyDescriptor","proto","getOwnEnumerableKeys","hasOwnKey","hasKey","size","getName","getIdentity","assignDeep","updateDeep","getValue","setValue","getKeyValue","setKeyValue","updateValues","addValue","removeValues","apply","new","onValue","offValue","onKeyValue","offKeyValue","getKeyDependencies","getValueDependencies","keyHasDependencies","valueHasDependencies","onKeys","onKeysAdded","onKeysRemoved","onPatches"].forEach((function(t){qa.for("can."+t)}));var Ya=Wa.Symbol=qa,Ha={makeGetFirstSymbolValue:function(t){var e=t.map((function(t){return Ya.for(t)})),n=e.length;return function getFirstSymbol(t){for(var i=-1;++i<n;)if(void 0!==t[e[i]])return t[e[i]]}},hasLength:function(t){var e=typeof t;if("string"===e||Array.isArray(t))return!0;var n=t&&"boolean"!==e&&"number"!==e&&"length"in t&&t.length;return"function"!=typeof t&&(0===n||"number"==typeof n&&n>0&&n-1 in t)}},Xa=Object.getOwnPropertyNames(function(){}.prototype),$a=Object.getPrototypeOf(function(){}.prototype);var Qa=Ha.makeGetFirstSymbolValue(["can.new","can.apply"]);function isPrimitive(t){var e=typeof t;return null==t||"function"!==e&&"object"!==e}var Ja=Object.prototype.hasOwnProperty,ts=Function.prototype.toString,es=ts.call(Object);function isPlainObject(t){if(!t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);if(e===Object.prototype||null===e)return!0;var n=Ja.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ts.call(n)===es}var ns,is=Ya.for("can.onValue"),rs=Ya.for("can.onKeyValue"),os=Ya.for("can.onPatches");if("undefined"!=typeof Symbol&&"function"==typeof Symbol.for&&"symbol"==typeof Symbol("a symbol for testing symbols"))ns=function(t){return"symbol"==typeof t};else{ns=function(t){return"object"==typeof t&&!Array.isArray(t)&&"@@symbol"===t.toString().substr(0,"@@symbol".length)}}var as={isConstructorLike:function isConstructorLike(t){var e=t[Ya.for("can.new")];if(void 0!==e)return e;if("function"!=typeof t)return!1;var n=t.prototype;if(!n)return!1;if($a!==Object.getPrototypeOf(n))return!0;var i=Object.getOwnPropertyNames(n);if(i.length===Xa.length){for(var r=0,o=i.length;r<o;r++)if(i[r]!==Xa[r])return!0;return!1}return!0},isFunctionLike:function isFunctionLike(t){var e,n=!!t&&t[Ya.for("can.isFunctionLike")];return void 0!==n?n:void 0!==(e=Qa(t))?!!e:"function"==typeof t},isListLike:function isListLike(t){var e;if("string"===typeof t)return!0;if(isPrimitive(t))return!1;if(void 0!==(e=t[Ya.for("can.isListLike")]))return e;var n=t[Ya.iterator];return void 0!==n?!!n:!!Array.isArray(t)||Ha.hasLength(t)},isMapLike:function isMapLike(t){if(isPrimitive(t))return!1;var e=t[Ya.for("can.isMapLike")];if(void 0!==e)return!!e;var n=t[Ya.for("can.getKeyValue")];return void 0===n||!!n},isObservableLike:function isObservableLike(t){return!isPrimitive(t)&&Boolean(t[is]||t[rs]||t[os])},isPrimitive:isPrimitive,isBuiltIn:function isBuiltIn(t){return!!(isPrimitive(t)||Array.isArray(t)||isPlainObject(t)||"[object Object]"!==Object.prototype.toString.call(t)&&-1!==Object.prototype.toString.call(t).indexOf("[object "))},isValueLike:function isValueLike(t){var e;if(isPrimitive(t))return!0;if(void 0!==(e=t[Ya.for("can.isValueLike")]))return e;var n=t[Ya.for("can.getValue")];return void 0!==n?!!n:void 0},isSymbolLike:ns,isMoreListLikeThanMapLike:function(t){if(Array.isArray(t))return!0;if(t instanceof Array)return!0;if(null==t)return!1;var e=t[Ya.for("can.isMoreListLikeThanMapLike")];if(void 0!==e)return e;var n=this.isListLike(t),i=this.isMapLike(t);return!(!n||i)||!(!n&&i)&&void 0},isIteratorLike:function(t){return t&&"object"==typeof t&&"function"==typeof t.next&&0===t.next.length},isPromise:function(t){return t instanceof Promise||"[object Promise]"===Object.prototype.toString.call(t)},isPlainObject:isPlainObject},ss={call:function(t,e){var n=[].slice.call(arguments,2),i=t[Ya.for("can.apply")];return i?i.call(t,e,n):t.apply(e,n)},apply:function(t,e,n){var i=t[Ya.for("can.apply")];return i?i.call(t,e,n):t.apply(e,n)},new:function(t){var e=[].slice.call(arguments,1),n=t[Ya.for("can.new")];if(n)return n.apply(t,e);var i=Object.create(t.prototype),r=t.apply(i,e);return as.isPrimitive(r)?i:r}},ls=Ya.for("can.setKeyValue"),us=Ya.for("can.getKeyValue"),cs=Ya.for("can.getValue"),hs=Ya.for("can.setValue"),ds={setKeyValue:function(t,e,n){if(as.isSymbolLike(e))"symbol"==typeof e?t[e]=n:Object.defineProperty(t,e,{enumerable:!1,configurable:!0,value:n,writable:!0});else{var i=t[ls];if(void 0!==i)return i.call(t,e,n);t[e]=n}},getKeyValue:function(t,e){var n=t[us];return n?n.call(t,e):t[e]},deleteKeyValue:function(t,e){var n=t[Ya.for("can.deleteKeyValue")];if(n)return n.call(t,e);delete t[e]},getValue:function(t){if(as.isPrimitive(t))return t;var e=t[cs];return e?e.call(t):t},setValue:function(t,e){var n=t&&t[hs];if(n)return n.call(t,e);throw new Error("can-reflect.setValue - Can not set value.")},splice:function(t,e,n,i){var r;if("number"!=typeof n){var o=t[Ya.for("can.updateValues")];if(o)return o.call(t,e,n,i);r=n.length}else r=n;arguments.length<=3&&(i=[]);var a=t[Ya.for("can.splice")];return a?a.call(t,e,r,i):[].splice.apply(t,[e,r].concat(i))},addValues:function(t,e,n){var i=t[Ya.for("can.addValues")];return i?i.call(t,e,n):Array.isArray(t)&&void 0===n?t.push.apply(t,e):ds.splice(t,n,[],e)},removeValues:function(t,e,n){var i=t[Ya.for("can.removeValues")];return i?i.call(t,e,n):Array.isArray(t)&&void 0===n?void e.forEach((function(e){var n=t.indexOf(e);n>=0&&t.splice(n,1)})):ds.splice(t,n,e,[])}};ds.get=ds.getKeyValue,ds.set=ds.setKeyValue,ds.delete=ds.deleteKeyValue;var ps=ds,fs=[].slice;function makeFallback(t,e){return function(n,i,r,o){var a=n[Ya.for(t)];return void 0!==a?a.call(n,i,r,o):this[e].apply(this,arguments)}}function makeErrorIfMissing(t,e){return function(n){var i=n[Ya.for(t)];if(void 0!==i){var r=fs.call(arguments,1);return i.apply(n,r)}throw new Error(e)}}var ms,ys={onKeyValue:makeFallback("can.onKeyValue","onEvent"),offKeyValue:makeFallback("can.offKeyValue","offEvent"),onKeys:makeErrorIfMissing("can.onKeys","can-reflect: can not observe an onKeys event"),onKeysAdded:makeErrorIfMissing("can.onKeysAdded","can-reflect: can not observe an onKeysAdded event"),onKeysRemoved:makeErrorIfMissing("can.onKeysRemoved","can-reflect: can not unobserve an onKeysRemoved event"),getKeyDependencies:makeErrorIfMissing("can.getKeyDependencies","can-reflect: can not determine dependencies"),getWhatIChange:makeErrorIfMissing("can.getWhatIChange","can-reflect: can not determine dependencies"),getChangesDependencyRecord:function getChangesDependencyRecord(t){var e=t[Ya.for("can.getChangesDependencyRecord")];if("function"==typeof e)return e()},keyHasDependencies:makeErrorIfMissing("can.keyHasDependencies","can-reflect: can not determine if this has key dependencies"),onValue:makeErrorIfMissing("can.onValue","can-reflect: can not observe value change"),offValue:makeErrorIfMissing("can.offValue","can-reflect: can not unobserve value change"),getValueDependencies:makeErrorIfMissing("can.getValueDependencies","can-reflect: can not determine dependencies"),valueHasDependencies:makeErrorIfMissing("can.valueHasDependencies","can-reflect: can not determine if value has dependencies"),onPatches:makeErrorIfMissing("can.onPatches","can-reflect: can not observe patches on object"),offPatches:makeErrorIfMissing("can.offPatches","can-reflect: can not unobserve patches on object"),onInstancePatches:makeErrorIfMissing("can.onInstancePatches","can-reflect: can not observe onInstancePatches on Type"),offInstancePatches:makeErrorIfMissing("can.offInstancePatches","can-reflect: can not unobserve onInstancePatches on Type"),onInstanceBoundChange:makeErrorIfMissing("can.onInstanceBoundChange","can-reflect: can not observe bound state change in instances."),offInstanceBoundChange:makeErrorIfMissing("can.offInstanceBoundChange","can-reflect: can not unobserve bound state change"),isBound:makeErrorIfMissing("can.isBound","can-reflect: cannot determine if object is bound"),onEvent:function(t,e,n,i){if(t){var r=t[Ya.for("can.onEvent")];if(void 0!==r)return r.call(t,e,n,i);t.addEventListener&&t.addEventListener(e,n,i)}},offEvent:function(t,e,n,i){if(t){var r=t[Ya.for("can.offEvent")];if(void 0!==r)return r.call(t,e,n,i);t.removeEventListener&&t.removeEventListener(e,n,i)}},setPriority:function(t,e){if(t){var n=t[Ya.for("can.setPriority")];if(void 0!==n)return n.call(t,e),!0}return!1},getPriority:function(t){if(t){var e=t[Ya.for("can.getPriority")];if(void 0!==e)return e.call(t)}}},gs=!0;try{Object.getPrototypeOf(1)}catch(t){gs=!1}if("function"==typeof Map)ms=Map;else{var vs=function isEven(t){return t%2==0};(ms=function(){this.contents=[]}).prototype={_getIndex:function(t){var e;do{e=this.contents.indexOf(t,e)}while(-1!==e&&!vs(e));return e},has:function(t){return-1!==this._getIndex(t)},get:function(t){var e=this._getIndex(t);if(-1!==e)return this.contents[e+1]},set:function(t,e){var n=this._getIndex(t);-1!==n?this.contents[n+1]=e:(this.contents.push(t),this.contents.push(e))},delete:function(t){var e=this._getIndex(t);-1!==e&&this.contents.splice(e,2)}}}var _s,bs,Ts,ws=Object.prototype.hasOwnProperty,shiftFirstArgumentToThis=function(t){return function(){var e=[this];return e.push.apply(e,arguments),t.apply(null,e)}},Es=Ya.for("can.getKeyValue"),Ss=shiftFirstArgumentToThis(ps.getKeyValue),Ms=Ya.for("can.setKeyValue"),Os=shiftFirstArgumentToThis(ps.setKeyValue),xs=Ya.for("can.size"),Ps=Ha.makeGetFirstSymbolValue(["can.updateDeep","can.assignDeep","can.setKeyValue"]),shouldUpdateOrAssign=function(t){return as.isPlainObject(t)||Array.isArray(t)||!!Ps(t)};function isSerializedHelper(t){return!!as.isPrimitive(t)||!Ps(t)&&(as.isBuiltIn(t)&&!as.isPlainObject(t)&&!Array.isArray(t)&&!as.isObservableLike(t))}try{Object.keys(1),bs=Object.keys}catch(t){bs=function(t){return as.isPrimitive(t)?[]:Object.keys(t)}}function makeSerializer(t,e){var n=null;function SerializeOperation(t){this.first=!n,this.first&&(n=function createSerializeMap(t){var e=t||ms;return{unwrap:new e,serialize:new e,isSerializing:{unwrap:new e,serialize:new e},circularReferenceIsSerializing:{unwrap:new e,serialize:new e}}}(t)),this.map=n,this.result=null}return SerializeOperation.prototype.end=function(){return this.first&&(n=null),this.result},function serializer(n,i){if(isSerializedHelper(n))return n;var r=new SerializeOperation(i);if(as.isValueLike(n))r.result=this[t](ps.getValue(n));else{var o=as.isIteratorLike(n)||as.isMoreListLikeThanMapLike(n);if(r.result=o?[]:{},r.map[t].has(n))return r.map.isSerializing[t].has(n)&&r.map.circularReferenceIsSerializing[t].set(n,!0),r.map[t].get(n);r.map[t].set(n,r.result);for(var a=0,s=e.length;a<s;a++){var serializer=n[e[a]];if(serializer){r.map.isSerializing[t].set(n,!0);var l=r.result;if(r.result=serializer.call(n,l),r.map.isSerializing[t].delete(n),r.result!==l){if(r.map.circularReferenceIsSerializing[t].has(n))throw r.end(),new Error("Cannot serialize cirular reference!");r.map[t].set(n,r.result)}return r.end()}}"function"==typeof obj?(r.map[t].set(n,n),r.result=n):o?this.eachIndex(n,(function(e,n){r.result[n]=this[t](e)}),this):this.eachKey(n,(function(e,n){r.result[n]=this[t](e)}),this)}return r.end()}}Ts="undefined"!=typeof Map?function(t){var e=new Map;return _s.eachIndex(t,(function(t){e.set(t,!0)})),e}:function(t){var e={};return t.forEach((function(t){e[t]=!0})),{get:function(t){return e[t]},set:function(t,n){e[t]=n},keys:function(){return t}}};var fastHasOwnKey=function(t){var e=t[Ya.for("can.hasOwnKey")];if(e)return e.bind(t);var n=Ts(_s.getOwnEnumerableKeys(t));return function(t){return n.get(t)}};function addPatch(t,e){var n=t[t.length-1];if(n&&n.deleteCount===n.insert.length&&e.index-n.index===n.deleteCount)return n.insert.push.apply(n.insert,e.insert),void(n.deleteCount+=e.deleteCount);t.push(e)}function updateDeepList(t,e,n){var i=this.toArray(e),r=[],o=-1;this.eachIndex(t,(function(e,a){if(o=a,a>=i.length)return n||addPatch(r,{index:a,deleteCount:t.length-a+1,insert:[]}),!1;var s=i[a];as.isPrimitive(e)||as.isPrimitive(s)||!1===shouldUpdateOrAssign(e)?addPatch(r,{index:a,deleteCount:1,insert:[s]}):!0===n?this.assignDeep(e,s):this.updateDeep(e,s)}),this),i.length>o&&addPatch(r,{index:o+1,deleteCount:0,insert:i.slice(o+1)});for(var a=0,s=r.length;a<s;a++){var l=r[a];ps.splice(t,l.index,l.deleteCount,l.insert)}return t}(_s={each:function(t,e,n){return as.isIteratorLike(t)||as.isMoreListLikeThanMapLike(t)?_s.eachIndex(t,e,n):_s.eachKey(t,e,n)},eachIndex:function(t,e,n){if(Array.isArray(t))return _s.eachListLike(t,e,n);var i,r=t[Ya.iterator];if(as.isIteratorLike(t)?i=t:r&&(i=r.call(t)),i)for(var o,a=0;!(o=i.next()).done&&!1!==e.call(n||t,o.value,a++,t););else _s.eachListLike(t,e,n);return t},eachListLike:function(t,e,n){var i=-1,r=t.length;if(void 0===r){var o=t[xs];if(!o)throw new Error("can-reflect: unable to iterate.");r=o.call(t)}for(;++i<r;){var a=t[i];if(!1===e.call(n||a,a,i,t))break}return t},toArray:function(t){var e=[];return _s.each(t,(function(t){e.push(t)})),e},eachKey:function(t,e,n){if(t){var i=_s.getOwnEnumerableKeys(t),r=t[Es]||Ss;return _s.eachIndex(i,(function(i){var o=r.call(t,i);return e.call(n||t,o,i,t)}))}return t},hasOwnKey:function(t,e){var n=t[Ya.for("can.hasOwnKey")];if(n)return n.call(t,e);var i=t[Ya.for("can.getOwnKeys")];if(i){var r=!1;return _s.eachIndex(i.call(t),(function(t){if(t===e)return r=!0,!1})),r}return ws.call(t,e)},getOwnEnumerableKeys:function(t){var e=t[Ya.for("can.getOwnEnumerableKeys")];if(e)return e.call(t);if(t[Ya.for("can.getOwnKeys")]&&t[Ya.for("can.getOwnKeyDescriptor")]){var n=[];return _s.eachIndex(_s.getOwnKeys(t),(function(e){_s.getOwnKeyDescriptor(t,e).enumerable&&n.push(e)}),this),n}return bs(t)},getOwnKeys:function(t){var e=t[Ya.for("can.getOwnKeys")];return e?e.call(t):Object.getOwnPropertyNames(t)},getOwnKeyDescriptor:function(t,e){var n=t[Ya.for("can.getOwnKeyDescriptor")];return n?n.call(t,e):Object.getOwnPropertyDescriptor(t,e)},unwrap:makeSerializer("unwrap",[Ya.for("can.unwrap")]),serialize:makeSerializer("serialize",[Ya.for("can.serialize"),Ya.for("can.unwrap")]),assignMap:function(t,e){var n=fastHasOwnKey(t),i=t[Es]||Ss,r=t[Ms]||Os;return _s.eachKey(e,(function(e,o){n(o)&&i.call(t,o)===e||r.call(t,o,e)})),t},assignList:function(t,e){var n=_s.toArray(e);return ps.splice(t,0,n,n),t},assign:function(t,e){return as.isIteratorLike(e)||as.isMoreListLikeThanMapLike(e)?_s.assignList(t,e):_s.assignMap(t,e),t},assignDeepMap:function(t,e){var n=fastHasOwnKey(t),i=t[Es]||Ss,r=t[Ms]||Os;return _s.eachKey(e,(function(e,o){if(n(o)){var a=i.call(t,o);e===a||(as.isPrimitive(a)||as.isPrimitive(e)||!1===shouldUpdateOrAssign(a)?r.call(t,o,e):_s.assignDeep(a,e))}else ps.setKeyValue(t,o,e)}),this),t},assignDeepList:function(t,e){return updateDeepList.call(this,t,e,!0)},assignDeep:function(t,e){var n=t[Ya.for("can.assignDeep")];return n?n.call(t,e):as.isMoreListLikeThanMapLike(e)?_s.assignDeepList(t,e):_s.assignDeepMap(t,e),t},updateMap:function(t,e){var n=Ts(_s.getOwnEnumerableKeys(e)),i=e[Es]||Ss,r=t[Ms]||Os;return _s.eachKey(t,(function(o,a){if(n.get(a)){n.set(a,!1);var s=i.call(e,a);s!==o&&r.call(t,a,s)}else ps.deleteKeyValue(t,a)}),this),_s.eachIndex(n.keys(),(function(o){n.get(o)&&r.call(t,o,i.call(e,o))})),t},updateList:function(t,e){var n=_s.toArray(e);return ps.splice(t,0,t,n),t},update:function(t,e){return as.isIteratorLike(e)||as.isMoreListLikeThanMapLike(e)?_s.updateList(t,e):_s.updateMap(t,e),t},updateDeepMap:function(t,e){var n=Ts(_s.getOwnEnumerableKeys(e)),i=e[Es]||Ss,r=t[Ms]||Os;return _s.eachKey(t,(function(o,a){if(n.get(a)){n.set(a,!1);var s=i.call(e,a);as.isPrimitive(o)||as.isPrimitive(s)||!1===shouldUpdateOrAssign(o)?r.call(t,a,s):_s.updateDeep(o,s)}else ps.deleteKeyValue(t,a)}),this),_s.eachIndex(n.keys(),(function(o){n.get(o)&&r.call(t,o,i.call(e,o))})),t},updateDeepList:function(t,e){return updateDeepList.call(this,t,e)},updateDeep:function(t,e){var n=t[Ya.for("can.updateDeep")];return n?n.call(t,e):as.isMoreListLikeThanMapLike(e)?_s.updateDeepList(t,e):_s.updateDeepMap(t,e),t},hasKey:function(t,e){if(null==t)return!1;var n;if(as.isPrimitive(t))return!!ws.call(t,e)||(void 0!==(n=gs?Object.getPrototypeOf(t):t.__proto__)?e in n:void 0!==t[e]);var i=t[Ya.for("can.hasKey")];return i?i.call(t,e):_s.hasOwnKey(t,e)||e in t},getAllEnumerableKeys:function(){},getAllKeys:function(){},assignSymbols:function(t,e){return _s.eachKey(e,(function(e,n){var i=as.isSymbolLike(Ya[n])?Ya[n]:Ya.for(n);ps.setKeyValue(t,i,e)})),t},isSerialized:isSerializedHelper,size:function(t){if(null==t)return 0;var e=t[xs],n=0;return e?e.call(t):Ha.hasLength(t)?t.length:as.isListLike(t)?(_s.eachIndex(t,(function(){n++})),n):t?_s.getOwnEnumerableKeys(t).length:void 0},defineInstanceKey:function(t,e,n){var i=t[Ya.for("can.defineInstanceKey")];if(i)return i.call(t,e,n);var r=t.prototype;(i=r[Ya.for("can.defineInstanceKey")])?i.call(r,e,n):Object.defineProperty(r,e,_s.assign({configurable:!0,enumerable:!as.isSymbolLike(e),writable:!0},n))}}).isSerializable=_s.isSerialized,_s.keys=_s.getOwnEnumerableKeys;var Cs=_s,Is=Ya.for("can.getSchema"),Ls=Ya.for("can.isMember"),Rs=Ya.for("can.new");function comparator(t,e){return t.localeCompare(e)}var ks={getSchema:function(t){if(void 0!==t){var e=t[Is];return void 0===e&&(e=(t=t.constructor)&&t[Is]),void 0!==e?e.call(t):void 0}},getIdentity:function(t,e){if(void 0===(e=e||ks.getSchema(t)))throw new Error("can-reflect.getIdentity - Unable to find a schema for the given value.");var n=e.identity;if(n&&0!==n.length){if(1===n.length)return ps.getKeyValue(t,n[0]);var i={};return n.forEach((function(e){i[e]=ps.getKeyValue(t,e)})),JSON.stringify(ks.cloneKeySort(i))}throw new Error("can-reflect.getIdentity - Provided schema lacks an identity property.")},cloneKeySort:function(t){return function sort(t){return as.isPrimitive(t)||t instanceof Date?t:as.isListLike(t)?(e=[],Cs.eachKey(t,(function(t){e.push(sort(t))})),e):as.isMapLike(t)?(e={},Cs.getOwnKeys(t).sort(comparator).forEach((function(n){e[n]=sort(ps.getKeyValue(t,n))})),e):t;var e}(t)},convert:function(t,e){if(function isPrimitiveConverter(t){return t===Number||t===String||t===Boolean}(e))return e(t);var n=e[Ls],i=!1,r=typeof e,o=e[Rs];if(void 0!==n?i=n.call(e,t):"function"===r&&as.isConstructorLike(e)&&(i=t instanceof e),i)return t;if(void 0!==o)return o.call(e,t);if("function"===r)return as.isConstructorLike(e)?new e(t):e(t);throw new Error("can-reflect: Can not convert values into type. Type must provide `can.new` symbol.")}},As=ks,Ds=Ya.for("can.getName");var js=0;var Ns={setName:function setName(t,e){if("function"!=typeof e){var n=e;e=function(){return n}}Object.defineProperty(t,Ds,{value:e})},getName:function getName(t){var e=typeof t;if(null===t||"object"!==e&&"function"!==e)return""+t;var n=t[Ds];if(n)return n.call(t);if("function"===e)return"name"in t||(t.name="functionIE"+js++),t.name;if(t.constructor&&t!==t.constructor){var i=getName(t.constructor);if(i){if(as.isValueLike(t))return i+"<>";if(as.isMoreListLikeThanMapLike(t))return i+"[]";if(as.isMapLike(t))return i+"{}"}}}};"undefined"!=typeof Map&&(Cs.assignSymbols(Map.prototype,{"can.getOwnEnumerableKeys":Map.prototype.keys,"can.setKeyValue":Map.prototype.set,"can.getKeyValue":Map.prototype.get,"can.deleteKeyValue":Map.prototype.delete,"can.hasOwnKey":Map.prototype.has}),"function"!=typeof Map.prototype.keys&&(Map.prototype.keys=Map.prototype[Ya.for("can.getOwnEnumerableKeys")]=function keysPolyfill(){var t=[],e=0;return this.forEach((function(e,n){t.push(n)})),{next:function(){return{value:t[e],done:e++===t.length}}}})),"undefined"!=typeof WeakMap&&Cs.assignSymbols(WeakMap.prototype,{"can.getOwnEnumerableKeys":function(){throw new Error("can-reflect: WeakMaps do not have enumerable keys.")},"can.setKeyValue":WeakMap.prototype.set,"can.getKeyValue":WeakMap.prototype.get,"can.deleteKeyValue":WeakMap.prototype.delete,"can.hasOwnKey":WeakMap.prototype.has}),"undefined"!=typeof Set&&(Cs.assignSymbols(Set.prototype,{"can.isMoreListLikeThanMapLike":!0,"can.updateValues":function(t,e,n){e!==n&&Cs.each(e,(function(t){this.delete(t)}),this),Cs.each(n,(function(t){this.add(t)}),this)},"can.size":function(){return this.size}}),"function"!=typeof Set.prototype[Ya.iterator]&&(Set.prototype[Ya.iterator]=function(){var t=[],e=0;return this.forEach((function(e){t.push(e)})),{next:function(){return{value:t[e],done:e++===t.length}}}})),"undefined"!=typeof WeakSet&&Cs.assignSymbols(WeakSet.prototype,{"can.isListLike":!0,"can.isMoreListLikeThanMapLike":!0,"can.updateValues":function(t,e,n){e!==n&&Cs.each(e,(function(t){this.delete(t)}),this),Cs.each(n,(function(t){this.add(t)}),this)},"can.size":function(){throw new Error("can-reflect: WeakSets do not have enumerable keys.")}});var Fs={};[ss,ps,ys,Cs,as,Ns,As].forEach((function(t){for(var e in t)Fs[e]=t[e]}));var Us=Wa.Reflect=Fs;function dispatch(t){var e=this.eventHandlers[t];if(e)for(var n=e.slice(),i=this.getKeyValue(t),r=0;r<n.length;r++)n[r](i)}function Globals(){this.eventHandlers={},this.properties={}}Globals.prototype.define=function(t,e,n){return void 0===n&&(n=!0),this.properties[t]||(this.properties[t]={default:e,value:e,enableCache:n}),this},Globals.prototype.getKeyValue=function(t){var e=this.properties[t];if(e)return"function"==typeof e.value?e.cachedValue?e.cachedValue:e.enableCache?(e.cachedValue=e.value(),e.cachedValue):e.value():e.value},Globals.prototype.makeExport=function(t){return function(e){return 0===arguments.length?this.getKeyValue(t):null!=e?("function"==typeof e?this.setKeyValue(t,(function(){return e})):this.setKeyValue(t,e),e):void this.deleteKeyValue(t)}.bind(this)},Globals.prototype.offKeyValue=function(t,e){if(this.properties[t]){var n=this.eventHandlers[t];if(n){var i=n.indexOf(e);n.splice(i,1)}}return this},Globals.prototype.onKeyValue=function(t,e){return this.properties[t]&&(this.eventHandlers[t]||(this.eventHandlers[t]=[]),this.eventHandlers[t].push(e)),this},Globals.prototype.deleteKeyValue=function(t){var e=this.properties[t];return void 0!==e&&(e.value=e.default,e.cachedValue=void 0,dispatch.call(this,t)),this},Globals.prototype.setKeyValue=function(t,e){if(!this.properties[t])return this.define(t,e);var n=this.properties[t];return n.value=e,n.cachedValue=void 0,dispatch.call(this,t),this},Globals.prototype.reset=function(){for(var t in this.properties)this.properties.hasOwnProperty(t)&&(this.properties[t].value=this.properties[t].default,this.properties[t].cachedValue=void 0,dispatch.call(this,t));return this},Us.assignSymbols(Globals.prototype,{"can.getKeyValue":Globals.prototype.getKeyValue,"can.setKeyValue":Globals.prototype.setKeyValue,"can.deleteKeyValue":Globals.prototype.deleteKeyValue,"can.onKeyValue":Globals.prototype.onKeyValue,"can.offKeyValue":Globals.prototype.offKeyValue});var Vs=Globals,zs=createCommonjsModule((function(t){var e=new Vs;if(Wa.globals)throw new Error("You can't have two versions of can-globals, check your dependencies");t.exports=Wa.globals=e}));zs.define("global",(function(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:"object"==typeof process&&"[object process]"==={}.toString.call(process)?D:window}));var Gs=zs.makeExport("global"),qs=Wa.parseURI=function(t){var e=String(t).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return e?{href:e[0]||"",protocol:e[1]||"",authority:e[2]||"",host:e[3]||"",hostname:e[4]||"",port:e[5]||"",pathname:e[6]||"",search:e[7]||"",hash:e[8]||""}:null};function buildParam(t,e,n){if(Array.isArray(e))for(var i=0,r=e.length;i<r;++i){var o=e[i];buildParam(t+("object"==typeof o?"["+i+"]":"[]"),o,n)}else if(e&&"object"==typeof e)for(var a in e)buildParam(t+"["+a+"]",e[a],n);else n(t,e)}var Ws=Wa.param=function param(t){var e=[],add=function(t,n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))};for(var n in t)buildParam(n,t[n],add);return e.join("&").replace(/%20/g,"+")},Bs=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP")}],Zs=null,Ks=qs(Gs().location.href),Ys={},makeXhr=function(){if(null!=Zs)return Zs();for(var t=0,e=Bs.length;t<e;t++)try{var n=Bs[t],i=n();if(null!=i)return Zs=n,i}catch(t){continue}return function(){}},Hs={json:"application/json",form:"application/x-www-form-urlencoded"},_xhrResp=function(t,e){try{var n=e.dataType||t.getResponseHeader("Content-Type").split(";")[0];if(!n||!t.responseText&&!t.responseXML)return t;switch(n){case"text/xml":case"xml":return t.responseXML;case"text/json":case"application/json":case"text/javascript":case"application/javascript":case"application/x-javascript":case"json":return t.responseText&&JSON.parse(t.responseText);default:return t.responseText}}catch(e){return t}};var Xs=Wa.ajax=function ajax(t){var e,n,i,r=makeXhr(),o=0,a={},s=new Promise((function(t,e){a.resolve=t,a.reject=e})),l=!1;s.abort=function(){l=!0,r.abort()};var u=!1!==(t=[{userAgent:"XMLHttpRequest",lang:"en",type:"GET",data:null,dataType:"json"},Ys,t].reduce((function(t,e,n){return Us.assignDeep(t,e)}))).async;if(t.contentType||(t.contentType="GET"===t.type.toUpperCase()?Hs.form:Hs.json),null==t.crossDomain)try{i=qs(t.url),t.crossDomain=!!(i.protocol&&i.protocol!==Ks.protocol||i.host&&i.host!==Ks.host)}catch(e){t.crossDomain=!0}t.timeout&&(e=setTimeout((function(){r.abort(),t.timeoutFn&&t.timeoutFn(t.url)}),t.timeout)),r.onreadystatechange=function(){try{4===r.readyState?(e&&clearTimeout(e),r.status<300?t.success&&t.success(_xhrResp(r,t)):t.error&&t.error(r,r.status,r.statusText),t.complete&&t.complete(r,r.statusText),r.status>=200&&r.status<300?a.resolve(_xhrResp(r,t)):a.reject(_xhrResp(r,t))):t.progress&&t.progress(++o)}catch(t){a.reject(t)}};var c=t.url,h=null,d=t.type.toUpperCase(),p=t.contentType===Hs.json,f="POST"===d||"PUT"===d;!f&&t.data&&(c+="?"+(p?JSON.stringify(t.data):Ws(t.data))),r.open(d,c,u);var m=t.crossDomain&&-1!==["GET","POST","HEAD"].indexOf(d);if(n="undefined"!=typeof FormData&&t.data instanceof FormData,f?n?h=t.data:p&&!m?(h="object"==typeof t.data?JSON.stringify(t.data):t.data,r.setRequestHeader("Content-Type","application/json")):(h=Ws(t.data),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):r.setRequestHeader("Content-Type",t.contentType),m||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.xhrFields)for(var y in t.xhrFields)r[y]=t.xhrFields[y];function send(){l||r.send(h)}if(t.beforeSend){var g=t.beforeSend.call(t,r,t);if(Us.isPromise(g))return g.then(send).catch(a.reject),s}return send(),s};Xs.ajaxSetup=function(t){Ys=t||{}};var $s=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Qs=function(t){function MapEvent(e,n,i){var r=t.call(this,e)||this;return r.map=n,r.frameState=void 0!==i?i:null,r}return $s(MapEvent,t),MapEvent}(Zn),Js=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),tl=function(t){function MapBrowserEvent(e,n,i,r,o){var a=t.call(this,e,n,o)||this;return a.originalEvent=i,a.pixel_=null,a.coordinate_=null,a.dragging=void 0!==r&&r,a}return Js(MapBrowserEvent,t),Object.defineProperty(MapBrowserEvent.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!0,configurable:!0}),Object.defineProperty(MapBrowserEvent.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!0,configurable:!0}),MapBrowserEvent.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},MapBrowserEvent.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},MapBrowserEvent}(Qs),el=(createCommonjsModule((function(t,e){
/*!
     * PEP v0.5.3 | https://github.com/jquery/PEP
     * Copyright jQuery Foundation and other contributors | http://jquery.org/license
     */
t.exports=function(){var t=["bubbles","cancelable","view","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],e=[!1,!1,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function PointerEvent(n,i){i=i||Object.create(null);var r=document.createEvent("Event");r.initEvent(n,i.bubbles||!1,i.cancelable||!1);for(var o,a=2;a<t.length;a++)r[o=t[a]]=i[o]||e[a];r.buttons=i.buttons||0;var s=0;return s=void 0!==i.pressure&&r.buttons?i.pressure:r.buttons?.5:0,r.x=r.clientX,r.y=r.clientY,r.pointerId=i.pointerId||0,r.width=i.width||1,r.height=i.height||1,r.pressure=s,r.tiltX=i.tiltX||0,r.tiltY=i.tiltY||0,r.twist=i.twist||0,r.tangentialPressure=i.tangentialPressure||0,r.pointerType=i.pointerType||"",r.hwTimestamp=i.hwTimestamp||0,r.isPrimary=i.isPrimary||!1,r.detail=0,r}var n=window.Map&&window.Map.prototype.forEach?Map:SparseArrayMap;function SparseArrayMap(){this.array=[],this.size=0}SparseArrayMap.prototype={set:function(t,e){if(void 0===e)return this.delete(t);this.has(t)||this.size++,this.array[t]=e},has:function(t){return void 0!==this.array[t]},delete:function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,e){return this.array.forEach((function(n,i){t.call(e,n,i,this)}),this)}};var i=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],r=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],o={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},a="undefined"!=typeof SVGElementInstance,s={pointermap:new n,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(t,e){var n=e,i=n.events;i&&(i.forEach((function(t){n[t]&&(this.eventMap[t]=n[t].bind(n))}),this),this.eventSources[t]=n,this.eventSourceList.push(n))},register:function(t){for(var e,n=this.eventSourceList.length,i=0;i<n&&(e=this.eventSourceList[i]);i++)e.register.call(e,t)},unregister:function(t){for(var e,n=this.eventSourceList.length,i=0;i<n&&(e=this.eventSourceList[i]);i++)e.unregister.call(e,t)},contains:function(t,e){try{return t.contains(e)}catch(t){return!1}},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){t.bubbles=!1,this.fireEvent("pointerenter",t)},leave:function(t){t.bubbles=!1,this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.propagate(t,this.leave,!1)},enterOver:function(t){this.over(t),this.propagate(t,this.enter,!0)},eventHandler:function(t){if(!t._handledByPE){var e=t.type,n=this.eventMap&&this.eventMap[e];n&&n(t),t._handledByPE=!0}},listen:function(t,e){e.forEach((function(e){this.addEvent(t,e)}),this)},unlisten:function(t,e){e.forEach((function(e){this.removeEvent(t,e)}),this)},addEvent:function(t,e){t.addEventListener(e,this.boundHandler)},removeEvent:function(t,e){t.removeEventListener(e,this.boundHandler)},makeEvent:function(t,e){this.captureInfo[e.pointerId]&&(e.relatedTarget=null);var n=new PointerEvent(t,e);return e.preventDefault&&(n.preventDefault=e.preventDefault),n._target=n._target||e.target,n},fireEvent:function(t,e){var n=this.makeEvent(t,e);return this.dispatchEvent(n)},cloneEvent:function(t){for(var e,n=Object.create(null),o=0;o<i.length;o++)n[e=i[o]]=t[e]||r[o],!a||"target"!==e&&"relatedTarget"!==e||n[e]instanceof SVGElementInstance&&(n[e]=n[e].correspondingUseElement);return t.preventDefault&&(n.preventDefault=function(){t.preventDefault()}),n},getTarget:function(t){var e=this.captureInfo[t.pointerId];return e?t._target!==e&&t.type in o?void 0:e:t._target},propagate:function(t,e,n){for(var i=t.target,r=[];null!=i&&i!==document&&!i.contains(t.relatedTarget);)if(r.push(i),!(i=i.parentNode))return;n&&r.reverse(),r.forEach((function(n){t.target=n,e.call(this,t)}),this)},setCapture:function(t,e,n){this.captureInfo[t]&&this.releaseCapture(t,n),this.captureInfo[t]=e,this.implicitRelease=this.releaseCapture.bind(this,t,n),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var i=new PointerEvent("gotpointercapture",{bubbles:!0});i.pointerId=t,i._target=e,n||this.asyncDispatchEvent(i)},releaseCapture:function(t,e){var n=this.captureInfo[t];if(n){this.captureInfo[t]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var i=new PointerEvent("lostpointercapture",{bubbles:!0});i.pointerId=t,i._target=n,e||this.asyncDispatchEvent(i)}},dispatchEvent:function(t){var e=this.getTarget(t);if(e)return e.dispatchEvent(t)},asyncDispatchEvent:function(t){requestAnimationFrame(this.dispatchEvent.bind(this,t))}};s.boundHandler=s.eventHandler.bind(s);var l={shadow:function(t){if(t)return t.shadowRoot||t.webkitShadowRoot},canTarget:function(t){return t&&Boolean(t.elementFromPoint)},targetingShadow:function(t){var e=this.shadow(t);if(this.canTarget(e))return e},olderShadow:function(t){var e=t.olderShadowRoot;if(!e){var n=t.querySelector("shadow");n&&(e=n.olderShadowRoot)}return e},allShadows:function(t){for(var e=[],n=this.shadow(t);n;)e.push(n),n=this.olderShadow(n);return e},searchRoot:function(t,e,n){if(t){var i,r,o=t.elementFromPoint(e,n);for(r=this.targetingShadow(o);r;){if(i=r.elementFromPoint(e,n)){var a=this.targetingShadow(i);return this.searchRoot(a,e,n)||i}r=this.olderShadow(r)}return o}},owner:function(t){for(var e=t;e.parentNode;)e=e.parentNode;return e.nodeType!==Node.DOCUMENT_NODE&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(e=document),e},findTarget:function(t){var e=t.clientX,n=t.clientY,i=this.owner(t.target);return i.elementFromPoint(e,n)||(i=document),this.searchRoot(i,e,n)}},u=Array.prototype.forEach.call.bind(Array.prototype.forEach),c=Array.prototype.map.call.bind(Array.prototype.map),h=Array.prototype.slice.call.bind(Array.prototype.slice),d=Array.prototype.filter.call.bind(Array.prototype.filter),p=window.MutationObserver||window.WebKitMutationObserver,f={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function Installer(t,e,n,i){this.addCallback=t.bind(i),this.removeCallback=e.bind(i),this.changedCallback=n.bind(i),p&&(this.observer=new p(this.mutationWatcher.bind(this)))}function rule(t){return"{ -ms-touch-action: "+t+"; touch-action: "+t+"; }"}Installer.prototype={watchSubtree:function(t){this.observer&&l.canTarget(t)&&this.observer.observe(t,f)},enableOnSubtree:function(t){this.watchSubtree(t),t===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(t)},installNewSubtree:function(t){u(this.findElements(t),this.addElement,this)},findElements:function(t){return t.querySelectorAll?t.querySelectorAll("[touch-action]"):[]},removeElement:function(t){this.removeCallback(t)},addElement:function(t){this.addCallback(t)},elementChanged:function(t,e){this.changedCallback(t,e)},concatLists:function(t,e){return t.concat(h(e))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(t){return t.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(t){var e=c(t,this.findElements,this);return e.push(d(t,this.isElement)),e.reduce(this.concatLists,[])},mutationWatcher:function(t){t.forEach(this.mutationHandler,this)},mutationHandler:function(t){"childList"===t.type?(this.flattenMutationTree(t.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(t.removedNodes).forEach(this.removeElement,this)):"attributes"===t.type&&this.elementChanged(t.target,t.oldValue)}};var m=[{selector:'[touch-action="none"]',value:"none"},{selector:'[touch-action="auto"]',value:"auto"},{selector:'[touch-action~="pan-x"]',value:"pan-x"},{selector:'[touch-action~="pan-y"]',value:"pan-y"},{selector:'[touch-action~="pan-up"]',value:"pan-up"},{selector:'[touch-action~="pan-down"]',value:"pan-down"},{selector:'[touch-action~="pan-left"]',value:"pan-left"},{selector:'[touch-action~="pan-right"]',value:"pan-right"}],y="",g=window.PointerEvent||window.MSPointerEvent,v=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,_=s.pointermap,b=[1,4,2,8,16],T=!1;try{T=1===new MouseEvent("test",{buttons:1}).buttons}catch(t){}var w,E={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","webkitmouseforcechanged","mousemove","mouseup","mouseover","mouseout"],register:function(t){s.listen(t,this.events)},unregister:function(t){s.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,n=this.lastTouches,i=t.clientX,r=t.clientY,o=0,a=n.length;o<a&&(e=n[o]);o++){var s=Math.abs(i-e.x),l=Math.abs(r-e.y);if(s<=25&&l<=25)return!0}},prepareEvent:function(t){var e=s.cloneEvent(t),n=e.preventDefault;return e.preventDefault=function(){t.preventDefault(),n()},e.pointerId=this.POINTER_ID,e.isPrimary=!0,e.pointerType=this.POINTER_TYPE,"webkitForce"in t&&(e.pressure=t.webkitForce-MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN),e},prepareButtonsForMove:function(t,e){var n=_.get(this.POINTER_ID);0!==e.which&&n?t.buttons=n.buttons:t.buttons=0,e.buttons=t.buttons},mousedown:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=_.get(this.POINTER_ID),n=this.prepareEvent(t);T||(n.buttons=b[n.button],e&&(n.buttons|=e.buttons),t.buttons=n.buttons),_.set(this.POINTER_ID,t),e&&0!==e.buttons?s.move(n):s.down(n)}},webkitmouseforcechanged:function(t){this.mousemove(t)},mousemove:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);T||this.prepareButtonsForMove(e,t),e.button=-1,_.set(this.POINTER_ID,t),s.move(e)}},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=_.get(this.POINTER_ID),n=this.prepareEvent(t);if(!T){var i=b[n.button];n.buttons=e?e.buttons&~i:0,t.buttons=n.buttons}_.set(this.POINTER_ID,t),n.buttons&=~b[n.button],0===n.buttons?s.up(n):s.move(n)}},mouseover:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);T||this.prepareButtonsForMove(e,t),e.button=-1,_.set(this.POINTER_ID,t),s.enterOver(e)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);T||this.prepareButtonsForMove(e,t),e.button=-1,s.leaveOut(e)}},cancel:function(t){var e=this.prepareEvent(t);s.cancel(e),this.deactivateMouse()},deactivateMouse:function(){_.delete(this.POINTER_ID)}},S=s.captureInfo,M=l.findTarget.bind(l),O=l.allShadows.bind(l),x=s.pointermap,P={events:["touchstart","touchmove","touchforcechange","touchend","touchcancel"],register:function(t){w.enableOnSubtree(t)},unregister:function(){},elementAdded:function(t){var e=t.getAttribute("touch-action"),n=this.touchActionToScrollType(e);"number"==typeof n&&(t._scrollType=n,s.listen(t,this.events),O(t).forEach((function(t){t._scrollType=n,s.listen(t,this.events)}),this))},elementRemoved:function(t){if(x.size>0){var e=this.events;t.addEventListener("touchend",(function(){t._scrollType=void 0,s.unlisten(t,e)}))}else t._scrollType=void 0,s.unlisten(t,this.events);O(t).forEach((function(t){t._scrollType=void 0,s.unlisten(t,this.events)}),this)},elementChanged:function(t,e){var n=t.getAttribute("touch-action"),i=this.touchActionToScrollType(n),r=this.touchActionToScrollType(e);"number"==typeof i&&"number"==typeof r?(t._scrollType=i,O(t).forEach((function(t){t._scrollType=i}),this)):"number"==typeof r?this.elementRemoved(t):"number"==typeof i&&this.elementAdded(t)},scrollTypes:{UP:function(t){return t.includes("pan-y")||t.includes("pan-up")?1:0},DOWN:function(t){return t.includes("pan-y")||t.includes("pan-down")?2:0},LEFT:function(t){return t.includes("pan-x")||t.includes("pan-left")?4:0},RIGHT:function(t){return t.includes("pan-x")||t.includes("pan-right")?8:0}},touchActionToScrollType:function(t){if(t){if("auto"===t)return 15;if("none"===t)return 0;var e=t.split(" "),n=this.scrollTypes;return n.UP(e)|n.DOWN(e)|n.LEFT(e)|n.RIGHT(e)}},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===x.size||1===x.size&&x.has(1))&&(this.firstTouch=t.identifier,this.firstXY={X:t.clientX,Y:t.clientY},this.scrolling=!1)},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.firstXY=null)},typeToButtons:function(t){var e=0;return"touchstart"!==t&&"touchmove"!==t&&"touchforcechange"!==t||(e=1),e},touchToPointer:function(t){var e=this.currentTouchEvent,n=s.cloneEvent(t),i=n.pointerId=t.identifier+2;if(n.target=S[i]||M(n),n.bubbles=!0,n.cancelable=!0,n.button=0,n.buttons=this.typeToButtons(e.type),n.width=2*(t.radiusX||t.webkitRadiusX||0),n.height=2*(t.radiusY||t.webkitRadiusY||0),n.pressure=void 0!==t.force?t.force:void 0!==t.webkitForce?t.webkitForce:void 0,n.isPrimary=this.isPrimaryTouch(t),t.altitudeAngle){var r=Math.tan(t.altitudeAngle),o=180/Math.PI;n.tiltX=Math.atan(Math.cos(t.azimuthAngle)/r)*o,n.tiltY=Math.atan(Math.sin(t.azimuthAngle)/r)*o}else n.tiltX=0,n.tiltY=0;"stylus"===t.touchType?n.pointerType="pen":n.pointerType=this.POINTER_TYPE,n.altKey=e.altKey,n.ctrlKey=e.ctrlKey,n.metaKey=e.metaKey,n.shiftKey=e.shiftKey;var a=this;return n.preventDefault=function(){a.scrolling=!1,a.firstXY=null,e.preventDefault()},n},processTouches:function(t,e){var n=t.changedTouches;this.currentTouchEvent=t;for(var i,r=0;r<n.length;r++)i=n[r],e.call(this,this.touchToPointer(i))},shouldScroll:function(t){if(this.firstXY){var e,n=t.currentTarget._scrollType;if(0===n)e=!1;else if(15===n)e=!0;else{var i=t.changedTouches[0],r=i.clientY-this.firstXY.Y,o=Math.abs(r),a=i.clientX-this.firstXY.X,s=Math.abs(a),l=1&n,u=2&n,c=4&n,h=8&n;c&&h?e=s>o:c?e=s>o&&a>0:h&&(e=s>o&&a<0),e||(l&&u?e=s<o:l?e=s<o&&r>0:u&&(e=s<o&&r<0))}return this.firstXY=null,e}},findTouch:function(t,e){for(var n,i=0,r=t.length;i<r&&(n=t[i]);i++)if(n.identifier===e)return!0},vacuumTouches:function(t){var e=t.touches;if(x.size>=e.length){var n=[];x.forEach((function(t,i){if(1!==i&&!this.findTouch(e,i-2)){var r=t.out;n.push(r)}}),this),n.forEach(this.cancelOut,this)}},touchstart:function(t){this.vacuumTouches(t),this.setPrimaryTouch(t.changedTouches[0]),this.dedupSynthMouse(t),this.scrolling||this.processTouches(t,this.overDown)},overDown:function(t){x.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),s.enterOver(t),s.down(t)},touchforcechange:function(t){this.touchmove(t)},touchmove:function(t){this.scrolling||(this.shouldScroll(t)?(this.scrolling=!0,this.touchcancel(t)):("touchforcechange"!==t.type&&t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var e=t,n=x.get(e.pointerId);if(n){var i=n.out,r=n.outTarget;s.move(e),i&&r!==e.target&&(i.relatedTarget=e.target,e.relatedTarget=r,i.target=r,e.target?(s.leaveOut(i),s.enterOver(e)):(e.target=r,e.relatedTarget=null,this.cancelOut(e))),n.out=e,n.outTarget=e.target}},touchend:function(t){this.dedupSynthMouse(t),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(s.up(t),s.leaveOut(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){s.cancel(t),s.leaveOut(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){x.delete(t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var e=E.lastTouches,n=t.changedTouches[0];if(this.isPrimaryTouch(n)){var i={x:n.clientX,y:n.clientY};e.push(i);var r=function(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}.bind(null,e,i);setTimeout(r,2500)}}};w=new Installer(P.elementAdded,P.elementRemoved,P.elementChanged,P);var C,I,L,R=s.pointermap,k=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,A={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){s.listen(t,this.events)},unregister:function(t){s.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var e=t;return k&&((e=s.cloneEvent(t)).pointerType=this.POINTER_TYPES[t.pointerType]),e},cleanup:function(t){R.delete(t)},MSPointerDown:function(t){R.set(t.pointerId,t);var e=this.prepareEvent(t);s.down(e)},MSPointerMove:function(t){var e=this.prepareEvent(t);s.move(e)},MSPointerUp:function(t){var e=this.prepareEvent(t);s.up(e),this.cleanup(t.pointerId)},MSPointerOut:function(t){var e=this.prepareEvent(t);s.leaveOut(e)},MSPointerOver:function(t){var e=this.prepareEvent(t);s.enterOver(e)},MSPointerCancel:function(t){var e=this.prepareEvent(t);s.cancel(e),this.cleanup(t.pointerId)},MSLostPointerCapture:function(t){var e=s.makeEvent("lostpointercapture",t);s.dispatchEvent(e)},MSGotPointerCapture:function(t){var e=s.makeEvent("gotpointercapture",t);s.dispatchEvent(e)}};function assertActive(t){if(!s.pointermap.has(t)){var e=new Error("NotFoundError");throw e.name="NotFoundError",e}}function assertConnected(t){for(var e=t.parentNode;e&&e!==t.ownerDocument;)e=e.parentNode;if(!e){var n=new Error("InvalidStateError");throw n.name="InvalidStateError",n}}function inActiveButtonState(t){return 0!==s.pointermap.get(t).buttons}return window.navigator.msPointerEnabled?(C=function(t){assertActive(t),assertConnected(this),inActiveButtonState(t)&&(s.setCapture(t,this,!0),this.msSetPointerCapture(t))},I=function(t){assertActive(t),s.releaseCapture(t,!0),this.msReleasePointerCapture(t)}):(C=function setPointerCapture(t){assertActive(t),assertConnected(this),inActiveButtonState(t)&&s.setCapture(t,this)},I=function releasePointerCapture(t){assertActive(t),s.releaseCapture(t)}),L=function hasPointerCapture(t){return!!s.captureInfo[t]},function applyAttributeStyles(){if(g){m.forEach((function(t){y+=t.selector+rule(t.value)+"\n",v&&(y+=function shadowSelector(t){return"body /shadow-deep/ "+t}(t.selector)+rule(t.value)+"\n")}));var t=document.createElement("style");t.textContent=y,document.head.appendChild(t)}}(),function applyPolyfill(){if(!window.PointerEvent){if(window.PointerEvent=PointerEvent,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0}),s.registerSource("ms",A)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),s.registerSource("mouse",E),void 0!==window.ontouchstart&&s.registerSource("touch",P);s.register(document)}}(),function applyPolyfill$1(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:C},releasePointerCapture:{value:I},hasPointerCapture:{value:L}})}(),{dispatcher:s,Installer:Installer,PointerEvent:PointerEvent,PointerMap:n,targetFinding:l}}()})),{SINGLECLICK:"singleclick",CLICK:Hn.CLICK,DBLCLICK:Hn.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}),nl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),il=function(t){function MapBrowserPointerEvent(e,n,i,r,o){var a=t.call(this,e,n,i,r,o)||this;return a.pointerEvent=i,a}return nl(MapBrowserPointerEvent,t),MapBrowserPointerEvent}(tl),rl={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ol=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),al=function(t){function MapBrowserEventHandler(e,n){var i=t.call(this,e)||this;i.map_=e,i.clickTimeoutId_,i.dragging_=!1,i.dragListenerKeys_=[],i.moveTolerance_=n?n*Er:Er,i.down_=null;var r=i.map_.getViewport();return i.activePointers_=0,i.trackedTouches_={},i.element_=r,i.pointerdownListenerKey_=listen(r,rl.POINTERDOWN,i.handlePointerDown_,i),i.relayedListenerKey_=listen(r,rl.POINTERMOVE,i.relayEvent_,i),i}return ol(MapBrowserEventHandler,t),MapBrowserEventHandler.prototype.emulateClick_=function(t){var e=new il(el.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new il(el.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new il(el.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},MapBrowserEventHandler.prototype.updateActivePointers_=function(t){var e=t;e.type==el.POINTERUP||e.type==el.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==el.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},MapBrowserEventHandler.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new il(el.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},MapBrowserEventHandler.prototype.isMouseActionButton_=function(t){return 0===t.button},MapBrowserEventHandler.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new il(el.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&this.dragListenerKeys_.push(listen(document,el.POINTERMOVE,this.handlePointerMove_,this),listen(document,el.POINTERUP,this.handlePointerUp_,this),listen(this.element_,el.POINTERCANCEL,this.handlePointerUp_,this))},MapBrowserEventHandler.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new il(el.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}},MapBrowserEventHandler.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new il(t.type,this.map_,t,e))},MapBrowserEventHandler.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},MapBrowserEventHandler.prototype.disposeInternal=function(){this.relayedListenerKey_&&(unlistenByKey(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(unlistenByKey(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(unlistenByKey),this.dragListenerKeys_.length=0,this.element_=null,t.prototype.disposeInternal.call(this)},MapBrowserEventHandler}(Yn),sl={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};function createExtent(t,e,n){return function(i,r,o,a){if(i){var s=e?0:o[0]*r,l=e?0:o[1]*r,u=t[0]+s/2,c=t[2]-s/2,h=t[1]+l/2,d=t[3]-l/2;u>c&&(c=u=(c+u)/2),h>d&&(d=h=(d+h)/2);var p=clamp(i[0],u,c),f=clamp(i[1],h,d),m=30*r;return a&&n&&(p+=-m*Math.log(1+Math.max(0,u-i[0])/m)+m*Math.log(1+Math.max(0,i[0]-c)/m),f+=-m*Math.log(1+Math.max(0,h-i[1])/m)+m*Math.log(1+Math.max(0,i[1]-d)/m)),[p,f]}}}function none(t){return t}function getViewportClampedResolution(t,e,n){var i=getWidth(e)/n[0],r=getHeight(e)/n[1];return Math.min(t,Math.min(i,r))}function getSmoothClampedResolution(t,e,n){var i=Math.min(t,e);return i*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(i=Math.max(i,n),i/=Math.log(1+50*Math.max(0,n/t-1))/50+1),clamp(i,n/2,2*e)}function createMinMaxResolution(t,e,n,i){return function(r,o,a,s){if(void 0!==r){var l=i?getViewportClampedResolution(t,i,a):t;return(void 0===n||n)&&s?getSmoothClampedResolution(r,l,e):clamp(r,e,l)}}}function disable(t){return void 0!==t?0:void 0}function none$1(t){return void 0!==t?t:void 0}var ll="center",ul="resolution",cl="rotation";function linearRing(t,e,n,i){for(var r=0,o=t[n-i],a=t[n-i+1];e<n;e+=i){var s=t[e],l=t[e+1];r+=a*s-o*l,o=s,a=l}return r/2}function assignClosest(t,e,n,i,r,o,a){var s,l=t[e],u=t[e+1],c=t[n]-l,h=t[n+1]-u;if(0===c&&0===h)s=e;else{var d=((r-l)*c+(o-u)*h)/(c*c+h*h);if(d>1)s=n;else{if(d>0){for(var p=0;p<i;++p)a[p]=lerp(t[e+p],t[n+p],d);return void(a.length=i)}s=e}}for(p=0;p<i;++p)a[p]=t[s+p];a.length=i}function maxSquaredDelta(t,e,n,i,r){var o=t[e],a=t[e+1];for(e+=i;e<n;e+=i){var s=t[e],l=t[e+1],u=squaredDistance(o,a,s,l);u>r&&(r=u),o=s,a=l}return r}function assignClosestPoint(t,e,n,i,r,o,a,s,l,u,c){if(e==n)return u;var h,d;if(0===r){if((d=squaredDistance(a,s,t[e],t[e+1]))<u){for(h=0;h<i;++h)l[h]=t[e+h];return l.length=i,d}return u}for(var p=c||[NaN,NaN],f=e+i;f<n;)if(assignClosest(t,f-i,f,i,a,s,p),(d=squaredDistance(a,s,p[0],p[1]))<u){for(u=d,h=0;h<i;++h)l[h]=p[h];l.length=i,f+=i}else f+=i*Math.max((Math.sqrt(d)-Math.sqrt(u))/r|0,1);if(o&&(assignClosest(t,n-i,e,i,a,s,p),(d=squaredDistance(a,s,p[0],p[1]))<u)){for(u=d,h=0;h<i;++h)l[h]=p[h];l.length=i}return u}function inflateCoordinates(t,e,n,i,r){for(var o=void 0!==r?r:[],a=0,s=e;s<n;s+=i)o[a++]=t.slice(s,s+i);return o.length=a,o}function snap(t,e){return e*Math.round(t/e)}function quantize(t,e,n,i,r,o,a){if(e==n)return a;var s,l,u=snap(t[e],r),c=snap(t[e+1],r);e+=i,o[a++]=u,o[a++]=c;do{if(s=snap(t[e],r),l=snap(t[e+1],r),(e+=i)==n)return o[a++]=s,o[a++]=l,a}while(s==u&&l==c);for(;e<n;){var h=snap(t[e],r),d=snap(t[e+1],r);if(e+=i,h!=s||d!=l){var p=s-u,f=l-c,m=h-u,y=d-c;p*y==f*m&&(p<0&&m<p||p==m||p>0&&m>p)&&(f<0&&y<f||f==y||f>0&&y>f)?(s=h,l=d):(o[a++]=s,o[a++]=l,u=s,c=l,s=h,l=d)}}return o[a++]=s,o[a++]=l,a}var hl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),dl=function(t){function LinearRing(e,n){var i=t.call(this)||this;return i.maxDelta_=-1,i.maxDeltaRevision_=-1,void 0===n||Array.isArray(e[0])?i.setCoordinates(e,n):i.setFlatCoordinates(n,e),i}return hl(LinearRing,t),LinearRing.prototype.clone=function(){return new LinearRing(this.flatCoordinates.slice(),this.layout)},LinearRing.prototype.closestPointXY=function(t,e,n,i){return i<closestSquaredDistanceXY(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(maxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),assignClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))},LinearRing.prototype.getArea=function(){return linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},LinearRing.prototype.getCoordinates=function(){return inflateCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},LinearRing.prototype.getSimplifiedGeometryInternal=function(t){var e=[];return e.length=function douglasPeucker(t,e,n,i,r,o,a){var s=(n-e)/i;if(s<3){for(;e<n;e+=i)o[a++]=t[e],o[a++]=t[e+1];return a}var l=new Array(s);l[0]=1,l[s-1]=1;for(var u=[e,n-i],c=0;u.length>0;){for(var h=u.pop(),d=u.pop(),p=0,f=t[d],m=t[d+1],y=t[h],g=t[h+1],v=d+i;v<h;v+=i){var _=squaredSegmentDistance(t[v],t[v+1],f,m,y,g);_>p&&(c=v,p=_)}p>r&&(l[(c-e)/i]=1,d+i<c&&u.push(d,c),c+i<h&&u.push(c,h))}for(v=0;v<s;++v)l[v]&&(o[a++]=t[e+v*i],o[a++]=t[e+v*i+1]);return a}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new LinearRing(e,bo.XY)},LinearRing.prototype.getType=function(){return r},LinearRing.prototype.intersectsExtent=function(t){return!1},LinearRing.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=deflateCoordinates(this.flatCoordinates,0,t,this.stride),this.changed()},LinearRing}(wo);function linearRingContainsExtent(t,e,n,i,r){return!function forEachCorner(t,e){var n;return(n=e(getBottomLeft(t)))?n:(n=e(getBottomRight(t)))?n:(n=e(getTopRight(t)))?n:(n=e(getTopLeft(t)))||!1}(r,(function(r){return!linearRingContainsXY(t,e,n,i,r[0],r[1])}))}function linearRingContainsXY(t,e,n,i,r,o){for(var a=0,s=t[n-i],l=t[n-i+1];e<n;e+=i){var u=t[e],c=t[e+1];l<=o?c>o&&(u-s)*(o-l)-(r-s)*(c-l)>0&&a++:c<=o&&(u-s)*(o-l)-(r-s)*(c-l)<0&&a--,s=u,l=c}return 0!==a}function linearRingsContainsXY(t,e,n,i,r,o){if(0===n.length)return!1;if(!linearRingContainsXY(t,e,n[0],i,r,o))return!1;for(var a=1,s=n.length;a<s;++a)if(linearRingContainsXY(t,n[a-1],n[a],i,r,o))return!1;return!0}function intersectsLineString(t,e,n,i,r){var o=extendFlatCoordinates([1/0,1/0,-1/0,-1/0],t,e,n,i);return!!intersects(r,o)&&(!!containsExtent(r,o)||(o[0]>=r[0]&&o[2]<=r[2]||(o[1]>=r[1]&&o[3]<=r[3]||function forEach$2(t,e,n,i,r){for(var o,a=[t[e],t[e+1]],s=[];e+i<n;e+=i){if(s[0]=t[e+i],s[1]=t[e+i+1],o=r(a,s))return o;a[0]=s[0],a[1]=s[1]}return!1}(t,e,n,i,(function(t,e){return function intersectsSegment(t,e,n){var i=!1,r=coordinateRelationship(t,e),o=coordinateRelationship(t,n);if(r===m.INTERSECTING||o===m.INTERSECTING)i=!0;else{var a=t[0],s=t[1],l=t[2],u=t[3],c=e[0],h=e[1],d=n[0],p=n[1],f=(p-h)/(d-c),y=void 0,g=void 0;o&m.ABOVE&&!(r&m.ABOVE)&&(i=(y=d-(p-u)/f)>=a&&y<=l),i||!(o&m.RIGHT)||r&m.RIGHT||(i=(g=p-(d-l)*f)>=s&&g<=u),i||!(o&m.BELOW)||r&m.BELOW||(i=(y=d-(p-s)/f)>=a&&y<=l),i||!(o&m.LEFT)||r&m.LEFT||(i=(g=p-(d-a)*f)>=s&&g<=u)}return i}(r,t,e)})))))}function intersectsLinearRingArray(t,e,n,i,r){if(!function intersectsLinearRing(t,e,n,i,r){return!!intersectsLineString(t,e,n,i,r)||(!!linearRingContainsXY(t,e,n,i,r[0],r[1])||(!!linearRingContainsXY(t,e,n,i,r[0],r[3])||(!!linearRingContainsXY(t,e,n,i,r[2],r[1])||!!linearRingContainsXY(t,e,n,i,r[2],r[3]))))}(t,e,n[0],i,r))return!1;if(1===n.length)return!0;for(var o=1,a=n.length;o<a;++o)if(linearRingContainsExtent(t,n[o-1],n[o],i,r)&&!intersectsLineString(t,n[o-1],n[o],i,r))return!1;return!0}function coordinates(t,e,n,i){for(;e<n-i;){for(var r=0;r<i;++r){var o=t[e+r];t[e+r]=t[n-i+r],t[n-i+r]=o}e+=i,n-=i}}function linearRingIsClockwise(t,e,n,i){for(var r=0,o=t[n-i],a=t[n-i+1];e<n;e+=i){var s=t[e],l=t[e+1];r+=(s-o)*(l+a),o=s,a=l}return r>0}function orientLinearRings(t,e,n,i,r){for(var o=void 0!==r&&r,a=0,s=n.length;a<s;++a){var l=n[a],u=linearRingIsClockwise(t,e,l,i);(0===a?o&&u||!o&&!u:o&&!u||!o&&u)&&coordinates(t,e,l,i),e=l}return e}var pl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),fl=function(t){function Polygon(e,n,i){var r=t.call(this)||this;return r.ends_=[],r.flatInteriorPointRevision_=-1,r.flatInteriorPoint_=null,r.maxDelta_=-1,r.maxDeltaRevision_=-1,r.orientedRevision_=-1,r.orientedFlatCoordinates_=null,void 0!==n&&i?(r.setFlatCoordinates(n,e),r.ends_=i):r.setCoordinates(e,n),r}return pl(Polygon,t),Polygon.prototype.appendLinearRing=function(t){this.flatCoordinates?function extend$1(t,e){for(var n=Array.isArray(e)?e:[e],i=n.length,r=0;r<i;r++)t[t.length]=n[r]}(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},Polygon.prototype.clone=function(){return new Polygon(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},Polygon.prototype.closestPointXY=function(t,e,n,i){return i<closestSquaredDistanceXY(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function arrayMaxSquaredDelta(t,e,n,i,r){for(var o=0,a=n.length;o<a;++o){var s=n[o];r=maxSquaredDelta(t,e,s,i,r),e=s}return r}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function assignClosestArrayPoint(t,e,n,i,r,o,a,s,l,u,c){for(var h=c||[NaN,NaN],d=0,p=n.length;d<p;++d){var f=n[d];u=assignClosestPoint(t,e,f,i,r,o,a,s,l,u,h),e=f}return u}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))},Polygon.prototype.containsXY=function(t,e){return linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},Polygon.prototype.getArea=function(){return function linearRings(t,e,n,i){for(var r=0,o=0,a=n.length;o<a;++o){var s=n[o];r+=linearRing(t,e,s,i),e=s}return r}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},Polygon.prototype.getCoordinates=function(t){var e;return void 0!==t?orientLinearRings(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,function inflateCoordinatesArray(t,e,n,i,r){for(var o=void 0!==r?r:[],a=0,s=0,l=n.length;s<l;++s){var u=n[s];o[a++]=inflateCoordinates(t,e,u,i,o[a]),e=u}return o.length=a,o}(e,0,this.ends_,this.stride)},Polygon.prototype.getEnds=function(){return this.ends_},Polygon.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=getCenter(this.getExtent());this.flatInteriorPoint_=function getInteriorPointOfArray(t,e,n,i,r,o,a){for(var s,l,u,c,h,d,p,f=r[o+1],m=[],y=0,g=n.length;y<g;++y){var v=n[y];for(c=t[v-i],d=t[v-i+1],s=e;s<v;s+=i)h=t[s],p=t[s+1],(f<=d&&p<=f||d<=f&&f<=p)&&(u=(f-d)/(p-d)*(h-c)+c,m.push(u)),c=h,d=p}var _=NaN,b=-1/0;for(m.sort(numberSafeCompareFunction),c=m[0],s=1,l=m.length;s<l;++s){h=m[s];var T=Math.abs(h-c);T>b&&linearRingsContainsXY(t,e,n,i,u=(c+h)/2,f)&&(_=u,b=T),c=h}return isNaN(_)&&(_=r[o]),a?(a.push(_,f,b),a):[_,f,b]}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},Polygon.prototype.getInteriorPoint=function(){return new So(this.getFlatInteriorPoint(),bo.XYM)},Polygon.prototype.getLinearRingCount=function(){return this.ends_.length},Polygon.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new dl(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},Polygon.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,n=this.ends_,i=[],r=0,o=0,a=n.length;o<a;++o){var s=n[o],l=new dl(e.slice(r,s),t);i.push(l),r=s}return i},Polygon.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function linearRingsAreOriented(t,e,n,i,r){for(var o=void 0!==r&&r,a=0,s=n.length;a<s;++a){var l=n[a],u=linearRingIsClockwise(t,e,l,i);if(0===a){if(o&&u||!o&&!u)return!1}else if(o&&!u||!o&&u)return!1;e=l}return!0}(t,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},Polygon.prototype.getSimplifiedGeometryInternal=function(t){var e=[],n=[];return e.length=function quantizeArray(t,e,n,i,r,o,a,s){for(var l=0,u=n.length;l<u;++l){var c=n[l];a=quantize(t,e,c,i,r,o,a),s.push(a),e=c}return a}(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new Polygon(e,bo.XY,n)},Polygon.prototype.getType=function(){return o},Polygon.prototype.intersectsExtent=function(t){return intersectsLinearRingArray(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},Polygon.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=function deflateCoordinatesArray(t,e,n,i,r){for(var o=r||[],a=0,s=0,l=n.length;s<l;++s){var u=deflateCoordinates(t,e,n[s],i);o[a++]=u,e=u}return o.length=a,o}(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()},Polygon}(wo);function fromExtent(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=[e,n,e,r,i,r,i,n,e,n];return new fl(o,bo.XY,[o.length])}var ml=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),yl=0,gl=function(e){function View(n){var i=e.call(this)||this,r=t({},n);return i.hints_=[0,0],i.animations_=[],i.updateAnimationKey_,i.projection_=createProjection(r.projection,"EPSG:3857"),i.targetCenter_=null,i.targetResolution_,i.targetRotation_,r.center&&(r.center=fromUserCoordinate(r.center,i.projection_)),r.extent&&(r.extent=fromUserExtent(r.extent,i.projection_)),i.applyOptions_(r),i}return ml(View,e),View.prototype.applyOptions_=function(t){var e=function createResolutionConstraint(t){var e,n,i,r=void 0!==t.minZoom?t.minZoom:yl,o=void 0!==t.maxZoom?t.maxZoom:28,a=void 0!==t.zoomFactor?t.zoomFactor:2,s=void 0!==t.multiWorld&&t.multiWorld,l=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,u=createProjection(t.projection,"EPSG:3857"),c=u.getExtent(),h=t.constrainOnlyCenter,d=t.extent;s||d||!u.isGlobal()||(h=!1,d=c);if(void 0!==t.resolutions){var p=t.resolutions;n=p[r],i=void 0!==p[o]?p[o]:p[p.length-1],e=t.constrainResolution?function createSnapToResolutions(t,e,n){return function(i,r,o,a){if(void 0!==i){var s=t[0],l=t[t.length-1],u=n?getViewportClampedResolution(s,n,o):s;if(a)return void 0===e||e?getSmoothClampedResolution(i,u,l):clamp(i,l,u);var c=Math.min(u,i),h=Math.floor(linearFindNearest(t,c,r));return t[h]>u&&h<t.length-1?t[h+1]:t[h]}}}(p,l,!h&&d):createMinMaxResolution(n,i,l,!h&&d)}else{var f=(c?Math.max(getWidth(c),getHeight(c)):360*g[y.DEGREES]/u.getMetersPerUnit())/eo/Math.pow(2,yl),m=f/Math.pow(2,28-yl);void 0!==(n=t.maxResolution)?r=0:n=f/Math.pow(a,r),void 0===(i=t.minResolution)&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(a,o):f/Math.pow(a,o):m),o=r+Math.floor(Math.log(n/i)/Math.log(a)),i=n/Math.pow(a,o-r),e=t.constrainResolution?function createSnapToPower(t,e,n,i,r){return function(o,a,s,l){if(void 0!==o){var u=r?getViewportClampedResolution(e,r,s):e,c=void 0!==n?n:0;if(l)return void 0===i||i?getSmoothClampedResolution(o,u,c):clamp(o,c,u);var h=Math.ceil(Math.log(e/u)/Math.log(t)-1e-9),d=-a*(.5-1e-9)+.5,p=Math.min(u,o),f=Math.floor(Math.log(e/p)/Math.log(t)+d),m=Math.max(h,f);return clamp(e/Math.pow(t,m),c,u)}}}(a,n,i,l,!h&&d):createMinMaxResolution(n,i,l,!h&&d)}return{constraint:e,maxResolution:n,minResolution:i,minZoom:r,zoomFactor:a}}(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;var n=function createCenterConstraint(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return createExtent(t.extent,t.constrainOnlyCenter,e)}var n=createProjection(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&n.isGlobal()){var i=n.getExtent().slice();return i[0]=-1/0,i[2]=1/0,createExtent(i,!1,!1)}return none}(t),i=e.constraint,r=function createRotationConstraint(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?function createSnapToZero(t){var e=t||toRadians(5);return(function(t,n){return n?t:void 0!==t?Math.abs(t)<=e?0:t:void 0})}():!1===e?none$1:"number"==typeof e?function createSnapToN(t){var e=2*Math.PI/t;return(function(t,n){return n?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0})}(e):none$1}return disable}(t);this.constraints_={center:n,resolution:i,rotation:r},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.resolveConstraints(0),this.setProperties({}),this.options_=t},View.prototype.getUpdatedOptions_=function(e){var n=t({},this.options_);return void 0!==n.resolution?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),t({},n,e)},View.prototype.animate=function(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var n=new Array(arguments.length),i=0;i<n.length;++i){var r=arguments[i];r.center&&((r=t({},r)).center=fromUserCoordinate(r.center,this.getProjection())),r.anchor&&((r=t({},r)).anchor=fromUserCoordinate(r.anchor,this.getProjection())),n[i]=r}this.animateInternal.apply(this,n)},View.prototype.animateInternal=function(t){var e,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var i=arguments[n-1];return i.center&&this.setCenterInternal(i.center),void 0!==i.zoom&&this.setZoom(i.zoom),void 0!==i.rotation&&this.setRotation(i.rotation),void(e&&animationCallback(e,!0))}for(var r=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,s=this.targetRotation_,l=[],u=0;u<n;++u){var c=arguments[u],h={start:r,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||inAndOut,callback:e};if(c.center&&(h.sourceCenter=o,h.targetCenter=c.center.slice(),o=h.targetCenter),void 0!==c.zoom?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(c.zoom),a=h.targetResolution):c.resolution&&(h.sourceResolution=a,h.targetResolution=c.resolution,a=h.targetResolution),void 0!==c.rotation){h.sourceRotation=s;var d=modulo(c.rotation-s+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=s+d,s=h.targetRotation}isNoopAnimation(h)?h.complete=!0:r+=h.duration,l.push(h)}this.animations_.push(l),this.setHint(cr,1),this.updateAnimations_()},View.prototype.getAnimating=function(){return this.hints_[cr]>0},View.prototype.getInteracting=function(){return this.hints_[hr]>0},View.prototype.cancelAnimations=function(){this.setHint(cr,-this.hints_[cr]);for(var t=0,e=this.animations_.length;t<e;++t){var n=this.animations_[t];n[0].callback&&animationCallback(n[0].callback,!1)}this.animations_.length=0},View.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var i=this.animations_[n],r=!0,o=0,a=i.length;o<a;++o){var s=i[o];if(!s.complete){var l=t-s.start,u=s.duration>0?l/s.duration:1;u>=1?(s.complete=!0,u=1):r=!1;var c=s.easing(u);if(s.sourceCenter){var h=s.sourceCenter[0],d=s.sourceCenter[1],p=h+c*(s.targetCenter[0]-h),f=d+c*(s.targetCenter[1]-d);this.targetCenter_=[p,f]}if(s.sourceResolution&&s.targetResolution){var m=1===c?s.targetResolution:s.sourceResolution+c*(s.targetResolution-s.sourceResolution);if(s.anchor){var y=this.getSizeFromViewport_(this.getRotation()),g=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(g,s.anchor)}this.targetResolution_=m,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){var v=1===c?modulo(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+c*(s.targetRotation-s.sourceRotation);if(s.anchor){var _=this.constraints_.rotation(v,!0);this.targetCenter_=this.calculateCenterRotate(_,s.anchor)}this.targetRotation_=v}if(this.applyTargetState_(!0),e=!0,!s.complete)break}}if(r){this.animations_[n]=null,this.setHint(cr,-1);var b=i[0].callback;b&&animationCallback(b,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},View.prototype.calculateCenterRotate=function(t,e){var n,i=this.getCenterInternal();return void 0!==i&&(rotate(n=[i[0]-e[0],i[1]-e[1]],t-this.getRotation()),function add$2(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}(n,e)),n},View.prototype.calculateCenterZoom=function(t,e){var n,i=this.getCenterInternal(),r=this.getResolution();void 0!==i&&void 0!==r&&(n=[e[0]-t*(e[0]-i[0])/r,e[1]-t*(e[1]-i[1])/r]);return n},View.prototype.getSizeFromViewport_=function(t){var e=[100,100],n='.ol-viewport[data-view="'+getUid(this)+'"]',i=document.querySelector(n);if(i){var r=getComputedStyle(i);e[0]=parseInt(r.width,10),e[1]=parseInt(r.height,10)}if(t){var o=e[0],a=e[1];e[0]=Math.abs(o*Math.cos(t))+Math.abs(a*Math.sin(t)),e[1]=Math.abs(o*Math.sin(t))+Math.abs(a*Math.cos(t))}return e},View.prototype.getCenter=function(){var t=this.getCenterInternal();return t?toUserCoordinate(t,this.getProjection()):t},View.prototype.getCenterInternal=function(){return this.get(ll)},View.prototype.getConstraints=function(){return this.constraints_},View.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},View.prototype.calculateExtent=function(t){return function toUserExtent(t,e){return A?transformExtent(t,e,A):t}(this.calculateExtentInternal(t),this.getProjection())},View.prototype.calculateExtentInternal=function(t){var e=t||this.getSizeFromViewport_(),n=this.getCenterInternal();assert(n,1);var i=this.getResolution();assert(void 0!==i,2);var r=this.getRotation();return assert(void 0!==r,3),getForViewAndSize(n,i,r,e)},View.prototype.getMaxResolution=function(){return this.maxResolution_},View.prototype.getMinResolution=function(){return this.minResolution_},View.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},View.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},View.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},View.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},View.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},View.prototype.getProjection=function(){return this.projection_},View.prototype.getResolution=function(){return this.get(ul)},View.prototype.getResolutions=function(){return this.resolutions_},View.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(fromUserExtent(t,this.getProjection()),e)},View.prototype.getResolutionForExtentInternal=function(t,e){var n=e||this.getSizeFromViewport_(),i=getWidth(t)/n[0],r=getHeight(t)/n[1];return Math.max(i,r)},View.prototype.getResolutionForValueFunction=function(t){var e=t||2,n=this.maxResolution_,i=this.minResolution_,r=Math.log(n/i)/Math.log(e);return function(t){return n/Math.pow(e,t*r)}},View.prototype.getRotation=function(){return this.get(cl)},View.prototype.getValueForResolutionFunction=function(t){var e=t||2,n=this.maxResolution_,i=this.minResolution_,r=Math.log(n/i)/Math.log(e);return function(t){return Math.log(n/t)/Math.log(e)/r}},View.prototype.getState=function(){var t=this.getCenterInternal(),e=this.getProjection(),n=this.getResolution(),i=this.getRotation();return{center:t.slice(0),projection:void 0!==e?e:null,resolution:n,rotation:i,zoom:this.getZoom()}},View.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},View.prototype.getZoomForResolution=function(t){var e,n,i=this.minZoom_||0;if(this.resolutions_){var r=linearFindNearest(this.resolutions_,t,1);i=r,e=this.resolutions_[r],n=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,n=this.zoomFactor_;return i+Math.log(e/t)/Math.log(n)},View.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=clamp(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,clamp(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},View.prototype.fit=function(e,n){var i,r=t({size:this.getSizeFromViewport_()},n||{});if(assert(Array.isArray(e)||"function"==typeof e.getSimplifiedGeometry,24),Array.isArray(e))assert(!isEmpty(e),25),i=fromExtent(o=fromUserExtent(e,this.getProjection()));else if(e.getType()===a){var o;(i=fromExtent(o=fromUserExtent(e.getExtent(),this.getProjection()))).rotate(this.getRotation(),getCenter(o))}else{var s=getUserProjection();i=s?i.clone().transform(s,this.getProjection()):e}this.fitInternal(i,r)},View.prototype.fitInternal=function(t,e){var n=e||{},i=n.size;i||(i=this.getSizeFromViewport_());var r,o=void 0!==n.padding?n.padding:[0,0,0,0],a=void 0!==n.nearest&&n.nearest;r=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.getResolutionForZoom(n.maxZoom):0;for(var s=t.getFlatCoordinates(),l=this.getRotation(),u=Math.cos(-l),c=Math.sin(-l),h=1/0,d=1/0,p=-1/0,f=-1/0,m=t.getStride(),y=0,g=s.length;y<g;y+=m){var v=s[y]*u-s[y+1]*c,_=s[y]*c+s[y+1]*u;h=Math.min(h,v),d=Math.min(d,_),p=Math.max(p,v),f=Math.max(f,_)}var b=this.getResolutionForExtentInternal([h,d,p,f],[i[0]-o[1]-o[3],i[1]-o[0]-o[2]]);b=isNaN(b)?r:Math.max(b,r),b=this.getConstrainedResolution(b,a?0:1),c=-c;var T=(h+p)/2,w=(d+f)/2,E=[(T+=(o[1]-o[3])/2*b)*u-(w+=(o[0]-o[2])/2*b)*c,w*u+T*c],S=n.callback?n.callback:VOID;void 0!==n.duration?this.animateInternal({resolution:b,center:this.getConstrainedCenter(E,b),duration:n.duration,easing:n.easing},S):(this.targetResolution_=b,this.targetCenter_=E,this.applyTargetState_(!1,!0),animationCallback(S,!0))},View.prototype.centerOn=function(t,e,n){this.centerOnInternal(fromUserCoordinate(t,this.getProjection()),e,n)},View.prototype.centerOnInternal=function(t,e,n){var i=this.getRotation(),r=Math.cos(-i),o=Math.sin(-i),a=t[0]*r-t[1]*o,s=t[1]*r+t[0]*o,l=this.getResolution(),u=(a+=(e[0]/2-n[0])*l)*r-(s+=(n[1]-e[1]/2)*l)*(o=-o),c=s*r+a*o;this.setCenterInternal([u,c])},View.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},View.prototype.adjustCenter=function(t){var e=toUserCoordinate(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])},View.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])},View.prototype.adjustResolution=function(t,e){var n=e&&fromUserCoordinate(e,this.getProjection());this.adjustResolutionInternal(t,n)},View.prototype.adjustResolutionInternal=function(t,e){var n=this.getAnimating()||this.getInteracting(),i=this.getSizeFromViewport_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,i,n);void 0!==e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()},View.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)},View.prototype.adjustRotation=function(t,e){e&&(e=fromUserCoordinate(e,this.getProjection())),this.adjustRotationInternal(t,e)},View.prototype.adjustRotationInternal=function(t,e){var n=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,n);void 0!==e&&(this.targetCenter_=this.calculateCenterRotate(i,e)),this.targetRotation_+=t,this.applyTargetState_()},View.prototype.setCenter=function(t){this.setCenterInternal(fromUserCoordinate(t,this.getProjection()))},View.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},View.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},View.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},View.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},View.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},View.prototype.applyTargetState_=function(t,e){var n=this.getAnimating()||this.getInteracting()||e,i=this.constraints_.rotation(this.targetRotation_,n),r=this.getSizeFromViewport_(i),o=this.constraints_.resolution(this.targetResolution_,0,r,n),a=this.constraints_.center(this.targetCenter_,o,r,n);this.get(cl)!==i&&this.set(cl,i),this.get(ul)!==o&&this.set(ul,o),this.get(ll)&&equals$2(this.get(ll),a)||this.set(ll,a),this.getAnimating()&&!t&&this.cancelAnimations()},View.prototype.resolveConstraints=function(t,e,n){var i=void 0!==t?t:200,r=e||0,o=this.constraints_.rotation(this.targetRotation_),a=this.getSizeFromViewport_(o),s=this.constraints_.resolution(this.targetResolution_,r,a),l=this.constraints_.center(this.targetCenter_,s,a);if(0===i)return this.targetResolution_=s,this.targetRotation_=o,this.targetCenter_=l,void this.applyTargetState_();this.getResolution()===s&&this.getRotation()===o&&this.getCenterInternal()&&equals$2(this.getCenterInternal(),l)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:l,resolution:s,duration:i,easing:easeOut,anchor:n}))},View.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(hr,1)},View.prototype.endInteraction=function(t,e,n){var i=n&&fromUserCoordinate(n,this.getProjection());this.endInteractionInternal(t,e,i)},View.prototype.endInteractionInternal=function(t,e,n){this.setHint(hr,-1),this.resolveConstraints(t,e,n)},View.prototype.getConstrainedCenter=function(t,e){var n=this.getSizeFromViewport_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)},View.prototype.getConstrainedZoom=function(t,e){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))},View.prototype.getConstrainedResolution=function(t,e){var n=e||0,i=this.getSizeFromViewport_(this.getRotation());return this.constraints_.resolution(t,n,i)},View}(ti);function animationCallback(t,e){setTimeout((function(){t(e)}),0)}function isNoopAnimation(t){return!(t.sourceCenter&&t.targetCenter&&!equals$2(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}var vl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),_l={LAYERS:"layers"},bl=function(e){function LayerGroup(n){var i=this,r=n||{},o=t({},r);delete o.layers;var a=r.layers;return(i=e.call(this,o)||this).layersListenerKeys_=[],i.listenerKeys_={},i.addEventListener(getChangeEventType(_l.LAYERS),i.handleLayersChanged_),a?Array.isArray(a)?a=new Co(a.slice(),{unique:!0}):assert("function"==typeof a.getArray,43):a=new Co(void 0,{unique:!0}),i.setLayers(a),i}return vl(LayerGroup,e),LayerGroup.prototype.handleLayerChange_=function(){this.changed()},LayerGroup.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(unlistenByKey),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(listen(t,Mo.ADD,this.handleLayersAdd_,this),listen(t,Mo.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(unlistenByKey);clear(this.listenerKeys_);for(var n=t.getArray(),i=0,r=n.length;i<r;i++){var o=n[i];this.listenerKeys_[getUid(o)]=[listen(o,Wn,this.handleLayerChange_,this),listen(o,Hn.CHANGE,this.handleLayerChange_,this)]}this.changed()},LayerGroup.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[getUid(e)]=[listen(e,Wn,this.handleLayerChange_,this),listen(e,Hn.CHANGE,this.handleLayerChange_,this)],this.changed()},LayerGroup.prototype.handleLayersRemove_=function(t){var e=getUid(t.element);this.listenerKeys_[e].forEach(unlistenByKey),delete this.listenerKeys_[e],this.changed()},LayerGroup.prototype.getLayers=function(){return this.get(_l.LAYERS)},LayerGroup.prototype.setLayers=function(t){this.set(_l.LAYERS,t)},LayerGroup.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},LayerGroup.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));for(var i=this.getLayerState(),r=n,o=e.length;r<o;r++){var a=e[r];a.opacity*=i.opacity,a.visible=a.visible&&i.visible,a.maxResolution=Math.min(a.maxResolution,i.maxResolution),a.minResolution=Math.max(a.minResolution,i.minResolution),a.minZoom=Math.max(a.minZoom,i.minZoom),a.maxZoom=Math.min(a.maxZoom,i.maxZoom),void 0!==i.extent&&(void 0!==a.extent?a.extent=getIntersection(a.extent,i.extent):a.extent=i.extent)}return e},LayerGroup.prototype.getSourceState=function(){return ki.READY},LayerGroup}(xi),Tl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}();function setTouchAction(t,e){t.style.msTouchAction=e,t.style.touchAction=e,t.setAttribute("touch-action",e)}var wl=function(t){function PluggableMap(e){var n=t.call(this)||this,i=function createOptionsInternal(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var n,i,r,o={},a=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new bl({layers:t.layers});o[sl.LAYERGROUP]=a,o[sl.TARGET]=t.target,o[sl.VIEW]=void 0!==t.view?t.view:new gl,void 0!==t.controls&&(Array.isArray(t.controls)?n=new Co(t.controls.slice()):(assert("function"==typeof t.controls.getArray,47),n=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?i=new Co(t.interactions.slice()):(assert("function"==typeof t.interactions.getArray,48),i=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?r=new Co(t.overlays.slice()):(assert("function"==typeof t.overlays.getArray,49),r=t.overlays):r=new Co;return{controls:n,interactions:i,keyboardEventTarget:e,overlays:r,values:o}}(e);n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,n.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:Er,n.postRenderTimeoutHandle_,n.animationDelayKey_,n.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(n),n.coordinateToPixelTransform_=[1,0,0,1,0,0],n.pixelToCoordinateTransform_=[1,0,0,1,0,0],n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=new al(n,e.moveTolerance);var r=n.handleMapBrowserEvent.bind(n);for(var o in el)n.mapBrowserEventHandler_.addEventListener(el[o],r);n.keyboardEventTarget_=i.keyboardEventTarget,n.keyHandlerKeys_=null,n.focusHandlerKeys_=null;var a=n.handleBrowserEvent.bind(n);return n.viewport_.addEventListener(Hn.CONTEXTMENU,a,!1),n.viewport_.addEventListener(Hn.WHEEL,a,!1),n.controls=i.controls||new Co,n.interactions=i.interactions||new Co,n.overlays_=i.overlays,n.overlayIdIndex_={},n.renderer_=null,n.handleResize_,n.postRenderFunctions_=[],n.tileQueue_=new Do(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addEventListener(getChangeEventType(sl.LAYERGROUP),n.handleLayerGroupChanged_),n.addEventListener(getChangeEventType(sl.VIEW),n.handleViewChanged_),n.addEventListener(getChangeEventType(sl.SIZE),n.handleSizeChanged_),n.addEventListener(getChangeEventType(sl.TARGET),n.handleTargetChanged_),n.setProperties(i.values),n.controls.forEach(function(t){t.setMap(this)}.bind(n)),n.controls.addEventListener(Mo.ADD,function(t){t.element.setMap(this)}.bind(n)),n.controls.addEventListener(Mo.REMOVE,function(t){t.element.setMap(null)}.bind(n)),n.interactions.forEach(function(t){t.setMap(this)}.bind(n)),n.interactions.addEventListener(Mo.ADD,function(t){t.element.setMap(this)}.bind(n)),n.interactions.addEventListener(Mo.REMOVE,function(t){t.element.setMap(null)}.bind(n)),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n.overlays_.addEventListener(Mo.ADD,function(t){this.addOverlayInternal_(t.element)}.bind(n)),n.overlays_.addEventListener(Mo.REMOVE,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(n)),n}return Tl(PluggableMap,t),PluggableMap.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},PluggableMap.prototype.addControl=function(t){this.getControls().push(t)},PluggableMap.prototype.addInteraction=function(t){this.getInteractions().push(t)},PluggableMap.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},PluggableMap.prototype.addOverlay=function(t){this.getOverlays().push(t)},PluggableMap.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},PluggableMap.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),this.viewport_.removeEventListener(Hn.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Hn.WHEEL,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(Hn.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},PluggableMap.prototype.forEachFeatureAtPixel=function(t,e,n){if(this.frameState_){var i=this.getCoordinateFromPixelInternal(t),r=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==n.layerFilter?n.layerFilter:TRUE,a=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,r,a,e,null,o,null)}},PluggableMap.prototype.getFeaturesAtPixel=function(t,e){var n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n},PluggableMap.prototype.forEachLayerAtPixel=function(t,e,n){if(this.frameState_){var i=n||{},r=void 0!==i.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=i.layerFilter||TRUE;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,r,e,o)}},PluggableMap.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var n=this.getCoordinateFromPixelInternal(t),i=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:TRUE,r=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,r,o,i,null)},PluggableMap.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},PluggableMap.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},PluggableMap.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),n="changedTouches"in t?t.changedTouches[0]:t;return[n.clientX-e.left,n.clientY-e.top]},PluggableMap.prototype.getTarget=function(){return this.get(sl.TARGET)},PluggableMap.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},PluggableMap.prototype.getCoordinateFromPixel=function(t){return toUserCoordinate(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},PluggableMap.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;return e?apply(e.pixelToCoordinateTransform,t.slice()):null},PluggableMap.prototype.getControls=function(){return this.controls},PluggableMap.prototype.getOverlays=function(){return this.overlays_},PluggableMap.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},PluggableMap.prototype.getInteractions=function(){return this.interactions},PluggableMap.prototype.getLayerGroup=function(){return this.get(sl.LAYERGROUP)},PluggableMap.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},PluggableMap.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var i=t[e].layer.getSource();if(i&&i.loading)return!0}return!1},PluggableMap.prototype.getPixelFromCoordinate=function(t){var e=fromUserCoordinate(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)},PluggableMap.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;return e?apply(e.coordinateToPixelTransform,t.slice(0,2)):null},PluggableMap.prototype.getRenderer=function(){return this.renderer_},PluggableMap.prototype.getSize=function(){return this.get(sl.SIZE)},PluggableMap.prototype.getView=function(){return this.get(sl.VIEW)},PluggableMap.prototype.getViewport=function(){return this.viewport_},PluggableMap.prototype.getOverlayContainer=function(){return this.overlayContainer_},PluggableMap.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},PluggableMap.prototype.getTilePriority=function(t,e,n,i){var r=this.frameState_;if(!(r&&e in r.wantedTiles))return 1/0;if(!r.wantedTiles[e][t.getKey()])return 1/0;var o=r.viewState.center,a=n[0]-o[0],s=n[1]-o[1];return 65536*Math.log(i)+Math.sqrt(a*a+s*s)/i},PluggableMap.prototype.handleBrowserEvent=function(t,e){var n=e||t.type,i=new tl(n,this,t);this.handleMapBrowserEvent(i)},PluggableMap.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){for(var e=t.originalEvent.target;e instanceof HTMLElement;){if(e.parentElement===this.overlayContainerStopEvent_)return;e=e.parentElement}t.frameState=this.frameState_;var n=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var i=n.length-1;i>=0;i--){var r=n[i];if(r.getActive())if(!r.handleEvent(t))break}}},PluggableMap.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var n=this.maxTilesLoading_,i=n;if(t){var r=t.viewHints;if(r[cr]||r[hr]){var o=!Sr&&Date.now()-t.time>8;n=o?0:8,i=o?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,i))}!t||!this.hasListener(Ri)||t.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(Ri,t);for(var a=this.postRenderFunctions_,s=0,l=a.length;s<l;++s)a[s](this,t);a.length=0},PluggableMap.prototype.handleSizeChanged_=function(){this.getView()&&this.getView().resolveConstraints(0),this.render()},PluggableMap.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.focusHandlerKeys_){for(var e=0,n=this.focusHandlerKeys_.length;e<n;++e)unlistenByKey(this.focusHandlerKeys_[e]);this.focusHandlerKeys_=null}if(this.keyHandlerKeys_){for(e=0,n=this.keyHandlerKeys_.length;e<n;++e)unlistenByKey(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer());var i=!0;t.hasAttribute("tabindex")&&(i=document.activeElement===t,this.focusHandlerKeys_=[listen(t,Hn.FOCUS,setTouchAction.bind(this,this.viewport_,"none")),listen(t,Hn.BLUR,setTouchAction.bind(this,this.viewport_,"auto"))]),setTouchAction(this.viewport_,i?"none":"auto");var r=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[listen(r,Hn.KEYDOWN,this.handleBrowserEvent,this),listen(r,Hn.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(Hn.RESIZE,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),removeNode(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(Hn.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},PluggableMap.prototype.handleTileChange_=function(){this.render()},PluggableMap.prototype.handleViewPropertyChanged_=function(){this.render()},PluggableMap.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(unlistenByKey(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(unlistenByKey(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",getUid(t)),this.viewPropertyListenerKey_=listen(t,Wn,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=listen(t,Hn.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},PluggableMap.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[listen(t,Wn,this.render,this),listen(t,Hn.CHANGE,this.render,this)]),this.render()},PluggableMap.prototype.isRendered=function(){return!!this.frameState_},PluggableMap.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},PluggableMap.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}},PluggableMap.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},PluggableMap.prototype.removeControl=function(t){return this.getControls().remove(t)},PluggableMap.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},PluggableMap.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},PluggableMap.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},PluggableMap.prototype.renderFrame_=function(t){var e=this.getSize(),n=this.getView(),i=this.frameState_,r=null;if(void 0!==e&&function hasArea(t){return t[0]>0&&t[1]>0}(e)&&n&&n.isDef()){var o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:i?i.declutterItems:[],extent:getForViewAndSize(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{}}}if(this.frameState_=r,this.renderer_.renderFrame(r),r){if(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),i)(!this.previousExtent_||!isEmpty(this.previousExtent_)&&!equals(r.extent,this.previousExtent_))&&(this.dispatchEvent(new Qs(Ti,this,i)),this.previousExtent_=createOrUpdateEmpty(this.previousExtent_));this.previousExtent_&&!r.viewHints[cr]&&!r.viewHints[hr]&&!equals(r.extent,this.previousExtent_)&&(this.dispatchEvent(new Qs(wi,this,r)),function clone(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}(r.extent,this.previousExtent_))}this.dispatchEvent(new Qs(bi,this,r)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},PluggableMap.prototype.setLayerGroup=function(t){this.set(sl.LAYERGROUP,t)},PluggableMap.prototype.setSize=function(t){this.set(sl.SIZE,t)},PluggableMap.prototype.setTarget=function(t){this.set(sl.TARGET,t)},PluggableMap.prototype.setView=function(t){this.set(sl.VIEW,t)},PluggableMap.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},PluggableMap}(ti);var El=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Sl=function(t){function Attribution(e){var n=this,i=e||{};(n=t.call(this,{element:document.createElement("div"),render:i.render||render$1,target:i.target})||this).ulElement_=document.createElement("ul"),n.collapsed_=void 0===i.collapsed||i.collapsed,n.overrideCollapsible_=void 0!==i.collapsible,n.collapsible_=void 0===i.collapsible||i.collapsible,n.collapsible_||(n.collapsed_=!1);var r=void 0!==i.className?i.className:"ol-attribution",o=void 0!==i.tipLabel?i.tipLabel:"Attributions",a=void 0!==i.collapseLabel?i.collapseLabel:"»";"string"==typeof a?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=a):n.collapseLabel_=a;var s=void 0!==i.label?i.label:"i";"string"==typeof s?(n.label_=document.createElement("span"),n.label_.textContent=s):n.label_=s;var l=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_,u=document.createElement("button");u.setAttribute("type","button"),u.title=o,u.appendChild(l),u.addEventListener(Hn.CLICK,n.handleClick_.bind(n),!1);var c=r+" "+Bi+" "+Zi+(n.collapsed_&&n.collapsible_?" "+Ki:"")+(n.collapsible_?"":" ol-uncollapsible"),h=n.element;return h.className=c,h.appendChild(n.ulElement_),h.appendChild(u),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return El(Attribution,t),Attribution.prototype.collectSourceAttributions_=function(t){for(var e={},n=[],i=t.layerStatesArray,r=0,o=i.length;r<o;++r){var a=i[r];if(inView(a,t.viewState)){var s=a.layer.getSource();if(s){var l=s.getAttributions();if(l){var u=l(t);if(u)if(this.overrideCollapsible_||!1!==s.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(u))for(var c=0,h=u.length;c<h;++c)u[c]in e||(n.push(u[c]),e[u[c]]=!0);else u in e||(n.push(u),e[u]=!0)}}}}return n},Attribution.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!equals$1(e,this.renderedAttributions_)){!function removeChildren(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(var i=0,r=e.length;i<r;++i){var o=document.createElement("li");o.innerHTML=e[i],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},Attribution.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},Attribution.prototype.handleToggle_=function(){this.element.classList.toggle(Ki),this.collapsed_?replaceNode(this.collapseLabel_,this.label_):replaceNode(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},Attribution.prototype.getCollapsible=function(){return this.collapsible_},Attribution.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},Attribution.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},Attribution.prototype.getCollapsed=function(){return this.collapsed_},Attribution}(Si);function render$1(t){this.updateElement_(t.frameState)}var Ml=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Ol=function(t){function Rotate(e){var n=this,i=e||{};n=t.call(this,{element:document.createElement("div"),render:i.render||render$2,target:i.target})||this;var r=void 0!==i.className?i.className:"ol-rotate",o=void 0!==i.label?i.label:"⇧";n.label_=null,"string"==typeof o?(n.label_=document.createElement("span"),n.label_.className="ol-compass",n.label_.textContent=o):(n.label_=o,n.label_.classList.add("ol-compass"));var a=i.tipLabel?i.tipLabel:"Reset rotation",s=document.createElement("button");s.className=r+"-reset",s.setAttribute("type","button"),s.title=a,s.appendChild(n.label_),s.addEventListener(Hn.CLICK,n.handleClick_.bind(n),!1);var l=r+" "+Bi+" "+Zi,u=n.element;return u.className=l,u.appendChild(s),n.callResetNorth_=i.resetNorth?i.resetNorth:void 0,n.duration_=void 0!==i.duration?i.duration:250,n.autoHide_=void 0===i.autoHide||i.autoHide,n.rotation_=void 0,n.autoHide_&&n.element.classList.add(Wi),n}return Ml(Rotate,t),Rotate.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},Rotate.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:easeOut}):t.setRotation(0))},Rotate}(Si);function render$2(t){var e=t.frameState;if(e){var n=e.viewState.rotation;if(n!=this.rotation_){var i="rotate("+n+"rad)";if(this.autoHide_){var r=this.element.classList.contains(Wi);r||0!==n?r&&0!==n&&this.element.classList.remove(Wi):this.element.classList.add(Wi)}this.label_.style.transform=i}this.rotation_=n}}var xl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Pl=function(t){function Zoom(e){var n=this,i=e||{};n=t.call(this,{element:document.createElement("div"),target:i.target})||this;var r=void 0!==i.className?i.className:"ol-zoom",o=void 0!==i.delta?i.delta:1,a=void 0!==i.zoomInLabel?i.zoomInLabel:"+",s=void 0!==i.zoomOutLabel?i.zoomOutLabel:"−",l=void 0!==i.zoomInTipLabel?i.zoomInTipLabel:"Zoom in",u=void 0!==i.zoomOutTipLabel?i.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=r+"-in",c.setAttribute("type","button"),c.title=l,c.appendChild("string"==typeof a?document.createTextNode(a):a),c.addEventListener(Hn.CLICK,n.handleClick_.bind(n,o),!1);var h=document.createElement("button");h.className=r+"-out",h.setAttribute("type","button"),h.title=u,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(Hn.CLICK,n.handleClick_.bind(n,-o),!1);var d=r+" "+Bi+" "+Zi,p=n.element;return p.className=d,p.appendChild(c),p.appendChild(h),n.duration_=void 0!==i.duration?i.duration:250,n}return xl(Zoom,t),Zoom.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},Zoom.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var n=e.getZoom();if(void 0!==n){var i=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:i,duration:this.duration_,easing:easeOut})):e.setZoom(i)}}},Zoom}(Si);function asString(t){return"string"==typeof t?t:function toString$1(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var i=t[2];i!=(0|i)&&(i=i+.5|0);var r=void 0===t[3]?1:t[3];return"rgba("+e+","+n+","+i+","+r+")"}(t)}function getKey$1(t,e,n){return e+":"+t+":"+(n?asString(n):"null")}var Cl=new(function(){function IconImageCache(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return IconImageCache.prototype.clear=function(){this.cache_={},this.cacheSize_=0},IconImageCache.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},IconImageCache.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},IconImageCache.prototype.get=function(t,e,n){var i=getKey$1(t,e,n);return i in this.cache_?this.cache_[i]:null},IconImageCache.prototype.set=function(t,e,n,i){var r=getKey$1(t,e,n);this.cache_[r]=i,++this.cacheSize_},IconImageCache.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},IconImageCache}());var Il=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Ll=function(t){function MapRenderer(e){var n=t.call(this)||this;return n.map_=e,n.declutterTree_=null,n}return Il(MapRenderer,t),MapRenderer.prototype.dispatchRenderEvent=function(t,e){abstract()},MapRenderer.prototype.calculateMatrices2D=function(t){var e=t.viewState,n=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;compose(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),makeInverse(i,n)},MapRenderer.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r,o,a,s){var l,u=e.viewState;function forEachFeatureAtCoordinate(t,e,n){return r.call(o,e,t?n:null)}var c=u.projection,h=t,d=[[0,0]];if(c.canWrapX()){var p=c.getExtent(),f=getWidth(p),m=t[0];if(m<p[0]||m>p[2])h=[m+f*Math.ceil((p[0]-m)/f),t[1]];i&&d.push([-f,0],[f,0])}var y,g=e.layerStatesArray,v=g.length;this.declutterTree_&&(y=this.declutterTree_.all().map((function(t){return t.value})));for(var _=[],b=0;b<d.length;b++)for(var T=v-1;T>=0;--T){var w=g[T],E=w.layer;if(E.hasRenderer()&&inView(w,u)&&a.call(s,E)){var S=E.getRenderer(),M=E.getSource();if(S&&M){var O=M.getWrapX()?h:t,x=forEachFeatureAtCoordinate.bind(null,w.managed);_[0]=O[0]+d[b][0],_[1]=O[1]+d[b][1],l=S.forEachFeatureAtCoordinate(_,e,n,x,y)}if(l)return l}}},MapRenderer.prototype.forEachLayerAtPixel=function(t,e,n,i,r){return abstract()},MapRenderer.prototype.hasFeatureAtCoordinate=function(t,e,n,i,r,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,i,TRUE,this,r,o)},MapRenderer.prototype.getMap=function(){return this.map_},MapRenderer.prototype.renderFrame=function(t){this.declutterTree_=function renderDeclutterItems(t,e){e&&e.clear();for(var n=t.declutterItems,i=n.length-1;i>=0;--i)for(var r=n[i],o=r.items,a=0,s=o.length;a<s;a+=3)e=o[a].renderDeclutter(o[a+1],o[a+2],r.opacity,e);return n.length=0,e}(t,this.declutterTree_)},MapRenderer.prototype.scheduleExpireIconCache=function(t){Cl.canExpireCache()&&t.postRenderFunctions.push(expireIconCache)},MapRenderer}(Bn);function expireIconCache(t,e){Cl.expire()}var Rl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),kl=function(t){function CompositeMapRenderer(e){var n=t.call(this,e)||this;n.labelCacheKey_=listen($i,Hn.CLEAR,e.redrawText.bind(e)),n.element_=document.createElement("div");var i=n.element_.style;i.position="absolute",i.width="100%",i.height="100%",i.zIndex="0",n.element_.className=Bi+" ol-layers";var r=e.getViewport();return r.insertBefore(n.element_,r.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return Rl(CompositeMapRenderer,t),CompositeMapRenderer.prototype.dispatchRenderEvent=function(t,e){var n=this.getMap();if(n.hasListener(t)){var i=new qi(t,void 0,e);n.dispatchEvent(i)}},CompositeMapRenderer.prototype.disposeInternal=function(){unlistenByKey(this.labelCacheKey_),t.prototype.disposeInternal.call(this)},CompositeMapRenderer.prototype.renderFrame=function(e){if(e){this.calculateMatrices2D(e),this.dispatchRenderEvent(Ii,e);var n=e.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),i=e.viewState;this.children_.length=0;for(var r=null,o=0,a=n.length;o<a;++o){var s=n[o];if(e.layerIndex=o,inView(s,i)&&(s.sourceState==ki.READY||s.sourceState==ki.UNDEFINED)){var l=s.layer.render(e,r);l&&l!==r&&(this.children_.push(l),r=l)}}t.prototype.renderFrame.call(this,e),function replaceChildren(t,e){for(var n=t.childNodes,i=0;;++i){var r=n[i],o=e[i];if(!r&&!o)break;r!==o&&(r?o?t.insertBefore(o,r):(t.removeChild(r),--i):t.appendChild(o))}}(this.element_,this.children_),this.dispatchRenderEvent(Li,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},CompositeMapRenderer.prototype.forEachLayerAtPixel=function(t,e,n,i,r){for(var o=e.viewState,a=e.layerStatesArray,s=a.length-1;s>=0;--s){var l=a[s],u=l.layer;if(u.hasRenderer()&&inView(l,o)&&r(u)){var c=u.getRenderer().getDataAtPixel(t,e,n);if(c){var h=i(u,c);if(h)return h}}}},CompositeMapRenderer}(Ll);var Al=function(){function Kinetic(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return Kinetic.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},Kinetic.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},Kinetic.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var n=e-3;n>0&&this.points_[n+2]>t;)n-=3;var i=this.points_[e+2]-this.points_[n+2];if(i<1e3/60)return!1;var r=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/i,this.initialVelocity_>this.minVelocity_},Kinetic.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},Kinetic.prototype.getAngle=function(){return this.angle_},Kinetic}(),Dl="active",jl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Nl=function(t){function Interaction(e){var n=t.call(this)||this;return e.handleEvent&&(n.handleEvent=e.handleEvent),n.map_=null,n.setActive(!0),n}return jl(Interaction,t),Interaction.prototype.getActive=function(){return this.get(Dl)},Interaction.prototype.getMap=function(){return this.map_},Interaction.prototype.handleEvent=function(t){return!0},Interaction.prototype.setActive=function(t){this.set(Dl,t)},Interaction.prototype.setMap=function(t){this.map_=t},Interaction}(ti);function zoomByDelta(t,e,n,i){var r=t.getZoom();if(void 0!==r){var o=t.getConstrainedZoom(r+e),a=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:n,duration:void 0!==i?i:250,easing:easeOut})}}var Fl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Ul=function(t){function DoubleClickZoom(e){var n=t.call(this,{handleEvent:handleEvent})||this,i=e||{};return n.delta_=i.delta?i.delta:1,n.duration_=void 0!==i.duration?i.duration:250,n}return Fl(DoubleClickZoom,t),DoubleClickZoom}(Nl);function handleEvent(t){var e=!1;if(t.type==el.DBLCLICK){var n=t.originalEvent,i=t.map,r=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_;zoomByDelta(i.getView(),o,r,this.duration_),t.preventDefault(),e=!0}return!e}var altShiftKeysOnly=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},focus=function(t){return t.target.getTargetElement()===document.activeElement},Vl=TRUE,mouseActionButton=function(t){var e=t.originalEvent;return 0==e.button&&!(Tr&&wr&&e.ctrlKey)},noModifierKeys=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},shiftKeyOnly=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},targetNotEditable=function(t){var e=t.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},mouseOnly=function(t){var e=t.pointerEvent;return assert(void 0!==e,56),"mouse"==e.pointerType},primaryAction=function(t){var e=t.pointerEvent;return assert(void 0!==e,56),e.isPrimary&&0===e.button},zl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Gl=function(t){function PointerInteraction(e){var n=this,i=e||{};return n=t.call(this,i)||this,i.handleDownEvent&&(n.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(n.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(n.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(n.handleUpEvent=i.handleUpEvent),i.stopDown&&(n.stopDown=i.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return zl(PointerInteraction,t),PointerInteraction.prototype.handleDownEvent=function(t){return!1},PointerInteraction.prototype.handleDragEvent=function(t){},PointerInteraction.prototype.handleEvent=function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==el.POINTERDRAG)this.handleDragEvent(t);else if(t.type==el.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==el.POINTERDOWN){var i=this.handleDownEvent(t);i&&t.preventDefault(),this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==el.POINTERMOVE&&this.handleMoveEvent(t);return!e},PointerInteraction.prototype.handleMoveEvent=function(t){},PointerInteraction.prototype.handleUpEvent=function(t){return!1},PointerInteraction.prototype.stopDown=function(t){return t},PointerInteraction.prototype.updateTrackedPointers_=function(t){if(function isPointerDraggingEvent(t){var e=t.type;return e===el.POINTERDOWN||e===el.POINTERDRAG||e===el.POINTERUP}(t)){var n=t.pointerEvent,i=n.pointerId.toString();t.type==el.POINTERUP?delete this.trackedPointers_[i]:t.type==el.POINTERDOWN?this.trackedPointers_[i]=n:i in this.trackedPointers_&&(this.trackedPointers_[i]=n),this.targetPointers=e(this.trackedPointers_)}},PointerInteraction}(Nl);function centroid(t){for(var e=t.length,n=0,i=0,r=0;r<e;r++)n+=t[r].clientX,i+=t[r].clientY;return[n/e,i/e]}var ql=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Wl=function(t){function DragPan(e){var n=t.call(this,{stopDown:FALSE})||this,i=e||{};return n.kinetic_=i.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1,n.condition_=i.condition?i.condition:defaultCondition,n.noKinetic_=!1,n}return ql(DragPan,t),DragPan.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e=this.targetPointers,n=centroid(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){var i=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],r=t.map.getView();!function scale$1(t,e){return t[0]*=e,t[1]*=e,t}(i,r.getResolution()),rotate(i,r.getRotation()),r.adjustCenterInternal(i)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=e.length},DragPan.prototype.handleUpEvent=function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var i=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),s=e.getCoordinateFromPixelInternal([a[0]-i*Math.cos(r),a[1]-i*Math.sin(r)]);n.animateInternal({center:n.getConstrainedCenter(s),duration:500,easing:easeOut})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},DragPan.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},DragPan}(Gl);function defaultCondition(t){return noModifierKeys(t)&&primaryAction(t)}var Bl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Zl=function(t){function DragRotate(e){var n=this,i=e||{};return(n=t.call(this,{stopDown:FALSE})||this).condition_=i.condition?i.condition:altShiftKeysOnly,n.lastAngle_=void 0,n.duration_=void 0!==i.duration?i.duration:250,n}return Bl(DragRotate,t),DragRotate.prototype.handleDragEvent=function(t){if(mouseOnly(t)){var e=t.map,n=e.getView();if(n.getConstraints().rotation!==disable){var i=e.getSize(),r=t.pixel,o=Math.atan2(i[1]/2-r[1],r[0]-i[0]/2);if(void 0!==this.lastAngle_){var a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}}},DragRotate.prototype.handleUpEvent=function(t){return!mouseOnly(t)||(t.map.getView().endInteraction(this.duration_),!1)},DragRotate.prototype.handleDownEvent=function(t){return!!mouseOnly(t)&&(!(!mouseActionButton(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))},DragRotate}(Gl),Kl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Yl=function(t){function RenderBox(e){var n=t.call(this)||this;return n.geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.className="ol-box "+e,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return Kl(RenderBox,t),RenderBox.prototype.disposeInternal=function(){this.setMap(null)},RenderBox.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,n=this.element_.style;n.left=Math.min(t[0],e[0])+"px",n.top=Math.min(t[1],e[1])+"px",n.width=Math.abs(e[0]-t[0])+"px",n.height=Math.abs(e[1]-t[1])+"px"},RenderBox.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},RenderBox.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},RenderBox.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new fl([n])},RenderBox.prototype.getGeometry=function(){return this.geometry_},RenderBox}(Bn),Hl=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),Xl="boxstart",$l="boxdrag",Ql="boxend",Jl=function(t){function DragBoxEvent(e,n,i){var r=t.call(this,e)||this;return r.coordinate=n,r.mapBrowserEvent=i,r}return Hl(DragBoxEvent,t),DragBoxEvent}(Zn),tu=function(t){function DragBox(e){var n=t.call(this)||this,i=e||{};return n.box_=new Yl(i.className||"ol-dragbox"),n.minArea_=void 0!==i.minArea?i.minArea:64,n.onBoxEnd_=i.onBoxEnd?i.onBoxEnd:VOID,n.startPixel_=null,n.condition_=i.condition?i.condition:Vl,n.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:n.defaultBoxEndCondition,n}return Hl(DragBox,t),DragBox.prototype.defaultBoxEndCondition=function(t,e,n){var i=n[0]-e[0],r=n[1]-e[1];return i*i+r*r>=this.minArea_},DragBox.prototype.getGeometry=function(){return this.box_.getGeometry()},DragBox.prototype.handleDragEvent=function(t){mouseOnly(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Jl($l,t.coordinate,t)))},DragBox.prototype.handleUpEvent=function(t){return!mouseOnly(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new Jl(Ql,t.coordinate,t))),!1)},DragBox.prototype.handleDownEvent=function(t){return!!mouseOnly(t)&&(!(!mouseActionButton(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Jl(Xl,t.coordinate,t)),!0))},DragBox}(Gl),eu=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),nu=function(t){function DragZoom(e){var n=this,i=e||{},r=i.condition?i.condition:shiftKeyOnly;return(n=t.call(this,{condition:r,className:i.className||"ol-dragzoom",minArea:i.minArea,onBoxEnd:onBoxEnd})||this).duration_=void 0!==i.duration?i.duration:200,n.out_=void 0!==i.out&&i.out,n}return eu(DragZoom,t),DragZoom}(tu);function onBoxEnd(){var t=this.getMap(),e=t.getView(),n=t.getSize(),i=this.getGeometry().getExtent();if(this.out_){var r=e.calculateExtentInternal(n),o=createOrUpdateFromCoordinates([t.getPixelFromCoordinateInternal(getBottomLeft(i)),t.getPixelFromCoordinateInternal(getTopRight(i))]);!function scaleFromCenter(t,e){var n=(t[2]-t[0])/2*(e-1),i=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=i,t[3]+=i}(r,1/e.getResolutionForExtentInternal(o,n)),i=r}var a=e.getConstrainedResolution(e.getResolutionForExtentInternal(i,n)),s=e.getConstrainedCenter(getCenter(i),a);e.animateInternal({resolution:a,center:s,duration:this.duration_,easing:easeOut})}var iu={LEFT:37,UP:38,RIGHT:39,DOWN:40},ru=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),ou=function(t){function KeyboardPan(e){var n=t.call(this,{handleEvent:handleEvent$1})||this,i=e||{};return n.defaultCondition_=function(t){return noModifierKeys(t)&&targetNotEditable(t)},n.condition_=void 0!==i.condition?i.condition:n.defaultCondition_,n.duration_=void 0!==i.duration?i.duration:100,n.pixelDelta_=void 0!==i.pixelDelta?i.pixelDelta:128,n}return ru(KeyboardPan,t),KeyboardPan}(Nl);function handleEvent$1(t){var e=!1;if(t.type==Hn.KEYDOWN){var n=t.originalEvent.keyCode;if(this.condition_(t)&&(n==iu.DOWN||n==iu.LEFT||n==iu.RIGHT||n==iu.UP)){var i=t.map.getView(),r=i.getResolution()*this.pixelDelta_,o=0,a=0;n==iu.DOWN?a=-r:n==iu.LEFT?o=-r:n==iu.RIGHT?o=r:a=r;var s=[o,a];rotate(s,i.getRotation()),function pan(t,e,n){var i=t.getCenterInternal();if(i){var r=[i[0]+e[0],i[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:linear,center:t.getConstrainedCenter(r)})}}(i,s,this.duration_),t.preventDefault(),e=!0}}return!e}var au=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),su=function(t){function KeyboardZoom(e){var n=t.call(this,{handleEvent:handleEvent$2})||this,i=e||{};return n.condition_=i.condition?i.condition:targetNotEditable,n.delta_=i.delta?i.delta:1,n.duration_=void 0!==i.duration?i.duration:100,n}return au(KeyboardZoom,t),KeyboardZoom}(Nl);function handleEvent$2(t){var e=!1;if(t.type==Hn.KEYDOWN||t.type==Hn.KEYPRESS){var n=t.originalEvent.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var i=t.map,r=n=="+".charCodeAt(0)?this.delta_:-this.delta_;zoomByDelta(i.getView(),r,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}var lu=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),uu="trackpad",cu="wheel",hu=function(t){function MouseWheelZoom(e){var n=this,i=e||{};return(n=t.call(this,i)||this).totalDelta_=0,n.lastDelta_=0,n.maxDelta_=void 0!==i.maxDelta?i.maxDelta:1,n.duration_=void 0!==i.duration?i.duration:250,n.timeout_=void 0!==i.timeout?i.timeout:80,n.useAnchor_=void 0===i.useAnchor||i.useAnchor,n.condition_=i.condition?i.condition:Vl,n.lastAnchor_=null,n.startTime_=void 0,n.timeoutId_,n.mode_=void 0,n.trackpadEventGap_=400,n.trackpadTimeoutId_,n.trackpadDeltaPerZoom_=300,n}return lu(MouseWheelZoom,t),MouseWheelZoom.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,Math.sign(this.lastDelta_),this.lastAnchor_)},MouseWheelZoom.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;if(t.type!==Hn.WHEEL)return!0;t.preventDefault();var e,n=t.map,i=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==Hn.WHEEL&&(e=i.deltaY,br&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=Er),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var r=Date.now();if(void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?uu:cu),this.mode_===uu){var o=n.getView();return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):o.beginInteraction(),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.trackpadEventGap_),o.adjustZoom(-e/this.trackpadDeltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1}this.totalDelta_+=e;var a=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),a),!1},MouseWheelZoom.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations(),zoomByDelta(e,-clamp(this.totalDelta_,-this.maxDelta_,this.maxDelta_),this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},MouseWheelZoom.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},MouseWheelZoom}(Nl),du=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),pu=function(t){function PinchRotate(e){var n=this,i=e||{},r=i;return r.stopDown||(r.stopDown=FALSE),(n=t.call(this,r)||this).anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=void 0!==i.threshold?i.threshold:.3,n.duration_=void 0!==i.duration?i.duration:250,n}return du(PinchRotate,t),PinchRotate.prototype.handleDragEvent=function(t){var e=0,n=this.targetPointers[0],i=this.targetPointers[1],r=Math.atan2(i.clientY-n.clientY,i.clientX-n.clientX);if(void 0!==this.lastAngle_){var o=r-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=r;var a=t.map,s=a.getView();if(s.getConstraints().rotation!==disable){var l=a.getViewport().getBoundingClientRect(),u=centroid(this.targetPointers);u[0]-=l.left,u[1]-=l.top,this.anchor_=a.getCoordinateFromPixelInternal(u),this.rotating_&&(a.render(),s.adjustRotationInternal(e,this.anchor_))}},PinchRotate.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)},PinchRotate.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},PinchRotate}(Gl),fu=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),mu=function(t){function PinchZoom(e){var n=this,i=e||{},r=i;return r.stopDown||(r.stopDown=FALSE),(n=t.call(this,r)||this).anchor_=null,n.duration_=void 0!==i.duration?i.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return fu(PinchZoom,t),PinchZoom.prototype.handleDragEvent=function(t){var e=1,n=this.targetPointers[0],i=this.targetPointers[1],r=n.clientX-i.clientX,o=n.clientY-i.clientY,a=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var s=t.map,l=s.getView();1!=e&&(this.lastScaleDelta_=e);var u=s.getViewport().getBoundingClientRect(),c=centroid(this.targetPointers);c[0]-=u.left,c[1]-=u.top,this.anchor_=s.getCoordinateFromPixelInternal(c),s.render(),l.adjustResolutionInternal(e,this.anchor_)},PinchZoom.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0},PinchZoom.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},PinchZoom}(Gl);var yu=function(){var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}}(),gu=function(e){function Map(n){return(n=t({},n)).controls||(n.controls=function defaults(t){var e=t||{},n=new Co;return(void 0===e.zoom||e.zoom)&&n.push(new Pl(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&n.push(new Ol(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&n.push(new Sl(e.attributionOptions)),n}()),n.interactions||(n.interactions=function defaults$1(t){var e=t||{},n=new Co,i=new Al(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&n.push(new Zl),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&n.push(new Ul({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&n.push(new Wl({condition:e.onFocusOnly?focus:void 0,kinetic:i})),(void 0===e.pinchRotate||e.pinchRotate)&&n.push(new pu),(void 0===e.pinchZoom||e.pinchZoom)&&n.push(new mu({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(n.push(new ou),n.push(new su({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&n.push(new hu({condition:e.onFocusOnly?focus:void 0,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&n.push(new nu({duration:e.zoomDuration})),n}()),e.call(this,n)||this}return yu(Map,e),Map.prototype.createRenderer=function(){return new kl(this)},Map}(wl),vu=createCommonjsModule((function(t,e){t.exports=function(t,e){t="default"in t?t.default:t;var classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&defineProperties(t.prototype,e),n&&defineProperties(t,n),t}}(),possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},i="layer-switcher-",r=function(t){function LayerSwitcher(t){classCallCheck(this,LayerSwitcher);var e=t||{},n=e.tipLabel?e.tipLabel:"Legend",i=document.createElement("div"),r=possibleConstructorReturn(this,(LayerSwitcher.__proto__||Object.getPrototypeOf(LayerSwitcher)).call(this,{element:i,target:e.target}));r.groupSelectStyle=LayerSwitcher.getGroupSelectStyle(e.groupSelectStyle),r.mapListeners=[],r.hiddenClassName="ol-unselectable ol-control layer-switcher",LayerSwitcher.isTouchDevice_()&&(r.hiddenClassName+=" touch"),r.shownClassName="shown",i.className=r.hiddenClassName;var o=document.createElement("button");o.setAttribute("title",n),i.appendChild(o),r.panel=document.createElement("div"),r.panel.className="panel",i.appendChild(r.panel),LayerSwitcher.enableTouchScroll_(r.panel);var a=r;return o.onmouseover=function(t){a.showPanel()},o.onclick=function(t){t=t||window.event,a.showPanel(),t.preventDefault()},a.panel.onmouseout=function(t){t=t||window.event,a.panel.contains(t.toElement||t.relatedTarget)||a.hidePanel()},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(LayerSwitcher,t),n(LayerSwitcher,[{key:"setMap",value:function setMap(t){for(var n=0;n<this.mapListeners.length;n++)e.unByKey(this.mapListeners[n]);if(this.mapListeners.length=0,function get(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:get(r,e,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0}(LayerSwitcher.prototype.__proto__||Object.getPrototypeOf(LayerSwitcher.prototype),"setMap",this).call(this,t),t){var i=this;this.mapListeners.push(t.on("pointerdown",(function(){i.hidePanel()}))),this.renderPanel()}}},{key:"showPanel",value:function showPanel(){this.element.classList.contains(this.shownClassName)||(this.element.classList.add(this.shownClassName),this.renderPanel())}},{key:"hidePanel",value:function hidePanel(){this.element.classList.contains(this.shownClassName)&&this.element.classList.remove(this.shownClassName)}},{key:"renderPanel",value:function renderPanel(){LayerSwitcher.renderPanel(this.getMap(),this.panel,{groupSelectStyle:this.groupSelectStyle})}}],[{key:"renderPanel",value:function renderPanel(t,e,n){for((n=n||{}).groupSelectStyle=LayerSwitcher.getGroupSelectStyle(n.groupSelectStyle),LayerSwitcher.ensureTopVisibleBaseLayerShown_(t);e.firstChild;)e.removeChild(e.firstChild);LayerSwitcher.forEachRecursive(t,(function(t,e,n){t.set("indeterminate",!1)})),"children"===n.groupSelectStyle||"none"===n.groupSelectStyle?LayerSwitcher.setGroupVisibility(t):"group"===n.groupSelectStyle&&LayerSwitcher.setChildVisibility(t);var i=document.createElement("ul");e.appendChild(i),LayerSwitcher.renderLayers_(t,t,i,n,(function render(i){LayerSwitcher.renderPanel(t,e,n)}))}},{key:"isBaseGroup",value:function isBaseGroup(t){var e=t.getLayers?t.getLayers().getArray():[];return e.length&&"base"===e[0].get("type")}},{key:"setGroupVisibility",value:function setGroupVisibility(t){LayerSwitcher.getGroupsAndLayers(t,(function(t){return t.getLayers&&!t.get("combine")&&!LayerSwitcher.isBaseGroup(t)})).reverse().forEach((function(t){var e=t.getLayersArray().map((function(t){return t.getVisible()}));e.every((function(t){return!0===t}))?(t.setVisible(!0),t.set("indeterminate",!1)):e.every((function(t){return!1===t}))?(t.setVisible(!1),t.set("indeterminate",!1)):(t.setVisible(!0),t.set("indeterminate",!0))}))}},{key:"setChildVisibility",value:function setChildVisibility(t){LayerSwitcher.getGroupsAndLayers(t,(function(t){return t.getLayers&&!t.get("combine")&&!LayerSwitcher.isBaseGroup(t)})).forEach((function(t){var e=t.getVisible(),n=t.get("indeterminate");t.getLayers().getArray().forEach((function(t){t.set("indeterminate",!1),e&&!n||!t.getVisible()||t.set("indeterminate",!0)}))}))}},{key:"ensureTopVisibleBaseLayerShown_",value:function ensureTopVisibleBaseLayerShown_(t){var e;LayerSwitcher.forEachRecursive(t,(function(t,n,i){"base"===t.get("type")&&t.getVisible()&&(e=t)})),e&&LayerSwitcher.setVisible_(t,e,!0)}},{key:"getGroupsAndLayers",value:function getGroupsAndLayers(t,e){var n=[];return e=e||function(t,e,n){return!0},LayerSwitcher.forEachRecursive(t,(function(t,i,r){t.get("title")&&e(t,i,r)&&n.push(t)})),n}},{key:"setVisible_",value:function setVisible_(t,e,n,i){e.setVisible(n),n&&"base"===e.get("type")&&LayerSwitcher.forEachRecursive(t,(function(t,n,i){t!=e&&"base"===t.get("type")&&t.setVisible(!1)})),e.getLayers&&!e.get("combine")&&"children"===i&&e.getLayers().forEach((function(n){LayerSwitcher.setVisible_(t,n,e.getVisible(),i)}))}},{key:"renderLayer_",value:function renderLayer_(t,e,n,r,o){var a=document.createElement("li"),s=e.get("title"),l=LayerSwitcher.uuid(),u=document.createElement("label");if(e.getLayers&&!e.get("combine")){var c=LayerSwitcher.isBaseGroup(e);if(a.classList.add("group"),c&&a.classList.add(i+"base-group"),e.get("fold")){a.classList.add(i+"fold"),a.classList.add(i+e.get("fold"));var h=document.createElement("button");h.onclick=function(t){LayerSwitcher.toggleFold_(e,a)},a.appendChild(h)}if(!c&&"none"!=r.groupSelectStyle){var d=document.createElement("input");d.type="checkbox",d.id=l,d.checked=e.getVisible(),d.indeterminate=e.get("indeterminate"),d.onchange=function(n){LayerSwitcher.setVisible_(t,e,n.target.checked,r.groupSelectStyle),o(e)},a.appendChild(d),u.htmlFor=l}u.innerHTML=s,a.appendChild(u);var p=document.createElement("ul");a.appendChild(p),LayerSwitcher.renderLayers_(t,e,p,r,o)}else{a.className="layer";var f=document.createElement("input");"base"===e.get("type")?(f.type="radio",f.name="base"):f.type="checkbox",f.id=l,f.checked=e.get("visible"),f.indeterminate=e.get("indeterminate"),f.onchange=function(n){LayerSwitcher.setVisible_(t,e,n.target.checked,r.groupSelectStyle),o(e)},a.appendChild(f),u.htmlFor=l,u.innerHTML=s;var m=t.getView().getResolution();(m>e.getMaxResolution()||m<e.getMinResolution())&&(u.className+=" disabled"),a.appendChild(u)}return a}},{key:"renderLayers_",value:function renderLayers_(t,e,n,i,r){for(var o,a=e.getLayers().getArray().slice().reverse(),s=0;s<a.length;s++)(o=a[s]).get("title")&&n.appendChild(LayerSwitcher.renderLayer_(t,o,s,i,r))}},{key:"forEachRecursive",value:function forEachRecursive(t,e){t.getLayers().forEach((function(t,n,i){e(t,n,i),t.getLayers&&LayerSwitcher.forEachRecursive(t,e)}))}},{key:"uuid",value:function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}},{key:"enableTouchScroll_",value:function enableTouchScroll_(t){if(LayerSwitcher.isTouchDevice_()){var e=0;t.addEventListener("touchstart",(function(t){e=this.scrollTop+t.touches[0].pageY}),!1),t.addEventListener("touchmove",(function(t){this.scrollTop=e-t.touches[0].pageY}),!1)}}},{key:"isTouchDevice_",value:function isTouchDevice_(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}},{key:"toggleFold_",value:function toggleFold_(t,e){e.classList.remove(i+t.get("fold")),t.set("fold","open"===t.get("fold")?"close":"open"),e.classList.add(i+t.get("fold"))}},{key:"getGroupSelectStyle",value:function getGroupSelectStyle(t){return["none","children","group"].indexOf(t)>=0?t:"children"}}]),LayerSwitcher}(t);return window.ol&&window.ol.control&&(window.ol.control.LayerSwitcher=r),r}(Si,$n)})),_u=createCommonjsModule((function(t,e){
/** @license
     * element-visibility-watcher <Prathap Reddy (svap.reddy@hotmail.com)>
     * Date: 2019-03-05
     * License: Apache-2.0
     * 
     * Bundled dependencies (npm packages): 
     * {"package":"intersection-observer@0.5.1","license":"W3C-20150513","link":"https://github.com/w3c/IntersectionObserver#readme"}
    */
t.exports=function(){!function(r,o){function a(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,i=this.intersectionRect,r=i.width*i.height;this.intersectionRatio=n?Number((r/n).toFixed(4)):this.isIntersecting?1:0}function t(t,e){var n,i,r,o=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(o.root&&1!=o.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),i=this.THROTTLE_TIMEOUT,r=null,function(){r||(r=setTimeout((function(){n(),r=null}),i))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(o.rootMargin),this.thresholds=this._initThresholds(o.threshold),this.root=o.root||null,this.rootMargin=this._rootMarginValues.map((function(t){return t.value+t.unit})).join(" ")}function e(t,e,n,i){"function"==typeof t.addEventListener?t.addEventListener(e,n,i||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function n(t,e,n,i){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,i||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function b(t){var e;try{e=t.getBoundingClientRect()}catch(t){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function i(t,e){for(var n=e;n;){if(n==t)return!0;n=m(n)}return!1}function m(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e}"IntersectionObserver"in r&&"IntersectionObserverEntry"in r&&"intersectionRatio"in r.IntersectionObserverEntry.prototype?"isIntersecting"in r.IntersectionObserverEntry.prototype||Object.defineProperty(r.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}}):(t.prototype.THROTTLE_TIMEOUT=100,t.prototype.POLL_INTERVAL=null,t.prototype.USE_MUTATION_OBSERVER=!0,t.prototype.observe=function(t){if(!this._observationTargets.some((function(e){return e.element==t}))){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},t.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter((function(e){return e.element!=t})),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},t.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},t.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},t.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter((function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||1<t)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]}))},t.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map((function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}}));return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},t.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(e(r,"resize",this._checkForIntersections,!0),e(o,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in r&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(o,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},t.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,n(r,"resize",this._checkForIntersections,!0),n(o,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},t.prototype._checkForIntersections=function(){var t=this._rootIsInDom(),e=t?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(n){var i=n.element,o=b(i),s=this._rootContainsTarget(i),l=n.entry,u=t&&s&&this._computeTargetAndRootIntersection(i,e),c=n.entry=new a({time:r.performance&&performance.now&&performance.now(),target:i,boundingClientRect:o,rootBounds:e,intersectionRect:u});l?t&&s?this._hasCrossedThreshold(l,c)&&this._queuedEntries.push(c):l&&l.isIntersecting&&this._queuedEntries.push(c):this._queuedEntries.push(c)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},t.prototype._computeTargetAndRootIntersection=function(t,e){if("none"!=r.getComputedStyle(t).display){for(var n,i,a,s,l,u,c,h,d=b(t),p=m(t),f=!1;!f;){var y=null,g=1==p.nodeType?r.getComputedStyle(p):{};if("none"==g.display)return;if(p==this.root||p==o?(f=!0,y=e):p!=o.body&&p!=o.documentElement&&"visible"!=g.overflow&&(y=b(p)),y&&(n=y,i=d,a=Math.max(n.top,i.top),s=Math.min(n.bottom,i.bottom),l=Math.max(n.left,i.left),h=s-a,!(d=0<=(c=(u=Math.min(n.right,i.right))-l)&&0<=h&&{top:a,bottom:s,left:l,right:u,width:c,height:h})))break;p=m(p)}return d}},t.prototype._getRootRect=function(){var t;if(this.root)t=b(this.root);else{var e=o.documentElement,n=o.body;t={top:0,left:0,right:e.clientWidth||n.clientWidth,width:e.clientWidth||n.clientWidth,bottom:e.clientHeight||n.clientHeight,height:e.clientHeight||n.clientHeight}}return this._expandRectByRootMargin(t)},t.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map((function(e,n){return"px"==e.unit?e.value:e.value*(n%2?t.width:t.height)/100})),n={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},t.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,i=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==i)for(var r=0;r<this.thresholds.length;r++){var o=this.thresholds[r];if(o==n||o==i||o<n!=o<i)return!0}},t.prototype._rootIsInDom=function(){return!this.root||i(o,this.root)},t.prototype._rootContainsTarget=function(t){return i(this.root||o,t)},t.prototype._registerInstance=function(){},t.prototype._unregisterInstance=function(){},r.IntersectionObserver=t,r.IntersectionObserverEntry=a)}(window,document);var t=function(t){void 0===t&&(t={}),this.observerOptions=Object.assign({root:null,rootMargin:"0px",threshold:.01},t),this.visibleElementsStack=[],this.observingElements=[],this.observingElementsCallbacks=[],this.initialize()};t.prototype.triggerCallbacks=function(t,e){var n=this.observingElements,i=this.observingElementsCallbacks,r=t.map((function(t){return t.target})),o=e.map((function(t){return t.target}));n.forEach((function(e,n){var a,s,l=r.indexOf(e),u=o.indexOf(e);-1<l&&(a=!0,s=t[l]),-1<u&&(a=!1,s=t[u]),void 0!==a&&i[n](a,s)}))},t.prototype.observerCallback=function(t){var e=this,n=[],i=[];t.forEach((function(t){var r=t.target,o=e.visibleElementsStack.indexOf(r);t.isIntersecting?-1===o&&(i.push(t),e.visibleElementsStack.push(t.target)):-1<o&&(n.push(t),e.visibleElementsStack.splice(o,1))})),this.triggerCallbacks(i,n)},t.prototype.initialize=function(){var t=this.observerCallback.bind(this);this.visibilityObserver=new window.IntersectionObserver(t,this.observerOptions)},t.prototype.watch=function(t,e){t&&e&&(this.observingElements.push(t),this.observingElementsCallbacks.push(e),this.visibilityObserver.observe(t))},t.prototype.unwatch=function(t){var e=this.observingElements.indexOf(t);-1<e&&(this.observingElements.splice(e,1),this.observingElementsCallbacks.splice(e,1))};var e=new t;return window.Ractive&&window.Ractive.events&&!window.Ractive.events.viewport&&(window.Ractive.events.viewport=function(t,n){return e.watch(t,(function(e,i){n({node:t,original:{visible:e,intersectionData:i}})})),{teardown:function(){e.unwatch(t)}}}),t}()}));class MetOClient extends ti{constructor(e={}){super(),j.defs("EPSG:3067","+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),register(j),this.config_=t(En,e),null==e.target&&null!=e.container&&(this.config_.target=e.container),this.set("options",e,!0),this.set("map",null),this.timeSlider_=null,this.status_={},this.delay_=null!=e.refreshInterval&&e.refreshInterval<=Number.MAX_SAFE_INTEGER&&e.refreshInterval>=0?e.refreshInterval:Ge,this.periodDelay_=2*Ge,this.times_=[],this.playingListener_=null,this.nextListener_=null,this.previousListener_=null,this.renderComplete_=!1,this.updateNeeded_=!1,this.waitingRender_=0,this.refreshInterval_=e.refreshInterval?Math.min(Duration.fromISO(e.refreshInterval).valueOf(),Ne):vn,this.capabilities_={},this.legends_={},this.selectedLegend_=xn,this.layerSwitcherWatcher=null,this.on("change:options",()=>{this.config_=t(En,this.get("options")),this.refresh()})}render(){return this.updateCapabilities_().then(()=>{this.updateTimes_();let t=this.times_[0];const e=Date.now();this.times_.some(n=>{const i=n>e;return i||(t=n),i}),null==this.config_.time&&(this.config_.time=t),this.config_.time<this.times_[0]&&(this.config_.time=this.times_[0]);let n=this.times_.length-1;this.config_.time>this.times_[n]&&(this.config_.time=this.times_[n]),Object.keys(this.config_.sources).forEach(e=>{null!=this.config_.sources[e].times&&this.config_.sources[e].times.length>0&&(this.config_.sources[e].tiles=function updateSourceTime(t,e){return t.map(t=>{const n=new N(t);let i="time";for(let t in n.query)n.query.hasOwnProperty(t)&&"time"===t.toLocaleLowerCase()&&(i=t);return null!=e?n.query[i]="number"==typeof e?new Date(e).toISOString():e:delete n.query[i],n.toString()})}(this.config_.sources[e].tiles,this.config_.sources[e].times.includes(t)?t:this.config_.sources[e].times[0]))}),this.updateMap_()}).catch(t=>{console.log(t)})}refresh_(){const t=this.get("map");if(null!=t){t.getLayers().getArray().forEach(t=>{let e=t.getSource();null!=e.get(Mn)&&e.set(Mn,null)})}this.render()}async updateCapabilities_(){let t=Date.now(),e=await Promise.all(this.config_.layers.reduce((e,n)=>{if(null==n.source)return e;let i=[n.source];return null==n.time||null==n.time.source||i.includes(n.time.source)||i.push(n.time.source),i.forEach(i=>{let r=this.config_.sources[i];if(null==r)return;let o="";if(null!=r.capabilities&&r.capabilities.length>0)o=r.capabilities;else{if(null==r.tiles||0===r.tiles.length)return;o=r.tiles[0]}o.endsWith("/")&&(o=o.substring(0,o.length-1));const a=o.lastIndexOf("/");let s="";s=o.toLowerCase().startsWith("http")&&a>=0?o.substring(a+1).toLowerCase():n.url.service.toLowerCase(),null==this.capabilities_[o]&&(this.capabilities_[o]={updated:null,type:s,data:null}),this.capabilities_[o].updated!==t&&(e.push(o+`?service=${s}&${wn}`),this.capabilities_[o].updated=t)}),e},[]).map(t=>Xs({url:t,crossDomain:!0,contentType:"text/plain",beforeSend:function(e){e.requestURL=t}})));await Promise.all(e.map(t=>{if(null!=t.responseText&&t.requestURL.endsWith(wn)){let e=t.requestURL.split("?")[0];const n=e.split("/");let i="";n.length>0&&(i=n[n.length-1]),i.length>0&&null!=this.capabilities_[i]&&(e=i),"function"==typeof CapabilitiesReader[this.capabilities_[e].type]&&(this.capabilities_[e].data=CapabilitiesReader[this.capabilities_[e].type](t.responseText))}}))}isTiledLayer_(t){if(null==t||null==t.source)return!1;if(null!=t.url&&"string"==typeof t.url.service&&"wmts"===t.url.service.toLowerCase())return!0;const e=this.config_.sources[t.source];if("OSM"===e.type)return!0;if(null==e||null==e.tiles)return!1;let n=Array.isArray(e.tileSize)?e.tileSize.map(t=>Number(t)>0):new Array(2).fill(Number(e.tileSize)>0);if(Array.isArray(e.tiles)){const t=new N(e.tiles[0].toLowerCase());n=["width","height"].map((e,i)=>null!=t.query&&void 0!==t.query[e]&&Number(t.query[e])>0||n[i])}return null!=t.url&&["width","height"].forEach((e,i)=>{void 0!==t.url[e]&&(n[i]=Number(t.url[e])>0)}),n.every(Boolean)}isAnimationLayer_(t){return null!=t.get("times")&&!t.get("id").startsWith("metoclient:")}createLayer_(t,e=this.config_.time,n=""){const i=this.isTiledLayer_(t)?"tiled":"image",r=this.config_.sources[t.source],o=null!=t.time&&null!=t.time.data,a=n.length>0;if(a&&!o)return null;let s={...this.config_};o&&(s.time=e,t.time.data.includes(s.time)||(s.time=t.time.data.reduce((t,e)=>(e<this.config_.time&&e>t&&(t=e),t),t.time.data[0])));const l=null!=r.tiles?r.tiles[0]:null,u=null!=r.capabilities&&r.capabilities.length>0?r.capabilities:l,c=LayerCreator[i](t,s,null!=u?this.capabilities_[u]:null);if(null!=c){c.on("change:visible",t=>{const e=c.getVisible();if(["previous","next"].forEach(t=>{this.setRelativesVisible_(c,t,e);const n=c.get("metoclient:previous");null!=n&&n.setVisible(e);const i=c.get("metoclient:next");null!=i&&i.setVisible(e)}),this.isAnimationLayer_(c)){if(!this.isVisibleTime_(this.config_.time)){const t=this.getNextTime_(),e=this.getPrevTime_(),n=Math.abs(t-this.config_.time)<Math.abs(this.config_.time-e)?t:e;null!=n&&this.get("map").set("time",n)}this.updateTimeSlider_()}}),o&&c.set("times",t.time.data),c.set("displayInLayerSwitcher",!a),c.set("metoclient:opacity",null!=t.opacity?t.opacity:1);const e=c.get("id");if(c.set("metoclient:id",e),a)c.set("id","metoclient:"+e+n),c.set("title",""),this.hideLayer_(c);else{const t=c.get("previous"),e=null!=t&&t.length>0?this.config_.layers.find(e=>e.id===t):null;(null!=e&&null!=e.time?e.time.data:[]).includes(this.config_.time)&&this.hideLayer_(c)}}return c}createLayerSwitcherTitle_(t){let e=t.metadata.title,n=this.config_.layers;const i=t.next,r=null!=i&&i.length>0?n.find(t=>t.id===i):null;let o=null!=r?this.createLayerSwitcherTitle_(r):"";return null!=o&&o.length>0&&e!==o&&(e+=" / "+o),t.metadata.title="",e}setRelativesVisible_(t,e,n){let i=t.get(e),r=this.get("map").getLayers().getArray();const o=null!=i&&i.length>0?r.find(t=>t.get("id")===i):null;if(null!=o){o.setVisible(n),this.setRelativesVisible_(o,e,n);let t=o.get("metoclient:previous");null!=t&&t.setVisible(n);let i=o.get("metoclient:next");null!=i&&i.setVisible(n)}}createLayers_(){const t=this.config_.layers.reduce((t,e)=>t+(null!=e.metadata&&null!=e.metadata.type&&"base"===e.metadata.type.toLowerCase()),0);let e=new Co(this.config_.layers.map(t=>(null!=t.time&&null!=t.metadata&&null!=t.metadata.title&&(t.legendTitle=t.metadata.title),t)).reduce((e,n)=>{if(null==n.time||null!=n.previous&&0!==n.previous.length||null==n.metadata||null==n.metadata.title||(n.metadata.title=this.createLayerSwitcherTitle_(n)),null!=n.url&&(n.url=Object.keys(n.url).reduce((t,e)=>(t[e.toLowerCase()]=n.url[e],t),{})),null==n.source||null!=n.url&&("string"!=typeof n.url.service||0===n.url.service.length))return e;1===t&&null!=n.metadata&&null!=n.metadata.type&&"base"===n.metadata.type.toLowerCase()&&(n.metadata.title="");const i=this.createLayer_(n);return null!=i&&e.push(i),e},[]));return e.getArray().forEach((t,n,i)=>{const r=t.get("metoclient:opacity");if(null==t.get("times"))e.item(n).setOpacity(r);else{if(t.getSource().get("metoclient:time")===this.config_.time){const o=t.get("previous");if(null!=o&&o.length>0){i.find(t=>t.get("id")===o).get("times").includes(this.config_.time)||e.item(n).setOpacity(r)}}}}),e}setVisible_(t,e){e?this.showLayer_(t):this.hideLayer_(t)}showLayer_(t){let e=t.get("metoclient:opacity");null==e&&(e=1),t.setOpacity(e)}hideLayer_(t){t.setOpacity(0)}createView_(){let t={...this.config_};return delete t.sources,delete t.layers,new gl(t)}isVisibleTime_(t){return this.get("map").getLayers().getArray().some(e=>e.getVisible()&&null!=e.get("times")&&e.get("times").includes(t))}updateTimeSlider_(){this.timeSlider_.updateTimeLoaderVis(this.times_.map(t=>({endTime:t,status:this.status_[t],active:this.isVisibleTime_(t)})))}currentTimeRendered_(t){let e=this.get("map");if(null==e)return;let n=e.getLayers().getArray();if(n.forEach(t=>{const e=t.get("times");let i=null==e||!Array.isArray(e)||0===e.length;if(!i){let e=t.getSource();const r=this.getVisibleTime_(t);if(e.get("metoclient:time")===r){i=!0;const e=t.get("previous"),r=null!=e&&e.length>0?n.find(t=>t.get("id")===e):null;if(null!=r){const t=r.get("times");t[t.length-1]>=this.config_.time&&(i=!1)}}}this.setVisible_(t,i)}),this.status_[this.config_.time]=ze,this.updateTimeSlider_(),this.updateNeeded_)this.updateNeeded_=!1,this.renderComplete_=!0,this.timeUpdated_();else if(null!=this.config_.time){const t=this.getPrevTime_(),i=this.getNextTime_();n.filter(t=>{const e=t.get("times");return!(null==e||!Array.isArray(e)||0===e.length)&&!t.get("id").startsWith("metoclient:")}).forEach(n=>{let r=n.get("id"),o=this.config_.layers.find(t=>t.id===r),a=!1,s=!1;const l=n.get("times");let u,c;const h=n.get("previous"),d=n.get("next");e.get("playing")||t<l[0]&&null!=h&&h.length>0?a=!0:(u=l.includes(t)?t:l.reduce((e,n)=>n<t&&t-n<e?n:e,Number.POSITIVE_INFINITY))>t&&(u=Math.max(...l)),i>l[l.length-1]&&null!=d&&d.length>0?s=!0:(c=l.includes(i)?i:l.reduce((t,e)=>e>i&&i-e>t?e:t,Number.NEGATIVE_INFINITY))<i&&(c=Math.min(...l));let p=e.getLayers(),f=n.get("metoclient:previous");if(null==f&&null!=o&&null!=u){(f=this.createLayer_(o,u,"-previous")).setVisible(n.getVisible());let t=p.getArray().findIndex(t=>t.get("metoclient:id")===n.get("metoclient:id"));p.insertAt(t,f),n.set("metoclient:previous",f)}if(!a&&null!=f){const t=f.getSource();t.get("metoclient:time")!==u&&(this.hideLayer_(f),SourceUpdater[t.constructor.name](t,u))}let m=n.get("metoclient:next");if(null==m&&null!=o&&null!=c){(m=this.createLayer_(o,c,"-next")).setVisible(n.getVisible());let t=p.getArray().findIndex(t=>t.get("metoclient:id")===n.get("metoclient:id"));p.insertAt(t,m),n.set("metoclient:next",m)}if(!s&&null!=m){const t=m.getSource();t.get("metoclient:time")!==c&&(this.hideLayer_(m),SourceUpdater[t.constructor.name](t,c))}}),e.renderSync(),e.once("rendercomplete",t=>{this.renderComplete_=!0,this.updateNeeded_?(this.updateNeeded_=!1,this.timeUpdated_()):this.waitingRender_>0&&timeout$1(this.animate_.bind(this),Math.max(this.delay_-(Date.now()-this.waitingRender_),0))})}}getLayerSwitcher_(){const t=this.get("map");if(null==t)return null;const e=t.getControls();return null==e?null:e.getArray().find(t=>null!=t.constructor&&"LayerSwitcher"===t.constructor.name)}getVisibleTime_(t){let e=null;const n=t.get("times");return null!=n&&Array.isArray(n)&&n.length>0&&this.config_.time>=n[0]&&n.some(t=>{const n=t>=this.config_.time;return n&&(e=t),n}),e}timeUpdated_(){if(!this.renderComplete_){let t=this.get("map").get("time");return this.status_[t]!==ze&&(this.status_[t]=Ve,this.updateTimeSlider_()),void(this.updateNeeded_=!0)}this.get("map").once("rendercomplete",this.currentTimeRendered_.bind(this)),this.status_[this.config_.time]=ze,this.config_.time=this.get("map").get("time"),this.status_[this.config_.time]=Ve,Object.keys(this.status_).forEach(t=>{Number(t)!==this.config_.time&&this.status_[t]===Ve&&(this.status_[t]="")}),this.updateTimeSlider_();const t=this.get("map").getLayers().getArray();t.filter(e=>{const n=e.get("times");if(null==n||!Array.isArray(n)||0===n.length)return!1;if(this.config_.time<n[0]||this.config_.time>n[n.length-1])return this.hideLayer_(e),!1;const i=e.get("previous"),r=null!=i&&i.length>0?t.find(t=>t.get("id")===i):null;return(null!=r?r.get("times"):[]).includes(this.config_.time)?(this.hideLayer_(e),!1):!e.get("id").startsWith("metoclient:")}).forEach(t=>{const e=t.getSource();let n=this.getVisibleTime_(t);if(e.get("metoclient:time")===n){let e=t.get("metoclient:previous");null!=e?this.hideLayer_(e):(this.status_[this.config_.time]=ze,this.updateTimeSlider_());let n=t.get("metoclient:next");null!=n&&this.hideLayer_(n),this.showLayer_(t)}else{let i=t.get("metoclient:previous"),r=t.get("metoclient:next");if(null!=i){let e=i.getSource();if(null!=e&&e.get("metoclient:time")===n){this.hideLayer_(t),this.showLayer_(i);const e=t.get("metoclient:id");return t.set("id","metoclient:"+e+"-next"),i.set("id",e),null!=r&&r.set("id","metoclient:"+e+"-previous"),i.set("metoclient:previous",r),i.set("metoclient:next",t),i.set("title",t.get("title")),t.set("metoclient:next",i),void t.set("title","")}}if(null!=r){let e=r.getSource();if(null!=e){if(e.get("metoclient:time")===n){this.hideLayer_(t),this.showLayer_(r);const e=t.get("metoclient:id");return t.set("id","metoclient:"+e+"-previous"),r.set("id",e),null!=i&&i.set("id","metoclient:"+e+"-next"),r.set("metoclient:previous",t),r.set("metoclient:next",i),r.set("title",t.get("title")),t.set("metoclient:previous",r),void t.set("title","")}const o=t.get("metoclient:id");return t.set("id","metoclient:"+o+"-previous"),r.set("id",o),null!=i&&i.set("id","metoclient:"+o+"-next"),r.set("metoclient:previous",t),r.set("metoclient:next",i),r.set("title",t.get("title")),t.set("metoclient:previous",r),t.set("title",""),void SourceUpdater[e.constructor.name](e,n)}}SourceUpdater[e.constructor.name](e,this.config_.time)}}),this.renderComplete_=!1,this.get("map").renderSync()}updateTimeListener_(){this.timeListener_=this.get("map").on("change:time",this.timeUpdated_.bind(this))}getLayerSwitcherPanel_(){return document.querySelector("div#"+Pn+" div.panel")}createLegendChooser_(){const t=this.getLayerSwitcherPanel_();if(null==t)return;let e=document.getElementById(Cn);if(null!=e)return;(e=document.createElement("div")).setAttribute("id",Cn);const n=document.createElement("label");n.setAttribute("id",In),n.setAttribute("for",Ln),n.innerHTML=this.config_.texts.Legend,e.appendChild(n);const i=document.createElement("select");i.setAttribute("id",Ln),Object.keys(this.legends_).forEach(t=>{const e=document.createElement("option");e.value=t,e.text=this.legends_[t].title,i.appendChild(e)}),i.value=this.selectedLegend_,i.addEventListener("change",t=>{const e=i.options[i.selectedIndex];this.selectedLegend_=e.value;const n=document.getElementById(Rn);if(null!=n){for(;n.firstChild;)n.removeChild(n.firstChild);const t=this.legends_[e.value].url;if(null!=t&&t.length>0){const i=document.createElement("figure"),r=document.createElement("figcaption");r.innerHTML=e.text,i.appendChild(r);const o=document.createElement("img");o.setAttribute("src",t),i.appendChild(o),n.appendChild(i)}}}),e.appendChild(i),t.appendChild(e);const r=t.querySelector("ul");null!=r&&r.addEventListener("change",t=>{this.createLegendChooser_()})}createLayerSwitcherWatcher_(){if(null!=this.layerSwitcherWatcher)return;const t=this.getLayerSwitcherPanel_();null!=t&&(this.layerSwitcherWatcher=new _u,this.layerSwitcherWatcher.watch(t,t=>{t&&this.createLegendChooser_()}))}createLegendContainer_(){let t=document.getElementById(this.config_.target);if(null!=t){let e=document.createElement("div");e.setAttribute("id",Rn),t.appendChild(e)}}createLegends_(){const t=this.get("map");if(null==t)return;if(null==t.getView())return;const e=t.getLayers();this.legends_=e.getArray().filter(t=>this.isAnimationLayer_(t)).reduce((t,e)=>{const n=e.getSource();if(null!=n&&"function"==typeof n.getLegendUrl){const i=n.getLegendUrl();t[e.get("id")]={title:e.get("legendTitle"),url:i}}return t},{[xn]:{title:"",url:null}}),Object.entries(this.legends_).length>0&&(this.createLegendContainer_(),this.createLayerSwitcherWatcher_())}createMap_(){this.timeSlider_=new TimeSlider({locale:"fi-FI",showTimeSlider:!0,timeZone:this.config_.timeZone,timeZoneLabel:this.config_.timeZoneLabel});let t=new gu({target:this.config_.target,layers:this.createLayers_(),view:this.createView_(),controls:[new Pl({zoomInTipLabel:this.config_.texts["Zoom In"],zoomOutTipLabel:this.config_.texts["Zoom Out"]}),this.timeSlider_],interactions:[new Ul,new Wl,new mu,new ou,new su]});this.set("map",t),t.addControl(new vu);const e=document.querySelector("div#"+this.config_.target+" div.layer-switcher");if(null!=e){e.setAttribute("id",Pn);const t=e.querySelector("button");null!=t&&(t.onmouseover=()=>{});const n=this.getLayerSwitcherPanel_();null!=n&&(n.onmouseout=()=>{})}this.createLegends_(),this.renderComplete_=!0,this.timeSlider_.createTimeSlider(this.times_),this.playingListener_=this.get("map").on("change:playing",t=>{this.get("map").get("playing")&&this.animate_()}),this.updateTimeListener_(),this.nextListener_=this.get("map").on("next",t=>{this.next()}),this.previousListener_=this.get("map").on("previous",t=>{this.previous()}),t.set("time",this.config_.time),this.refreshTimer_=function interval$1(t,e,n){var i=new Timer,r=e;return null==e?(i.restart(t,e,n),i):(e=+e,n=null==n?now$1():+n,i.restart((function tick(o){o+=r,i.restart(tick,r+=e,n),t(o)}),e,n),i)}(this.refresh_.bind(this),this.refreshInterval_)}updateMap_(){let t=this.get("map");null==t?this.createMap_():(t.setTarget(this.config_.target),t.getLayerGroup().setLayers(this.createLayers_()),t.setView(this.createView_()),t.set("time",this.config_.time),this.updateTimeListener_(),this.timeUpdated_())}updateTimes_(){this.times_=[],this.status_={},this.config_.layers.forEach(t=>{if(null!=t.time&&null!=t.time.range){const e=null!=t.time.source?this.config_.sources[t.time.source]:this.config_.sources[t.source],n=this.capabilities_[e.tiles[0]];if(null==n||null==n.data||null==n.data.Capability||null==n.data.Capability.Layer||null==n.data.Capability.Layer.Layer)return;const i=n.data.Capability.Layer.Layer.find(e=>[t.url.layer,t.url.layers].includes(e.Name)),r=parseTimes(null!=i?i.Dimension.find(t=>"time"===t.name.toLowerCase()).values:[]),o=parseTimes(t.time.range,t.time.offset,r),a=Date.now();let s,l,u=0,c=0;o.forEach((t,e)=>{isNaN(t)||isFinite(t)||(t<0?(null==s&&(s=r.filter(t=>t<a).sort().reverse()),o[e]=s[u],u++):(null==l&&(l=r.filter(t=>t>=a).sort()),o[e]=l[c],c++))}),o.sort(),t.time.data=o.filter(t=>r.includes(t)),this.times_=[...new Set([...this.times_,...t.time.data])].sort()}}),this.times_.forEach(t=>{this.status_[t]=""})}play(t){this.delay_=Math.sign(t.delay)>0?t.delay:Ge,this.periodDelay_=Math.sign(t.periodDelay)>0?t.periodDelay:2*Ge,this.get("map").set("playing",!0)}animate_(){this.get("map").get("playing")&&(this.renderComplete_?(this.waitingRender_=0,this.next(),timeout$1(this.animate_.bind(this),this.delay_)):this.waitingRender_=Date.now())}getNextTime_(){const t=this.config_.time,e=this.times_.length;let n;for(let i=0;i<e;i++)if(this.isVisibleTime_(this.times_[i])){if(this.times_[i]>t){n=i;break}null==n&&(n=i)}return this.times_[n]}next(){this.isReady_()&&this.get("map").set("time",this.getNextTime_())}getPrevTime_(){const t=this.config_.time;let e;for(let n=this.times_.length-1;n>=0;n--)if(this.isVisibleTime_(this.times_[n])){if(this.times_[n]<t){e=n;break}null==e&&(e=n)}return this.times_[e]}previous(){this.isReady_()&&this.get("map").set("time",this.getPrevTime_())}isReady_(){return null!=this.get("map")&&this.times_.length>0}pause(){this.get("map").set("playing",!1)}stop(){this.pause()}destroy(){unByKey(this.playingListener_),unByKey(this.nextListener_),unByKey(this.previousListener_),unByKey(this.timeListener_),this.timeSlider_.destroy()}static transform(t,e,n){return j.defs("EPSG:3067","+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),register(j),transform(t,e,n)}}fetch("./config.json").then(t=>t.json()).then(t=>{const e=new MetOClient(t);e.render().then((function(){e.get("map");e.play({delay:1e3,time:Date.now()})})).catch(t=>{(console.error||console.log).call(console,t.stack||t)})})}();
